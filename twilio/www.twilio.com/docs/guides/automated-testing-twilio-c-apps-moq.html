


<!DOCTYPE html>
<html class="no-js">
  
<!-- Mirrored from www.twilio.com/docs/guides/automated-testing-twilio-c-apps-moq by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 22:10:05 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    
	<!-- Optimizely -->
	<script src="https://cdn.optimizely.com/js/6082066.js"></script>

    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width">
    
    
    <meta name="description" content="Learn how to automate testing of your Twilio API calls using C# and the Moq .NET mocking framework. Also learn good C# code decoupling techniques.">
    
    
    

    <title>
      Automated Testing of Twilio C# Apps with Moq - Twilio
    </title>

    <link rel="canonical" href="https://www.twilio.com/docs/guides/automated-testing-twilio-c-apps-moq" />

    
    <link rel="shortcut icon" href="https://www.twilio.com/docs/static/img/favicons/favicon.db41f19ea294.ico"/>
    <link rel="apple-touch-icon" href="https://www.twilio.com/docs/static/img/favicons/favicon_57.98200b6899e6.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="https://www.twilio.com/docs/static/img/favicons/favicon_72.86ae17486256.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="https://www.twilio.com/docs/static/img/favicons/favicon_114.ee1859950ad4.png"/>

    
    <link rel="stylesheet" type="text/css" href="http://cloud.typography.com/6230892/752864/css/fonts.css">
    <link rel="stylesheet" href="https://www.twilio.com/docs/static/css/font-awesome.min.295235b28b6e.css" />
    <link rel="stylesheet" href="https://www.twilio.com/docs/static/css/twilio-icons.45de73e993f2.css" />
    <link rel="stylesheet" href="https://www.twilio.com/docs/static/css/font-mfizz.818f36cb00cc.css" />

    
    
    <meta property="og:title" content="Automated Testing of Twilio C# Apps with Moq">
    
    
    <meta property="og:description" content="Learn how to automate testing of your Twilio API calls using C# and the Moq .NET mocking framework. Also learn good C# code decoupling techniques.">
    
    
    <meta property="og:url" content="https://www.twilio.com/docs/guides/automated-testing-twilio-c-apps-moq?utm_source=docs&utm_medium=social&utm_campaign=guides_tags">

    
    
    <meta name="twitter:title" content="Automated Testing of Twilio C# Apps with Moq">
    
    
    <meta name="twitter:description" content="Learn how to automate testing of your Twilio API calls using C# and the Moq .NET mocking framework. Also learn good C# code decoupling techniques.">
    
    

    
    

    

    
      <link rel="stylesheet" href="https://www.twilio.com/docs/static/css/docs.min.05ed18599e08.css" />
    

    
    

    
    <script>
  var twilio = twilio || {};
  twilio.realm = "prod";
  twilio.SWIFTYPE_ENGINE_KEY = "T68bXEBf7NaKzyRpvbnG";
</script>


<script>
  twilio.account = twilio.account || {};
  

  twilio.user = twilio.user || {};
  
  

</script>


    <script>
  
  window.userBetaFeatures = ["enable-video-rooms", "marketplace"];
</script>

  </head>

  <body class="
    
      guides
    
    
    
  ">

    

	
	<!-- Google Tag Manager -->
	<noscript><iframe src="http://www.googletagmanager.com/ns.html?id=GTM-MWRD6S"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'http://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window, document, 'script', 'dataLayer', 'GTM-MWRD6S');</script>
	<!-- End Google Tag Manager -->
	



    
    <div role="drawer" class="nav__drawer">
  <div role="drawer__wrapper" class="nav__drawer-wrapper">
    <div role="drawer__nav" class="nav__drawer-nav"><span class="nav__drawer-auth"><a href="https://www.twilio.com/login" class="nav__drawer-auth-link">Log In</a><a href="https://www.twilio.com/try-twilio" class="nav__drawer-auth-link">Sign Up</a></span><a href="#close" role="drawer__close" class="nav__drawer-close">Close</a></div>
    <div class="nav__drawer-menu">
      <div class="nav__drawer-container">
        <div class="nav__drawer-grid">
          <div class="nav__drawer-section">
            <div role="drawer__header" class="nav__drawer-header">Products</div>
            <div role="drawer__dropdown" class="nav__drawer-dropdown">
              <div class="nav__drawer-column">
                <ul>
                  <li><a href="https://www.twilio.com/voice-video" class="nav__drawer-link nav__drawer-link--category">Voice &amp; Video</a></li>
                  <li><a href="https://www.twilio.com/voice" class="nav__drawer-link">Programmable Voice</a></li>
                  <li><a href="https://www.twilio.com/video" class="nav__drawer-link">Programmable Video</a></li>
                  <li><a href="https://www.twilio.com/sip-trunking" class="nav__drawer-link">Elastic SIP Trunking</a></li>
                  <li><a href="https://www.twilio.com/taskrouter" class="nav__drawer-link">TaskRouter</a></li>
                  <li><a href="https://www.twilio.com/stun-turn" class="nav__drawer-link">Network Traversal</a></li>
                </ul>
                <ul>
                  <li><a href="https://www.twilio.com/messaging" class="nav__drawer-link nav__drawer-link--category">Messaging</a></li>
                  <li><a href="https://www.twilio.com/sms" class="nav__drawer-link">Programmable SMS</a></li>
                  <li><a href="https://www.twilio.com/chat" class="nav__drawer-link">Programmable Chat</a></li>
                  <li><a href="https://www.twilio.com/notify" class="nav__drawer-link">Notify</a></li>
                </ul>
              </div>
              <div class="nav__drawer-column">
                <ul>
                  <li>
                    <div class="nav__drawer-link nav__drawer-link--category">Authentication</div>
                  </li>
                  <li><a href="https://www.twilio.com/authy" class="nav__drawer-link">Authy</a></li>
                </ul>
                <ul>
                  <li>
                    <div class="nav__drawer-link nav__drawer-link--category">Connectivity</div>
                  </li>
                  <li><a href="https://www.twilio.com/lookup" class="nav__drawer-link">Lookup</a></li>
                  <li><a href="https://www.twilio.com/phone-numbers" class="nav__drawer-link">Phone Numbers</a></li>
                  <li><a href="https://www.twilio.com/wireless" class="nav__drawer-link">Programmable Wireless</a></li>
                  <li><a href="https://www.twilio.com/sync" class="nav__drawer-link">Sync</a></li>
                </ul>
                <ul>
                  <li>
                    <div class="nav__drawer-link nav__drawer-link--category">Marketplace</div>
                  </li>
                  <li><a href="https://www.twilio.com/marketplace/add-ons" class="nav__drawer-link">Add-ons</a></li>
                </ul>
                <ul>
                  <li>
                    <div class="nav__drawer-link nav__drawer-link--category">Platform</div>
                  </li>
                  <li><a href="https://www.twilio.com/enterprise" class="nav__drawer-link">Enterprise Plan</a></li>
                  <li><a href="https://www.twilio.com/interconnect" class="nav__drawer-link">Interconnect</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="nav__drawer-section">
            <div role="drawer__header" class="nav__drawer-header">Use Cases</div>
            <div role="drawer__dropdown" class="nav__drawer-dropdown">
              <ul>
                <li><a href="https://www.twilio.com/use-cases/access-security" class="nav__drawer-link nav__drawer-link--category">Access Security</a></li>
                <li><a href="https://www.twilio.com/use-cases/call-and-text-marketing" class="nav__drawer-link nav__drawer-link--category">Call &amp; Text Marketing</a></li>
                <li><a href="https://www.twilio.com/use-cases/collaboration" class="nav__drawer-link nav__drawer-link--category">Collaboration</a></li>
                <li><a href="https://www.twilio.com/use-cases/commerce-communications" class="nav__drawer-link nav__drawer-link--category">Commerce Communications</a></li>
                <li><a href="https://www.twilio.com/use-cases/contact-center" class="nav__drawer-link nav__drawer-link--category">Contact Center</a></li>
              </ul>
              <hr>
            </div>
            <div>
              <div class="nav__drawer-column">
                <ul>
                  <li><a href="https://customers.twilio.com/" class="nav__drawer-link nav__drawer-link--small">Customer Stories</a></li>
                  <li><a href="https://www.twilio.com/showcase" class="nav__drawer-link nav__drawer-link--small">Partner Showcase</a></li>
                  <li><a href="https://www.twilio.com/what-is-cloud-communications?" class="nav__drawer-link nav__drawer-link--small">Why Twilio?</a></li>
                  <li><a href="https://www.twilio.com/support-plans" class="nav__drawer-link nav__drawer-link--small">Support Plans</a></li>
                  <li><a href="http://status.twilio.com/" class="nav__drawer-link nav__drawer-link--small">Status</a></li>
                </ul>
              </div>
              <div class="nav__drawer-column">
                <ul>
                  <li><a href="https://www.twilio.com/docs" class="nav__drawer-link nav__drawer-link--small">API &amp; Docs</a></li>
                  <li><a href="https://www.twilio.com/blog" class="nav__drawer-link nav__drawer-link--small">Blog</a></li>
                  <li><a href="https://www.twilio.com/help" class="nav__drawer-link nav__drawer-link--small">Help</a></li>
                  <li><a href="https://www.twilio.com/company/jobs" class="nav__drawer-link nav__drawer-link--small">Jobs at Twilio</a></li>
                </ul>
              </div>
            </div>
            <div class="nav__sales"><a href="https://www.twilio.com/help/sales" class="nav__sales-button">Talk to Sales</a></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div role="nav" class="nav nav--subnav nav--inverted nav--transparent " data-subnav-length="40">
  <div role="nav__menu" class="nav__header">
    <div class="nav__title"><a href="https://www.twilio.com/" class="nav__logo">Twilio</a></div>
    <nav class="nav__menu">
      <ul class="nav__menu-items">
        <li class="nav__menu-item"></li>
        
        <li class="nav__menu-item">
          <a href="https://www.twilio.com/login" class="nav__menu-link">
            <svg xmlns="http://www.w3.org/2000/svg" width="10.2" height="13.5" viewBox="0 0 10.2 13.5">
              <circle fill="none" stroke="#F22F46" stroke-miterlimit="10" cx="5.1" cy="3" r="2.5"></circle>
              <path fill="none" stroke="#F22F46" stroke-miterlimit="10" d="M.5 13.5c0-2.5 2.1-4.6 4.6-4.6s4.6 2.1 4.6 4.6"></path>
            </svg>
            Log In
          </a>
        </li>
        <li class="nav__menu-item">
          <a href="https://www.twilio.com/try-twilio" class="nav__menu-link">
            <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 13 13">
              <path d="M0 6.5h13M6.5 0v13" fill="none" stroke="#F22F46" stroke-miterlimit="10"></path>
            </svg>
            Sign Up
          </a>
        </li>
        
        <li class="nav__menu-item"><a href="#menu" role="nav__activate" class="nav__menu-link nav__menu-activate"><span></span>Menu &amp; Products</a></li>
      </ul>
    </nav>
    <nav role="subnav" class="nav__subnav">
      <header class="nav__subnav-header">
        <a href="https://www.twilio.com/docs" class="nav__subnav-header-link">Docs</a>
        
          <a href="https://www.twilio.com/docs/guides" role="subnav__dropdown" 
            class="nav__subnav-link nav__subnav-current">Guides</a>
        
      </header>
      <ul role="subnav__items" class="nav__subnav-items">
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/quickstart" class="nav__subnav-link">Quickstart</a>
        </li>
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/guides" class="nav__subnav-link">Guides</a>
        </li>
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/tutorials" class="nav__subnav-link">Tutorials</a>
        </li>
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/api" class="nav__subnav-link">API Reference</a>
        </li>
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/libraries" class="nav__subnav-link">SDKs</a>
        </li>
      </ul>
    </nav>
  </div>
</div>



    
    
      

<div class="docs__pagenav">
  <div class="uk-container uk-container-center">
    <div class="uk-grid">
      <div class="uk-width-3-4 uk-hidden-small">
      
      
        <div class="breadcrumbs">
          
            
          
            
          
            
              <a href="https://www.twilio.com/docs/guides">Guides</a> &gt;
            
          
          <span>Automated Testing of Twilio C# Apps with Moq</span>
        </div>
      
      </div>

      
      <div class="uk-width-1-1 uk-width-medium-1-4">
  <div class="search">
    <form action="https://www.twilio.com/docs/search" method="GET">
      <div class="wrapper">
        <input id="search-box" name="q" type="text" value=""/>
      </div>
      <button type="submit">
        <i class="fa fa-fw fa-search"></i>
      </button>
    </form>
  </div>
</div>

    </div>
  </div>
</div>

    

    <div class="docs-container">
      <div class="uk-container">
        
        
  <div class="coderail-container">

    <div class="sidenav-column">
      <div class="theme-switcher uk-hidden-small">
  <div class="theme-wrapper">
    <a data-theme="light" class="selected">
      <i class="fa fa-fw fa-sun-o"></i>
    </a>
    <a data-theme="dark" >
      <i class="fa fa-fw fa-moon-o"></i>
    </a>
  </div>
</div>
      
        <div class="sidenav" data-uk-sticky="{boundary: true}">
          

<ul id="doc_menu" class="sidenav__section" data-swiftype-index="false">

  <!-- Page entries -->
  
    <li id="dynamic-menu">
      <ul>
        
          
            
<li class="menu-title expanded" role="menu-title" id="doc-navigation-parent">
  Automated Testing of Twilio C# Apps with Moq
</li>
<ul class="menu-accordion expanded" role="menu-accordion" id="doc-navigation"></ul>

          
          
<li class="menu-title expanded" role="menu-title">

    <span class="heading">Related Guides</span>
</li>


<ul class="menu-accordion expanded" role="menu-accordion">

    
        



  <li 
    >
      <a href="https://www.twilio.com/docs/guides/sms/how-to-send-sms-messages-in-csharp">
          Send SMS and MMS Messages in C#
      </a>
  </li>



    
        



  <li 
    >
      <a href="https://www.twilio.com/docs/guides/voice/how-to-make-outbound-phone-calls-in-csharp">
          Make Outbound Phone Calls with C#
      </a>
  </li>



    
</ul>

        
        
      </ul>
    </li>
  
</ul>

        </div>
      
    </div>

    <div class="primary-column 
        ">
      <div class="docs-prose">
        
  
    
    <h1 class="page-title ">
      Automated Testing of Twilio C# Apps with Moq
    </h1>
    
      
<div class="authors">
  <div class="authors-body">
    <div class="author">
      <img src="https://www.gravatar.com/avatar/560630d6945c6a8777533e7ea3b4e69b?d=mm&amp;s=50" title="David Prothero" alt="David Prothero" />
      David Prothero
    </div>
  </div>
  <div class="authors-footer"></div>
</div>


    
  
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><p>Automating testing of apps that rely on third-party API's like Twilio can be challenging. Let's look at how structure your C# app and write tests using Moq to achieve automated testing nirvana. All of the example code in this guide is <a href="https://github.com/TwilioDevEd/automated-testing-csharp">available on GitHub</a>.</p>
<h2 id="set-things-up"><a class="toclink" href="#set-things-up">Set Things Up</a></h2>
<h3 id="create-a-test-project"><a class="toclink" href="#create-a-test-project">Create a Test Project</a></h3>
<p>We'll use <a href="https://www.visualstudio.com/en-us/docs/test/developer-testing/getting-started/getting-started-with-developer-testing">Visual Studio's built-in test projects</a> for this guide, but the practices here translate readily to alternative testing frameworks such as <a href="https://www.nunit.org/">NUnit</a> and <a href="https://xunit.github.io/">xUnit</a>.</p>
<p>To add a new test project to your existing solution, right-click on your solution in the Solution Explorer and select Add... New Project:</p>
<p><img alt="Visual Studio - Add Test Project" class="richtext-image full-width" height="491" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/VSAddTestProject.width-800.png" width="651"/></p>
<p>Select a Unit Test project and name your new project:</p>
<p><img alt="Visual Studio - New Test Project" class="richtext-image full-width" height="460" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/VSNewTestProject.width-800.png" width="800"/></p>
<p>Don't forget to add project references to other projects in the solution that you want to test:</p>
<p><img alt="Visual Studio - Add References to Test Project" class="richtext-image full-width" height="142" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/VSAddReferences.width-800.png" width="240"/></p>
<p><img alt="Visual Studio - Add References to Test Project" class="richtext-image full-width" height="227" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/VSAddReferences2.width-800.png" width="396"/></p></div>

      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><h3 id="install-the-moq-mocking-framework"><a class="toclink" href="#install-the-moq-mocking-framework">Install the Moq Mocking Framework</a></h3>
<p>When testing our services in isolation we'll create <a href="https://en.wikipedia.org/wiki/Mock_object">mock objects</a>. Mock objects are the crash-test dummies of software development.</p>
<p>Let's install the mocking framework Moq using Nuget:</p>
<div class="codehilite"><pre><span class="code-line">Install-Package Moq
</span></pre></div>
<p>Make sure before you run that command the "Default project" is set to your test project:</p>
<p><img alt="Visual Studio - Install Moq Package" class="richtext-image full-width" height="98" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/VSPackageMgrConsole.width-800.png" width="526"/></p></div>

      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><h2 id="improve-your-apps-testability"><a class="toclink" href="#improve-your-apps-testability">Improve Your App's Testability</a></h2>
<h3 id="decouple-code-that-makes-external-api-calls"><a class="toclink" href="#decouple-code-that-makes-external-api-calls">Decouple Code That Makes External API Calls</a></h3>
<p>Let's say you're building an <code>OrderService</code> class that needs to process orders for items. It needs to reserve inventory, ship the order, and notify the customer via SMS that their order has been shipped. You could call the Twilio API to send the SMS directly from your service. Your code might look like this:</p>
<div class="codehilite"><pre><span class="code-line"><span class="k">public</span> <span class="k">void</span> <span class="nf">ProcessOrder</span><span class="p">(</span><span class="n">IOrder</span> <span class="n">order</span><span class="p">)</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line">    <span class="n">TryReserveInventory</span><span class="p">(</span><span class="n">order</span><span class="p">);</span>
</span><span class="code-line">    <span class="kt">var</span> <span class="n">trackingNum</span> <span class="p">=</span> <span class="n">ShipOrder</span><span class="p">(</span><span class="n">order</span><span class="p">);</span>
</span><span class="code-line">    <span class="kt">var</span> <span class="n">message</span> <span class="p">=</span> <span class="err">$</span><span class="s">"Your order {order.Id} has shipped! Tracking: {trackingNum}"</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="kt">var</span> <span class="n">accountSid</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">"TwilioAccountSid"</span><span class="p">];</span>
</span><span class="code-line">    <span class="kt">var</span> <span class="n">authToken</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">"TwilioAuthToken"</span><span class="p">];</span>
</span><span class="code-line">    <span class="kt">var</span> <span class="n">fromPhoneNumber</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">"TwilioFromNumber"</span><span class="p">];</span>
</span><span class="code-line">    <span class="kt">var</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TwilioRestClient</span><span class="p">(</span><span class="n">accountSid</span><span class="p">,</span> <span class="n">authToken</span><span class="p">);</span>
</span><span class="code-line">    <span class="n">client</span><span class="p">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">fromPhoneNumber</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">Customer</span><span class="p">.</span><span class="n">MobileNumber</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
</span><span class="code-line"><span class="p">}</span>
</span></pre></div>
<p>The problem is that your <code>OrderService</code> is <a href="http://stackoverflow.com/questions/2832017/what-is-the-difference-between-loose-coupling-and-tight-coupling-in-object-orien">tightly coupled</a> to the Twilio API. Tight coupling is bad for a number of reasons, but it's especially bad for testability. What we need is a simple <code>NotificationService</code> that can handle talking to the Twilio API. This will allow us to test our <code>OrderService</code> in isolation without actually sending a text message.</p>
<p>Now our code can look something like:</p>
<div class="codehilite"><pre><span class="code-line"><span class="k">public</span> <span class="k">void</span> <span class="nf">ProcessOrder</span><span class="p">(</span><span class="n">IOrder</span> <span class="n">order</span><span class="p">)</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line">    <span class="n">TryReserveInventory</span><span class="p">(</span><span class="n">order</span><span class="p">);</span>
</span><span class="code-line">    <span class="kt">var</span> <span class="n">trackingNum</span> <span class="p">=</span> <span class="n">ShipOrder</span><span class="p">(</span><span class="n">order</span><span class="p">);</span>
</span><span class="code-line">    <span class="n">_notificationService</span><span class="p">.</span><span class="n">SendText</span><span class="p">(</span><span class="n">order</span><span class="p">.</span><span class="n">Customer</span><span class="p">.</span><span class="n">MobileNumber</span><span class="p">,</span>
</span><span class="code-line">        <span class="err">$</span><span class="s">"Your order {order.Id} has shipped! Tracking: {trackingNum}"</span><span class="p">);</span>
</span><span class="code-line"><span class="p">}</span>
</span></pre></div>
<p>And here's the full code of our new <code>NotificationService</code>:</p></div>

      
    </div>
  
    <div class="block-code_sample ">
      
        

<div class="md-code-sample" id="code-simple-c-notificationservice" 
  data-title="Simple C# NotificationService" data-pref="server">

  <div class="inline-mode">
    <div class="code-snippets">
      <div class="sample-tabs">
      <a class="title" href="#code-simple-c-notificationservice">Simple C# NotificationService</a>
        <ul style="visibility:hidden" >
          
            <li class="sample-tab active" 
              data-ext="cs">C#</li>
          
        </ul>
      </div>

      
        
      
          
      
        <pre data-ext="cs" data-version="default" class="codehilite"><code><span class="code-line"><span class="k">using</span> <span class="nn">Twilio</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Interfaces.Exceptions</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Interfaces.Services</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="k">namespace</span> <span class="nn">TwilioStore.Services</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line">    <span class="k">public</span> <span class="k">class</span> <span class="nc">NotificationService</span> <span class="p">:</span> <span class="n">INotificationService</span>
</span><span class="code-line">    <span class="p">{</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">readonly</span> <span class="n">TwilioRestClient</span> <span class="n">_client</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="nf">NotificationService</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">accountSid</span> <span class="p">=</span> 
</span><span class="code-line">                <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;TwilioAccountSid&quot;</span><span class="p">];</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">authToken</span> <span class="p">=</span> 
</span><span class="code-line">                <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;TwilioAuthToken&quot;</span><span class="p">];</span>
</span><span class="code-line">            <span class="n">_client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TwilioRestClient</span><span class="p">(</span><span class="n">accountSid</span><span class="p">,</span> <span class="n">authToken</span><span class="p">);</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">SendText</span><span class="p">(</span><span class="kt">string</span> <span class="n">to</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">fromPhoneNumber</span> <span class="p">=</span> 
</span><span class="code-line">                <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;TwilioFromNumber&quot;</span><span class="p">];</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">_client</span><span class="p">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">fromPhoneNumber</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
</span><span class="code-line">            <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotificationException</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
</span><span class="code-line">            <span class="p">}</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">    <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></code></pre>
      
    </div>

    
  </div>

  <div class="button-mode">
    <h5 class="title">
      <i class="fa fa-fw fa-code"></i>
      Simple C# NotificationService
    </h5>
    
      <p>Example C# NotificationService that sends a text message.</p>
    
    <div class="active-tail"></div>
  </div>
</div>



      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><p>Notice that it implements an <code>INotificationService</code> interface, which will come in handy for mocking later.</p>
<div class="codehilite"><pre><span class="code-line"><span class="k">namespace</span> <span class="nn">TwilioStore.Interfaces.Services</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line">    <span class="k">public</span> <span class="k">interface</span> <span class="n">INotificationService</span>
</span><span class="code-line">    <span class="p">{</span>
</span><span class="code-line">        <span class="k">void</span> <span class="nf">SendText</span><span class="p">(</span><span class="kt">string</span> <span class="n">to</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span><span class="p">);</span>
</span><span class="code-line">    <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></pre></div>
<h3 id="decouple-api-credential-configuration"><a class="toclink" href="#decouple-api-credential-configuration">Decouple API Credential Configuration</a></h3>
<p>There's one more change we should make to improve our testability. In our notification service, we're loading configuration values like so:</p>
<div class="codehilite"><pre><span class="code-line"><span class="kt">var</span> <span class="n">accountSid</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">"TwilioAccountSid"</span><span class="p">];</span>
</span><span class="code-line"><span class="kt">var</span> <span class="n">authToken</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">"TwilioAuthToken"</span><span class="p">];</span>
</span><span class="code-line"><span class="p">...</span>
</span><span class="code-line"><span class="kt">var</span> <span class="n">fromPhoneNumber</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">"TwilioFromNumber"</span><span class="p">];</span>
</span></pre></div>
<p>When we test <code>NotificationService</code>, we don't want to be tightly coupled to the configuration system. In fact, we might even want to test our service with different values for different tests. So, let's extract a new class we'll call <code>NotificationConfiguration</code>:</p></div>

      
    </div>
  
    <div class="block-code_sample ">
      
        

<div class="md-code-sample" id="code-c-notificationconfiguration-class" 
  data-title="C# NotificationConfiguration class" data-pref="server">

  <div class="inline-mode">
    <div class="code-snippets">
      <div class="sample-tabs">
      <a class="title" href="#code-c-notificationconfiguration-class">C# NotificationConfiguration class</a>
        <ul style="visibility:hidden" >
          
            <li class="sample-tab active" 
              data-ext="cs">C#</li>
          
        </ul>
      </div>

      
        
      
          
      
        <pre data-ext="cs" data-version="default" class="codehilite"><code><span class="code-line"><span class="k">using</span> <span class="nn">System.Configuration</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Interfaces.Services</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="k">namespace</span> <span class="nn">TwilioStore.Services</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line">    <span class="k">public</span> <span class="k">class</span> <span class="nc">NotificationConfiguration</span> <span class="p">:</span> <span class="n">INotificationConfiguration</span>
</span><span class="code-line">    <span class="p">{</span>
</span><span class="code-line">        <span class="k">public</span> <span class="nf">NotificationConfiguration</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="n">AccountSid</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;TwilioAccountSid&quot;</span><span class="p">];</span>
</span><span class="code-line">            <span class="n">AuthToken</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;TwilioAuthToken&quot;</span><span class="p">];</span>
</span><span class="code-line">            <span class="n">DefaultFromPhoneNumber</span> <span class="p">=</span> 
</span><span class="code-line">                <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;TwilioFromNumber&quot;</span><span class="p">];</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="kt">string</span> <span class="n">AccountSid</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class="code-line">        <span class="k">public</span> <span class="kt">string</span> <span class="n">AuthToken</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class="code-line">        <span class="k">public</span> <span class="kt">string</span> <span class="n">DefaultFromPhoneNumber</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class="code-line">    <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></code></pre>
      
    </div>

    
  </div>

  <div class="button-mode">
    <h5 class="title">
      <i class="fa fa-fw fa-code"></i>
      C# NotificationConfiguration class
    </h5>
    
      <p>Configuration class for the NotificationService</p>
    
    <div class="active-tail"></div>
  </div>
</div>



      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><p>Again, we created an interface for this class:</p>
<div class="codehilite"><pre><span class="code-line"><span class="k">namespace</span> <span class="nn">TwilioStore.Interfaces.Services</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line">    <span class="k">public</span> <span class="k">interface</span> <span class="n">INotificationConfiguration</span>
</span><span class="code-line">    <span class="p">{</span>
</span><span class="code-line">        <span class="kt">string</span> <span class="n">AccountSid</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class="code-line">        <span class="kt">string</span> <span class="n">AuthToken</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class="code-line">        <span class="kt">string</span> <span class="n">DefaultFromPhoneNumber</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class="code-line">    <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></pre></div>
<p>Now our <code>NotificationService</code> can make use of this configuration class to get the required variables. Notice below how we allow passing in a custom <code>INotificationConfiguration</code>. If none is passed in, it defaults to our <code>NotificationConfiguration</code> implmentation. For fun, let's also add <code>MakePhoneCall()</code> and <code>BuyPhoneNumber()</code> methods to our service.</p>
<p>Here's the completed code:</p></div>

      
    </div>
  
    <div class="block-code_sample ">
      
        

<div class="md-code-sample" id="code-completed-c-notificationservice" 
  data-title="Completed C# NotificationService" data-pref="server">

  <div class="inline-mode">
    <div class="code-snippets">
      <div class="sample-tabs">
      <a class="title" href="#code-completed-c-notificationservice">Completed C# NotificationService</a>
        <ul style="visibility:hidden" >
          
            <li class="sample-tab active" 
              data-ext="cs">C#</li>
          
        </ul>
      </div>

      
        
      
          
      
        <pre data-ext="cs" data-version="default" class="codehilite"><code><span class="code-line"><span class="k">using</span> <span class="nn">Twilio</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Interfaces.Services</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Services.Exceptions</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="k">namespace</span> <span class="nn">TwilioStore.Services</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line">    <span class="k">public</span> <span class="k">class</span> <span class="nc">NotificationService</span> <span class="p">:</span> <span class="n">INotificationService</span>
</span><span class="code-line">    <span class="p">{</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">readonly</span> <span class="n">TwilioRestClient</span> <span class="n">_client</span><span class="p">;</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">readonly</span> <span class="n">INotificationConfiguration</span> <span class="n">_config</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="nf">NotificationService</span><span class="p">()</span> <span class="p">:</span> <span class="k">this</span><span class="p">(</span><span class="k">new</span> <span class="n">NotificationConfiguration</span><span class="p">())</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="nf">NotificationService</span><span class="p">(</span><span class="n">INotificationConfiguration</span> <span class="n">config</span><span class="p">)</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="n">_config</span> <span class="p">=</span> <span class="n">config</span><span class="p">;</span>
</span><span class="code-line">            <span class="n">_client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TwilioRestClient</span><span class="p">(</span><span class="n">_config</span><span class="p">.</span><span class="n">AccountSid</span><span class="p">,</span> 
</span><span class="code-line">                <span class="n">_config</span><span class="p">.</span><span class="n">AuthToken</span><span class="p">);</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">SendText</span><span class="p">(</span><span class="kt">string</span> <span class="n">to</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">_client</span><span class="p">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">_config</span><span class="p">.</span><span class="n">DefaultFromPhoneNumber</span><span class="p">,</span> 
</span><span class="code-line">                <span class="n">to</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
</span><span class="code-line">            <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotificationException</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
</span><span class="code-line">            <span class="p">}</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">MakePhoneCall</span><span class="p">(</span><span class="kt">string</span> <span class="n">to</span><span class="p">,</span> <span class="kt">string</span> <span class="n">voiceUrl</span><span class="p">)</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">_client</span><span class="p">.</span><span class="n">InitiateOutboundCall</span><span class="p">(</span>
</span><span class="code-line">                <span class="n">_config</span><span class="p">.</span><span class="n">DefaultFromPhoneNumber</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">voiceUrl</span><span class="p">);</span>
</span><span class="code-line">            <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotificationException</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
</span><span class="code-line">            <span class="p">}</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">BuyPhoneNumber</span><span class="p">(</span><span class="kt">string</span> <span class="n">number</span><span class="p">)</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">_client</span><span class="p">.</span><span class="n">AddIncomingPhoneNumber</span><span class="p">(</span><span class="k">new</span> <span class="n">PhoneNumberOptions</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="n">PhoneNumber</span> <span class="p">=</span> <span class="n">number</span>
</span><span class="code-line">            <span class="p">});</span>
</span><span class="code-line">            <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotificationException</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
</span><span class="code-line">            <span class="p">}</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">    <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></code></pre>
      
    </div>

    
  </div>

  <div class="button-mode">
    <h5 class="title">
      <i class="fa fa-fw fa-code"></i>
      Completed C# NotificationService
    </h5>
    
      <p>Sends text messages, makes phone calls, and buys phone numbers!</p>
    
    <div class="active-tail"></div>
  </div>
</div>



      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><p>And the final interface:</p>
<div class="codehilite"><pre><span class="code-line"><span class="k">namespace</span> <span class="nn">TwilioStore.Interfaces.Services</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line">    <span class="k">public</span> <span class="k">interface</span> <span class="n">INotificationService</span>
</span><span class="code-line">    <span class="p">{</span>
</span><span class="code-line">        <span class="k">void</span> <span class="nf">SendText</span><span class="p">(</span><span class="kt">string</span> <span class="n">to</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span><span class="p">);</span>
</span><span class="code-line">        <span class="k">void</span> <span class="nf">MakePhoneCall</span><span class="p">(</span><span class="kt">string</span> <span class="n">to</span><span class="p">,</span> <span class="kt">string</span> <span class="n">voiceUrl</span><span class="p">);</span>
</span><span class="code-line">        <span class="k">void</span> <span class="nf">BuyPhoneNumber</span><span class="p">(</span><span class="kt">string</span> <span class="n">number</span><span class="p">);</span>
</span><span class="code-line">    <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></pre></div>
<h2 id="test-your-apps-logic-with-moq"><a class="toclink" href="#test-your-apps-logic-with-moq">Test Your App's Logic with Moq</a></h2>
<p>Now, let's test our <code>ProcessOrder()</code> method. We just want to make sure that it calls our <code>NotificationService.SendText()</code> method with the right values, but we don't need to actually talk to the Twilio API. Let's use Moq to create a mock <code>INotificationService</code>:</p>
<div class="codehilite"><pre><span class="code-line"><span class="kt">var</span> <span class="n">notificationServiceMock</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Mock</span><span class="p">&lt;</span><span class="n">INotificationService</span><span class="p">&gt;();</span>
</span><span class="code-line"><span class="kt">string</span> <span class="n">textMessage</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span><span class="code-line"><span class="n">notificationServiceMock</span><span class="p">.</span><span class="n">Setup</span><span class="p">(</span>
</span><span class="code-line">        <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">SendText</span><span class="p">(</span><span class="n">ValidToNumber</span><span class="p">,</span> <span class="n">It</span><span class="p">.</span><span class="n">IsAny</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;())</span>
</span><span class="code-line">    <span class="p">)</span>
</span><span class="code-line">    <span class="p">.</span><span class="n">Callback</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;((</span><span class="n">_</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">textMessage</span> <span class="p">=</span> <span class="n">message</span><span class="p">);</span>
</span></pre></div>
<p>The call to <code>Setup()</code> tells our mock to expect a call to the <code>SendText()</code> method with the first parameter a constant we defined to represent a valid customer's phone number and <em>any</em> string for the second, message parameter. We then provide a callback method that saves the message into a variable for later inspection.</p>
<p>Using the mock object is as easy as passing it into our <code>OrderService</code>:</p>
<div class="codehilite"><pre><span class="code-line"><span class="kt">var</span> <span class="n">orderService</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderService</span><span class="p">(</span><span class="n">notificationServiceMock</span><span class="p">.</span><span class="n">Object</span><span class="p">);</span>
</span><span class="code-line"><span class="n">orderService</span><span class="p">.</span><span class="n">ProcessOrder</span><span class="p">(</span><span class="n">fakeOrder</span><span class="p">);</span>
</span></pre></div>
<p>Finally, we can assert that the <code>SendText()</code> method was called exactly once:</p>
<div class="codehilite"><pre><span class="code-line"><span class="n">notificationServiceMock</span><span class="p">.</span><span class="n">Verify</span><span class="p">(</span>
</span><span class="code-line">        <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">SendText</span><span class="p">(</span><span class="n">ValidToNumber</span><span class="p">,</span> <span class="n">It</span><span class="p">.</span><span class="n">IsAny</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;()),</span>
</span><span class="code-line">        <span class="n">Times</span><span class="p">.</span><span class="n">Once</span>
</span><span class="code-line">    <span class="p">);</span>
</span></pre></div>
<p>Here's the complete code for our test:</p></div>

      
    </div>
  
    <div class="block-code_sample ">
      
        

<div class="md-code-sample" id="code-test-the-c-orderservice" 
  data-title="Test the C# OrderService" data-pref="server">

  <div class="inline-mode">
    <div class="code-snippets">
      <div class="sample-tabs">
      <a class="title" href="#code-test-the-c-orderservice">Test the C# OrderService</a>
        <ul style="visibility:hidden" >
          
            <li class="sample-tab active" 
              data-ext="cs">C#</li>
          
        </ul>
      </div>

      
        
      
          
      
        <pre data-ext="cs" data-version="default" class="codehilite"><code><span class="code-line"><span class="k">using</span> <span class="nn">Microsoft.VisualStudio.TestTools.UnitTesting</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">Moq</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Domain</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Interfaces.Services</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Services</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="k">namespace</span> <span class="nn">TwilioStore.Tests.Services</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line"><span class="na">    [TestClass]</span>
</span><span class="code-line">    <span class="k">public</span> <span class="k">class</span> <span class="nc">OrderServiceTest</span>
</span><span class="code-line">    <span class="p">{</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">ValidToNumber</span> <span class="p">=</span> <span class="s">&quot;+18778894546&quot;</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="na">        [TestMethod]</span>
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">ProcessOrder_Should_Notify_Customer</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="c1">// Arrange</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">fakeOrder</span> <span class="p">=</span> <span class="n">GetFakeOrder</span><span class="p">();</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="kt">var</span> <span class="n">notificationServiceMock</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Mock</span><span class="p">&lt;</span><span class="n">INotificationService</span><span class="p">&gt;();</span>
</span><span class="code-line">            <span class="kt">string</span> <span class="n">textMessage</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span><span class="code-line">            <span class="n">notificationServiceMock</span><span class="p">.</span><span class="n">Setup</span><span class="p">(</span>
</span><span class="code-line">                    <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">SendText</span><span class="p">(</span><span class="n">ValidToNumber</span><span class="p">,</span> <span class="n">It</span><span class="p">.</span><span class="n">IsAny</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;())</span>
</span><span class="code-line">                <span class="p">)</span>
</span><span class="code-line">                <span class="p">.</span><span class="n">Callback</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;((</span><span class="n">_</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">textMessage</span> <span class="p">=</span> <span class="n">message</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="c1">// Act</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">orderService</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderService</span><span class="p">(</span><span class="n">notificationServiceMock</span><span class="p">.</span><span class="n">Object</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">orderService</span><span class="p">.</span><span class="n">ProcessOrder</span><span class="p">(</span><span class="n">fakeOrder</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="c1">// Assert</span>
</span><span class="code-line">            <span class="n">notificationServiceMock</span><span class="p">.</span><span class="n">Verify</span><span class="p">(</span>
</span><span class="code-line">                    <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">SendText</span><span class="p">(</span><span class="n">ValidToNumber</span><span class="p">,</span> <span class="n">It</span><span class="p">.</span><span class="n">IsAny</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;()),</span>
</span><span class="code-line">                    <span class="n">Times</span><span class="p">.</span><span class="n">Once</span>
</span><span class="code-line">                <span class="p">);</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">expectedMessageStart</span> <span class="p">=</span> <span class="err">$</span><span class="s">&quot;Your order {fakeOrder.Id} has &quot;</span> <span class="p">+</span>
</span><span class="code-line">                <span class="s">&quot;shipped! Tracking: &quot;</span><span class="p">;</span>
</span><span class="code-line">            <span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">textMessage</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="n">expectedMessageStart</span><span class="p">));</span>
</span><span class="code-line">            <span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">textMessage</span><span class="p">.</span><span class="n">Length</span> <span class="p">&gt;</span> <span class="n">expectedMessageStart</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">private</span> <span class="k">static</span> <span class="n">Order</span> <span class="nf">GetFakeOrder</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">fakeOrder</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Order</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="n">Id</span> <span class="p">=</span> <span class="s">&quot;1234&quot;</span><span class="p">,</span>
</span><span class="code-line">                <span class="n">Customer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Customer</span>
</span><span class="code-line">                <span class="p">{</span>
</span><span class="code-line">                    <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Joe Customer&quot;</span><span class="p">,</span>
</span><span class="code-line">                    <span class="n">MobileNumber</span> <span class="p">=</span> <span class="n">ValidToNumber</span>
</span><span class="code-line">                <span class="p">}</span>
</span><span class="code-line">            <span class="p">};</span>
</span><span class="code-line">            <span class="n">fakeOrder</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">OrderDetail</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="n">ItemId</span> <span class="p">=</span> <span class="s">&quot;5678&quot;</span><span class="p">,</span>
</span><span class="code-line">                <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;Widget&quot;</span><span class="p">,</span>
</span><span class="code-line">                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">1</span>
</span><span class="code-line">            <span class="p">});</span>
</span><span class="code-line">            <span class="k">return</span> <span class="n">fakeOrder</span><span class="p">;</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">    <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></code></pre>
      
    </div>

    
  </div>

  <div class="button-mode">
    <h5 class="title">
      <i class="fa fa-fw fa-code"></i>
      Test the C# OrderService
    </h5>
    
      <p>Test ProcessOrder, mocking the INotificationService</p>
    
    <div class="active-tail"></div>
  </div>
</div>



      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><h2 id="test-your-external-api-classes"><a class="toclink" href="#test-your-external-api-classes">Test Your External API Classes</a></h2>
<p>Since your application logic will likely have many tests, it makes sense for the tests not to hit an external API every time. But what about the <code>NotificationService</code>? Where's the test coverage love for him?</p>
<p>Thankfully, Twilio provides <a href="https://www.twilio.com/docs/api/rest/test-credentials">test credentials</a> that we can use to allow us to write a suite of tests to exercise our service. Our approach will be to create a mock of <code>INotificationConfiguration</code> that provides our test credentials instead of reading them from a configuration file:</p>
<div class="codehilite"><pre><span class="code-line"><span class="k">private</span> <span class="k">static</span> <span class="n">INotificationConfiguration</span> <span class="nf">GetTestConfig</span><span class="p">()</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line">    <span class="kt">var</span> <span class="n">configMock</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Mock</span><span class="p">&lt;</span><span class="n">INotificationConfiguration</span><span class="p">&gt;();</span>
</span><span class="code-line">    <span class="n">configMock</span><span class="p">.</span><span class="n">SetupGet</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">AccountSid</span><span class="p">)</span>
</span><span class="code-line">        <span class="p">.</span><span class="n">Returns</span><span class="p">(</span><span class="n">TestAccountSid</span><span class="p">);</span>
</span><span class="code-line">    <span class="n">configMock</span><span class="p">.</span><span class="n">SetupGet</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">AuthToken</span><span class="p">)</span>
</span><span class="code-line">        <span class="p">.</span><span class="n">Returns</span><span class="p">(</span><span class="n">TestAuthToken</span><span class="p">);</span>
</span><span class="code-line">    <span class="n">configMock</span><span class="p">.</span><span class="n">SetupGet</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">DefaultFromPhoneNumber</span><span class="p">)</span>
</span><span class="code-line">        <span class="p">.</span><span class="n">Returns</span><span class="p">(</span><span class="n">ValidFromNumber</span><span class="p">);</span>
</span><span class="code-line">    <span class="k">return</span> <span class="n">configMock</span><span class="p">.</span><span class="n">Object</span><span class="p">;</span>
</span><span class="code-line"><span class="p">}</span>
</span></pre></div>
<h3 id="test-sending-an-sms"><a class="toclink" href="#test-sending-an-sms">Test Sending an SMS</a></h3>
<p>As <a href="https://www.twilio.com/docs/api/rest/test-credentials">documented in our API Reference</a>, when you use your test credentials there are special phone numbers you can use for your testing. For SMS tests you can send a text to any valid phone number and you will receive a successful response.</p>
<p>Here's how we could test that, passing in the mock config object we created above:</p>
<div class="codehilite"><pre><span class="code-line"><span class="na">[TestMethod]</span>
</span><span class="code-line"><span class="k">public</span> <span class="k">void</span> <span class="nf">SendText_Should_Send_a_Text</span><span class="p">()</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line">    <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">GetTestConfig</span><span class="p">();</span>
</span><span class="code-line">    <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NotificationService</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span class="code-line">    <span class="n">service</span><span class="p">.</span><span class="n">SendText</span><span class="p">(</span><span class="n">ValidToNumber</span><span class="p">,</span> <span class="s">"Test message"</span><span class="p">);</span>
</span><span class="code-line">    <span class="c1">// Should complete w/o exception</span>
</span><span class="code-line"><span class="p">}</span>
</span></pre></div>
<p>To test an invalid phone number, use the magic number "+15005550001" (which we can assign to the constant <code>InvalidNumber</code>):</p>
<div class="codehilite"><pre><span class="code-line"><span class="na">[TestMethod]</span>
</span><span class="code-line"><span class="na">[ExpectedException(typeof(NotificationException))]</span>
</span><span class="code-line"><span class="k">public</span> <span class="k">void</span> <span class="nf">SendText_Should_Throw_Exception_If_Bad_Number</span><span class="p">()</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line">    <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">GetTestConfig</span><span class="p">();</span>
</span><span class="code-line">    <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NotificationService</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span class="code-line">    <span class="n">service</span><span class="p">.</span><span class="n">SendText</span><span class="p">(</span><span class="n">InvalidNumber</span><span class="p">,</span> <span class="s">"Test message"</span><span class="p">);</span>
</span><span class="code-line"><span class="p">}</span>
</span></pre></div>
<p>Notice how this test uses the <code>ExpectedException</code> attribute to ensure that an exception is raised when trying to send a text to an invalid number.</p></div>

      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><h3 id="test-making-a-phone-call"><a class="toclink" href="#test-making-a-phone-call">Test Making a Phone Call</a></h3>
<p>Testing phone calls can be done using the same phone numbers. Any valid number will return a success response and "+15005550001" will raise an exception.</p>
<h3 id="test-buying-a-phone-number"><a class="toclink" href="#test-buying-a-phone-number">Test Buying a Phone Number</a></h3>
<p>When buying a phone number, you can try to purchase "+15005550006" for a successful response and "+15005550000" to simulate trying to purchase an unavailable number.</p>
<p>Here's the full code for all our tests:</p></div>

      
    </div>
  
    <div class="block-code_sample ">
      
        

<div class="md-code-sample" id="code-c-automated-twilio-tests" 
  data-title="C# Automated Twilio Tests" data-pref="server">

  <div class="inline-mode">
    <div class="code-snippets">
      <div class="sample-tabs">
      <a class="title" href="#code-c-automated-twilio-tests">C# Automated Twilio Tests</a>
        <ul style="visibility:hidden" >
          
            <li class="sample-tab active" 
              data-ext="cs">C#</li>
          
        </ul>
      </div>

      
        
      
          
      
        <pre data-ext="cs" data-version="default" class="codehilite"><code><span class="code-line"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">Microsoft.VisualStudio.TestTools.UnitTesting</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">Moq</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Interfaces.Services</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Services</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Services.Exceptions</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="k">namespace</span> <span class="nn">TwilioStore.Tests.Services</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line"><span class="na">    [TestClass]</span>
</span><span class="code-line">    <span class="k">public</span> <span class="k">class</span> <span class="nc">NotificationServiceTest</span>
</span><span class="code-line">    <span class="p">{</span>
</span><span class="code-line">        <span class="c1">// TODO: Get your test credentials from </span>
</span><span class="code-line">        <span class="c1">//   https://www.twilio.com/console/account/settings</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">TestAccountSid</span> <span class="p">=</span>
</span><span class="code-line">            <span class="s">&quot;ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span><span class="p">;</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">TestAuthToken</span> <span class="p">=</span>
</span><span class="code-line">            <span class="s">&quot;0123456789abcdef0123456789abcdef&quot;</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="c1">// Magic numbers: https://www.twilio.com/docs/api/rest/test-credentials</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">ValidFromNumber</span> <span class="p">=</span> <span class="s">&quot;+15005550006&quot;</span><span class="p">;</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">ValidToNumber</span> <span class="p">=</span> <span class="s">&quot;+18778894546&quot;</span><span class="p">;</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">InvalidNumber</span> <span class="p">=</span> <span class="s">&quot;+15005550001&quot;</span><span class="p">;</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">AvailableNumber</span> <span class="p">=</span> <span class="s">&quot;+15005550006&quot;</span><span class="p">;</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">UnavailableNumber</span> <span class="p">=</span> <span class="s">&quot;+15005550000&quot;</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">private</span> <span class="k">static</span> <span class="n">INotificationConfiguration</span> <span class="nf">GetTestConfig</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">configMock</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Mock</span><span class="p">&lt;</span><span class="n">INotificationConfiguration</span><span class="p">&gt;();</span>
</span><span class="code-line">            <span class="n">configMock</span><span class="p">.</span><span class="n">SetupGet</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">AccountSid</span><span class="p">)</span>
</span><span class="code-line">                <span class="p">.</span><span class="n">Returns</span><span class="p">(</span><span class="n">TestAccountSid</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">configMock</span><span class="p">.</span><span class="n">SetupGet</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">AuthToken</span><span class="p">)</span>
</span><span class="code-line">                <span class="p">.</span><span class="n">Returns</span><span class="p">(</span><span class="n">TestAuthToken</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">configMock</span><span class="p">.</span><span class="n">SetupGet</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">DefaultFromPhoneNumber</span><span class="p">)</span>
</span><span class="code-line">                <span class="p">.</span><span class="n">Returns</span><span class="p">(</span><span class="n">ValidFromNumber</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="k">if</span> <span class="p">(</span><span class="n">TestAccountSid</span> <span class="p">==</span> <span class="s">&quot;ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span> <span class="p">||</span>
</span><span class="code-line">                <span class="n">TestAuthToken</span> <span class="p">==</span> <span class="s">&quot;0123456789abcdef0123456789abcdef&quot;</span><span class="p">)</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;You forgot to set your TestAccountSid &quot;</span> <span class="p">+</span>
</span><span class="code-line">                                    <span class="s">&quot;and/or TestAuthToken&quot;</span><span class="p">);</span>
</span><span class="code-line">            <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="k">return</span> <span class="n">configMock</span><span class="p">.</span><span class="n">Object</span><span class="p">;</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="na">        [TestMethod]</span>
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">SendText_Should_Send_a_Text</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">GetTestConfig</span><span class="p">();</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NotificationService</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">service</span><span class="p">.</span><span class="n">SendText</span><span class="p">(</span><span class="n">ValidToNumber</span><span class="p">,</span> <span class="s">&quot;Test message&quot;</span><span class="p">);</span>
</span><span class="code-line">            <span class="c1">// Should complete w/o exception</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="na">        [TestMethod]</span>
</span><span class="code-line"><span class="na">        [ExpectedException(typeof(NotificationException))]</span>
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">SendText_Should_Throw_Exception_If_Bad_Number</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">GetTestConfig</span><span class="p">();</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NotificationService</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">service</span><span class="p">.</span><span class="n">SendText</span><span class="p">(</span><span class="n">InvalidNumber</span><span class="p">,</span> <span class="s">&quot;Test message&quot;</span><span class="p">);</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="na">        [TestMethod]</span>
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">MakePhoneCall_Should_Initiate_Phone_Call</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">GetTestConfig</span><span class="p">();</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NotificationService</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">service</span><span class="p">.</span><span class="n">MakePhoneCall</span><span class="p">(</span><span class="n">ValidToNumber</span><span class="p">,</span> 
</span><span class="code-line">                <span class="s">&quot;http://demo.twilio.com/docs/voice.xml&quot;</span><span class="p">);</span>
</span><span class="code-line">            <span class="c1">// Should complete w/o exception</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="na">        [TestMethod]</span>
</span><span class="code-line"><span class="na">        [ExpectedException(typeof(NotificationException))]</span>
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">MakePhoneCall_Should_Throw_Exception_If_Bad_Number</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">GetTestConfig</span><span class="p">();</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NotificationService</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">service</span><span class="p">.</span><span class="n">MakePhoneCall</span><span class="p">(</span><span class="n">InvalidNumber</span><span class="p">,</span> 
</span><span class="code-line">                <span class="s">&quot;http://demo.twilio.com/docs/voice.xml&quot;</span><span class="p">);</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="na">        [TestMethod]</span>
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">BuyPhoneNumber_Should_Purchase_Number</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">GetTestConfig</span><span class="p">();</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NotificationService</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">service</span><span class="p">.</span><span class="n">BuyPhoneNumber</span><span class="p">(</span><span class="n">AvailableNumber</span><span class="p">);</span>
</span><span class="code-line">            <span class="c1">// Should complete w/o exception</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="na">        [TestMethod]</span>
</span><span class="code-line"><span class="na">        [ExpectedException(typeof(NotificationException))]</span>
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">BuyPhoneNumber_Should_Throw_Exception_If_Unavailable</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">GetTestConfig</span><span class="p">();</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NotificationService</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">service</span><span class="p">.</span><span class="n">BuyPhoneNumber</span><span class="p">(</span><span class="n">UnavailableNumber</span><span class="p">);</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">    <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></code></pre>
      
    </div>

    
  </div>

  <div class="button-mode">
    <h5 class="title">
      <i class="fa fa-fw fa-code"></i>
      C# Automated Twilio Tests
    </h5>
    
      <p>Automates testing of sending a text, making a phone call, and buying a phone number.</p>
    
    <div class="active-tail"></div>
  </div>
</div>



      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><p>To download all of the code in a complete, working Visual Studio solution, <a href="https://github.com/TwilioDevEd/automated-testing-csharp">head over to GitHub</a>.</p>
<h2 id="whats-next"><a class="toclink" href="#whats-next">What's Next</a></h2>
<p>There's a lot more you can do with test credentials, so do <a href="https://www.twilio.com/docs/api/rest/test-credentials">read up on them in our API Reference</a>. Also, check out our <a href="https://www.twilio.com/tutorials?filter-language=csharp">C# Tutorials</a>. Most have tests written for them, like the <a href="https://www.twilio.com/tutorials/walkthrough/conference-broadcast/csharp/mvc">Conference &amp; Broadcast</a> tutorial.</p>
<p>Until next time, happy testing.</p></div>

      
    </div>
  

    
      
<div class="contributors">
  <div class="contributors-body">
  
    <div class="contributor">
      
        <label>Contributors:</label>
      
      <img src="https://www.gravatar.com/avatar/560630d6945c6a8777533e7ea3b4e69b?d=mm&amp;s=50" title="David Prothero" alt="David Prothero" />
    </div>
  
    <div class="contributor">
      
      <img src="https://www.gravatar.com/avatar/7ff74e11de7b63c4ec66966b9cb75f63?d=mm&amp;s=50" title="Andrew Baker" alt="Andrew Baker" />
    </div>
  
  </div>
  <div class="contributors-footer"></div>
</div>


    

        
          
<div id="disqus_thread"></div>


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

// Unique identifiers
PAGE_URL = "https://www.twilio.com/docs/guides/automated-testing-twilio-c-apps-moq";

var disqus_config = function () {
  this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'http://twiliodocumentation.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


        
      </div>
    </div>

    <div class="code-column">
      
  <div id="coderail" class="code-rail" data-uk-sticky="{boundary: true}">

  <div class="rail-placeholder"></div>

  <div class="rail-header uk-hidden">

    <div class="rail-header-wrapper">

      <div class="rail-navigation">
        <div class="inner">
          <a href="#previous" class="inactive" data-previous>
            <i class="fa fa-fw fa-arrow-left left"></i>
          </a>
        </div>
        <div class="inner">
          <span>
            <span class="current-index">1</span>
            <span>/</span>
            <span class="snippet-total">1</span>
          </span>
        </div>
        <div class="inner">
          <a href="#next" data-next>
            <i class="fa fa-fw fa-arrow-right"></i>
          </a>
        </div>
      </div>

      <div class="rail-title">
        <div class="title-content inner">
          <span>Loading Code Samples...</span>
          <i class="fa fa-fw fa-chevron-down"></i>
        </div>
      </div>

    </div>

  </div>

  <div class="rail-toolbar uk-hidden">

    <div class="rail-current-language">
      <div class="inner">
        <span>Language</span>
        <i class="fa fa-fw fa-chevron-down"></i>
      </div>
    </div>

    <div class="toolbar">
      <a href="#code" class="uk-hidden tab" data-code>Code</a>
      <a href="#output" class="uk-hidden inactive" data-output>Output</a>

      <span class="separator"></span>

      <a id="download" class="uk-hidden">
        <i class="fa fa-fw fa-download"></i>
        <span>Download Project</span>
      </a>

      <a id="github" class="uk-hidden" target="_blank">
        <i class="fa fa-fw fa-github-square"></i>
        <span>View on GitHub</span>
      </a>

      <a id="defrosty" class="fr-on" href="#defrosty">
        <i class="fa fa-fw fa-eye"></i>
        <span class="wider-tooltip">Toggle Highlighted Lines</span>
      </a>

      <a id="clippy" href="#copy">
        <i class="fa fa-fw fa-copy"></i>
        <span>Copy to Clipboard</span>
      </a>

      <a id="linkcode" href="#linkcode">
        <i class="fa fa-fw fa-link"></i>
        <span>Link to this Code</span>
      </a>

      <a href="#expand" data-expand>
        <i class="fa fa-fw fa-arrows-alt"></i>
        <span>Full Screen</span>
      </a>
      <a href="#collapse" class="uk-hidden" data-collapse>
        <i class="fa fa-fw fa-compress"></i>
        <span>Normal Size</span>
      </a>
    </div>
  </div>

  <div class="rail-samples">
    <ul>
      
        <li>
          <a href="#code-simple-c-notificationservice">
            Simple C# NotificationService
          </a>
        </li>
      
        <li>
          <a href="#code-c-notificationconfiguration-class">
            C# NotificationConfiguration class
          </a>
        </li>
      
        <li>
          <a href="#code-completed-c-notificationservice">
            Completed C# NotificationService
          </a>
        </li>
      
        <li>
          <a href="#code-test-the-c-orderservice">
            Test the C# OrderService
          </a>
        </li>
      
        <li>
          <a href="#code-c-automated-twilio-tests">
            C# Automated Twilio Tests
          </a>
        </li>
      
    </ul>
  </div>

  <div class="rail-languages"></div>

  <div class="rail-content">
    <div class="rail-content-inner">
      
        
        <div data-sample-title="Simple C# NotificationService"
            data-sample="code-simple-c-notificationservice" 
            data-pref="server"
            data-download-url=""
            data-github-url=""
            class="code-sample">

          <div class="sample-language-data" style="display:none;">
            <select>
              
                <option value="cs">C#</option>
              
            </select>
          </div>

          
            
          

          

          <div class="snippet-container">
            
              <pre data-ext="cs" 
                data-version="default"
                data-filename=""
                class="codehilite"><code><span class="code-line"><span class="k">using</span> <span class="nn">Twilio</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Interfaces.Exceptions</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Interfaces.Services</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="k">namespace</span> <span class="nn">TwilioStore.Services</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line">    <span class="k">public</span> <span class="k">class</span> <span class="nc">NotificationService</span> <span class="p">:</span> <span class="n">INotificationService</span>
</span><span class="code-line">    <span class="p">{</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">readonly</span> <span class="n">TwilioRestClient</span> <span class="n">_client</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="nf">NotificationService</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">accountSid</span> <span class="p">=</span> 
</span><span class="code-line">                <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;TwilioAccountSid&quot;</span><span class="p">];</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">authToken</span> <span class="p">=</span> 
</span><span class="code-line">                <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;TwilioAuthToken&quot;</span><span class="p">];</span>
</span><span class="code-line">            <span class="n">_client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TwilioRestClient</span><span class="p">(</span><span class="n">accountSid</span><span class="p">,</span> <span class="n">authToken</span><span class="p">);</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">SendText</span><span class="p">(</span><span class="kt">string</span> <span class="n">to</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">fromPhoneNumber</span> <span class="p">=</span> 
</span><span class="code-line">                <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;TwilioFromNumber&quot;</span><span class="p">];</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">_client</span><span class="p">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">fromPhoneNumber</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
</span><span class="code-line">            <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotificationException</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
</span><span class="code-line">            <span class="p">}</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">    <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></code></pre>
            
          </div>

          <div class="output-snippet-container">
            
          </div>

        </div>
        
      
        
        <div data-sample-title="C# NotificationConfiguration class"
            data-sample="code-c-notificationconfiguration-class" 
            data-pref="server"
            data-download-url="https://github.com/TwilioDevEd/automated-testing-csharp/archive/master.zip"
            data-github-url="https://github.com/TwilioDevEd/automated-testing-csharp/blob/master/TwilioStore.Services/NotificationConfiguration.cs"
            class="code-sample">

          <div class="sample-language-data" style="display:none;">
            <select>
              
                <option value="cs">C#</option>
              
            </select>
          </div>

          
            
          

          

          <div class="snippet-container">
            
              <pre data-ext="cs" 
                data-version="default"
                data-filename=""
                class="codehilite"><code><span class="code-line"><span class="k">using</span> <span class="nn">System.Configuration</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Interfaces.Services</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="k">namespace</span> <span class="nn">TwilioStore.Services</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line">    <span class="k">public</span> <span class="k">class</span> <span class="nc">NotificationConfiguration</span> <span class="p">:</span> <span class="n">INotificationConfiguration</span>
</span><span class="code-line">    <span class="p">{</span>
</span><span class="code-line">        <span class="k">public</span> <span class="nf">NotificationConfiguration</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="n">AccountSid</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;TwilioAccountSid&quot;</span><span class="p">];</span>
</span><span class="code-line">            <span class="n">AuthToken</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;TwilioAuthToken&quot;</span><span class="p">];</span>
</span><span class="code-line">            <span class="n">DefaultFromPhoneNumber</span> <span class="p">=</span> 
</span><span class="code-line">                <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;TwilioFromNumber&quot;</span><span class="p">];</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="kt">string</span> <span class="n">AccountSid</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class="code-line">        <span class="k">public</span> <span class="kt">string</span> <span class="n">AuthToken</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class="code-line">        <span class="k">public</span> <span class="kt">string</span> <span class="n">DefaultFromPhoneNumber</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class="code-line">    <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></code></pre>
            
          </div>

          <div class="output-snippet-container">
            
          </div>

        </div>
        
      
        
        <div data-sample-title="Completed C# NotificationService"
            data-sample="code-completed-c-notificationservice" 
            data-pref="server"
            data-download-url="https://github.com/TwilioDevEd/automated-testing-csharp/archive/master.zip"
            data-github-url="https://github.com/TwilioDevEd/automated-testing-csharp/blob/master/TwilioStore.Services/NotificationService.cs"
            class="code-sample">

          <div class="sample-language-data" style="display:none;">
            <select>
              
                <option value="cs">C#</option>
              
            </select>
          </div>

          
            
          

          

          <div class="snippet-container">
            
              <pre data-ext="cs" 
                data-version="default"
                data-filename=""
                class="codehilite"><code><span class="code-line"><span class="k">using</span> <span class="nn">Twilio</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Interfaces.Services</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Services.Exceptions</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="k">namespace</span> <span class="nn">TwilioStore.Services</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line">    <span class="k">public</span> <span class="k">class</span> <span class="nc">NotificationService</span> <span class="p">:</span> <span class="n">INotificationService</span>
</span><span class="code-line">    <span class="p">{</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">readonly</span> <span class="n">TwilioRestClient</span> <span class="n">_client</span><span class="p">;</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">readonly</span> <span class="n">INotificationConfiguration</span> <span class="n">_config</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="nf">NotificationService</span><span class="p">()</span> <span class="p">:</span> <span class="k">this</span><span class="p">(</span><span class="k">new</span> <span class="n">NotificationConfiguration</span><span class="p">())</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="nf">NotificationService</span><span class="p">(</span><span class="n">INotificationConfiguration</span> <span class="n">config</span><span class="p">)</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="n">_config</span> <span class="p">=</span> <span class="n">config</span><span class="p">;</span>
</span><span class="code-line">            <span class="n">_client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TwilioRestClient</span><span class="p">(</span><span class="n">_config</span><span class="p">.</span><span class="n">AccountSid</span><span class="p">,</span> 
</span><span class="code-line">                <span class="n">_config</span><span class="p">.</span><span class="n">AuthToken</span><span class="p">);</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">SendText</span><span class="p">(</span><span class="kt">string</span> <span class="n">to</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">_client</span><span class="p">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">_config</span><span class="p">.</span><span class="n">DefaultFromPhoneNumber</span><span class="p">,</span> 
</span><span class="code-line">                <span class="n">to</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
</span><span class="code-line">            <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotificationException</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
</span><span class="code-line">            <span class="p">}</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">MakePhoneCall</span><span class="p">(</span><span class="kt">string</span> <span class="n">to</span><span class="p">,</span> <span class="kt">string</span> <span class="n">voiceUrl</span><span class="p">)</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">_client</span><span class="p">.</span><span class="n">InitiateOutboundCall</span><span class="p">(</span>
</span><span class="code-line">                <span class="n">_config</span><span class="p">.</span><span class="n">DefaultFromPhoneNumber</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">voiceUrl</span><span class="p">);</span>
</span><span class="code-line">            <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotificationException</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
</span><span class="code-line">            <span class="p">}</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">BuyPhoneNumber</span><span class="p">(</span><span class="kt">string</span> <span class="n">number</span><span class="p">)</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">_client</span><span class="p">.</span><span class="n">AddIncomingPhoneNumber</span><span class="p">(</span><span class="k">new</span> <span class="n">PhoneNumberOptions</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="n">PhoneNumber</span> <span class="p">=</span> <span class="n">number</span>
</span><span class="code-line">            <span class="p">});</span>
</span><span class="code-line">            <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotificationException</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">RestException</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
</span><span class="code-line">            <span class="p">}</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">    <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></code></pre>
            
          </div>

          <div class="output-snippet-container">
            
          </div>

        </div>
        
      
        
        <div data-sample-title="Test the C# OrderService"
            data-sample="code-test-the-c-orderservice" 
            data-pref="server"
            data-download-url="https://github.com/TwilioDevEd/automated-testing-csharp/archive/master.zip"
            data-github-url="https://github.com/TwilioDevEd/automated-testing-csharp/blob/master/TwilioStore.Tests/Services/OrderServiceTest.cs"
            class="code-sample">

          <div class="sample-language-data" style="display:none;">
            <select>
              
                <option value="cs">C#</option>
              
            </select>
          </div>

          
            
          

          

          <div class="snippet-container">
            
              <pre data-ext="cs" 
                data-version="default"
                data-filename=""
                class="codehilite"><code><span class="code-line"><span class="k">using</span> <span class="nn">Microsoft.VisualStudio.TestTools.UnitTesting</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">Moq</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Domain</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Interfaces.Services</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Services</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="k">namespace</span> <span class="nn">TwilioStore.Tests.Services</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line"><span class="na">    [TestClass]</span>
</span><span class="code-line">    <span class="k">public</span> <span class="k">class</span> <span class="nc">OrderServiceTest</span>
</span><span class="code-line">    <span class="p">{</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">ValidToNumber</span> <span class="p">=</span> <span class="s">&quot;+18778894546&quot;</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="na">        [TestMethod]</span>
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">ProcessOrder_Should_Notify_Customer</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="c1">// Arrange</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">fakeOrder</span> <span class="p">=</span> <span class="n">GetFakeOrder</span><span class="p">();</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="kt">var</span> <span class="n">notificationServiceMock</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Mock</span><span class="p">&lt;</span><span class="n">INotificationService</span><span class="p">&gt;();</span>
</span><span class="code-line">            <span class="kt">string</span> <span class="n">textMessage</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span><span class="code-line">            <span class="n">notificationServiceMock</span><span class="p">.</span><span class="n">Setup</span><span class="p">(</span>
</span><span class="code-line">                    <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">SendText</span><span class="p">(</span><span class="n">ValidToNumber</span><span class="p">,</span> <span class="n">It</span><span class="p">.</span><span class="n">IsAny</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;())</span>
</span><span class="code-line">                <span class="p">)</span>
</span><span class="code-line">                <span class="p">.</span><span class="n">Callback</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;((</span><span class="n">_</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">textMessage</span> <span class="p">=</span> <span class="n">message</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="c1">// Act</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">orderService</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderService</span><span class="p">(</span><span class="n">notificationServiceMock</span><span class="p">.</span><span class="n">Object</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">orderService</span><span class="p">.</span><span class="n">ProcessOrder</span><span class="p">(</span><span class="n">fakeOrder</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="c1">// Assert</span>
</span><span class="code-line">            <span class="n">notificationServiceMock</span><span class="p">.</span><span class="n">Verify</span><span class="p">(</span>
</span><span class="code-line">                    <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">SendText</span><span class="p">(</span><span class="n">ValidToNumber</span><span class="p">,</span> <span class="n">It</span><span class="p">.</span><span class="n">IsAny</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;()),</span>
</span><span class="code-line">                    <span class="n">Times</span><span class="p">.</span><span class="n">Once</span>
</span><span class="code-line">                <span class="p">);</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">expectedMessageStart</span> <span class="p">=</span> <span class="err">$</span><span class="s">&quot;Your order {fakeOrder.Id} has &quot;</span> <span class="p">+</span>
</span><span class="code-line">                <span class="s">&quot;shipped! Tracking: &quot;</span><span class="p">;</span>
</span><span class="code-line">            <span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">textMessage</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="n">expectedMessageStart</span><span class="p">));</span>
</span><span class="code-line">            <span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">textMessage</span><span class="p">.</span><span class="n">Length</span> <span class="p">&gt;</span> <span class="n">expectedMessageStart</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">private</span> <span class="k">static</span> <span class="n">Order</span> <span class="nf">GetFakeOrder</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">fakeOrder</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Order</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="n">Id</span> <span class="p">=</span> <span class="s">&quot;1234&quot;</span><span class="p">,</span>
</span><span class="code-line">                <span class="n">Customer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Customer</span>
</span><span class="code-line">                <span class="p">{</span>
</span><span class="code-line">                    <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Joe Customer&quot;</span><span class="p">,</span>
</span><span class="code-line">                    <span class="n">MobileNumber</span> <span class="p">=</span> <span class="n">ValidToNumber</span>
</span><span class="code-line">                <span class="p">}</span>
</span><span class="code-line">            <span class="p">};</span>
</span><span class="code-line">            <span class="n">fakeOrder</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">OrderDetail</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="n">ItemId</span> <span class="p">=</span> <span class="s">&quot;5678&quot;</span><span class="p">,</span>
</span><span class="code-line">                <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;Widget&quot;</span><span class="p">,</span>
</span><span class="code-line">                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">1</span>
</span><span class="code-line">            <span class="p">});</span>
</span><span class="code-line">            <span class="k">return</span> <span class="n">fakeOrder</span><span class="p">;</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">    <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></code></pre>
            
          </div>

          <div class="output-snippet-container">
            
          </div>

        </div>
        
      
        
        <div data-sample-title="C# Automated Twilio Tests"
            data-sample="code-c-automated-twilio-tests" 
            data-pref="server"
            data-download-url="https://github.com/TwilioDevEd/automated-testing-csharp/archive/master.zip"
            data-github-url="https://github.com/TwilioDevEd/automated-testing-csharp/blob/master/TwilioStore.Tests/Services/NotificationServiceTest.cs"
            class="code-sample">

          <div class="sample-language-data" style="display:none;">
            <select>
              
                <option value="cs">C#</option>
              
            </select>
          </div>

          
            
          

          

          <div class="snippet-container">
            
              <pre data-ext="cs" 
                data-version="default"
                data-filename=""
                class="codehilite"><code><span class="code-line"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">Microsoft.VisualStudio.TestTools.UnitTesting</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">Moq</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Interfaces.Services</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Services</span><span class="p">;</span>
</span><span class="code-line"><span class="k">using</span> <span class="nn">TwilioStore.Services.Exceptions</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="k">namespace</span> <span class="nn">TwilioStore.Tests.Services</span>
</span><span class="code-line"><span class="p">{</span>
</span><span class="code-line"><span class="na">    [TestClass]</span>
</span><span class="code-line">    <span class="k">public</span> <span class="k">class</span> <span class="nc">NotificationServiceTest</span>
</span><span class="code-line">    <span class="p">{</span>
</span><span class="code-line">        <span class="c1">// TODO: Get your test credentials from </span>
</span><span class="code-line">        <span class="c1">//   https://www.twilio.com/console/account/settings</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">TestAccountSid</span> <span class="p">=</span>
</span><span class="code-line">            <span class="s">&quot;ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span><span class="p">;</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">TestAuthToken</span> <span class="p">=</span>
</span><span class="code-line">            <span class="s">&quot;0123456789abcdef0123456789abcdef&quot;</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="c1">// Magic numbers: https://www.twilio.com/docs/api/rest/test-credentials</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">ValidFromNumber</span> <span class="p">=</span> <span class="s">&quot;+15005550006&quot;</span><span class="p">;</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">ValidToNumber</span> <span class="p">=</span> <span class="s">&quot;+18778894546&quot;</span><span class="p">;</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">InvalidNumber</span> <span class="p">=</span> <span class="s">&quot;+15005550001&quot;</span><span class="p">;</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">AvailableNumber</span> <span class="p">=</span> <span class="s">&quot;+15005550006&quot;</span><span class="p">;</span>
</span><span class="code-line">        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">UnavailableNumber</span> <span class="p">=</span> <span class="s">&quot;+15005550000&quot;</span><span class="p">;</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">private</span> <span class="k">static</span> <span class="n">INotificationConfiguration</span> <span class="nf">GetTestConfig</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">configMock</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Mock</span><span class="p">&lt;</span><span class="n">INotificationConfiguration</span><span class="p">&gt;();</span>
</span><span class="code-line">            <span class="n">configMock</span><span class="p">.</span><span class="n">SetupGet</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">AccountSid</span><span class="p">)</span>
</span><span class="code-line">                <span class="p">.</span><span class="n">Returns</span><span class="p">(</span><span class="n">TestAccountSid</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">configMock</span><span class="p">.</span><span class="n">SetupGet</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">AuthToken</span><span class="p">)</span>
</span><span class="code-line">                <span class="p">.</span><span class="n">Returns</span><span class="p">(</span><span class="n">TestAuthToken</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">configMock</span><span class="p">.</span><span class="n">SetupGet</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">DefaultFromPhoneNumber</span><span class="p">)</span>
</span><span class="code-line">                <span class="p">.</span><span class="n">Returns</span><span class="p">(</span><span class="n">ValidFromNumber</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="k">if</span> <span class="p">(</span><span class="n">TestAccountSid</span> <span class="p">==</span> <span class="s">&quot;ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span> <span class="p">||</span>
</span><span class="code-line">                <span class="n">TestAuthToken</span> <span class="p">==</span> <span class="s">&quot;0123456789abcdef0123456789abcdef&quot;</span><span class="p">)</span>
</span><span class="code-line">            <span class="p">{</span>
</span><span class="code-line">                <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;You forgot to set your TestAccountSid &quot;</span> <span class="p">+</span>
</span><span class="code-line">                                    <span class="s">&quot;and/or TestAuthToken&quot;</span><span class="p">);</span>
</span><span class="code-line">            <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="k">return</span> <span class="n">configMock</span><span class="p">.</span><span class="n">Object</span><span class="p">;</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="na">        [TestMethod]</span>
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">SendText_Should_Send_a_Text</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">GetTestConfig</span><span class="p">();</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NotificationService</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">service</span><span class="p">.</span><span class="n">SendText</span><span class="p">(</span><span class="n">ValidToNumber</span><span class="p">,</span> <span class="s">&quot;Test message&quot;</span><span class="p">);</span>
</span><span class="code-line">            <span class="c1">// Should complete w/o exception</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="na">        [TestMethod]</span>
</span><span class="code-line"><span class="na">        [ExpectedException(typeof(NotificationException))]</span>
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">SendText_Should_Throw_Exception_If_Bad_Number</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">GetTestConfig</span><span class="p">();</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NotificationService</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">service</span><span class="p">.</span><span class="n">SendText</span><span class="p">(</span><span class="n">InvalidNumber</span><span class="p">,</span> <span class="s">&quot;Test message&quot;</span><span class="p">);</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="na">        [TestMethod]</span>
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">MakePhoneCall_Should_Initiate_Phone_Call</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">GetTestConfig</span><span class="p">();</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NotificationService</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">service</span><span class="p">.</span><span class="n">MakePhoneCall</span><span class="p">(</span><span class="n">ValidToNumber</span><span class="p">,</span> 
</span><span class="code-line">                <span class="s">&quot;http://demo.twilio.com/docs/voice.xml&quot;</span><span class="p">);</span>
</span><span class="code-line">            <span class="c1">// Should complete w/o exception</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="na">        [TestMethod]</span>
</span><span class="code-line"><span class="na">        [ExpectedException(typeof(NotificationException))]</span>
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">MakePhoneCall_Should_Throw_Exception_If_Bad_Number</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">GetTestConfig</span><span class="p">();</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NotificationService</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">service</span><span class="p">.</span><span class="n">MakePhoneCall</span><span class="p">(</span><span class="n">InvalidNumber</span><span class="p">,</span> 
</span><span class="code-line">                <span class="s">&quot;http://demo.twilio.com/docs/voice.xml&quot;</span><span class="p">);</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="na">        [TestMethod]</span>
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">BuyPhoneNumber_Should_Purchase_Number</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">GetTestConfig</span><span class="p">();</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NotificationService</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">service</span><span class="p">.</span><span class="n">BuyPhoneNumber</span><span class="p">(</span><span class="n">AvailableNumber</span><span class="p">);</span>
</span><span class="code-line">            <span class="c1">// Should complete w/o exception</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="na">        [TestMethod]</span>
</span><span class="code-line"><span class="na">        [ExpectedException(typeof(NotificationException))]</span>
</span><span class="code-line">        <span class="k">public</span> <span class="k">void</span> <span class="nf">BuyPhoneNumber_Should_Throw_Exception_If_Unavailable</span><span class="p">()</span>
</span><span class="code-line">        <span class="p">{</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">GetTestConfig</span><span class="p">();</span>
</span><span class="code-line">            <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NotificationService</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span class="code-line">            <span class="n">service</span><span class="p">.</span><span class="n">BuyPhoneNumber</span><span class="p">(</span><span class="n">UnavailableNumber</span><span class="p">);</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">    <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></code></pre>
            
          </div>

          <div class="output-snippet-container">
            
          </div>

        </div>
        
      
    </div>
  </div>
</div>


    </div>

  </div>

      </div>
    </div>

    
    


<div class="footer" data-swiftype-index="false">
  <div class="uk-container uk-container-center">
    <div class="footer__statement">We can’t wait to see what you build.</div>
    <div class="uk-grid">
      <div class="uk-width-1-1 uk-width-small-1-3 uk-width-medium-1-5">
        <section class="footer__section">
          <header class="footer__header">Products</header>
          <ul class="footer__list">
            <li class="footer__list-item">
              <a href="https://www.twilio.com/voice-video" class="footer__link">Voice &amp; Video</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/messaging" class="footer__link">Messaging</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/authy" class="footer__link">Authentication</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/wireless" class="footer__link">Connected Devices</a>
            </li>
          </ul>
        </section>
      </div>
      <div class="uk-width-1-1 uk-width-small-1-3 uk-width-medium-1-5">
        <section class="footer__section">
          <header class="footer__header">Use Cases</header>
          <ul class="footer__list">
            <li class="footer__list-item">
              <a href="https://www.twilio.com/use-cases/access-security" class="footer__link">Access Security</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/use-cases/contextual-call-center" class="footer__link">Contextual Call Center</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/use-cases/marketplace-communications" class="footer__link">Marketplace Communications</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/use-cases/mobile-messaging" class="footer__link">Mobile Messaging</a>
            </li>
          </ul>
        </section>
      </div>
      <div class="uk-width-1-1 uk-width-small-1-3 uk-width-medium-1-5">
        <section class="footer__section">
          <header class="footer__header">About</header>
          <ul class="footer__list">
            <li class="footer__list-item">
              <a href="https://www.twilio.com/what-is-cloud-communications?" class="footer__link">What is Twilio?</a>
            </li>
            <li class="footer__list-item">
              <a href="https://customers.twilio.com/" class="footer__link">Customers</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/help" class="footer__link">Get Help</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/help/sales" class="footer__link">Talk to Sales</a>
            </li>
          </ul>
        </section>
      </div>
      <div class="uk-width-1-1 uk-width-medium-2-5">
        <section class="footer__section">
  <header class="footer__header">Hits From The Blog</header>
  <ul class="footer__list footer__list">
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/building-an-ivr-with-no-code-by-using-taskrouter-as-a-state-machine.html" class="footer__link">Building an IVR with no code by using TaskRouter as a state machine</a>
    </li>
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/logrole-gives-you-permissions-based-granular-searching-for-twilio-logs.html" class="footer__link">Logrole Gives You Permissions Based, Granular Searching For Twilio Logs</a>
    </li>
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/build-callbacks-with-stamplay-twilio-and-unbounce.html" class="footer__link">Build Callbacks With Stamplay, Twilio and Unbounce</a>
    </li>
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/build-a-basic-call-center-in-just-a-few-minutes-with-twilio.html" class="footer__link">Build a Basic Call Center in Just a Few Minutes with Twilio</a>
    </li>
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/redact-delete-sms-messages-node-js.html" class="footer__link">Redact or Delete SMS Messages as They Arrive with Node.js</a>
    </li>
    
  </ul>

</section>
      </div>
    </div>
    <footer class="footer__footer">
      <div class="footer__logo" title="Twilio">
        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30">
          <path d="M15 0C6.7 0 0 6.7 0 15s6.7 15 15 15 15-6.7 15-15S23.3 0 15 0zm0 26C8.9 26 4 21.1 4 15S8.9 4 15 4s11 4.9 11 11-4.9 11-11 11z"/>
          <circle cx="18.7" cy="11.3" r="3.1"/>
          <circle cx="18.7" cy="18.7" r="3.1"/>
          <circle cx="11.3" cy="18.7" r="3.1"/>
          <circle cx="11.3" cy="11.3" r="3.1"/>
        </svg>
      </div>
      <ul class="legal__list">
        <li class="legal__list-item">
          <a href="https://www.twilio.com/company" class="legal__link">About Twilio</a>
        </li>
        <li class="legal__list-item">
          <a href="https://www.twilio.com/legal" class="legal__link">Legal</a>
        </li>
        <li class="legal__list-item">Copyright &copy; 2016 Twilio, Inc. 
          <br class="uk-visible-small">All Rights Reserved.
        </li>
      </ul>
    </footer>
  </div>
</div>


    
    <script src="https://www.twilio.com/docs/static/js/vendor.min.16abf41c42de.js"></script>
    

  

  <!-- Mixpanel -->
  <script type="text/javascript">(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"===e.location.protocol?"https:":"http:")+'//cdn.mxpnl.com/libs/mixpanel-2.2.min.js';f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f);b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==
  typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,
    e,d])};b.__SV=1.2}})(document,window.mixpanel||[]);
    mixpanel.init("f71c19735fa6ecc5225ff563285e1794");
    </script>
  

  
    <!-- Heap -->
    <script type="text/javascript">
    window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var n=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(n?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(a,o);for(var r=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["clearEventProperties","identify","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=r(p[c])};
    heap.load('1541905715');
    </script>
  

  
    <!-- GA -->
    <script type="text/javascript">
    try {
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-2900316-1']);
      _gaq.push(['_setSiteSpeedSampleRate', 50]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    } catch(err) {}

    var _kmq = _kmq || [];
    </script>
  

  
    <!-- Eloqua -->
    <script type="text/javascript">
    var _elqQ = _elqQ || [];
    _elqQ.push(['elqSetSiteId', '815114181']);
    _elqQ.push(['elqTrackPageView']);
    _elqQ.push(['elqUseFirstPartyCookie', 'www.twilio.com']);

    (function () {
      function async_load() {
        var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;
        s.src = 'http://img03.en25.com/i/elqCfg.min.js';
        var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);
      }
      if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
      else if (window.attachEvent) window.attachEvent('onload', async_load);
    })();
    </script>
  

  
    <!-- Transifex -->
    <script type="text/javascript">
    window.liveSettings = {
      api_key: '4c06c1c5a6b341e591d969476fe2675f'
    };
    </script>
    <script type="text/javascript" src="http://cdn.transifex.com/live.js"></script>
    <style>
    .txlive-langselector { display: none; }
    </style>
  

  



    
      <script src="https://www.twilio.com/docs/static/js/docs.min.0c5bb1abb16f.js"></script>
    

    
    



    

  </body>

<!-- Mirrored from www.twilio.com/docs/guides/automated-testing-twilio-c-apps-moq by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 22:10:05 GMT -->
</html>
