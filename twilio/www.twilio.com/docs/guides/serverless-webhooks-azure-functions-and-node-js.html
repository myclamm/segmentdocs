


<!DOCTYPE html>
<html class="no-js">
  
<!-- Mirrored from www.twilio.com/docs/guides/serverless-webhooks-azure-functions-and-node-js by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 22:10:04 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    
	<!-- Optimizely -->
	<script src="https://cdn.optimizely.com/js/6082066.js"></script>

    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width">
    
    
    <meta name="description" content="Leverage serverless architecture using Azure Functions and JavaScript/Node.js to handle Twilio&#39;s webhooks for incoming SMS messages and voice phone calls.">
    
    
    

    <title>
      Serverless Webhooks with Azure Functions and Node.js - Twilio
    </title>

    <link rel="canonical" href="https://www.twilio.com/docs/guides/serverless-webhooks-azure-functions-and-node-js" />

    
    <link rel="shortcut icon" href="https://www.twilio.com/docs/static/img/favicons/favicon.db41f19ea294.ico"/>
    <link rel="apple-touch-icon" href="https://www.twilio.com/docs/static/img/favicons/favicon_57.98200b6899e6.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="https://www.twilio.com/docs/static/img/favicons/favicon_72.86ae17486256.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="https://www.twilio.com/docs/static/img/favicons/favicon_114.ee1859950ad4.png"/>

    
    <link rel="stylesheet" type="text/css" href="http://cloud.typography.com/6230892/752864/css/fonts.css">
    <link rel="stylesheet" href="https://www.twilio.com/docs/static/css/font-awesome.min.295235b28b6e.css" />
    <link rel="stylesheet" href="https://www.twilio.com/docs/static/css/twilio-icons.45de73e993f2.css" />
    <link rel="stylesheet" href="https://www.twilio.com/docs/static/css/font-mfizz.818f36cb00cc.css" />

    
    
    <meta property="og:title" content="Serverless Webhooks with Azure Functions and Node.js">
    
    
    <meta property="og:description" content="Leverage serverless architecture using Azure Functions and JavaScript/Node.js to handle Twilio&#39;s webhooks for incoming SMS messages and voice phone calls.">
    
    
    <meta property="og:url" content="https://www.twilio.com/docs/guides/serverless-webhooks-azure-functions-and-node-js?utm_source=docs&utm_medium=social&utm_campaign=guides_tags">

    
    
    <meta name="twitter:title" content="Serverless Webhooks with Azure Functions and Node.js">
    
    
    <meta name="twitter:description" content="Leverage serverless architecture using Azure Functions and JavaScript/Node.js to handle Twilio&#39;s webhooks for incoming SMS messages and voice phone calls.">
    
    

    
    

    

    
      <link rel="stylesheet" href="https://www.twilio.com/docs/static/css/docs.min.05ed18599e08.css" />
    

    
    

    
    <script>
  var twilio = twilio || {};
  twilio.realm = "prod";
  twilio.SWIFTYPE_ENGINE_KEY = "T68bXEBf7NaKzyRpvbnG";
</script>


<script>
  twilio.account = twilio.account || {};
  

  twilio.user = twilio.user || {};
  
  

</script>


    <script>
  
  window.userBetaFeatures = ["enable-video-rooms", "marketplace"];
</script>

  </head>

  <body class="
    
      guides
    
    
    
  ">

    

	
	<!-- Google Tag Manager -->
	<noscript><iframe src="http://www.googletagmanager.com/ns.html?id=GTM-MWRD6S"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'http://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window, document, 'script', 'dataLayer', 'GTM-MWRD6S');</script>
	<!-- End Google Tag Manager -->
	



    
    <div role="drawer" class="nav__drawer">
  <div role="drawer__wrapper" class="nav__drawer-wrapper">
    <div role="drawer__nav" class="nav__drawer-nav"><span class="nav__drawer-auth"><a href="https://www.twilio.com/login" class="nav__drawer-auth-link">Log In</a><a href="https://www.twilio.com/try-twilio" class="nav__drawer-auth-link">Sign Up</a></span><a href="#close" role="drawer__close" class="nav__drawer-close">Close</a></div>
    <div class="nav__drawer-menu">
      <div class="nav__drawer-container">
        <div class="nav__drawer-grid">
          <div class="nav__drawer-section">
            <div role="drawer__header" class="nav__drawer-header">Products</div>
            <div role="drawer__dropdown" class="nav__drawer-dropdown">
              <div class="nav__drawer-column">
                <ul>
                  <li><a href="https://www.twilio.com/voice-video" class="nav__drawer-link nav__drawer-link--category">Voice &amp; Video</a></li>
                  <li><a href="https://www.twilio.com/voice" class="nav__drawer-link">Programmable Voice</a></li>
                  <li><a href="https://www.twilio.com/video" class="nav__drawer-link">Programmable Video</a></li>
                  <li><a href="https://www.twilio.com/sip-trunking" class="nav__drawer-link">Elastic SIP Trunking</a></li>
                  <li><a href="https://www.twilio.com/taskrouter" class="nav__drawer-link">TaskRouter</a></li>
                  <li><a href="https://www.twilio.com/stun-turn" class="nav__drawer-link">Network Traversal</a></li>
                </ul>
                <ul>
                  <li><a href="https://www.twilio.com/messaging" class="nav__drawer-link nav__drawer-link--category">Messaging</a></li>
                  <li><a href="https://www.twilio.com/sms" class="nav__drawer-link">Programmable SMS</a></li>
                  <li><a href="https://www.twilio.com/chat" class="nav__drawer-link">Programmable Chat</a></li>
                  <li><a href="https://www.twilio.com/notify" class="nav__drawer-link">Notify</a></li>
                </ul>
              </div>
              <div class="nav__drawer-column">
                <ul>
                  <li>
                    <div class="nav__drawer-link nav__drawer-link--category">Authentication</div>
                  </li>
                  <li><a href="https://www.twilio.com/authy" class="nav__drawer-link">Authy</a></li>
                </ul>
                <ul>
                  <li>
                    <div class="nav__drawer-link nav__drawer-link--category">Connectivity</div>
                  </li>
                  <li><a href="https://www.twilio.com/lookup" class="nav__drawer-link">Lookup</a></li>
                  <li><a href="https://www.twilio.com/phone-numbers" class="nav__drawer-link">Phone Numbers</a></li>
                  <li><a href="https://www.twilio.com/wireless" class="nav__drawer-link">Programmable Wireless</a></li>
                  <li><a href="https://www.twilio.com/sync" class="nav__drawer-link">Sync</a></li>
                </ul>
                <ul>
                  <li>
                    <div class="nav__drawer-link nav__drawer-link--category">Marketplace</div>
                  </li>
                  <li><a href="https://www.twilio.com/marketplace/add-ons" class="nav__drawer-link">Add-ons</a></li>
                </ul>
                <ul>
                  <li>
                    <div class="nav__drawer-link nav__drawer-link--category">Platform</div>
                  </li>
                  <li><a href="https://www.twilio.com/enterprise" class="nav__drawer-link">Enterprise Plan</a></li>
                  <li><a href="https://www.twilio.com/interconnect" class="nav__drawer-link">Interconnect</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="nav__drawer-section">
            <div role="drawer__header" class="nav__drawer-header">Use Cases</div>
            <div role="drawer__dropdown" class="nav__drawer-dropdown">
              <ul>
                <li><a href="https://www.twilio.com/use-cases/access-security" class="nav__drawer-link nav__drawer-link--category">Access Security</a></li>
                <li><a href="https://www.twilio.com/use-cases/call-and-text-marketing" class="nav__drawer-link nav__drawer-link--category">Call &amp; Text Marketing</a></li>
                <li><a href="https://www.twilio.com/use-cases/collaboration" class="nav__drawer-link nav__drawer-link--category">Collaboration</a></li>
                <li><a href="https://www.twilio.com/use-cases/commerce-communications" class="nav__drawer-link nav__drawer-link--category">Commerce Communications</a></li>
                <li><a href="https://www.twilio.com/use-cases/contact-center" class="nav__drawer-link nav__drawer-link--category">Contact Center</a></li>
              </ul>
              <hr>
            </div>
            <div>
              <div class="nav__drawer-column">
                <ul>
                  <li><a href="https://customers.twilio.com/" class="nav__drawer-link nav__drawer-link--small">Customer Stories</a></li>
                  <li><a href="https://www.twilio.com/showcase" class="nav__drawer-link nav__drawer-link--small">Partner Showcase</a></li>
                  <li><a href="https://www.twilio.com/what-is-cloud-communications?" class="nav__drawer-link nav__drawer-link--small">Why Twilio?</a></li>
                  <li><a href="https://www.twilio.com/support-plans" class="nav__drawer-link nav__drawer-link--small">Support Plans</a></li>
                  <li><a href="http://status.twilio.com/" class="nav__drawer-link nav__drawer-link--small">Status</a></li>
                </ul>
              </div>
              <div class="nav__drawer-column">
                <ul>
                  <li><a href="https://www.twilio.com/docs" class="nav__drawer-link nav__drawer-link--small">API &amp; Docs</a></li>
                  <li><a href="https://www.twilio.com/blog" class="nav__drawer-link nav__drawer-link--small">Blog</a></li>
                  <li><a href="https://www.twilio.com/help" class="nav__drawer-link nav__drawer-link--small">Help</a></li>
                  <li><a href="https://www.twilio.com/company/jobs" class="nav__drawer-link nav__drawer-link--small">Jobs at Twilio</a></li>
                </ul>
              </div>
            </div>
            <div class="nav__sales"><a href="https://www.twilio.com/help/sales" class="nav__sales-button">Talk to Sales</a></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div role="nav" class="nav nav--subnav nav--inverted nav--transparent " data-subnav-length="40">
  <div role="nav__menu" class="nav__header">
    <div class="nav__title"><a href="https://www.twilio.com/" class="nav__logo">Twilio</a></div>
    <nav class="nav__menu">
      <ul class="nav__menu-items">
        <li class="nav__menu-item"></li>
        
        <li class="nav__menu-item">
          <a href="https://www.twilio.com/login" class="nav__menu-link">
            <svg xmlns="http://www.w3.org/2000/svg" width="10.2" height="13.5" viewBox="0 0 10.2 13.5">
              <circle fill="none" stroke="#F22F46" stroke-miterlimit="10" cx="5.1" cy="3" r="2.5"></circle>
              <path fill="none" stroke="#F22F46" stroke-miterlimit="10" d="M.5 13.5c0-2.5 2.1-4.6 4.6-4.6s4.6 2.1 4.6 4.6"></path>
            </svg>
            Log In
          </a>
        </li>
        <li class="nav__menu-item">
          <a href="https://www.twilio.com/try-twilio" class="nav__menu-link">
            <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 13 13">
              <path d="M0 6.5h13M6.5 0v13" fill="none" stroke="#F22F46" stroke-miterlimit="10"></path>
            </svg>
            Sign Up
          </a>
        </li>
        
        <li class="nav__menu-item"><a href="#menu" role="nav__activate" class="nav__menu-link nav__menu-activate"><span></span>Menu &amp; Products</a></li>
      </ul>
    </nav>
    <nav role="subnav" class="nav__subnav">
      <header class="nav__subnav-header">
        <a href="https://www.twilio.com/docs" class="nav__subnav-header-link">Docs</a>
        
          <a href="https://www.twilio.com/docs/guides" role="subnav__dropdown" 
            class="nav__subnav-link nav__subnav-current">Guides</a>
        
      </header>
      <ul role="subnav__items" class="nav__subnav-items">
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/quickstart" class="nav__subnav-link">Quickstart</a>
        </li>
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/guides" class="nav__subnav-link">Guides</a>
        </li>
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/tutorials" class="nav__subnav-link">Tutorials</a>
        </li>
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/api" class="nav__subnav-link">API Reference</a>
        </li>
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/libraries" class="nav__subnav-link">SDKs</a>
        </li>
      </ul>
    </nav>
  </div>
</div>



    
    
      

<div class="docs__pagenav">
  <div class="uk-container uk-container-center">
    <div class="uk-grid">
      <div class="uk-width-3-4 uk-hidden-small">
      
      
        <div class="breadcrumbs">
          
            
          
            
          
            
              <a href="https://www.twilio.com/docs/guides">Guides</a> &gt;
            
          
          <span>Serverless Webhooks with Azure Functions and Node.js</span>
        </div>
      
      </div>

      
      <div class="uk-width-1-1 uk-width-medium-1-4">
  <div class="search">
    <form action="https://www.twilio.com/docs/search" method="GET">
      <div class="wrapper">
        <input id="search-box" name="q" type="text" value=""/>
      </div>
      <button type="submit">
        <i class="fa fa-fw fa-search"></i>
      </button>
    </form>
  </div>
</div>

    </div>
  </div>
</div>

    

    <div class="docs-container">
      <div class="uk-container">
        
        
  <div class="coderail-container">

    <div class="sidenav-column">
      <div class="theme-switcher uk-hidden-small">
  <div class="theme-wrapper">
    <a data-theme="light" class="selected">
      <i class="fa fa-fw fa-sun-o"></i>
    </a>
    <a data-theme="dark" >
      <i class="fa fa-fw fa-moon-o"></i>
    </a>
  </div>
</div>
      
        <div class="sidenav" data-uk-sticky="{boundary: true}">
          

<ul id="doc_menu" class="sidenav__section" data-swiftype-index="false">

  <!-- Page entries -->
  
    <li id="dynamic-menu">
      <ul>
        
          
            
<li class="menu-title expanded" role="menu-title" id="doc-navigation-parent">
  Serverless Webhooks with Azure Functions and Node.js
</li>
<ul class="menu-accordion expanded" role="menu-accordion" id="doc-navigation"></ul>

          
          
<li class="menu-title expanded" role="menu-title">

    <span class="heading">Related Guides</span>
</li>


<ul class="menu-accordion expanded" role="menu-accordion">

    
        



  <li 
    >
      <a href="https://www.twilio.com/docs/guides/sms/how-to-receive-and-reply-in-node-js">
          Receive and Reply to SMS and MMS Messages in Node.js
      </a>
  </li>



    
        



  <li 
    >
      <a href="https://www.twilio.com/docs/guides/sms/how-to-confirm-delivery-in-node-js">
          Track Delivery Status of Messages in Node.js
      </a>
  </li>



    
        



  <li 
    >
      <a href="https://www.twilio.com/docs/guides/voice/how-to-respond-to-incoming-phone-calls-in-node-js">
          Respond to Incoming Phone Calls in Node.js
      </a>
  </li>



    
        



  <li 
    >
      <a href="https://www.twilio.com/docs/guides/voice/how-to-record-phone-calls-in-node-js">
          Record Phone Calls in Node.js
      </a>
  </li>



    
</ul>

        
        
      </ul>
    </li>
  
</ul>

        </div>
      
    </div>

    <div class="primary-column 
        ">
      <div class="docs-prose">
        
  
    
    <h1 class="page-title ">
      Serverless Webhooks with Azure Functions and Node.js
    </h1>
    
      
<div class="authors">
  <div class="authors-body">
    <div class="author">
      <img src="https://www.gravatar.com/avatar/560630d6945c6a8777533e7ea3b4e69b?d=mm&amp;s=50" title="David Prothero" alt="David Prothero" />
      David Prothero
    </div>
  </div>
  <div class="authors-footer"></div>
</div>


    
  
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><p><a href="http://martinfowler.com/articles/serverless.html">Serverless architectures</a> allow developers to write code that runs in the cloud without managing servers. "Serverless" applications can be very efficient with compute resources (significantly reducing costs) by only running in response to events like API requests. Microsoft Azure's offering for serverless code is called <a href="https://azure.microsoft.com/en-us/services/functions/">Azure Functions</a>. Let's look at a practical application of Azure Functions by writing Node.js JavaScript code to handle Twilio webhooks for incoming SMS messages and voice phone calls.</p></div>

      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><h2 id="create-a-new-azure-function-app"><a class="toclink" href="#create-a-new-azure-function-app">Create a New Azure Function app</a></h2>
<p>To get started on the road to serverless bliss, you first need to create a new Function App in the <a href="https://portal.azure.com/">Azure Portal</a>. Do this by clicking New, searching for "Function App" and selecting "Function App" from the list:</p>
<p><img alt="Azure - Create function app" class="richtext-image full-width" height="318" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/Create_function_app.width-800.png" width="594"/></p>
<p>After clicking on "Function App," click the "Create" button. Provide an app name and other parameters to your preferences:</p>
<p><img alt="Azure - Function app details" class="richtext-image full-width" height="496" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/Function_app_details.width-800.png" width="277"/></p></div>

      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><h2 id="write-a-function-to-respond-to-sms-messages"><a class="toclink" href="#write-a-function-to-respond-to-sms-messages">Write a Function to Respond to SMS Messages</a></h2>
<h4 id="create-the-function"><a class="toclink" href="#create-the-function">Create the Function</a></h4>
<p>Bring up your new Function App in the Azure Portal. You should see the Quickstart page which will give you options for creating your first function. We want to use the "Webhook + API" scenario and choose JavaScript as our language:</p>
<p><img alt="Azure - Create JS function" class="richtext-image full-width" height="502" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/Create_function_JS.width-800.png" width="572"/></p>
<p>Click "Create this function" and you'll be presented with the function editor, where you can start cutting some code.</p></div>

      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><h4 id="install-the-twilio-helper-library"><a class="toclink" href="#install-the-twilio-helper-library">Install the Twilio Helper Library</a></h4>
<p>When Twilio calls your webhook, it is expecting a response in <a href="https://www.twilio.com/docs/api/twiml">TwiML</a>. Our JavaScript code will need to generate this TwiML, which is just standard XML. While we could create the XML in a string, the <a href="https://www.twilio.com/docs/libraries/node">Twilio Helper Library</a> provides classes to make it easy to build a valid TwiML response. Azure Functions allows installing npm packages and making them available to your functions. We need to create a <code>package.json</code> file with the following content:</p></div>

      
    </div>
  
    <div class="block-code_sample ">
      
        

<div class="md-code-sample" id="code-packagejson-for-nodejs-azure-functions" 
  data-title="package.json for Node.js Azure Functions" data-pref="server">

  <div class="inline-mode">
    <div class="code-snippets">
      <div class="sample-tabs">
      <a class="title" href="#code-packagejson-for-nodejs-azure-functions">package.json for Node.js Azure Functions</a>
        <ul style="visibility:hidden" >
          
            <li class="sample-tab active" 
              data-ext="json">JSON</li>
          
        </ul>
      </div>

      
        
      
          
      
        <pre data-ext="json" data-version="default" class="codehilite"><code><span class="code-line"><span class="p">{</span>
</span><span class="code-line">  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;twilio-azure-functions-sms-node&quot;</span><span class="p">,</span>
</span><span class="code-line">  <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span class="code-line">  <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Receive SMS with Azure Functions and Node.js&quot;</span><span class="p">,</span>
</span><span class="code-line">  <span class="nt">&quot;main&quot;</span><span class="p">:</span> <span class="s2">&quot;index.js&quot;</span><span class="p">,</span>
</span><span class="code-line">  <span class="nt">&quot;scripts&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="code-line">    <span class="nt">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>
</span><span class="code-line">  <span class="p">},</span>
</span><span class="code-line">  <span class="nt">&quot;author&quot;</span><span class="p">:</span> <span class="s2">&quot;Twilio&quot;</span><span class="p">,</span>
</span><span class="code-line">  <span class="nt">&quot;license&quot;</span><span class="p">:</span> <span class="s2">&quot;MIT&quot;</span><span class="p">,</span>
</span><span class="code-line">  <span class="nt">&quot;dependencies&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="code-line">    <span class="nt">&quot;twilio&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.11.1&quot;</span>
</span><span class="code-line">  <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></code></pre>
      
    </div>

    
  </div>

  <div class="button-mode">
    <h5 class="title">
      <i class="fa fa-fw fa-code"></i>
      package.json for Node.js Azure Functions
    </h5>
    
      <p>Customize the name, version, etc. for your project.</p>
    
    <div class="active-tail"></div>
  </div>
</div>



      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><p>To create this file, click the <img alt="View Files" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/View_Files_Button.original.png"/> button and then the <img alt="Add" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/Add_file_button.original.png"/> button. Name the file <code>package.json</code>. Paste the JSON into the code editor and Save the file.</p>
<p>Lastly, you need to run npm to install the packages:</p>
<ol>
<li>Click on <img alt="Function app settings" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/Function_app_settings_button.original.png"/> button in the lower-left corner.</li>
<li>Click the <img alt="Go to Kudu button" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/Go_to_Kudu_button.original.png"/> button to bring up a console window.</li>
<li>Navigate to the <code>D:\home\site\wwwroot\[YourFunctionName]</code> directory.</li>
<li>Run the following command at the command prompt: <code>npm install</code></li>
</ol>
<h4 id="write-the-message-handling-code"><a class="toclink" href="#write-the-message-handling-code">Write the Message Handling Code</a></h4>
<p>Now let's write the code that will handle the incoming text message. Switch back to your function code (click the function name and then select the <code>index.js</code> file) and paste the following JavaScript code into the editor:</p></div>

      
    </div>
  
    <div class="block-code_sample ">
      
        

<div class="md-code-sample" id="code-receive-sms-with-nodejs-azure-functions" 
  data-title="Receive SMS with Node.js Azure Functions" data-pref="server">

  <div class="inline-mode">
    <div class="code-snippets">
      <div class="sample-tabs">
      <a class="title" href="#code-receive-sms-with-nodejs-azure-functions">Receive SMS with Node.js Azure Functions</a>
        <ul style="visibility:hidden" >
          
            <li class="sample-tab active" 
              data-ext="js">Node.js</li>
          
        </ul>
      </div>

      
        
      
          
      
        <pre data-ext="js" data-version="default" class="codehilite"><code><span class="code-line"><span class="kd">var</span> <span class="nx">qs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;querystring&quot;</span><span class="p">);</span>
</span><span class="code-line"><span class="kd">var</span> <span class="nx">twilio</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;twilio&#39;</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
</span><span class="code-line">    <span class="nx">context</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;JavaScript HTTP trigger function processed a request.&#39;</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="kd">var</span> <span class="nx">formValues</span> <span class="o">=</span> <span class="nx">qs</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="kd">var</span> <span class="nx">twiml</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">twilio</span><span class="p">.</span><span class="nx">TwimlResponse</span><span class="p">();</span>
</span><span class="code-line">    <span class="nx">twiml</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="s1">&#39;You said: &#39;</span> <span class="o">+</span> <span class="nx">formValues</span><span class="p">.</span><span class="nx">Body</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="nx">res</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="code-line">        <span class="nx">status</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
</span><span class="code-line">        <span class="nx">body</span><span class="o">:</span> <span class="nx">twiml</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
</span><span class="code-line">        <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
</span><span class="code-line">            <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/xml&#39;</span>
</span><span class="code-line">        <span class="p">},</span>
</span><span class="code-line">        <span class="nx">isRaw</span><span class="o">:</span> <span class="kc">true</span>
</span><span class="code-line">    <span class="p">};</span>
</span><span class="code-line">    <span class="nx">context</span><span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">res</span><span class="p">);</span>
</span><span class="code-line"><span class="p">};</span>
</span></code></pre>
      
    </div>

    
  </div>

  <div class="button-mode">
    <h5 class="title">
      <i class="fa fa-fw fa-code"></i>
      Receive SMS with Node.js Azure Functions
    </h5>
    
    <div class="active-tail"></div>
  </div>
</div>



      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><p>Twilio will send <a href="https://www.twilio.com/docs/api/twiml/sms/twilio_request">data about the incoming SMS as form parameters</a> in the body of the POST request. This function has the code to parse out all of those parameters. You need only reference the name of the parameter you want such as <code>formValues.Body</code> for the body of the message or <code>formValues.From</code> for the phone number of the person sending the message (note the PascalCase of the parameters).</p>
<p>The output of the function is a properly formatted XML response containing the TwiML built by the <code>twilio.TwimlResponse</code> builder. This function simply echoes back whatever message was sent, but you can see where you you could put code to do any number of things such as call an external API or make use of <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-overview#a-nameintegrationsaintegrations">other Azure resources</a>.</p></div>

      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><h4 id="configure-the-message-webhook"><a class="toclink" href="#configure-the-message-webhook">Configure the Message Webhook</a></h4>
<p>Now we need to configure our Twilio phone number to call our Azure Function whenever a new text message comes in. To find the URL for your function, look for the <strong>Function Url</strong> label directly above the code editor in the Azure Portal:</p>
<p><img alt="Azure Function Node.js Url" class="richtext-image full-width" height="160" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/Function_url_JS.width-800.png" width="428"/></p>
<p>Copy this URL to the clipboard. Next, open the <a href="https://www.twilio.com/console">Twilio Console</a> and <a href="https://www.twilio.com/console/phone-numbers/incoming">find the phone number</a> you want to use (or <a href="https://www.twilio.com/console/phone-numbers/search">buy a new number</a>). On the configuration page for the number, scroll down to "Messaging" and next to "A MESSAGE COMES IN," select "Webhook" and paste in the function URL. (Be sure "HTTP POST" is selected, as well.)</p>
<p><img alt="Azure Functions Phone Number Config" class="richtext-image full-width" height="120" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/Phone_number_config.width-800.png" width="800"/></p></div>

      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><h4 id="test-the-message-webhook-function"><a class="toclink" href="#test-the-message-webhook-function">Test the Message Webhook Function</a></h4>
<p>Now send a text message to your Twilio phone number. If you texted "Hello", then you should get a reply back saying "You said: Hello". If there are any problems, you can use the <img alt="Logs" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/Logs_button.original.png"/> button in the Azure Function to see what error messages are happening on the server-side. To see errors on Twilio's side, use the <a href="https://www.twilio.com/console/dev-tools/debugger">Twilio Debugger</a>.</p>
<p>If you'd like to simulate a request from Twilio, you can use the <img alt="Test" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/Test_button.original.png"/> button. Provide <a href="https://en.wikipedia.org/wiki/POST_(HTTP)#Use_for_submitting_web_forms">url encoded form parameters</a> in the "Request body" field and the click the "Run" button at the top of code editor.</p></div>

      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><h2 id="write-a-function-to-handle-phone-calls"><a class="toclink" href="#write-a-function-to-handle-phone-calls">Write a Function to Handle Phone Calls</a></h2>
<p>Follow <a href="#write-a-function-to-respond-to-sms-messages">the same steps above</a> to create your function and reference the Twilio Helper Library.</p>
<h4 id="write-the-call-handling-code"><a class="toclink" href="#write-the-call-handling-code">Write the Call Handling Code</a></h4>
<p>Now let's write the code that will handle the incoming phone call. Switch back to your function code (click the function name and then select the <code>index.js</code> file) and paste the following JavaScript code into the editor:</p></div>

      
    </div>
  
    <div class="block-code_sample ">
      
        

<div class="md-code-sample" id="code-receive-voice-calls-with-nodejs-azure-functions" 
  data-title="Receive Voice Calls with Node.js Azure Functions" data-pref="server">

  <div class="inline-mode">
    <div class="code-snippets">
      <div class="sample-tabs">
      <a class="title" href="#code-receive-voice-calls-with-nodejs-azure-functions">Receive Voice Calls with Node.js Azure Functions</a>
        <ul style="visibility:hidden" >
          
            <li class="sample-tab active" 
              data-ext="js">Node.js</li>
          
        </ul>
      </div>

      
        
      
          
      
        <pre data-ext="js" data-version="default" class="codehilite"><code><span class="code-line"><span class="kd">var</span> <span class="nx">qs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;querystring&quot;</span><span class="p">);</span>
</span><span class="code-line"><span class="kd">var</span> <span class="nx">twilio</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;twilio&#39;</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
</span><span class="code-line">    <span class="nx">context</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;JavaScript HTTP trigger function processed a request.&#39;</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="kd">var</span> <span class="nx">formValues</span> <span class="o">=</span> <span class="nx">qs</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
</span><span class="code-line">    <span class="c1">// Insert spaces between numbers to aid text-to-speech engine</span>
</span><span class="code-line">    <span class="kd">var</span> <span class="nx">phoneNumber</span> <span class="o">=</span> <span class="nx">formValues</span><span class="p">.</span><span class="nx">From</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\+/g</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="kd">var</span> <span class="nx">twiml</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">twilio</span><span class="p">.</span><span class="nx">TwimlResponse</span><span class="p">();</span>
</span><span class="code-line">    <span class="nx">twiml</span><span class="p">.</span><span class="nx">say</span><span class="p">(</span><span class="s1">&#39;Your phone number is: &#39;</span> <span class="o">+</span> <span class="nx">phoneNumber</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="nx">res</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="code-line">        <span class="nx">status</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
</span><span class="code-line">        <span class="nx">body</span><span class="o">:</span> <span class="nx">twiml</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
</span><span class="code-line">        <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
</span><span class="code-line">            <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/xml&#39;</span>
</span><span class="code-line">        <span class="p">},</span>
</span><span class="code-line">        <span class="nx">isRaw</span><span class="o">:</span> <span class="kc">true</span>
</span><span class="code-line">    <span class="p">};</span>
</span><span class="code-line">    <span class="nx">context</span><span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">res</span><span class="p">);</span>
</span><span class="code-line"><span class="p">};</span>
</span></code></pre>
      
    </div>

    
  </div>

  <div class="button-mode">
    <h5 class="title">
      <i class="fa fa-fw fa-code"></i>
      Receive Voice Calls with Node.js Azure Functions
    </h5>
    
    <div class="active-tail"></div>
  </div>
</div>



      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><p>Twilio will send <a href="https://www.twilio.com/docs/api/twiml/twilio_request">data about the incoming call as form parameters</a> in the body of the POST request. This function has the code to parse out all of those parameters. You need only reference the name of the parameter you want such as <code>formValues.From</code> for the phone number of the person calling or <code>formValues.CallSid</code> for a unique identifier of the call (note the PascalCase of the parameters).</p>
<p>The output of the function is a properly formatted XML response containing the TwiML built by the <code>twilio.TwimlResponse</code> builder. This function simply tells the caller their phone number, but you can see where you you could put code to do any number of things such as call an external API or make use of <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-overview#a-nameintegrationsaintegrations">other Azure resources</a>.</p></div>

      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><h4 id="configure-the-voice-webhook"><a class="toclink" href="#configure-the-voice-webhook">Configure the Voice Webhook</a></h4>
<p>Now we need to configure our Twilio phone number to call our Azure Function whenever a call comes in. To find the URL for your function, look for the <strong>Function Url</strong> label directly above the code editor in the Azure Portal:</p>
<p><img alt="Azure Function Node.js Url" class="richtext-image full-width" height="160" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/Function_url_JS.width-800.png" width="428"/></p>
<p>Copy this URL to the clipboard. Next, open the <a href="https://www.twilio.com/console">Twilio Console</a> and <a href="https://www.twilio.com/console/phone-numbers/incoming">find the phone number</a> you want to use (or <a href="https://www.twilio.com/console/phone-numbers/search">buy a new number</a>). On the configuration page for the number, scroll down to "Voice" and next to "A CALL COMES IN," select "Webhook" and paste in the function URL. (Be sure "HTTP POST" is selected, as well.)</p>
<p><img alt="Azure Functions Voice Config" class="richtext-image full-width" height="123" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/Phone_number_config_for_voice.width-800.png" width="800"/></p></div>

      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><h4 id="test-the-voice-webhook-function"><a class="toclink" href="#test-the-voice-webhook-function">Test the Voice Webhook Function</a></h4>
<p>Now call your Twilio phone number. You should hear a voice saying "Your phone number is &lt;123456&gt;". If there are any problems, you can use the <img alt="Logs" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/Logs_button.original.png"/> button in the Azure Function to see what error messages are happening on the server-side. To see errors on Twilio's side, use the <a href="https://www.twilio.com/console/dev-tools/debugger">Twilio Debugger</a>.</p>
<p>If you'd like to simulate a request from Twilio, you can use the <img alt="Test" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/Test_button.original.png"/> button. Provide <a href="https://en.wikipedia.org/wiki/POST_(HTTP)#Use_for_submitting_web_forms">url encoded form parameters</a> in the "Request body" field and the click the "Run" button at the top of code editor.</p></div>

      
    </div>
  
    <div class="block-rich_text ">
      
        

<div class="rich-text"><h2 id="whats-next"><a class="toclink" href="#whats-next">What's Next?</a></h2>
<p>The <a href="https://docs.microsoft.com/en-us/azure/azure-functions/">Azure Functions documentation</a> contains all you need to take your functions to the next level. Be sure to also refer to our <a href="https://www.twilio.com/docs/api/twiml">TwiML Reference</a> for all that you can do with TwiML in your serverless webhooks.</p>
<p>Now, get out there and enjoy your new serverless life.</p></div>

      
    </div>
  

    
      
<div class="contributors">
  <div class="contributors-body">
  
    <div class="contributor">
      
        <label>Contributors:</label>
      
      <img src="https://www.gravatar.com/avatar/560630d6945c6a8777533e7ea3b4e69b?d=mm&amp;s=50" title="David Prothero" alt="David Prothero" />
    </div>
  
    <div class="contributor">
      
      <img src="https://www.gravatar.com/avatar/4786cf28e0f5886c4b006f7487333845?d=mm&amp;s=50" title="Kevin Whinnery" alt="Kevin Whinnery" />
    </div>
  
  </div>
  <div class="contributors-footer"></div>
</div>


    

        
          
<div id="disqus_thread"></div>


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

// Unique identifiers
PAGE_URL = "https://www.twilio.com/docs/guides/serverless-webhooks-azure-functions-and-node-js";

var disqus_config = function () {
  this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'http://twiliodocumentation.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


        
      </div>
    </div>

    <div class="code-column">
      
  <div id="coderail" class="code-rail" data-uk-sticky="{boundary: true}">

  <div class="rail-placeholder"></div>

  <div class="rail-header uk-hidden">

    <div class="rail-header-wrapper">

      <div class="rail-navigation">
        <div class="inner">
          <a href="#previous" class="inactive" data-previous>
            <i class="fa fa-fw fa-arrow-left left"></i>
          </a>
        </div>
        <div class="inner">
          <span>
            <span class="current-index">1</span>
            <span>/</span>
            <span class="snippet-total">1</span>
          </span>
        </div>
        <div class="inner">
          <a href="#next" data-next>
            <i class="fa fa-fw fa-arrow-right"></i>
          </a>
        </div>
      </div>

      <div class="rail-title">
        <div class="title-content inner">
          <span>Loading Code Samples...</span>
          <i class="fa fa-fw fa-chevron-down"></i>
        </div>
      </div>

    </div>

  </div>

  <div class="rail-toolbar uk-hidden">

    <div class="rail-current-language">
      <div class="inner">
        <span>Language</span>
        <i class="fa fa-fw fa-chevron-down"></i>
      </div>
    </div>

    <div class="toolbar">
      <a href="#code" class="uk-hidden tab" data-code>Code</a>
      <a href="#output" class="uk-hidden inactive" data-output>Output</a>

      <span class="separator"></span>

      <a id="download" class="uk-hidden">
        <i class="fa fa-fw fa-download"></i>
        <span>Download Project</span>
      </a>

      <a id="github" class="uk-hidden" target="_blank">
        <i class="fa fa-fw fa-github-square"></i>
        <span>View on GitHub</span>
      </a>

      <a id="defrosty" class="fr-on" href="#defrosty">
        <i class="fa fa-fw fa-eye"></i>
        <span class="wider-tooltip">Toggle Highlighted Lines</span>
      </a>

      <a id="clippy" href="#copy">
        <i class="fa fa-fw fa-copy"></i>
        <span>Copy to Clipboard</span>
      </a>

      <a id="linkcode" href="#linkcode">
        <i class="fa fa-fw fa-link"></i>
        <span>Link to this Code</span>
      </a>

      <a href="#expand" data-expand>
        <i class="fa fa-fw fa-arrows-alt"></i>
        <span>Full Screen</span>
      </a>
      <a href="#collapse" class="uk-hidden" data-collapse>
        <i class="fa fa-fw fa-compress"></i>
        <span>Normal Size</span>
      </a>
    </div>
  </div>

  <div class="rail-samples">
    <ul>
      
        <li>
          <a href="#code-packagejson-for-nodejs-azure-functions">
            package.json for Node.js Azure Functions
          </a>
        </li>
      
        <li>
          <a href="#code-receive-sms-with-nodejs-azure-functions">
            Receive SMS with Node.js Azure Functions
          </a>
        </li>
      
        <li>
          <a href="#code-receive-voice-calls-with-nodejs-azure-functions">
            Receive Voice Calls with Node.js Azure Functions
          </a>
        </li>
      
    </ul>
  </div>

  <div class="rail-languages"></div>

  <div class="rail-content">
    <div class="rail-content-inner">
      
        
        <div data-sample-title="package.json for Node.js Azure Functions"
            data-sample="code-packagejson-for-nodejs-azure-functions" 
            data-pref="server"
            data-download-url="https://github.com/TwilioDevEd/azure-functions-examples/archive/master.zip"
            data-github-url="https://github.com/TwilioDevEd/azure-functions-examples/blob/master/SmsNode/package.json"
            class="code-sample">

          <div class="sample-language-data" style="display:none;">
            <select>
              
                <option value="json">JSON</option>
              
            </select>
          </div>

          
            
          

          

          <div class="snippet-container">
            
              <pre data-ext="json" 
                data-version="default"
                data-filename=""
                class="codehilite"><code><span class="code-line"><span class="p">{</span>
</span><span class="code-line">  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;twilio-azure-functions-sms-node&quot;</span><span class="p">,</span>
</span><span class="code-line">  <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
</span><span class="code-line">  <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Receive SMS with Azure Functions and Node.js&quot;</span><span class="p">,</span>
</span><span class="code-line">  <span class="nt">&quot;main&quot;</span><span class="p">:</span> <span class="s2">&quot;index.js&quot;</span><span class="p">,</span>
</span><span class="code-line">  <span class="nt">&quot;scripts&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="code-line">    <span class="nt">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>
</span><span class="code-line">  <span class="p">},</span>
</span><span class="code-line">  <span class="nt">&quot;author&quot;</span><span class="p">:</span> <span class="s2">&quot;Twilio&quot;</span><span class="p">,</span>
</span><span class="code-line">  <span class="nt">&quot;license&quot;</span><span class="p">:</span> <span class="s2">&quot;MIT&quot;</span><span class="p">,</span>
</span><span class="code-line">  <span class="nt">&quot;dependencies&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="code-line">    <span class="nt">&quot;twilio&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.11.1&quot;</span>
</span><span class="code-line">  <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></code></pre>
            
          </div>

          <div class="output-snippet-container">
            
          </div>

        </div>
        
      
        
        <div data-sample-title="Receive SMS with Node.js Azure Functions"
            data-sample="code-receive-sms-with-nodejs-azure-functions" 
            data-pref="server"
            data-download-url="https://github.com/TwilioDevEd/azure-functions-examples/archive/master.zip"
            data-github-url="https://github.com/TwilioDevEd/azure-functions-examples/blob/master/SmsNode/index.js"
            class="code-sample">

          <div class="sample-language-data" style="display:none;">
            <select>
              
                <option value="js">Node.js</option>
              
            </select>
          </div>

          
            
          

          

          <div class="snippet-container">
            
              <pre data-ext="js" 
                data-version="default"
                data-filename=""
                class="codehilite"><code><span class="code-line"><span class="kd">var</span> <span class="nx">qs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;querystring&quot;</span><span class="p">);</span>
</span><span class="code-line"><span class="kd">var</span> <span class="nx">twilio</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;twilio&#39;</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
</span><span class="code-line">    <span class="nx">context</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;JavaScript HTTP trigger function processed a request.&#39;</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="kd">var</span> <span class="nx">formValues</span> <span class="o">=</span> <span class="nx">qs</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="kd">var</span> <span class="nx">twiml</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">twilio</span><span class="p">.</span><span class="nx">TwimlResponse</span><span class="p">();</span>
</span><span class="code-line">    <span class="nx">twiml</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="s1">&#39;You said: &#39;</span> <span class="o">+</span> <span class="nx">formValues</span><span class="p">.</span><span class="nx">Body</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="nx">res</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="code-line">        <span class="nx">status</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
</span><span class="code-line">        <span class="nx">body</span><span class="o">:</span> <span class="nx">twiml</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
</span><span class="code-line">        <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
</span><span class="code-line">            <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/xml&#39;</span>
</span><span class="code-line">        <span class="p">},</span>
</span><span class="code-line">        <span class="nx">isRaw</span><span class="o">:</span> <span class="kc">true</span>
</span><span class="code-line">    <span class="p">};</span>
</span><span class="code-line">    <span class="nx">context</span><span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">res</span><span class="p">);</span>
</span><span class="code-line"><span class="p">};</span>
</span></code></pre>
            
          </div>

          <div class="output-snippet-container">
            
          </div>

        </div>
        
      
        
        <div data-sample-title="Receive Voice Calls with Node.js Azure Functions"
            data-sample="code-receive-voice-calls-with-nodejs-azure-functions" 
            data-pref="server"
            data-download-url="https://github.com/TwilioDevEd/azure-functions-examples/archive/master.zip"
            data-github-url="https://github.com/TwilioDevEd/azure-functions-examples/blob/master/VoiceNode/index.js"
            class="code-sample">

          <div class="sample-language-data" style="display:none;">
            <select>
              
                <option value="js">Node.js</option>
              
            </select>
          </div>

          
            
          

          

          <div class="snippet-container">
            
              <pre data-ext="js" 
                data-version="default"
                data-filename=""
                class="codehilite"><code><span class="code-line"><span class="kd">var</span> <span class="nx">qs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;querystring&quot;</span><span class="p">);</span>
</span><span class="code-line"><span class="kd">var</span> <span class="nx">twilio</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;twilio&#39;</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
</span><span class="code-line">    <span class="nx">context</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;JavaScript HTTP trigger function processed a request.&#39;</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="kd">var</span> <span class="nx">formValues</span> <span class="o">=</span> <span class="nx">qs</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
</span><span class="code-line">    <span class="c1">// Insert spaces between numbers to aid text-to-speech engine</span>
</span><span class="code-line">    <span class="kd">var</span> <span class="nx">phoneNumber</span> <span class="o">=</span> <span class="nx">formValues</span><span class="p">.</span><span class="nx">From</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\+/g</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="kd">var</span> <span class="nx">twiml</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">twilio</span><span class="p">.</span><span class="nx">TwimlResponse</span><span class="p">();</span>
</span><span class="code-line">    <span class="nx">twiml</span><span class="p">.</span><span class="nx">say</span><span class="p">(</span><span class="s1">&#39;Your phone number is: &#39;</span> <span class="o">+</span> <span class="nx">phoneNumber</span><span class="p">);</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="nx">res</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="code-line">        <span class="nx">status</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
</span><span class="code-line">        <span class="nx">body</span><span class="o">:</span> <span class="nx">twiml</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
</span><span class="code-line">        <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
</span><span class="code-line">            <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/xml&#39;</span>
</span><span class="code-line">        <span class="p">},</span>
</span><span class="code-line">        <span class="nx">isRaw</span><span class="o">:</span> <span class="kc">true</span>
</span><span class="code-line">    <span class="p">};</span>
</span><span class="code-line">    <span class="nx">context</span><span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">res</span><span class="p">);</span>
</span><span class="code-line"><span class="p">};</span>
</span></code></pre>
            
          </div>

          <div class="output-snippet-container">
            
          </div>

        </div>
        
      
    </div>
  </div>
</div>


    </div>

  </div>

      </div>
    </div>

    
    


<div class="footer" data-swiftype-index="false">
  <div class="uk-container uk-container-center">
    <div class="footer__statement">We can’t wait to see what you build.</div>
    <div class="uk-grid">
      <div class="uk-width-1-1 uk-width-small-1-3 uk-width-medium-1-5">
        <section class="footer__section">
          <header class="footer__header">Products</header>
          <ul class="footer__list">
            <li class="footer__list-item">
              <a href="https://www.twilio.com/voice-video" class="footer__link">Voice &amp; Video</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/messaging" class="footer__link">Messaging</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/authy" class="footer__link">Authentication</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/wireless" class="footer__link">Connected Devices</a>
            </li>
          </ul>
        </section>
      </div>
      <div class="uk-width-1-1 uk-width-small-1-3 uk-width-medium-1-5">
        <section class="footer__section">
          <header class="footer__header">Use Cases</header>
          <ul class="footer__list">
            <li class="footer__list-item">
              <a href="https://www.twilio.com/use-cases/access-security" class="footer__link">Access Security</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/use-cases/contextual-call-center" class="footer__link">Contextual Call Center</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/use-cases/marketplace-communications" class="footer__link">Marketplace Communications</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/use-cases/mobile-messaging" class="footer__link">Mobile Messaging</a>
            </li>
          </ul>
        </section>
      </div>
      <div class="uk-width-1-1 uk-width-small-1-3 uk-width-medium-1-5">
        <section class="footer__section">
          <header class="footer__header">About</header>
          <ul class="footer__list">
            <li class="footer__list-item">
              <a href="https://www.twilio.com/what-is-cloud-communications?" class="footer__link">What is Twilio?</a>
            </li>
            <li class="footer__list-item">
              <a href="https://customers.twilio.com/" class="footer__link">Customers</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/help" class="footer__link">Get Help</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/help/sales" class="footer__link">Talk to Sales</a>
            </li>
          </ul>
        </section>
      </div>
      <div class="uk-width-1-1 uk-width-medium-2-5">
        <section class="footer__section">
  <header class="footer__header">Hits From The Blog</header>
  <ul class="footer__list footer__list">
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/building-an-ivr-with-no-code-by-using-taskrouter-as-a-state-machine.html" class="footer__link">Building an IVR with no code by using TaskRouter as a state machine</a>
    </li>
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/logrole-gives-you-permissions-based-granular-searching-for-twilio-logs.html" class="footer__link">Logrole Gives You Permissions Based, Granular Searching For Twilio Logs</a>
    </li>
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/build-callbacks-with-stamplay-twilio-and-unbounce.html" class="footer__link">Build Callbacks With Stamplay, Twilio and Unbounce</a>
    </li>
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/build-a-basic-call-center-in-just-a-few-minutes-with-twilio.html" class="footer__link">Build a Basic Call Center in Just a Few Minutes with Twilio</a>
    </li>
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/redact-delete-sms-messages-node-js.html" class="footer__link">Redact or Delete SMS Messages as They Arrive with Node.js</a>
    </li>
    
  </ul>

</section>
      </div>
    </div>
    <footer class="footer__footer">
      <div class="footer__logo" title="Twilio">
        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30">
          <path d="M15 0C6.7 0 0 6.7 0 15s6.7 15 15 15 15-6.7 15-15S23.3 0 15 0zm0 26C8.9 26 4 21.1 4 15S8.9 4 15 4s11 4.9 11 11-4.9 11-11 11z"/>
          <circle cx="18.7" cy="11.3" r="3.1"/>
          <circle cx="18.7" cy="18.7" r="3.1"/>
          <circle cx="11.3" cy="18.7" r="3.1"/>
          <circle cx="11.3" cy="11.3" r="3.1"/>
        </svg>
      </div>
      <ul class="legal__list">
        <li class="legal__list-item">
          <a href="https://www.twilio.com/company" class="legal__link">About Twilio</a>
        </li>
        <li class="legal__list-item">
          <a href="https://www.twilio.com/legal" class="legal__link">Legal</a>
        </li>
        <li class="legal__list-item">Copyright &copy; 2016 Twilio, Inc. 
          <br class="uk-visible-small">All Rights Reserved.
        </li>
      </ul>
    </footer>
  </div>
</div>


    
    <script src="https://www.twilio.com/docs/static/js/vendor.min.16abf41c42de.js"></script>
    

  

  <!-- Mixpanel -->
  <script type="text/javascript">(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"===e.location.protocol?"https:":"http:")+'//cdn.mxpnl.com/libs/mixpanel-2.2.min.js';f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f);b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==
  typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,
    e,d])};b.__SV=1.2}})(document,window.mixpanel||[]);
    mixpanel.init("f71c19735fa6ecc5225ff563285e1794");
    </script>
  

  
    <!-- Heap -->
    <script type="text/javascript">
    window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var n=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(n?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(a,o);for(var r=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["clearEventProperties","identify","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=r(p[c])};
    heap.load('1541905715');
    </script>
  

  
    <!-- GA -->
    <script type="text/javascript">
    try {
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-2900316-1']);
      _gaq.push(['_setSiteSpeedSampleRate', 50]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    } catch(err) {}

    var _kmq = _kmq || [];
    </script>
  

  
    <!-- Eloqua -->
    <script type="text/javascript">
    var _elqQ = _elqQ || [];
    _elqQ.push(['elqSetSiteId', '815114181']);
    _elqQ.push(['elqTrackPageView']);
    _elqQ.push(['elqUseFirstPartyCookie', 'www.twilio.com']);

    (function () {
      function async_load() {
        var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;
        s.src = 'http://img03.en25.com/i/elqCfg.min.js';
        var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);
      }
      if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
      else if (window.attachEvent) window.attachEvent('onload', async_load);
    })();
    </script>
  

  
    <!-- Transifex -->
    <script type="text/javascript">
    window.liveSettings = {
      api_key: '4c06c1c5a6b341e591d969476fe2675f'
    };
    </script>
    <script type="text/javascript" src="http://cdn.transifex.com/live.js"></script>
    <style>
    .txlive-langselector { display: none; }
    </style>
  

  



    
      <script src="https://www.twilio.com/docs/static/js/docs.min.0c5bb1abb16f.js"></script>
    

    
    



    

  </body>

<!-- Mirrored from www.twilio.com/docs/guides/serverless-webhooks-azure-functions-and-node-js by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 22:10:04 GMT -->
</html>
