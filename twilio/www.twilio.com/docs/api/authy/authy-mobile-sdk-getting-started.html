


<!DOCTYPE html>
<html class="no-js">
  
<!-- Mirrored from www.twilio.com/docs/api/authy/authy-mobile-sdk-getting-started by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 22:09:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    
	<!-- Optimizely -->
	<script src="https://cdn.optimizely.com/js/6082066.js"></script>

    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width">
    
    
    
    

    <title>
      Authy Mobile SDK - Getting Started - Twilio
    </title>

    <link rel="canonical" href="https://www.twilio.com/docs/api/authy/authy-mobile-sdk-getting-started" />

    
    <link rel="shortcut icon" href="https://www.twilio.com/docs/static/img/favicons/favicon.db41f19ea294.ico"/>
    <link rel="apple-touch-icon" href="https://www.twilio.com/docs/static/img/favicons/favicon_57.98200b6899e6.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="https://www.twilio.com/docs/static/img/favicons/favicon_72.86ae17486256.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="https://www.twilio.com/docs/static/img/favicons/favicon_114.ee1859950ad4.png"/>

    
    <link rel="stylesheet" type="text/css" href="http://cloud.typography.com/6230892/752864/css/fonts.css">
    <link rel="stylesheet" href="https://www.twilio.com/docs/static/css/font-awesome.min.295235b28b6e.css" />
    <link rel="stylesheet" href="https://www.twilio.com/docs/static/css/twilio-icons.45de73e993f2.css" />
    <link rel="stylesheet" href="https://www.twilio.com/docs/static/css/font-mfizz.818f36cb00cc.css" />

    
    
    <meta property="og:title" content="Authy Mobile SDK - Getting Started">
    
    
    
    <meta property="og:url" content="https://www.twilio.com/docs/api/authy/authy-mobile-sdk-getting-started?utm_source=docs&utm_medium=social&utm_campaign=guides_tags">

    
    
    <meta name="twitter:title" content="Authy Mobile SDK - Getting Started">
    
    
    

    
    

    

    
      <link rel="stylesheet" href="https://www.twilio.com/docs/static/css/docs.min.05ed18599e08.css" />
    

    
    

    
    <script>
  var twilio = twilio || {};
  twilio.realm = "prod";
  twilio.SWIFTYPE_ENGINE_KEY = "T68bXEBf7NaKzyRpvbnG";
</script>


<script>
  twilio.account = twilio.account || {};
  

  twilio.user = twilio.user || {};
  
  

</script>


    <script>
  
  window.userBetaFeatures = ["marketplace", "enable-video-rooms"];
</script>

  </head>

  <body class="
    
      apireference
    
    
    
  ">

    

	
	<!-- Google Tag Manager -->
	<noscript><iframe src="http://www.googletagmanager.com/ns.html?id=GTM-MWRD6S"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'http://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window, document, 'script', 'dataLayer', 'GTM-MWRD6S');</script>
	<!-- End Google Tag Manager -->
	



    
    <div role="drawer" class="nav__drawer">
  <div role="drawer__wrapper" class="nav__drawer-wrapper">
    <div role="drawer__nav" class="nav__drawer-nav"><span class="nav__drawer-auth"><a href="https://www.twilio.com/login" class="nav__drawer-auth-link">Log In</a><a href="https://www.twilio.com/try-twilio" class="nav__drawer-auth-link">Sign Up</a></span><a href="#close" role="drawer__close" class="nav__drawer-close">Close</a></div>
    <div class="nav__drawer-menu">
      <div class="nav__drawer-container">
        <div class="nav__drawer-grid">
          <div class="nav__drawer-section">
            <div role="drawer__header" class="nav__drawer-header">Products</div>
            <div role="drawer__dropdown" class="nav__drawer-dropdown">
              <div class="nav__drawer-column">
                <ul>
                  <li><a href="https://www.twilio.com/voice-video" class="nav__drawer-link nav__drawer-link--category">Voice &amp; Video</a></li>
                  <li><a href="https://www.twilio.com/voice" class="nav__drawer-link">Programmable Voice</a></li>
                  <li><a href="https://www.twilio.com/video" class="nav__drawer-link">Programmable Video</a></li>
                  <li><a href="https://www.twilio.com/sip-trunking" class="nav__drawer-link">Elastic SIP Trunking</a></li>
                  <li><a href="https://www.twilio.com/taskrouter" class="nav__drawer-link">TaskRouter</a></li>
                  <li><a href="https://www.twilio.com/stun-turn" class="nav__drawer-link">Network Traversal</a></li>
                </ul>
                <ul>
                  <li><a href="https://www.twilio.com/messaging" class="nav__drawer-link nav__drawer-link--category">Messaging</a></li>
                  <li><a href="https://www.twilio.com/sms" class="nav__drawer-link">Programmable SMS</a></li>
                  <li><a href="https://www.twilio.com/chat" class="nav__drawer-link">Programmable Chat</a></li>
                  <li><a href="https://www.twilio.com/notify" class="nav__drawer-link">Notify</a></li>
                </ul>
              </div>
              <div class="nav__drawer-column">
                <ul>
                  <li>
                    <div class="nav__drawer-link nav__drawer-link--category">Authentication</div>
                  </li>
                  <li><a href="https://www.twilio.com/authy" class="nav__drawer-link">Authy</a></li>
                </ul>
                <ul>
                  <li>
                    <div class="nav__drawer-link nav__drawer-link--category">Connectivity</div>
                  </li>
                  <li><a href="https://www.twilio.com/lookup" class="nav__drawer-link">Lookup</a></li>
                  <li><a href="https://www.twilio.com/phone-numbers" class="nav__drawer-link">Phone Numbers</a></li>
                  <li><a href="https://www.twilio.com/wireless" class="nav__drawer-link">Programmable Wireless</a></li>
                  <li><a href="https://www.twilio.com/sync" class="nav__drawer-link">Sync</a></li>
                </ul>
                <ul>
                  <li>
                    <div class="nav__drawer-link nav__drawer-link--category">Marketplace</div>
                  </li>
                  <li><a href="https://www.twilio.com/marketplace/add-ons" class="nav__drawer-link">Add-ons</a></li>
                </ul>
                <ul>
                  <li>
                    <div class="nav__drawer-link nav__drawer-link--category">Platform</div>
                  </li>
                  <li><a href="https://www.twilio.com/enterprise" class="nav__drawer-link">Enterprise Plan</a></li>
                  <li><a href="https://www.twilio.com/interconnect" class="nav__drawer-link">Interconnect</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="nav__drawer-section">
            <div role="drawer__header" class="nav__drawer-header">Use Cases</div>
            <div role="drawer__dropdown" class="nav__drawer-dropdown">
              <ul>
                <li><a href="https://www.twilio.com/use-cases/access-security" class="nav__drawer-link nav__drawer-link--category">Access Security</a></li>
                <li><a href="https://www.twilio.com/use-cases/call-and-text-marketing" class="nav__drawer-link nav__drawer-link--category">Call &amp; Text Marketing</a></li>
                <li><a href="https://www.twilio.com/use-cases/collaboration" class="nav__drawer-link nav__drawer-link--category">Collaboration</a></li>
                <li><a href="https://www.twilio.com/use-cases/commerce-communications" class="nav__drawer-link nav__drawer-link--category">Commerce Communications</a></li>
                <li><a href="https://www.twilio.com/use-cases/contact-center" class="nav__drawer-link nav__drawer-link--category">Contact Center</a></li>
              </ul>
              <hr>
            </div>
            <div>
              <div class="nav__drawer-column">
                <ul>
                  <li><a href="https://customers.twilio.com/" class="nav__drawer-link nav__drawer-link--small">Customer Stories</a></li>
                  <li><a href="https://www.twilio.com/showcase" class="nav__drawer-link nav__drawer-link--small">Partner Showcase</a></li>
                  <li><a href="https://www.twilio.com/what-is-cloud-communications?" class="nav__drawer-link nav__drawer-link--small">Why Twilio?</a></li>
                  <li><a href="https://www.twilio.com/support-plans" class="nav__drawer-link nav__drawer-link--small">Support Plans</a></li>
                  <li><a href="http://status.twilio.com/" class="nav__drawer-link nav__drawer-link--small">Status</a></li>
                </ul>
              </div>
              <div class="nav__drawer-column">
                <ul>
                  <li><a href="https://www.twilio.com/docs" class="nav__drawer-link nav__drawer-link--small">API &amp; Docs</a></li>
                  <li><a href="https://www.twilio.com/blog" class="nav__drawer-link nav__drawer-link--small">Blog</a></li>
                  <li><a href="https://www.twilio.com/help" class="nav__drawer-link nav__drawer-link--small">Help</a></li>
                  <li><a href="https://www.twilio.com/company/jobs" class="nav__drawer-link nav__drawer-link--small">Jobs at Twilio</a></li>
                </ul>
              </div>
            </div>
            <div class="nav__sales"><a href="https://www.twilio.com/help/sales" class="nav__sales-button">Talk to Sales</a></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div role="nav" class="nav nav--subnav nav--inverted nav--transparent " data-subnav-length="40">
  <div role="nav__menu" class="nav__header">
    <div class="nav__title"><a href="https://www.twilio.com/" class="nav__logo">Twilio</a></div>
    <nav class="nav__menu">
      <ul class="nav__menu-items">
        <li class="nav__menu-item"></li>
        
        <li class="nav__menu-item">
          <a href="https://www.twilio.com/login" class="nav__menu-link">
            <svg xmlns="http://www.w3.org/2000/svg" width="10.2" height="13.5" viewBox="0 0 10.2 13.5">
              <circle fill="none" stroke="#F22F46" stroke-miterlimit="10" cx="5.1" cy="3" r="2.5"></circle>
              <path fill="none" stroke="#F22F46" stroke-miterlimit="10" d="M.5 13.5c0-2.5 2.1-4.6 4.6-4.6s4.6 2.1 4.6 4.6"></path>
            </svg>
            Log In
          </a>
        </li>
        <li class="nav__menu-item">
          <a href="https://www.twilio.com/try-twilio" class="nav__menu-link">
            <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 13 13">
              <path d="M0 6.5h13M6.5 0v13" fill="none" stroke="#F22F46" stroke-miterlimit="10"></path>
            </svg>
            Sign Up
          </a>
        </li>
        
        <li class="nav__menu-item"><a href="#menu" role="nav__activate" class="nav__menu-link nav__menu-activate"><span></span>Menu &amp; Products</a></li>
      </ul>
    </nav>
    <nav role="subnav" class="nav__subnav">
      <header class="nav__subnav-header">
        <a href="https://www.twilio.com/docs" class="nav__subnav-header-link">Docs</a>
        
          <a href="https://www.twilio.com/docs/api" role="subnav__dropdown" 
            class="nav__subnav-link nav__subnav-current">API Reference</a>
        
      </header>
      <ul role="subnav__items" class="nav__subnav-items">
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/quickstart" class="nav__subnav-link">Quickstart</a>
        </li>
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/guides" class="nav__subnav-link">Guides</a>
        </li>
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/tutorials" class="nav__subnav-link">Tutorials</a>
        </li>
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/api" class="nav__subnav-link">API Reference</a>
        </li>
        <li role="subnav__item" class="nav__subnav-item ">
          <a href="https://www.twilio.com/docs/libraries" class="nav__subnav-link">SDKs</a>
        </li>
      </ul>
    </nav>
  </div>
</div>



    
    
      

<div class="docs__pagenav">
  <div class="uk-container uk-container-center">
    <div class="uk-grid">
      <div class="uk-width-3-4 uk-hidden-small">
      
      
        <div class="breadcrumbs">
          
            
          
            
          
            
              <a href="https://www.twilio.com/docs/api">API Reference</a> &gt;
            
          
            
              <a href="https://www.twilio.com/docs/api/authy">Authy</a> &gt;
            
          
          <span>Authy Mobile SDK - Getting Started</span>
        </div>
      
      </div>

      
      <div class="uk-width-1-1 uk-width-medium-1-4">
  <div class="search">
    <form action="https://www.twilio.com/docs/search" method="GET">
      <div class="wrapper">
        <input id="search-box" name="q" type="text" value=""/>
      </div>
      <button type="submit">
        <i class="fa fa-fw fa-search"></i>
      </button>
    </form>
  </div>
</div>

    </div>
  </div>
</div>

    

    <div class="docs-container">
      <div class="uk-container">
        
        
  <div class="coderail-container">

    <div class="sidenav-column">
      <div class="theme-switcher uk-hidden-small">
  <div class="theme-wrapper">
    <a data-theme="light" class="selected">
      <i class="fa fa-fw fa-sun-o"></i>
    </a>
    <a data-theme="dark" >
      <i class="fa fa-fw fa-moon-o"></i>
    </a>
  </div>
</div>
      
        <div class="sidenav" data-uk-sticky="{boundary: true}">
          

<ul id="doc_menu" class="sidenav__section" data-swiftype-index="false">

  <!-- Page entries -->
  
    <li id="dynamic-menu">
      <ul>
        
          
          



  <li 
    >
      <a href="https://www.twilio.com/docs/api/authy">
          Authy
      </a>
  </li>



        
          
            
<li class="menu-title expanded" role="menu-title" id="doc-navigation-parent">
  Authy Mobile SDK - Getting Started
</li>
<ul class="menu-accordion expanded" role="menu-accordion" id="doc-navigation"></ul>

          
          



  <li 
    >
      <a href="https://www.twilio.com/docs/api/authy/authy-totp">
          TOTP API
      </a>
  </li>



        
          
          



  <li 
    >
      <a href="https://www.twilio.com/docs/api/authy/authy-onetouch-api">
          OneTouch API
      </a>
  </li>



        
          
          



  <li 
    >
      <a href="https://www.twilio.com/docs/api/authy/authy-phone-verification-api">
          Phone Verification API
      </a>
  </li>



        
          
          



  <li 
    >
      <a href="https://www.twilio.com/docs/api/authy/authy-phone-intelligence-api">
          Phone Intelligence API
      </a>
  </li>



        
          
          



  <li 
    >
      <a href="https://www.twilio.com/docs/api/authy/authy-quickstarts">
          Authy API Quickstarts
      </a>
  </li>



        
          
          
<li class="menu-title" role="menu-title">

    <span class="heading">Authy Developer Best Practices</span>
</li>


<ul class="menu-accordion" role="menu-accordion">

    
        



  <li 
    >
      <a href="https://www.twilio.com/docs/api/authy/authy-developer-best-practices">
          Developer Best Practices
      </a>
  </li>



    
</ul>

        
        
      </ul>
    </li>
  
</ul>

        </div>
      
    </div>

    <div class="primary-column 
        ">
      <div class="docs-prose">
        
  
    
    <h1 class="page-title ">
      Authy Mobile SDK - Getting Started
    </h1>
    
  
  
    <div class="block-markdown ">
      
        

<div>
    <h3 id="what-is-the-authy-mobile-sdk"><a class="toclink" href="#what-is-the-authy-mobile-sdk">What is the Authy Mobile SDK</a></h3>
<p>The Authy Mobile SDK for iOS and Android provides a library, code samples and documentation for developers to build mobile applications using <a href="https://www.authy.com/product/options/#onetouch">Authy OneTouch</a></p>
<h3 id="introduction"><a class="toclink" href="#introduction">Introduction</a></h3>
<p>The following content is a beta build of the Authy Mobile SDK. Currently the SDK only supports OneTouch capabilities (TOTP SoftToken will be in a future release). To fully test drive this SDK, you will need to:</p>
<ol>
<li>
<p>Ensure you have an <a href="https://www.authy.com/signup/">Authy account with an app created and OneTouch enabled.</a></p>
</li>
<li>
<p>Select either the iOS or Android platform.</p>
<ol>
<li>
<p>For Android, you will need <a href="https://developer.android.com/studio/index.html">Android Studio 2.1+</a></p>
</li>
<li>
<p>For iOS you will need <a href="https://developer.apple.com/xcode/">Xcode 7.3+</a> installed. </p>
<ol>
<li>
<p>For Xcode 7.3 you will need OSX 10.11 or above.</p>
</li>
<li>
<p>If you don't have 10.11, you can download a previous version <a href="https://developer.apple.com/downloads/">here</a>. We recommend Xcode 7.2.1</p>
</li>
<li>
<p>If you have a device with iOS 9 and above you need Xcode 7.3 to be able to run your app</p>
</li>
</ol>
</li>
</ol>
</li>
<li>
<p>You will need to setup a backend that communicates with Authy in order to register users. You can implement your own backend but we have already created a sample backend that you can use, you can follow our instructions to set it up <a href="https://www.twilio.com/docs/api/authy/authy-mobile-sdk-back-end-and-apps#sample-backend-application">here</a></p>
</li>
<li>
<p>Follow the instructions below for the platform (iOS or Android) of your choice.</p>
</li>
</ol>
<h3 id="device-registration"><a class="toclink" href="#device-registration">Device Registration</a></h3>
<p>Here is the flow for the mobile device registration using the Authy Mobile SDK once you have completed this Getting Started project:</p>
<p><img alt="Mobile SDK Flow Diagram" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/mobile_sdk_flow_diagram_1.original.png" /></p>
<ol>
<li>Your mobile app initiates the registration process contacting your backend application.</li>
<li>Your backend application calls the Authy service and starts the device registration process. You will get a registration token to register a new device.</li>
<li>Your backend sends the registration token back to the mobile app to continue the registration process. The Authy service sends a PIN code (SMS or Voice) to the phone number being registered.</li>
<li>Your mobile app registers the device back to the Authy service using the Authy Mobile SDK with the registration token and the PIN code.</li>
<li>Your mobile app calls the sync function in the Authy Mobile SDK to synchronize the device with the Authy service.</li>
</ol>
<h3 id="approval-requests"><a class="toclink" href="#approval-requests">Approval Requests</a></h3>
<p>After the registration process is completed, your mobile application will be able to interact with Authy OneTouch approval requests. That way, when a user performs a transaction in the web application you're protecting with 2FA, the process to approve it or deny it shows up on their phone:</p>
<p><img alt="Mobile SDK Approval Request" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/mobile_sdk_flow_diagram_2.original.png" /></p>
<ol>
<li>Your backend detects the user has 2FA enabled and triggers a <code>createApprovalRequest</code> to the Authy service. The Authy service will respond with a request ID (uuid).</li>
<li>Your backend application sends a push notification to Apple Push Notification Services (APNS) or Google Cloud Messaging (GCM) to notify the user about the pending approval request with the request ID you received back from the Authy service in the previous step.</li>
<li>Your mobile application receives the push notification.</li>
<li>Your mobile application uses the Authy Mobile SDK to obtain and display the approval request details. Then the Authy Mobile SDK authenticates with the Authy service.</li>
<li>Your user takes an action on an approval request (Approve / Deny) and the mobile app uses the Authy Mobile SDK to send a digitally signed approved/denied request back to the Authy service.</li>
<li>Authy sends a OneTouch callback to your backend application and then you take the appropriate actions based on the results of the operation. Or, your service can poll the Authy OneTouch API asynchronously.</li>
</ol>
<h3 id="install-the-ios-sdk"><a class="toclink" href="#install-the-ios-sdk">Install the iOS SDK</a></h3>
<h4 id="new-project"><a class="toclink" href="#new-project">New Project</a></h4>
<ol>
<li><a href="https://www.authy.com/contact-sales/">Contact Authy sales</a> to download the Authy Mobile SDK files.</li>
<li>Open the AuthySDKSample.xcodeproj file. That will load the project into Apple’s Xcode.</li>
</ol>
<h4 id="existing-project"><a class="toclink" href="#existing-project">Existing Project</a></h4>
<ol>
<li>
<p><a href="https://www.authy.com/contact-sales/">Contact Authy sales</a> to download and extract the AuthyMobileSDKiOS.zip file inside the SDK-Debug or SDK-Release folder.
The framework inside the SDK-Debug folder includes x86_64 armv7 arm64 architectures and the one inside SDK-Release contains armv7 arm64 architectures. For testing purposes you should use the framework inside the SDK-Debug folder.</p>
</li>
<li>
<p>Go to your Xcode project, navigate to the project settings and add the AuthySDKiOS.framework to the Linked Binary with Libraries and to the Embed Frameworks sections under Build Phases like the image below:</p>
</li>
</ol>
<p><img alt="Mobile SDK Quickstart Install" src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/mobile_sdk_quickstart_install.original.png" /></p>
<h3 id="setup-authy-in-ios"><a class="toclink" href="#setup-authy-in-ios">Setup Authy in iOS</a></h3>
<p>Initialize an Authy instance. We recommend you to initialize an instance of the Authy SDK using a separate class. We are going to use a class called <code>AuthySDKManager.swift</code> for the rest of these instructions but feel free to use a different name if you want to.</p>
<p><code>AuthySDKManager.swift</code></p>
<div class="codehilite"><pre><span class="code-line"><span class="kd">import</span> <span class="nc">AuthySDKiOS</span>
</span><span class="code-line">
</span><span class="code-line"><span class="kd">class</span> <span class="nc">AuthySDKManager</span><span class="p">:</span> <span class="bp">NSObject</span> <span class="p">{</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="kd">private</span> <span class="kd">var</span> <span class="nv">Authy</span><span class="p">:</span> <span class="n">Authy</span><span class="p">?</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="kr">override</span> <span class="kd">init</span><span class="p">()</span> <span class="p">{</span>
</span><span class="code-line">        <span class="kc">super</span><span class="p">.</span><span class="kd">init</span><span class="p">()</span>
</span><span class="code-line">        <span class="kc">self</span><span class="p">.</span><span class="n">authy</span> <span class="p">=</span> <span class="n">Authy</span><span class="p">.</span><span class="n">sharedAuthy</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="kd">var</span> <span class="nv">setupError</span><span class="p">:</span> <span class="n">AUTError</span><span class="p">?</span> <span class="p">=</span> <span class="kc">nil</span>
</span><span class="code-line">        <span class="kc">self</span><span class="p">.</span><span class="n">authy</span><span class="p">?.</span><span class="n">setup</span><span class="p">(&amp;</span><span class="n">setupError</span><span class="p">)</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="k">if</span> <span class="n">setupError</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span><span class="code-line">            <span class="bp">print</span><span class="p">(</span><span class="s">&quot;Error </span><span class="si">\(</span><span class="n">setupError</span><span class="p">!.</span><span class="n">message</span><span class="si">())</span><span class="s">&quot;</span><span class="p">)</span>
</span><span class="code-line">        <span class="p">}</span>
</span><span class="code-line">    <span class="p">}</span>
</span><span class="code-line"><span class="p">}</span>
</span></pre></div>

<p>You can configure the environment for you app (STG or PROD). By default the environment is set to PROD</p>
<p><code>AuthySDKManager.swift</code></p>
<div class="codehilite"><pre><span class="code-line"><span class="kd">var</span> <span class="nv">error</span><span class="p">:</span> <span class="n">AUTError</span><span class="p">?</span> <span class="p">=</span> <span class="kc">nil</span>
</span><span class="code-line"><span class="kc">self</span><span class="p">.</span><span class="n">authy</span><span class="p">?.</span><span class="n">setEnvironment</span><span class="p">(.</span><span class="n">STG</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="p">&amp;</span><span class="n">error</span><span class="p">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="k">if</span> <span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span><span class="code-line">    <span class="bp">print</span><span class="p">(</span><span class="s">&quot;Error </span><span class="si">\(</span><span class="n">error</span><span class="p">!.</span><span class="n">message</span><span class="si">())</span><span class="s">&quot;</span><span class="p">)</span>
</span><span class="code-line"><span class="p">}</span>
</span></pre></div>

<p>To register the device with the Authy service, call <code>registerDevice</code>, this method should only be called when the user launches the application for the first time.</p>
<p>You need to obtain a registration token before calling the <code>registerDevice</code> method, this is where your backend needs to interact with the Authy backend to register users.</p>
<p><code>AuthySDKManager.swift</code></p>
<div class="codehilite"><pre><span class="code-line"><span class="kc">self</span><span class="p">.</span><span class="n">authy</span><span class="p">?.</span><span class="n">registerDevice</span><span class="p">(</span><span class="n">withRegistrationToken</span><span class="p">:</span> <span class="n">registrationToken</span><span class="p">,</span> <span class="n">andUniqueDeviceId</span><span class="p">:</span> <span class="n">uniqueDeviceId</span><span class="p">,</span> <span class="n">handler</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="n">error</span><span class="p">:</span> <span class="n">AUTError</span><span class="p">?)</span> <span class="p">-&gt;</span> <span class="nb">Void</span> <span class="k">in</span>
</span><span class="code-line">    <span class="c1">// ...</span>
</span><span class="code-line"><span class="p">})</span>
</span></pre></div>

<p>To make sure the current device is registered call <code>isDeviceRegistered</code>.</p>
<p><code>AuthySDKManager.swift</code></p>
<div class="codehilite"><pre><span class="code-line"><span class="kd">var</span> <span class="nv">currentError</span><span class="p">:</span> <span class="n">AUTError</span><span class="p">?</span> <span class="p">=</span> <span class="kc">nil</span>
</span><span class="code-line"><span class="kd">let</span> <span class="nv">isDeviceRegistered</span> <span class="p">=</span> <span class="kc">self</span><span class="p">.</span><span class="n">authy</span><span class="p">?.</span><span class="n">isDeviceRegistered</span><span class="p">(&amp;</span><span class="n">currentError</span><span class="p">)</span>
</span><span class="code-line"><span class="k">if</span>  <span class="n">currentError</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span><span class="code-line">    <span class="bp">print</span><span class="p">(</span><span class="s">&quot;Error </span><span class="si">\(</span><span class="n">currentError</span><span class="p">!.</span><span class="n">message</span><span class="si">())</span><span class="s">&quot;</span><span class="p">)</span>
</span><span class="code-line"><span class="p">}</span>
</span></pre></div>

<p>After registering your device, make sure you call the <code>sync</code> method to sync the device every time the app is run.
The <code>sync</code> method will synchronize your device with Authy and enable OneTouch capabilities if needed.</p>
<p><code>AuthySDKManager.swift</code></p>
<div class="codehilite"><pre><span class="code-line"><span class="kc">self</span><span class="p">.</span><span class="n">authy</span><span class="p">?.</span><span class="n">sync</span><span class="p">({</span> <span class="p">(</span><span class="n">error</span><span class="p">:</span> <span class="n">AUTError</span><span class="p">?)</span> <span class="p">-&gt;</span> <span class="nb">Void</span> <span class="k">in</span>
</span><span class="code-line">    <span class="c1">// ...</span>
</span><span class="code-line"><span class="p">})</span>
</span></pre></div>

<p>At this point your app is ready to get a list of approval requests from the Authy backend.</p>
<p>To create a new approval request, you can follow the instructions <a href="http://docs.authy.com/onetouch.html#create-approvalrequest">here</a> or use the pre-built Authy API scripts available <a href="https://github.com/AuthySE/Authy-API-Samples">here</a>.</p>
<p>Call <code>getApprovalRequests</code> to get the list of approval requests:</p>
<p><code>AuthySDKManager.swift</code></p>
<div class="codehilite"><pre><span class="code-line"><span class="kd">var</span> <span class="nv">statusOptions</span><span class="p">:</span> <span class="p">[</span><span class="n">AUTApprovalRequestStatusOption</span><span class="p">]</span> <span class="p">=</span> <span class="p">[]</span>
</span><span class="code-line"><span class="kd">let</span> <span class="nv">pendingRequests</span><span class="p">:</span> <span class="n">AUTApprovalRequestStatusOption</span> <span class="p">=</span> <span class="n">AUTApprovalRequestStatusOption</span><span class="p">(</span><span class="n">status</span><span class="p">:</span> <span class="p">.</span><span class="n">Pending</span><span class="p">)</span>
</span><span class="code-line"><span class="n">statusOptions</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">pendingRequests</span><span class="p">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="kc">self</span><span class="p">.</span><span class="n">authy</span><span class="p">?.</span><span class="n">getApprovalRequests</span><span class="p">(</span><span class="n">withOptions</span><span class="p">:</span> <span class="n">statusOptions</span><span class="p">,</span> <span class="n">completion</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="n">approvalRequests</span><span class="p">:</span> <span class="p">[</span><span class="n">AUTApprovalRequest</span><span class="p">]?,</span> <span class="n">error</span><span class="p">:</span> <span class="n">AUTError</span><span class="p">?)</span> <span class="p">-&gt;</span> <span class="nb">Void</span> <span class="k">in</span>
</span><span class="code-line">    <span class="c1">// ...</span>
</span><span class="code-line"><span class="p">})</span>
</span></pre></div>

<p>Once the user has approved or denied the request you will call <code>approveRequest</code> or <code>denyRequest</code>.</p>
<p>If you configured a callback url in the <a href="https://dashboard.authy.com/">Dasboard</a> to receive notifications when a user approves/denies a request it will be called after this step. Otherwise you should poll the OneTouch API. For more details go <a href="http://docs.authy.com/onetouch.html">here.</a></p>
<p>Call <code>approveRequest</code> or <code>denyRequest</code> to handle approval requests.</p>
<p><code>AuthySDKManager.swift</code></p>
<div class="codehilite"><pre><span class="code-line"><span class="kc">self</span><span class="p">.</span><span class="n">authy</span><span class="p">?.</span><span class="n">approveRequest</span><span class="p">(</span><span class="n">approvalRequest</span><span class="p">,</span> <span class="n">completion</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="n">error</span><span class="p">:</span> <span class="n">AUTError</span><span class="p">?)</span> <span class="p">-&gt;</span> <span class="nb">Void</span> <span class="k">in</span>
</span><span class="code-line">    <span class="c1">// ...</span>
</span><span class="code-line"><span class="p">})</span>
</span><span class="code-line">
</span><span class="code-line"><span class="kc">self</span><span class="p">.</span><span class="n">authy</span><span class="p">?.</span><span class="n">denyRequest</span><span class="p">(</span><span class="n">approvalRequest</span><span class="p">,</span> <span class="n">completion</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="n">error</span><span class="p">:</span> <span class="n">AUTError</span><span class="p">?)</span> <span class="p">-&gt;</span> <span class="nb">Void</span> <span class="k">in</span>
</span><span class="code-line">    <span class="c1">// ...</span>
</span><span class="code-line"><span class="p">})</span>
</span></pre></div>

<h3 id="install-the-android-sdk"><a class="toclink" href="#install-the-android-sdk">Install the Android SDK</a></h3>
<h4 id="new-project_1"><a class="toclink" href="#new-project_1">New Project</a></h4>
<ol>
<li><a href="https://www.authy.com/contact-sales/">Contact Authy sales</a> to download the Authy mobile SDK files.</li>
<li>Open Android Studio and load the sample project.</li>
<li>Navigate to the <code>authy-sdk-android</code> folder and open the <code>build.gradle</code> file.</li>
</ol>
<h3 id="existing-project_1"><a class="toclink" href="#existing-project_1">Existing Project</a></h3>
<ol>
<li><a href="https://www.authy.com/contact-sales/">Contact Authy sales</a> to download and extract the <code>AuthyMobileSDKAndroid.zip</code> file.</li>
<li>Go to your Android Studio project and import the <code>com.twilio.authy-sdk-android.aar</code> file. (File -&gt; New -&gt; New Module -&gt; Import .JAR/.AAR package)</li>
</ol>
<h3 id="set-up-authy-in-android"><a class="toclink" href="#set-up-authy-in-android">Set up Authy in Android</a></h3>
<p>Initialize an Authy instance. We recommend you to initialize an instance of the Authy SDK inside your custom <code>Application</code> class or in your launch screen activity.
We are going to use a class called <code>App.java</code> for the rest of these instructions but feel free to use a different name if you want to.</p>
<p><code>App.java</code></p>
<div class="codehilite"><pre><span class="code-line"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">App</span> <span class="kd">extends</span> <span class="n">Application</span> <span class="o">{</span>
</span><span class="code-line">    <span class="kd">private</span> <span class="n">Authy</span> <span class="n">authy</span><span class="o">;</span>
</span><span class="code-line">    <span class="nd">@Override</span>
</span><span class="code-line">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(){</span>
</span><span class="code-line">        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">();</span>
</span><span class="code-line">        <span class="n">authy</span> <span class="o">=</span> <span class="n">Authy</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
</span><span class="code-line">        <span class="n">authy</span><span class="o">.</span><span class="na">setup</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</span><span class="code-line">    <span class="o">}</span>
</span><span class="code-line">    <span class="kd">public</span> <span class="n">Authy</span> <span class="nf">getAuthy</span><span class="o">(){</span>
</span><span class="code-line">        <span class="k">return</span> <span class="n">authy</span><span class="o">;</span>
</span><span class="code-line">    <span class="o">}</span>
</span><span class="code-line"><span class="o">}</span>
</span></pre></div>

<p>You can configure the environment for your app (STG or PROD). By default, the environment is set to PROD.</p>
<p><code>App.java</code></p>
<div class="codehilite"><pre><span class="code-line"><span class="n">authy</span><span class="o">.</span><span class="na">setEnvironment</span><span class="o">(</span><span class="n">Environment</span><span class="o">.</span><span class="na">STG</span><span class="o">);</span>
</span></pre></div>

<p>To register the device with the Authy service, call <code>registerDevice</code>, this method should only be called when the user launches the application for the first time.</p>
<p>You need to obtain a registration token before calling the <code>registerDevice</code> method, this is where your backend needs to interact with the Authy backend to register users. Go <a href="https://www.twilio.com/docs/api/authy/authy-mobile-sdk-back-end-and-apps#sample-backend-application-instructions">here</a> to see how to get your registration token.</p>
<p>The <code>Enable2FAActivity.java</code> class in the Sample App interacts with your backend application (see sample back end, next page) to register the user and calls the <code>registerDevice</code> method:</p>
<p><code>Enable2FAActivity.java</code></p>
<div class="codehilite"><pre><span class="code-line"><span class="c1">// You should obtain the registration token from your backend or our sample backend</span>
</span><span class="code-line"><span class="nd">@Override</span>
</span><span class="code-line"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">onRegistrationVerificationSuccess</span><span class="o">(</span><span class="n">String</span> <span class="n">registrationToken</span><span class="o">)</span> <span class="o">{</span>
</span><span class="code-line">    <span class="c1">// Now register the device</span>
</span><span class="code-line">    <span class="n">authy</span><span class="o">.</span><span class="na">registerDevice</span><span class="o">(</span><span class="n">registrationToken</span><span class="o">,</span> <span class="n">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">(),</span>
</span><span class="code-line">        <span class="k">new</span> <span class="n">ListenerHelper</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">,</span> <span class="n">DeviceRegistrationListener</span><span class="o">&gt;(</span><span class="n">deviceRegistrationListener</span><span class="o">));</span>
</span><span class="code-line"><span class="o">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="c1">// Listener to capture the result from registration</span>
</span><span class="code-line"><span class="kd">private</span> <span class="n">DeviceRegistrationListener</span> <span class="n">deviceRegistrationListener</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DeviceRegistrationListener</span><span class="o">()</span> <span class="o">{</span>
</span><span class="code-line">    <span class="nd">@Override</span>
</span><span class="code-line">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="n">Void</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
</span><span class="code-line">        <span class="c1">// Now sync the device</span>
</span><span class="code-line">        <span class="n">authy</span><span class="o">.</span><span class="na">sync</span><span class="o">(</span><span class="k">new</span> <span class="n">ListenerHelper</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">,</span> <span class="n">SyncListener</span><span class="o">&gt;(</span><span class="n">syncListener</span><span class="o">));</span>
</span><span class="code-line">    <span class="o">}</span>
</span><span class="code-line">    <span class="nd">@Override</span>
</span><span class="code-line">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onError</span><span class="o">(</span><span class="n">Exception</span> <span class="n">exception</span><span class="o">)</span> <span class="o">{</span>
</span><span class="code-line">        <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">Enable2FAActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">registration_error_device</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
</span><span class="code-line">        <span class="n">state</span> <span class="o">=</span> <span class="n">RegistrationState</span><span class="o">.</span><span class="na">VERIFY</span><span class="o">;</span>
</span><span class="code-line">        <span class="n">updateView</span><span class="o">();</span>
</span><span class="code-line">    <span class="o">}</span>
</span><span class="code-line"><span class="o">};</span>
</span></pre></div>

<p>To make sure the current device is registered call <code>isDeviceRegistered</code>. It is useful to check the registration status
before starting the registration process.
In the sample app this is done on the <code>RegistrationActivity.java</code> class when the user launches the app:</p>
<p><code>RegistrationActivity.java</code></p>
<div class="codehilite"><pre><span class="code-line"><span class="n">authy</span> <span class="o">=</span> <span class="o">((</span><span class="n">App</span><span class="o">)</span> <span class="n">getApplicationContext</span><span class="o">()).</span><span class="na">getAuthy</span><span class="o">();</span>
</span><span class="code-line"><span class="k">if</span> <span class="o">(</span><span class="n">authy</span><span class="o">.</span><span class="na">isDeviceRegistered</span><span class="o">())</span> <span class="o">{</span>
</span><span class="code-line">    <span class="n">startSync</span><span class="o">();</span>
</span><span class="code-line"><span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span><span class="code-line">    <span class="n">startRegistrationProcess</span><span class="o">();</span>
</span><span class="code-line"><span class="o">}</span>
</span></pre></div>

<p>After registering your device, make sure you sync the device every time the Authy mobile app is started.
The <code>sync</code> method will synchronize your device with Authy and enable OneTouch capabilities if needed.</p>
<p><code>RegistrationActivity.java</code></p>
<div class="codehilite"><pre><span class="code-line"><span class="kd">private</span> <span class="kt">void</span> <span class="nf">startSync</span><span class="o">()</span> <span class="o">{</span>
</span><span class="code-line">    <span class="n">displayProgressBar</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span><span class="code-line">    <span class="n">authy</span><span class="o">.</span><span class="na">sync</span><span class="o">(</span><span class="k">new</span> <span class="n">ListenerHelper</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">,</span> <span class="n">SyncListener</span><span class="o">&gt;(</span><span class="k">this</span><span class="o">));</span>
</span><span class="code-line"><span class="o">}</span>
</span><span class="code-line"><span class="nd">@Override</span>
</span><span class="code-line"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="n">Void</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
</span><span class="code-line">    <span class="n">Intent</span> <span class="n">approvalRequestsIntent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">RegistrationActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">ApprovalRequestsListActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span><span class="code-line">    <span class="n">startActivity</span><span class="o">(</span><span class="n">approvalRequestsIntent</span><span class="o">);</span>
</span><span class="code-line">    <span class="n">finish</span><span class="o">();</span>
</span><span class="code-line"><span class="o">}</span>
</span><span class="code-line"><span class="nd">@Override</span>
</span><span class="code-line"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">onError</span><span class="o">(</span><span class="n">Exception</span> <span class="n">error</span><span class="o">)</span> <span class="o">{</span>
</span><span class="code-line">    <span class="k">if</span> <span class="o">(</span><span class="n">error</span> <span class="k">instanceof</span> <span class="n">AuthyException</span><span class="o">)</span> <span class="o">{</span>
</span><span class="code-line">        <span class="n">AuthyException</span> <span class="n">exception</span> <span class="o">=</span> <span class="o">(</span><span class="n">AuthyException</span><span class="o">)</span> <span class="n">error</span><span class="o">;</span>
</span><span class="code-line">        <span class="kt">int</span> <span class="n">exceptionCode</span> <span class="o">=</span> <span class="n">exception</span><span class="o">.</span><span class="na">getCode</span><span class="o">();</span>
</span><span class="code-line">        <span class="k">switch</span> <span class="o">(</span><span class="n">exceptionCode</span><span class="o">)</span> <span class="o">{</span>
</span><span class="code-line">            <span class="k">case</span> <span class="n">AuthyException</span><span class="o">.</span><span class="na">NO_CONNECTION</span><span class="o">:</span>
</span><span class="code-line">                <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">RegistrationActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">error_no_connection</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
</span><span class="code-line">                <span class="k">break</span><span class="o">;</span>
</span><span class="code-line">            <span class="k">case</span> <span class="n">AuthyException</span><span class="o">.</span><span class="na">DEVICE_SYNC_ERROR</span><span class="o">:</span>
</span><span class="code-line">                <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">RegistrationActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">registration_error_sync</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
</span><span class="code-line">                <span class="k">break</span><span class="o">;</span>
</span><span class="code-line">        <span class="o">}</span>
</span><span class="code-line">    <span class="o">}</span>
</span><span class="code-line">    <span class="n">finish</span><span class="o">();</span>
</span><span class="code-line"><span class="o">}</span>
</span></pre></div>

<p>At this point your app is ready to get a list of approval requests from the Authy backend.</p>
<p>To create a new approval request, you can follow the instructions <a href="http://docs.authy.com/onetouch.html#create-approvalrequest">here</a> or use the pre-built Authy API scripts available on Github <a href="https://github.com/AuthySE/Authy-API-Samples">here</a>.</p>
<p>Call <code>getApprovalRequests</code> to get the list of approval requests as in the <code>ApprovalRequestsListActivity.java</code> of the sample app:</p>
<p><code>ApprovalRequestsListActivity.java</code></p>
<div class="codehilite"><pre><span class="code-line"><span class="kd">private</span> <span class="kt">void</span> <span class="nf">fetchApprovalRequests</span><span class="o">()</span> <span class="o">{</span>
</span><span class="code-line">    <span class="n">ApprovalRequestStatusOption</span> <span class="n">statusPending</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ApprovalRequestStatusOption</span><span class="o">.</span><span class="na">Builder</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>
</span><span class="code-line">    <span class="n">statusPending</span><span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="n">ApprovalRequest</span><span class="o">.</span><span class="na">Status</span><span class="o">.</span><span class="na">pending</span><span class="o">);</span>
</span><span class="code-line">    <span class="n">List</span><span class="o">&lt;</span><span class="n">ApprovalRequestStatusOption</span><span class="o">&gt;</span> <span class="n">statusOptions</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
</span><span class="code-line">    <span class="n">statusOptions</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">statusPending</span><span class="o">);</span>
</span><span class="code-line">    <span class="n">authy</span><span class="o">.</span><span class="na">getApprovalRequests</span><span class="o">(</span><span class="n">statusOptions</span><span class="o">,</span> <span class="k">new</span> <span class="n">ListenerHelper</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">ApprovalRequest</span><span class="o">&gt;,</span> <span class="n">GetApprovalRequestsListener</span><span class="o">&gt;(</span><span class="k">this</span><span class="o">));</span>
</span><span class="code-line"><span class="o">}</span>
</span><span class="code-line"><span class="nd">@Override</span>
</span><span class="code-line"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">ApprovalRequest</span><span class="o">&gt;</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
</span><span class="code-line">    <span class="n">approvalRequests</span> <span class="o">=</span> <span class="n">result</span><span class="o">;</span>
</span><span class="code-line">    <span class="n">sectionsPagerAdapter</span><span class="o">.</span><span class="na">notifyDataSetChanged</span><span class="o">();</span>
</span><span class="code-line">    <span class="n">bus</span><span class="o">.</span><span class="na">post</span><span class="o">(</span><span class="k">new</span> <span class="n">ApprovalRequestsUpdatedEvent</span><span class="o">(</span><span class="kc">true</span><span class="o">));</span>
</span><span class="code-line"><span class="o">}</span>
</span><span class="code-line"><span class="nd">@Override</span>
</span><span class="code-line"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">onError</span><span class="o">(</span><span class="n">Exception</span> <span class="n">exception</span><span class="o">)</span> <span class="o">{</span>
</span><span class="code-line">    <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">ApprovalRequestsListActivity</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">(),</span> <span class="s">&quot;Error while getting approval requests for device&quot;</span><span class="o">,</span> <span class="n">exception</span><span class="o">);</span>
</span><span class="code-line">    <span class="n">toastHelper</span><span class="o">.</span><span class="na">show</span><span class="o">(</span><span class="n">ApprovalRequestsListActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">approval_request_fetch_error</span><span class="o">);</span>
</span><span class="code-line">    <span class="n">bus</span><span class="o">.</span><span class="na">post</span><span class="o">(</span><span class="k">new</span> <span class="n">ApprovalRequestsUpdatedEvent</span><span class="o">(</span><span class="kc">true</span><span class="o">));</span>
</span><span class="code-line"><span class="o">}</span>
</span></pre></div>

<p>Once the user has approved or denied the request you will call <code>approve</code> or <code>deny</code>.</p>
<p>If you configured a callback url in the <a href="https://dashboard.authy.com/">Dasboard</a> to receive notifications when a user approves/denies a request it will be called after this step. Otherwise you should poll the OneTouch API. For more details go <a href="http://docs.authy.com/onetouch.html">
here.</a></p>
<p>The <code>ApprovalRequestDetailActivity.java</code> class in the Sample App shows the details of an approval request and lets the user approve or deny:</p>
<p><code>ApprovalRequestDetailActivity.java</code></p>
<div class="codehilite"><pre><span class="code-line"><span class="kd">private</span> <span class="kt">void</span> <span class="nf">approve</span><span class="o">()</span> <span class="o">{</span>
</span><span class="code-line">    <span class="n">authy</span><span class="o">.</span><span class="na">approve</span><span class="o">(</span><span class="n">approvalRequest</span><span class="o">,</span> <span class="k">new</span> <span class="n">ListenerHelper</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">,</span> <span class="n">ApprovalRequestUpdatedListener</span><span class="o">&gt;(</span><span class="n">approvalRequestApprovedListener</span><span class="o">));</span>
</span><span class="code-line"><span class="o">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="c1">// Listener to capture the result from approve</span>
</span><span class="code-line"><span class="kd">private</span> <span class="n">ApprovalRequestUpdatedListener</span> <span class="n">approvalRequestApprovedListener</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ApprovalRequestUpdatedListener</span><span class="o">()</span> <span class="o">{</span>
</span><span class="code-line">    <span class="nd">@Override</span>
</span><span class="code-line">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="n">Void</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
</span><span class="code-line">        <span class="n">toastHelper</span><span class="o">.</span><span class="na">show</span><span class="o">(</span><span class="n">ApprovalRequestDetailActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">approve_success</span><span class="o">);</span>
</span><span class="code-line">        <span class="n">finish</span><span class="o">();</span>
</span><span class="code-line">    <span class="o">}</span>
</span><span class="code-line">    <span class="nd">@Override</span>
</span><span class="code-line">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onError</span><span class="o">(</span><span class="n">Exception</span> <span class="n">exception</span><span class="o">)</span> <span class="o">{</span>
</span><span class="code-line">        <span class="n">toastHelper</span><span class="o">.</span><span class="na">show</span><span class="o">(</span><span class="n">ApprovalRequestDetailActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">approve_failed</span><span class="o">);</span>
</span><span class="code-line">        <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">ApprovalRequestDetailActivity</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">(),</span> <span class="s">&quot;Exception while denying request&quot;</span><span class="o">,</span> <span class="n">exception</span><span class="o">);</span>
</span><span class="code-line">    <span class="o">}</span>
</span><span class="code-line"><span class="o">};</span>
</span><span class="code-line"><span class="kd">private</span> <span class="kt">void</span> <span class="nf">deny</span><span class="o">()</span> <span class="o">{</span>
</span><span class="code-line">    <span class="n">authy</span><span class="o">.</span><span class="na">deny</span><span class="o">(</span><span class="n">approvalRequest</span><span class="o">,</span> <span class="k">new</span> <span class="n">ListenerHelper</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">,</span> <span class="n">ApprovalRequestUpdatedListener</span><span class="o">&gt;(</span><span class="n">approvalRequestDeniedListener</span><span class="o">));</span>
</span><span class="code-line"><span class="o">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="c1">// Listener to capture the result from deny</span>
</span><span class="code-line"><span class="kd">private</span> <span class="n">ApprovalRequestUpdatedListener</span> <span class="n">approvalRequestDeniedListener</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ApprovalRequestUpdatedListener</span><span class="o">()</span> <span class="o">{</span>
</span><span class="code-line">    <span class="nd">@Override</span>
</span><span class="code-line">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="n">Void</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
</span><span class="code-line">        <span class="n">toastHelper</span><span class="o">.</span><span class="na">show</span><span class="o">(</span><span class="n">ApprovalRequestDetailActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">deny_success</span><span class="o">);</span>
</span><span class="code-line">        <span class="n">finish</span><span class="o">();</span>
</span><span class="code-line">    <span class="o">}</span>
</span><span class="code-line">    <span class="nd">@Override</span>
</span><span class="code-line">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onError</span><span class="o">(</span><span class="n">Exception</span> <span class="n">exception</span><span class="o">)</span> <span class="o">{</span>
</span><span class="code-line">        <span class="n">toastHelper</span><span class="o">.</span><span class="na">show</span><span class="o">(</span><span class="n">ApprovalRequestDetailActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">deny_failed</span><span class="o">);</span>
</span><span class="code-line">        <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">ApprovalRequestDetailActivity</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">(),</span> <span class="s">&quot;Exception while denying request&quot;</span><span class="o">,</span> <span class="n">exception</span><span class="o">);</span>
</span><span class="code-line">    <span class="o">}</span>
</span><span class="code-line"><span class="o">};</span>
</span></pre></div>

<h3 id="whats-next"><a class="toclink" href="#whats-next">What's next</a></h3>
<p><a href="https://www.twilio.com/docs/api/authy/authy-mobile-sdk-back-end-and-apps">Set Up Sample Backend Application</a></p>
</div>

      
    </div>
  

    

        
          
<div id="disqus_thread"></div>


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

// Unique identifiers
PAGE_URL = "https://www.twilio.com/docs/api/authy/authy-mobile-sdk-getting-started";

var disqus_config = function () {
  this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'http://twiliodocumentation.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


        
      </div>
    </div>

    <div class="code-column">
      
  <div id="coderail" class="code-rail" data-uk-sticky="{boundary: true}">

  <div class="rail-placeholder"></div>

  <div class="rail-header uk-hidden">

    <div class="rail-header-wrapper">

      <div class="rail-navigation">
        <div class="inner">
          <a href="#previous" class="inactive" data-previous>
            <i class="fa fa-fw fa-arrow-left left"></i>
          </a>
        </div>
        <div class="inner">
          <span>
            <span class="current-index">1</span>
            <span>/</span>
            <span class="snippet-total">1</span>
          </span>
        </div>
        <div class="inner">
          <a href="#next" data-next>
            <i class="fa fa-fw fa-arrow-right"></i>
          </a>
        </div>
      </div>

      <div class="rail-title">
        <div class="title-content inner">
          <span>Loading Code Samples...</span>
          <i class="fa fa-fw fa-chevron-down"></i>
        </div>
      </div>

    </div>

  </div>

  <div class="rail-toolbar uk-hidden">

    <div class="rail-current-language">
      <div class="inner">
        <span>Language</span>
        <i class="fa fa-fw fa-chevron-down"></i>
      </div>
    </div>

    <div class="toolbar">
      <a href="#code" class="uk-hidden tab" data-code>Code</a>
      <a href="#output" class="uk-hidden inactive" data-output>Output</a>

      <span class="separator"></span>

      <a id="download" class="uk-hidden">
        <i class="fa fa-fw fa-download"></i>
        <span>Download Project</span>
      </a>

      <a id="github" class="uk-hidden" target="_blank">
        <i class="fa fa-fw fa-github-square"></i>
        <span>View on GitHub</span>
      </a>

      <a id="defrosty" class="fr-on" href="#defrosty">
        <i class="fa fa-fw fa-eye"></i>
        <span class="wider-tooltip">Toggle Highlighted Lines</span>
      </a>

      <a id="clippy" href="#copy">
        <i class="fa fa-fw fa-copy"></i>
        <span>Copy to Clipboard</span>
      </a>

      <a id="linkcode" href="#linkcode">
        <i class="fa fa-fw fa-link"></i>
        <span>Link to this Code</span>
      </a>

      <a href="#expand" data-expand>
        <i class="fa fa-fw fa-arrows-alt"></i>
        <span>Full Screen</span>
      </a>
      <a href="#collapse" class="uk-hidden" data-collapse>
        <i class="fa fa-fw fa-compress"></i>
        <span>Normal Size</span>
      </a>
    </div>
  </div>

  <div class="rail-samples">
    <ul>
      
    </ul>
  </div>

  <div class="rail-languages"></div>

  <div class="rail-content">
    <div class="rail-content-inner">
      
    </div>
  </div>
</div>


    </div>

  </div>

      </div>
    </div>

    
    


<div class="footer" data-swiftype-index="false">
  <div class="uk-container uk-container-center">
    <div class="footer__statement">We can’t wait to see what you build.</div>
    <div class="uk-grid">
      <div class="uk-width-1-1 uk-width-small-1-3 uk-width-medium-1-5">
        <section class="footer__section">
          <header class="footer__header">Products</header>
          <ul class="footer__list">
            <li class="footer__list-item">
              <a href="https://www.twilio.com/voice-video" class="footer__link">Voice &amp; Video</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/messaging" class="footer__link">Messaging</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/authy" class="footer__link">Authentication</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/wireless" class="footer__link">Connected Devices</a>
            </li>
          </ul>
        </section>
      </div>
      <div class="uk-width-1-1 uk-width-small-1-3 uk-width-medium-1-5">
        <section class="footer__section">
          <header class="footer__header">Use Cases</header>
          <ul class="footer__list">
            <li class="footer__list-item">
              <a href="https://www.twilio.com/use-cases/access-security" class="footer__link">Access Security</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/use-cases/contextual-call-center" class="footer__link">Contextual Call Center</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/use-cases/marketplace-communications" class="footer__link">Marketplace Communications</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/use-cases/mobile-messaging" class="footer__link">Mobile Messaging</a>
            </li>
          </ul>
        </section>
      </div>
      <div class="uk-width-1-1 uk-width-small-1-3 uk-width-medium-1-5">
        <section class="footer__section">
          <header class="footer__header">About</header>
          <ul class="footer__list">
            <li class="footer__list-item">
              <a href="https://www.twilio.com/what-is-cloud-communications?" class="footer__link">What is Twilio?</a>
            </li>
            <li class="footer__list-item">
              <a href="https://customers.twilio.com/" class="footer__link">Customers</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/help" class="footer__link">Get Help</a>
            </li>
            <li class="footer__list-item">
              <a href="https://www.twilio.com/help/sales" class="footer__link">Talk to Sales</a>
            </li>
          </ul>
        </section>
      </div>
      <div class="uk-width-1-1 uk-width-medium-2-5">
        <section class="footer__section">
  <header class="footer__header">Hits From The Blog</header>
  <ul class="footer__list footer__list">
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/building-an-ivr-with-no-code-by-using-taskrouter-as-a-state-machine.html" class="footer__link">Building an IVR with no code by using TaskRouter as a state machine</a>
    </li>
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/logrole-gives-you-permissions-based-granular-searching-for-twilio-logs.html" class="footer__link">Logrole Gives You Permissions Based, Granular Searching For Twilio Logs</a>
    </li>
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/build-callbacks-with-stamplay-twilio-and-unbounce.html" class="footer__link">Build Callbacks With Stamplay, Twilio and Unbounce</a>
    </li>
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/build-a-basic-call-center-in-just-a-few-minutes-with-twilio.html" class="footer__link">Build a Basic Call Center in Just a Few Minutes with Twilio</a>
    </li>
    
    <li class="footer__list-item">
      <a href="https://www.twilio.com/blog/2017/01/redact-delete-sms-messages-node-js.html" class="footer__link">Redact or Delete SMS Messages as They Arrive with Node.js</a>
    </li>
    
  </ul>

</section>
      </div>
    </div>
    <footer class="footer__footer">
      <div class="footer__logo" title="Twilio">
        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30">
          <path d="M15 0C6.7 0 0 6.7 0 15s6.7 15 15 15 15-6.7 15-15S23.3 0 15 0zm0 26C8.9 26 4 21.1 4 15S8.9 4 15 4s11 4.9 11 11-4.9 11-11 11z"/>
          <circle cx="18.7" cy="11.3" r="3.1"/>
          <circle cx="18.7" cy="18.7" r="3.1"/>
          <circle cx="11.3" cy="18.7" r="3.1"/>
          <circle cx="11.3" cy="11.3" r="3.1"/>
        </svg>
      </div>
      <ul class="legal__list">
        <li class="legal__list-item">
          <a href="https://www.twilio.com/company" class="legal__link">About Twilio</a>
        </li>
        <li class="legal__list-item">
          <a href="https://www.twilio.com/legal" class="legal__link">Legal</a>
        </li>
        <li class="legal__list-item">Copyright &copy; 2016 Twilio, Inc. 
          <br class="uk-visible-small">All Rights Reserved.
        </li>
      </ul>
    </footer>
  </div>
</div>


    
    <script src="https://www.twilio.com/docs/static/js/vendor.min.16abf41c42de.js"></script>
    

  

  <!-- Mixpanel -->
  <script type="text/javascript">(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"===e.location.protocol?"https:":"http:")+'//cdn.mxpnl.com/libs/mixpanel-2.2.min.js';f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f);b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==
  typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,
    e,d])};b.__SV=1.2}})(document,window.mixpanel||[]);
    mixpanel.init("f71c19735fa6ecc5225ff563285e1794");
    </script>
  

  
    <!-- Heap -->
    <script type="text/javascript">
    window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var n=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(n?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(a,o);for(var r=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["clearEventProperties","identify","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=r(p[c])};
    heap.load('1541905715');
    </script>
  

  
    <!-- GA -->
    <script type="text/javascript">
    try {
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-2900316-1']);
      _gaq.push(['_setSiteSpeedSampleRate', 50]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    } catch(err) {}

    var _kmq = _kmq || [];
    </script>
  

  
    <!-- Eloqua -->
    <script type="text/javascript">
    var _elqQ = _elqQ || [];
    _elqQ.push(['elqSetSiteId', '815114181']);
    _elqQ.push(['elqTrackPageView']);
    _elqQ.push(['elqUseFirstPartyCookie', 'www.twilio.com']);

    (function () {
      function async_load() {
        var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;
        s.src = 'http://img03.en25.com/i/elqCfg.min.js';
        var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);
      }
      if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
      else if (window.attachEvent) window.attachEvent('onload', async_load);
    })();
    </script>
  

  
    <!-- Transifex -->
    <script type="text/javascript">
    window.liveSettings = {
      api_key: '4c06c1c5a6b341e591d969476fe2675f'
    };
    </script>
    <script type="text/javascript" src="http://cdn.transifex.com/live.js"></script>
    <style>
    .txlive-langselector { display: none; }
    </style>
  

  



    
      <script src="https://www.twilio.com/docs/static/js/docs.min.0c5bb1abb16f.js"></script>
    

    
    



    

  </body>

<!-- Mirrored from www.twilio.com/docs/api/authy/authy-mobile-sdk-getting-started by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 22:09:54 GMT -->
</html>
