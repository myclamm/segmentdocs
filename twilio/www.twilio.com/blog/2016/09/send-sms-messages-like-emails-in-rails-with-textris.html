<!DOCTYPE html>
<html lang="en-US">

<!-- Mirrored from www.twilio.com/blog/2016/09/send-sms-messages-like-emails-in-rails-with-textris.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 22:10:06 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<script type="text/javascript">
(function() {
    var projectId = 3524915770;
    var protocol = ('https:' == document.location.protocol ?
    'https://' : 'http://');
    var scriptTag = document.createElement('script');
    scriptTag.type = 'text/javascript';
    scriptTag.async = true;
    scriptTag.src = protocol + 'cdn.optimizely.com/js/' +
    projectId + '.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(scriptTag, s);
})();
function optimizelyTimeout() {
    window.optimizely = window.optimizely|| [];
    if (!window.optimizely.data) {
    window.optimizely.push("timeout");
    }
}
setTimeout(optimizelyTimeout, 1000);
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://www.twilio.com/blog/xmlrpc.php">
<script type="text/javascript">
var _elqQ = _elqQ || [];
_elqQ.push(['elqSetSiteId', '815114181']);
_elqQ.push(['elqTrackPageView']);
_elqQ.push(['elqUseFirstPartyCookie', 'www.twilio.com']);
(function () {
  function async_load()
  {
    var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;
    s.src = 'http://img03.en25.com/i/elqCfg.min.js';
    var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);
  }
  if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
  else if (window.attachEvent) window.attachEvent('onload', async_load);
})();
</script>
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','http://connect.facebook.net/en_US/fbevents.js');

fbq('init', '467131150158811');
fbq('track', "PageView");</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=467131150158811&amp;ev=PageView&amp;noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->

<style>
@media screen and (max-width: 600px) {
  #signal-header { display: none; }
}
</style>

<link type="text/css" media="all" href="https://www.twilio.com/blog/wp-content/cache/autoptimize/css/autoptimize_7a2cc50131d932d32297f43c61de37cd.css" rel="stylesheet" /><link type="text/css" media="screen" href="https://www.twilio.com/blog/wp-content/cache/autoptimize/css/autoptimize_97ca666341cd9b69002e26c8f2ca5299.css" rel="stylesheet" /><title>Send SMS messages like emails in Rails with Textris &#8211; Twilio Cloud Communications Blog</title>

<!-- This site is optimized with the Yoast WordPress SEO plugin v1.4.13 - http://yoast.com/wordpress/seo/ -->
<link rel="canonical" href="https://www.twilio.com/blog/2016/09/send-sms-messages-like-emails-in-rails-with-textris.html" />
<!-- / Yoast WordPress SEO plugin. -->

<link rel='dns-prefetch' href='https://www.twilio.com/blog//s0.wp.com' />
<link rel='dns-prefetch' href='https://www.twilio.com/blog//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Twilio Cloud Communications Blog &raquo; Feed" href="https://www.twilio.com/blog/feed" />
<link rel="alternate" type="application/rss+xml" title="Twilio Cloud Communications Blog &raquo; Comments Feed" href="https://www.twilio.com/blog/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="Twilio Cloud Communications Blog &raquo; Send SMS messages like emails in Rails with Textris Comments Feed" href="https://www.twilio.com/blog/2016/09/send-sms-messages-like-emails-in-rails-with-textris.html/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/twilioinc.wpengine.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.2"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>










<!-- This site uses the Google Analytics by Yoast plugin v5.4.7 - Universal enabled - https://yoast.com/wordpress/plugins/google-analytics/ -->
<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','http://www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-2900316-1', 'auto');
	__gaTracker('set', 'forceSSL', true);
	 window.optimizely = window.optimizely || [];
 window.optimizely.push("activateUniversalAnalytics");
	__gaTracker('set', 'dimension4', 'Phil Nash');
	__gaTracker('set', 'dimension5', 'post');
	__gaTracker('set', 'dimension6', 'all-things-code');
	__gaTracker('set', 'dimension7', 'Messaging,rails,Ruby,SMS,textris');
	__gaTracker('set', 'dimension8', '2016-09-12T10:24:52+00:00');
	__gaTracker('send','pageview');

</script>
<!-- / Google Analytics by Yoast -->


<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.4.3","is_admin":"0","ajaxurl":"https:\/\/twilioinc.wpengine.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>

<script type='text/javascript'>
/* <![CDATA[ */
var swiftypeParams = {"engineKey":"UpGyyJZzgUMXHM65YENj"};
/* ]]> */
</script>

<link rel='https://api.w.org/' href='https://www.twilio.com/blog/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.twilio.com/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.twilio.com/blog/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://www.twilio.com/blog/?p=18743' />
<link rel="alternate" type="application/json+oembed" href="https://www.twilio.com/blog/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.twilio.com%2Fblog%2F2016%2F09%2Fsend-sms-messages-like-emails-in-rails-with-textris.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.twilio.com/blog/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.twilio.com%2Fblog%2F2016%2F09%2Fsend-sms-messages-like-emails-in-rails-with-textris.html&amp;format=xml" />
<link rel="icon" href="https://www.twilio.com/blog/wp-content/uploads/2015/09/cropped-favicon_1141-32x32.png" sizes="32x32" />
<link rel="icon" href="https://www.twilio.com/blog/wp-content/uploads/2015/09/cropped-favicon_1141-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="https://www.twilio.com/blog/wp-content/uploads/2015/09/cropped-favicon_1141-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.twilio.com/blog/wp-content/uploads/2015/09/cropped-favicon_1141-270x270.png" />
</head>

<body class="single single-post postid-18743 single-format-standard group-blog">
<!-- Google Tag Manager -->
<noscript><iframe src="https://www.twilio.com/blog//www.googletagmanager.com/ns.html?id=GTM-W4RVXH"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'http://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-W4RVXH');</script>
<!-- End Google Tag Manager -->

<div id="fb-root"></div>
<script>(function(d, s, id) {
		var js, fjs = d.getElementsByTagName(s)[0];
		if (d.getElementById(id)) return;
		js = d.createElement(s); js.id = id;
		js.src = "http://connect.facebook.net/en_US/sdk.js#xfbml=1&appId=414254592083321&version=v2.0";
		fjs.parentNode.insertBefore(js, fjs);
	}(document, 'script', 'facebook-jssdk'));
window.fbAsyncInit = function() {
  FB.Event.subscribe('edge.create', function(targetUrl) {
    __gaTracker('send', 'social', 'facebook', 'like', targetUrl);
  });
};
window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));

function trackTwitter(intent_event) {
  if (intent_event) {
    var opt_pagePath;
    if (intent_event.target && intent_event.target.nodeName == 'IFRAME') {
          opt_target = extractParamFromUri(intent_event.target.src, 'url');
    }
    __gaTracker('send', 'social', 'twitter', 'tweet', opt_pagePath);
  }
}

function extractParamFromUri(uri, paramName) {
  if (!uri) {
    return;
  }
  var regex = new RegExp('[\\?&#]' + paramName + '=([^&#]*)');
  var params = regex.exec(uri);
  if (params != null) {
    return unescape(params[1]);
  }
  return;
}

//Wrap event bindings - Wait for async js to load
twttr.ready(function (twttr) {
  //event bindings
  twttr.events.bind('tweet', trackTwitter);
});
</script>
<script type="text/javascript">
  window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var n=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(n?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(a,o);for(var r=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["clearEventProperties","identify","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=r(p[c])};
  heap.load("1541905715");
</script>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<nav class="navbar navbar-default" role="navigation">
		<div class="container">
			<!-- Brand and toggle get grouped for better mobile display -->
			<div class="navbar-header">
				<button type="button" class="navbar-toggle hidden-xs" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="https://www.twilio.com/blog/">
					<img src="https://s3.amazonaws.com/ahoy-assets.twilio.com/global/images/wordmark.svg" width="200"> <span class="logo-blog">blog</span>
				</a>
			</div>

			<div class="hidden-xs"><ul id="menu-site-navigation" class="nav navbar-nav pull-right"><li id="menu-item-12202" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12202"><a href="http://www.twilio.com/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/', 'Home');" title="Home">Home</a></li>
<li id="menu-item-12205" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12205"><a href="http://www.twilio.com/blog" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/blog', 'Blog');" title="Blog">Blog</a></li>
<li id="menu-item-12204" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12204"><a href="https://www.twilio.com/docs/howto" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://www.twilio.com/docs/howto', 'Tutorials');" title="Tutorials">Tutorials</a></li>
<li id="menu-item-12206" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12206"><a href="https://www.twilio.com/docs/api" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://www.twilio.com/docs/api', 'Docs');" title="Docs">Docs</a></li>
<li id="menu-item-12207" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12207"><a href="http://www.twilio.com/help" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/help', 'Help');" title="Help">Help</a></li>
<li id="menu-item-12208" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12208"><a href="https://www.twilio.com/login" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://www.twilio.com/login', 'Login');" title="Login">Login</a></li>
<li id="menu-item-12209" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12209"><a href="https://www.twilio.com/try-twilio" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://www.twilio.com/try-twilio', 'Signup');" title="Signup">Signup</a></li>
</ul></div>		</div>
	</nav>

	<div id="content" class="site-content container">
		<div class="row">

	<div id="primary" class="content-area col-md-9">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-18743" class="row post-18743 post type-post status-publish format-standard has-post-thumbnail hentry category-all-things-code tag-messaging tag-rails tag-ruby tag-sms tag-textris">
	<header class="entry-header col-md-12">
		<h2 class="entry-title">Send SMS messages like emails in Rails with Textris</h2>
						<div class="entry-image col-md-12">
        <img width="640" height="240" src="https://www.twilio.com/blog/wp-content/uploads/2016/09/header.png" class="img-responsive wp-post-image" alt="" srcset="https://www.twilio.com/blog/wp-content/uploads/2016/09/header.png 640w, https://www.twilio.com/blog/wp-content/uploads/2016/09/header-300x113.png 300w, https://www.twilio.com/blog/wp-content/uploads/2016/09/header-200x75.png 200w" sizes="(max-width: 640px) 100vw, 640px" />			</div>
      <div class="clear"></div>
			
		<footer class="entry-footer">
			<div class="entry-meta">
					<div class="row">
	<div class="col-md-6">
	<span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://www.twilio.com/blog/author/phil">Phil Nash</a></span></span> on <span class="posted-on"><a href="https://www.twilio.com/blog/2016/09/send-sms-messages-like-emails-in-rails-with-textris.html" rel="bookmark"><time class="entry-date published updated" datetime="2016-09-12T10:24:52+00:00">September 12, 2016</time></a></span>	</div>
	<div class="col-md-6">
		<div class="social-buttons">
			<div class="fb-like" data-href="https://www.twilio.com/blog/2016/09/send-sms-messages-like-emails-in-rails-with-textris.html" data-layout="button" data-action="like" data-show-faces="false" data-share="false"></div>
			<a href="https://twitter.com/share" class="twitter-share-button" data-via="twilio" data-count="none" data-url="https://www.twilio.com/blog/2016/09/send-sms-messages-like-emails-in-rails-with-textris.html" data-text="Send SMS messages like emails in Rails with Textris ">Tweet</a>
      <a href="https://twitter.com/twilio" class="twitter-follow-button" data-show-count="false">Follow @twilio</a>
		</div>
	</div>
	</div>
			</div><!-- .entry-meta -->
		</footer><!-- .entry-footer -->
	</header><!-- .entry-header -->

	<div class="entry-content col-md-12">
		<div class="row">
			<div class="col-md-12">
				<p>The <a href="https://www.twilio.com/docs/libraries/ruby" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/docs/libraries/ruby', 'Twilio Ruby helper library');">Twilio Ruby helper library</a> makes <a href="https://www.twilio.com/docs/api/rest/sending-messages" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/docs/api/rest/sending-messages', 'sending SMS messages with Ruby');">sending SMS messages with Ruby</a> really easy. In fact, it&#8217;s as simple as:</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff99952d453013544" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Ruby</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
require "twilio-ruby"
client = Twilio::REST::Client.new(ENV["TWILIO_ACCOUNT_SID"], ENV["TWILIO_AUTH_TOKEN"])
client.messages.create(:from =&gt; A_TWILIO_NUMBER, :to =&gt; A_PHONE_NUMBER, :body =&gt; "Howdy")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff99952d453013544-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff99952d453013544-2">2</div><div class="crayon-num" data-line="crayon-58794ff99952d453013544-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff99952d453013544-1"><span class="crayon-i">require</span><span class="crayon-h"> </span><span class="crayon-s">"twilio-ruby"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff99952d453013544-2"><span class="crayon-v">client</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">Twilio</span><span class="crayon-o">::</span><span class="crayon-i">REST</span><span class="crayon-o">::</span><span class="crayon-v">Client</span><span class="crayon-sy">.</span><span class="crayon-e">new</span><span class="crayon-sy">(</span><span class="crayon-v">ENV</span><span class="crayon-sy">[</span><span class="crayon-s">"TWILIO_ACCOUNT_SID"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ENV</span><span class="crayon-sy">[</span><span class="crayon-s">"TWILIO_AUTH_TOKEN"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-58794ff99952d453013544-3"><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-v">messages</span><span class="crayon-sy">.</span><span class="crayon-e">create</span><span class="crayon-sy">(</span><span class="crayon-o">:</span><span class="crayon-v">from</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">A_TWILIO_NUMBER</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-v">to</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">A_PHONE_NUMBER</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-v">body</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">"Howdy"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0042 seconds] -->
<p>But in the context of a web application this just isn&#8217;t very &#8220;Rails&#8221; is it? Are we mixing views and controllers? Where&#8217;s the separation of concerns? What about localisation?</p>
<p>If you&#8217;ve thought this, or even if you&#8217;re just interested in better ways to send SMS messages in your Rails application, then the <a href="https://github.com/visualitypl/textris" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/visualitypl/textris', 'Textris gem');">Textris gem</a> may be for you. It makes working with SMS messages as easy as working with emails using <a href="http://guides.rubyonrails.org/action_mailer_basics.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://guides.rubyonrails.org/action_mailer_basics.html', 'Action Mailer');">Action Mailer</a>.</p>
<p>Let&#8217;s take a look at what it can do.</p>
<h3 id="h.ozym7he43k4r">Working with Textris</h3>
<p>We&#8217;re going to take an example Rails application and replace the existing message sending code with Textris to see how it can tidy up our application. For this blog post, we&#8217;ll use a <a href="https://www.twilio.com/docs/tutorials/walkthrough/lead-alerts/ruby/rails" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/docs/tutorials/walkthrough/lead-alerts/ruby/rails', 'tutorial on sending instant lead alerts');">tutorial on sending instant lead alerts</a> as our base. The application is a landing page for real estate. When a user expresses interest in a house, the real estate agent is instantly alerted about it via SMS. This application is written using Rails 4, but Textris works just as well with the latest Rails 5 too.</p>
<p>To hack on the app along with this post, you&#8217;ll need a few things:</p>
<ul>
<li><a href="http://ruby-lang.org/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://ruby-lang.org/', 'Ruby');">Ruby</a> and <a href="http://bundler.io/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://bundler.io/', 'Bundler');">Bundler</a> installed</li>
<li>A Twilio account (<a href="https://www.twilio.com/try-twilio" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/try-twilio', 'sign up for a free Twilio account');">sign up for a free Twilio account</a> if you don&#8217;t already have one) and a Twilio number that can send SMS messages</li>
</ul>
<p>Now, <a href="https://github.com/TwilioDevEd/lead-alerts-rails" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/TwilioDevEd/lead-alerts-rails', 'clone or download the application repo from GitHub');">clone or download the application repo from GitHub</a> and <a href="https://github.com/TwilioDevEd/lead-alerts-rails/blob/master/README.md" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/TwilioDevEd/lead-alerts-rails/blob/master/README.md', 'follow the instructions in the README');">follow the instructions in the README</a> to get the app set up. Use your own mobile number as the <code>AGENT_NUMBER</code> so you will get the alerts. Once it&#8217;s setup you will see a page like this:</p>
<p><img class="aligncenter" src="https://www.twilio.com/blog/wp-content/uploads/2016/09/Ebemw-A47BuJY80pwMI6eVZLPKn3vqsoAVQ5gpofEErpKRkE4Wa1nyjMRmGWea0CCPGgC3Hp6KBmkznpiSWb-6c9dNFUDl9NTN19Gzzr1QR1_zCrkdmnai0BlcjO2qmev5Yz6Gk.png" alt="A screenshot of the application. It shows a house, a description and a form to fill in for more information." /></p>
<p>Fill in some details in the form and submit. You will receive a message alerting you about the request with all the details you entered. Pretty sweet right.</p>
<p><img class="aligncenter" src="https://www.twilio.com/blog/wp-content/uploads/2016/09/s7xSv386ZGX0_dLqzb4ZWKWT5A9wlw54IpS0kQgDbvpY4NxTW5Yesiw4gczveD1XKO1LTDkuYdLvVpSjgOY_dgRfmCA0jufC9O-gRClbuXW_-F6nH94T1gWpB6QaBFTt0yzBMUE.png" alt="When you fill in the form from the last image, you will receive a text message with the details from the form." /></p>
<p>Let&#8217;s take this app and see what it would look like using Textris.</p>
<h3 id="h.nsd7gznrf6pk">Setting up Textris</h3>
<p>If you take a look around the application you&#8217;ll see that the <code>NotificationsController</code> (<a href="https://github.com/TwilioDevEd/lead-alerts-rails/blob/master/app/controllers/notifications_controller.rb" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/TwilioDevEd/lead-alerts-rails/blob/master/app/controllers/notifications_controller.rb', 'app/controllers/notifications_controller.rb');"><code>app/controllers/notifications_controller.rb</code></a>) is where interested parties submit their details and where we send the SMS to the real estate agent. That uses a class called <code>MessageSender</code> (<a href="https://github.com/TwilioDevEd/lead-alerts-rails/blob/master/lib/message_sender.rb" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/TwilioDevEd/lead-alerts-rails/blob/master/lib/message_sender.rb', 'lib/message_sender.rb');"><code>lib/message_sender.rb</code></a>) which <a href="https://github.com/TwilioDevEd/lead-alerts-rails/blob/master/lib/message_sender.rb#L11" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/TwilioDevEd/lead-alerts-rails/blob/master/lib/message_sender.rb#L11', 'creates a Twilio::REST::Client');">creates a <code>Twilio::REST::Client</code></a> and <a href="https://github.com/TwilioDevEd/lead-alerts-rails/blob/master/lib/message_sender.rb#L14-L20" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/TwilioDevEd/lead-alerts-rails/blob/master/lib/message_sender.rb#L14-L20', 'sends the message');">sends the message</a>.</p>
<p>To change this, we first need to install Textris. Open up the <code>Gemfile</code> and add this line:</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff999542800586855" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Ruby</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
# Gemfile
gem 'twilio-ruby'
gem 'textris'</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff999542800586855-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999542800586855-2">2</div><div class="crayon-num crayon-marked-num crayon-top crayon-bottom" data-line="crayon-58794ff999542800586855-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff999542800586855-1"><span class="crayon-c"># Gemfile</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999542800586855-2"><span class="crayon-i">gem</span><span class="crayon-h"> </span><span class="crayon-s">'twilio-ruby'</span></div><div class="crayon-line crayon-marked-line crayon-top crayon-bottom" id="crayon-58794ff999542800586855-3"><span class="crayon-i">gem</span><span class="crayon-h"> </span><span class="crayon-s">'textris'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>Install this by running <code>bundle install</code> on the command line in the project.</p>
<p>For Textris we need to configure Twilio ahead of time. Create a file at <code>config/initializers/twilio.rb</code> and add the following code:</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff999555888352950" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Ruby</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
# config/initializers/twilio.rb
Twilio.configure do |config|
  config.account_sid = ENV["TWILIO_ACCOUNT_SID"]
  config.auth_token  = ENV["TWILIO_AUTH_TOKEN"]
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff999555888352950-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999555888352950-2">2</div><div class="crayon-num" data-line="crayon-58794ff999555888352950-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999555888352950-4">4</div><div class="crayon-num" data-line="crayon-58794ff999555888352950-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff999555888352950-1"><span class="crayon-c"># config/initializers/twilio.rb</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999555888352950-2"><span class="crayon-v">Twilio</span><span class="crayon-sy">.</span><span class="crayon-i">configure</span><span class="crayon-h"> </span><span class="crayon-st">do</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-i">config</span><span class="crayon-o">|</span></div><div class="crayon-line" id="crayon-58794ff999555888352950-3"> <span class="crayon-h"> </span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-v">account_sid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ENV</span><span class="crayon-sy">[</span><span class="crayon-s">"TWILIO_ACCOUNT_SID"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999555888352950-4"> <span class="crayon-h"> </span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-i">auth_token</span><span class="crayon-h"> </span> <span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ENV</span><span class="crayon-sy">[</span><span class="crayon-s">"TWILIO_AUTH_TOKEN"</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-58794ff999555888352950-5"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0023 seconds] -->
<p>The final part of setting up Textris is to configure it to use Twilio for sending messages. Open up <code>config/environments/development.rb</code> and at the bottom of the block add:</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff999560247331039" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Ruby</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
# config/environments/development.rb
  # Raises error for missing translations
  # config.action_view.raise_on_missing_translations = true

  config.textris_delivery_method = :twilio
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff999560247331039-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999560247331039-2">2</div><div class="crayon-num" data-line="crayon-58794ff999560247331039-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999560247331039-4">4</div><div class="crayon-num crayon-marked-num crayon-top crayon-bottom" data-line="crayon-58794ff999560247331039-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999560247331039-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff999560247331039-1"><span class="crayon-c"># config/environments/development.rb</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999560247331039-2"> <span class="crayon-h"> </span><span class="crayon-c"># Raises error for missing translations</span></div><div class="crayon-line" id="crayon-58794ff999560247331039-3"> <span class="crayon-h"> </span><span class="crayon-c"># config.action_view.raise_on_missing_translations = true</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999560247331039-4">&nbsp;</div><div class="crayon-line crayon-marked-line crayon-top crayon-bottom" id="crayon-58794ff999560247331039-5"> <span class="crayon-h"> </span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-v">textris_delivery_method</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-i">twilio</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999560247331039-6"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>Textris has a number of delivery methods. Once you have this working in development with Twilio, you might want to switch this to <code>:log</code> so that you can see SMS messages in your Rails log instead of sending them whilst you are developing the app. Don&#8217;t forget to set the delivery method to <code>:twilio</code> in <code>config/environments/production.rb</code> before you deploy.</p>
<h3 id="h.kift54530jzj">Creating a Texter class</h3>
<p>Now that we have Textris set up in our app we can start to work with it. Textris behaves like Action Mailer. Just like how we create a  Mailer class to send emails with Action Mailer we need to create a Texter class to send SMS messages with Textris.</p>
<p>Create the folder <code>app/texters</code> and the file <code>app/texters/agent_texter.rb</code>. Enter the following code in your new file.</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff99956b010065372" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Ruby</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
# app/texters/agent_texter.rb
class AgentTexter &lt; Textris::Base
  default :from =&gt; ENV["TWILIO_NUMBER"]

  def alert(params)
    @params = params
    text :to =&gt; ENV["AGENT_NUMBER"]
  end
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff99956b010065372-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff99956b010065372-2">2</div><div class="crayon-num" data-line="crayon-58794ff99956b010065372-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff99956b010065372-4">4</div><div class="crayon-num" data-line="crayon-58794ff99956b010065372-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff99956b010065372-6">6</div><div class="crayon-num" data-line="crayon-58794ff99956b010065372-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff99956b010065372-8">8</div><div class="crayon-num" data-line="crayon-58794ff99956b010065372-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff99956b010065372-1"><span class="crayon-c"># app/texters/agent_texter.rb</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff99956b010065372-2"><span class="crayon-r">class</span><span class="crayon-h"> </span><span class="crayon-i">AgentTexter</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-i">Textris</span><span class="crayon-o">::</span><span class="crayon-i">Base</span></div><div class="crayon-line" id="crayon-58794ff99956b010065372-3"> <span class="crayon-h"> </span><span class="crayon-r">def</span>ault<span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-v">from</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">ENV</span><span class="crayon-sy">[</span><span class="crayon-s">"TWILIO_NUMBER"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff99956b010065372-4">&nbsp;</div><div class="crayon-line" id="crayon-58794ff99956b010065372-5"> <span class="crayon-h"> </span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">alert</span><span class="crayon-sy">(</span><span class="crayon-i">params</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff99956b010065372-6"> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">@params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">params</span></div><div class="crayon-line" id="crayon-58794ff99956b010065372-7"> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-i">text</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-v">to</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">ENV</span><span class="crayon-sy">[</span><span class="crayon-s">"AGENT_NUMBER"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff99956b010065372-8"> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-58794ff99956b010065372-9"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0037 seconds] -->
<p>Like in Action Mailer, we can set default options for our SMS messages. In this case we set a default from number, our Twilio number.</p>
<p>Then we create a method that builds a message to be sent. The method returns a <code>Textris::Message</code> object that we create with the method <code>text</code> and the remaining options, in this case the number we are sending the message to.</p>
<p>Now we need a view to render when we send this message. Like other views in Rails, the template will have access to instance variables defined in the <code>alert</code> method. Create a directory for our <code>AgentTexter</code>&#8216;s views at <code>app/views/agent_texter</code> and then create the file <code>app/views/agent_texter/alert.text.erb</code>. We can take the message template from the <code>NotificationsController</code> class and convert it to ERB.</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff999576340933314" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Ruby</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
&lt;%# app/views/agent_texter/alert.text.erb %&gt;
New lead received for &lt;%= @params[:house_title] %&gt;. Call &lt;%= @params[:name] %&gt; at &lt;%= @params[:phone] %&gt;. Message: &lt;%= @params[:message] %&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff999576340933314-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999576340933314-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff999576340933314-1"><span class="crayon-ta">&lt;%</span><span class="crayon-c"># app/views/agent_texter/alert.text.erb %&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999576340933314-2"><span class="crayon-i">New</span><span class="crayon-h"> </span><span class="crayon-i">lead</span><span class="crayon-h"> </span><span class="crayon-i">received</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-ta">&lt;%=</span><span class="crayon-h"> </span><span class="crayon-v">@params</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-i">house_title</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-ta">%&gt;</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-i">Call</span><span class="crayon-h"> </span><span class="crayon-ta">&lt;%=</span><span class="crayon-h"> </span><span class="crayon-v">@params</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-i">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-ta">%&gt;</span><span class="crayon-h"> </span><span class="crayon-i">at</span><span class="crayon-h"> </span><span class="crayon-ta">&lt;%=</span><span class="crayon-h"> </span><span class="crayon-v">@params</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-i">phone</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-ta">%&gt;</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-i">Message</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-ta">&lt;%=</span><span class="crayon-h"> </span><span class="crayon-v">@params</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-i">message</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-ta">%&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0047 seconds] -->
<p>Now that we have our Texter class and view in place we can remove the <code>MessageSender</code> and use our <code>AgentTexter</code> instead.</p>
<h3 id="h.g3id2rqalfyn">Using the AgentTexter</h3>
<p>Open up the <code>NotificationsController</code> and start by removing the private method <code>message</code>. Now we can replace the line that uses the <code>MessageSender</code> class with our <code>AgentTexter</code> like so:</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff999587672229164" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">diff</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
# app/controllers/notifications_controller.rb
 class NotificationsController &lt; ApplicationController
   def create
-    MessageSender.send_message(message)
+    AgentTexter.alert(params).deliver
     redirect_to root_url,
       success: 'Thanks! An agent will be contacting you shortly.'
   rescue Twilio::REST::RequestError =&gt; error
     redirect_to root_url,
       error: 'Oops! There was an error. Please try again.'
   end
-
-  private
-
-  def message
-    "New lead received for #{params[:house_title]}. " 
-    "Call #{params[:name]} at #{params[:phone]}. " 
-    "Message: #{params[:message]}"
-  end
 end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff999587672229164-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999587672229164-2">2</div><div class="crayon-num" data-line="crayon-58794ff999587672229164-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999587672229164-4">4</div><div class="crayon-num" data-line="crayon-58794ff999587672229164-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999587672229164-6">6</div><div class="crayon-num" data-line="crayon-58794ff999587672229164-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999587672229164-8">8</div><div class="crayon-num" data-line="crayon-58794ff999587672229164-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999587672229164-10">10</div><div class="crayon-num" data-line="crayon-58794ff999587672229164-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999587672229164-12">12</div><div class="crayon-num" data-line="crayon-58794ff999587672229164-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999587672229164-14">14</div><div class="crayon-num" data-line="crayon-58794ff999587672229164-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999587672229164-16">16</div><div class="crayon-num" data-line="crayon-58794ff999587672229164-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999587672229164-18">18</div><div class="crayon-num" data-line="crayon-58794ff999587672229164-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff999587672229164-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff999587672229164-1">#<span class="crayon-h"> </span>app/controllers/notifications_controller.rb</div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999587672229164-2"> class<span class="crayon-h"> </span>NotificationsController<span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span>ApplicationController</div><div class="crayon-line" id="crayon-58794ff999587672229164-3"> <span class="crayon-h"> </span> def<span class="crayon-h"> </span>create</div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999587672229164-4"><span class="crayon-cn ">-    MessageSender.send_message(message)</span></div><div class="crayon-line" id="crayon-58794ff999587672229164-5"><span class="crayon-s ">+    AgentTexter.alert(params).deliver</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999587672229164-6"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> redirect_to<span class="crayon-h"> </span>root_url,</div><div class="crayon-line" id="crayon-58794ff999587672229164-7"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> success:<span class="crayon-h"> </span>'Thanks!<span class="crayon-h"> </span>An<span class="crayon-h"> </span>agent<span class="crayon-h"> </span>will<span class="crayon-h"> </span>be<span class="crayon-h"> </span>contacting<span class="crayon-h"> </span>you<span class="crayon-h"> </span>shortly.'</div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999587672229164-8"> <span class="crayon-h"> </span> rescue<span class="crayon-h"> </span>Twilio::REST::RequestError<span class="crayon-h"> </span>=<span class="crayon-h">&gt;</span><span class="crayon-h"> </span>error</div><div class="crayon-line" id="crayon-58794ff999587672229164-9"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> redirect_to<span class="crayon-h"> </span>root_url,</div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999587672229164-10"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> error:<span class="crayon-h"> </span>'Oops!<span class="crayon-h"> </span>There<span class="crayon-h"> </span>was<span class="crayon-h"> </span>an<span class="crayon-h"> </span>error.<span class="crayon-h"> </span>Please<span class="crayon-h"> </span>try<span class="crayon-h"> </span>again.'</div><div class="crayon-line" id="crayon-58794ff999587672229164-11"> <span class="crayon-h"> </span> end</div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999587672229164-12"><span class="crayon-cn ">-</span></div><div class="crayon-line" id="crayon-58794ff999587672229164-13"><span class="crayon-cn ">-  private</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999587672229164-14"><span class="crayon-cn ">-</span></div><div class="crayon-line" id="crayon-58794ff999587672229164-15"><span class="crayon-cn ">-  def message</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999587672229164-16"><span class="crayon-cn ">-    "New lead received for #{params[:house_title]}. " </span></div><div class="crayon-line" id="crayon-58794ff999587672229164-17"><span class="crayon-cn ">-    "Call #{params[:name]} at #{params[:phone]}. " </span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999587672229164-18"><span class="crayon-cn ">-    "Message: #{params[:message]}"</span></div><div class="crayon-line" id="crayon-58794ff999587672229164-19"><span class="crayon-cn ">-  end</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff999587672229164-20"> end</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0034 seconds] -->
<p>We can delete the entire <code>MessageSender</code> class as well as its test file.</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff999593705697351" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
$ rm lib/message_sender.rb spec/lib/message_sender_spec.rb</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff999593705697351-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff999593705697351-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-r">rm</span><span class="crayon-h"> </span><span class="crayon-i">lib</span><span class="crayon-o">/</span><span class="crayon-v">message_sender</span><span class="crayon-e">.rb</span><span class="crayon-h"> </span><span class="crayon-i">spec</span><span class="crayon-o">/</span><span class="crayon-i">lib</span><span class="crayon-o">/</span><span class="crayon-v">message_sender_spec</span><span class="crayon-e">.rb</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>Speaking of tests, we need to fix one up. The test for the <code>NotificationsController</code> expects the <code>MessageSender</code> class to receive a call to <code>send_message</code>. Instead, we can use Textris in test mode to test that we make one delivery when we submit the form. We clear the list of deliveries before each test so that deliveries in other tests won&#8217;t affect this one.</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff99959d544573663" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">diff</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
 # spec/controllers/notifications_controller_spec.rb
 require 'rails_helper'
 
 RSpec.describe NotificationsController do
   before(:each) do
     Textris::Base.deliveries.clear
   end
 
   describe '#index' do
     it 'send a notification' do
-      expect(MessageSender).to receive(:send_message).once
       post :create, message: 'message'
 
+      expect(Textris::Base.deliveries.count).to be(1)
       expect(response).to redirect_to(root_url)
     end
   end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff99959d544573663-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff99959d544573663-2">2</div><div class="crayon-num" data-line="crayon-58794ff99959d544573663-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff99959d544573663-4">4</div><div class="crayon-num" data-line="crayon-58794ff99959d544573663-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff99959d544573663-6">6</div><div class="crayon-num" data-line="crayon-58794ff99959d544573663-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff99959d544573663-8">8</div><div class="crayon-num" data-line="crayon-58794ff99959d544573663-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff99959d544573663-10">10</div><div class="crayon-num" data-line="crayon-58794ff99959d544573663-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff99959d544573663-12">12</div><div class="crayon-num" data-line="crayon-58794ff99959d544573663-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff99959d544573663-14">14</div><div class="crayon-num" data-line="crayon-58794ff99959d544573663-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff99959d544573663-16">16</div><div class="crayon-num" data-line="crayon-58794ff99959d544573663-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff99959d544573663-1"> #<span class="crayon-h"> </span>spec/controllers/notifications_controller_spec.rb</div><div class="crayon-line crayon-striped-line" id="crayon-58794ff99959d544573663-2"> require<span class="crayon-h"> </span>'rails_helper'</div><div class="crayon-line" id="crayon-58794ff99959d544573663-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-58794ff99959d544573663-4"> RSpec.describe<span class="crayon-h"> </span>NotificationsController<span class="crayon-h"> </span>do</div><div class="crayon-line" id="crayon-58794ff99959d544573663-5"><span class="crayon-sy">&nbsp;&nbsp; before(:each) do</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff99959d544573663-6"><span class="crayon-sy">&nbsp;&nbsp;   Textris::Base.deliveries.clear</span></div><div class="crayon-line" id="crayon-58794ff99959d544573663-7"><span class="crayon-sy">&nbsp;&nbsp; end</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff99959d544573663-8"><span class="crayon-sy"> </span></div><div class="crayon-line" id="crayon-58794ff99959d544573663-9"> <span class="crayon-h"> </span> describe<span class="crayon-h"> </span>'#index'<span class="crayon-h"> </span>do</div><div class="crayon-line crayon-striped-line" id="crayon-58794ff99959d544573663-10"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> it<span class="crayon-h"> </span>'send<span class="crayon-h"> </span>a<span class="crayon-h"> </span>notification'<span class="crayon-h"> </span>do</div><div class="crayon-line" id="crayon-58794ff99959d544573663-11"><span class="crayon-cn ">-      expect(MessageSender).to receive(:send_message).once</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff99959d544573663-12"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> post<span class="crayon-h"> </span>:create,<span class="crayon-h"> </span>message:<span class="crayon-h"> </span>'message'</div><div class="crayon-line" id="crayon-58794ff99959d544573663-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-58794ff99959d544573663-14"><span class="crayon-s ">+      expect(Textris::Base.deliveries.count).to be(1)</span></div><div class="crayon-line" id="crayon-58794ff99959d544573663-15"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> expect(response).to<span class="crayon-h"> </span>redirect_to(root_url)</div><div class="crayon-line crayon-striped-line" id="crayon-58794ff99959d544573663-16"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> end</div><div class="crayon-line" id="crayon-58794ff99959d544573663-17"> <span class="crayon-h"> </span> end</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0023 seconds] -->
<p>Start up the application with <code>rails server</code> and navigate to <a href="http://localhost:3000/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://localhost:3000/', 'localhost:3000');">localhost:3000</a>. Enter a request to talk to an agent, hit the &#8220;Request info&#8221; button and celebrate as everything falls into place and you receive the text message. You can celebrate again when you realise that sending messages this way took 25 less lines of code!</p>
<p>You can check out <a href="https://github.com/philnash/lead-alerts-rails/tree/textris" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/philnash/lead-alerts-rails/tree/textris', 'my version of the newly Textris powered application on GitHub');">my version of the newly Textris powered application on GitHub</a>.</p>
<h3 id="h.rwcth8ph144y">What&#8217;s next?</h3>
<p>Now you&#8217;ve sent your first SMS message with Twilio using Textris there&#8217;s more features available to you that give you even more power.</p>
<ul>
<li>You can take advantage of Active Job and process the API requests off the main thread by replacing the call to <code>AgentTexter.alert(params).deliver</code> to <code>AgentTexter.alert(params).deliver_later</code>. Check out how to <a href="https://www.twilio.com/blog/2015/10/delay-api-calls-to-twilio-with-rails-active-job-and-sidekiq.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/blog/2015/10/delay-api-calls-to-twilio-with-rails-active-job-and-sidekiq.html', 'setup Active Job in Rails with Sidekiq');">setup Active Job in Rails with Sidekiq</a> here.</li>
<li>If you hired more salespeople to sell your real estate, you could send lead alerts to all of them by providing an array of numbers to the <code>AgentTexter</code>&#8216;s <code>text</code> method</li>
<li>Localise your SMS messages by adding templates for different languages, <a href="http://guides.rubyonrails.org/i18n.html#localized-views" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://guides.rubyonrails.org/i18n.html#localized-views', 'just like with other Rails templates');">just like with other Rails templates</a>. Textris renders to the locale set in <code>I18n.locale</code></li>
</ul>
<p>To see what else is available, check out the <a href="https://github.com/visualitypl/textris" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/visualitypl/textris', 'Textris documentation on GitHub');">Textris documentation on GitHub</a>.</p>
<p>I think Textris makes sending SMS messages in Rails feel natural and separates out views from controllers in a sensible way. What do you think? Let me know if you like the look of Textris or think you might use it in your next project. Or, do you know a better way of sending SMS messages in Rails? Drop me a line in the comments, by <a href="https://twitter.com/philnash" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://twitter.com/philnash', 'Twitter');">Twitter</a>.</p>
			</div>
					</div>
	</div><!-- .entry-content -->

	<footer class="entry-footer col-md-12">
		<div class="entry-meta">
					<div class="social-buttons">
			<div class="fb-like" data-href="https://www.twilio.com/blog/2016/09/send-sms-messages-like-emails-in-rails-with-textris.html" data-layout="button" data-action="like" data-show-faces="false" data-share="false"></div>
			<a href="https://twitter.com/share" class="twitter-share-button" data-via="twilio" data-count="none" data-url="https://www.twilio.com/blog/2016/09/send-sms-messages-like-emails-in-rails-with-textris.html" data-text="Send SMS messages like emails in Rails with Textris ">Tweet</a>
      <a href="https://twitter.com/twilio" class="twitter-follow-button" data-show-count="false">Follow @twilio</a>
		</div>
<span class="author-avatar"><img alt='' src='https://secure.gravatar.com/avatar/79fac5826d02217e841fd2354db2ae37?s=20&amp;d=mm&amp;r=g' srcset='https://secure.gravatar.com/avatar/79fac5826d02217e841fd2354db2ae37?s=40&amp;d=mm&amp;r=g 2x' class='avatar avatar-20 photo' height='20' width='20' /></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://www.twilio.com/blog/author/phil">Phil Nash</a></span></span> <span class="author-meta author-email"><a href="mailto:pnash@twilio.com">pnash@twilio.com</a></span><span class="author-meta author-twitter"><a href="http://twitter.com/philnash">@philnash<a/></span>		</div>
	</footer><!-- .entry-footer -->

   <div class="build-more"><h3>Build More With Ruby</h3>        <a href="https://www.twilio.com/docs/tutorials/walkthrough/server-notifications/ruby/rails" onclick="__gaTracker('send', 'event', 'buildmore-widget', 'https://www.twilio.com/docs/tutorials/walkthrough/server-notifications/ruby/rails', '');">
          <h5>SMS and MMS Notifications with Ruby</h5>
        </a>
              <a href="https://www.twilio.com/blog/2015/01/twilio-on-rails-part-3-adding-contextual-voip-using-webrtc-to-your-rails-4-app.html" rel="bookmark" title="Permanent Link to Twilio on Rails Part 3 &#8211; Adding Contextual VOIP Using WebRTC to Your Rails 4 App" onclick="__gaTracker('send', 'event', 'buildmore-widget', 'https://www.twilio.com/blog/2015/01/twilio-on-rails-part-3-adding-contextual-voip-using-webrtc-to-your-rails-4-app.html', '');">
          <h5>Twilio on Rails Part 3 &#8211; Adding Contextual VOIP Using WebRTC to Your Rails 4 App<h4>
        </a>
                <a href="https://www.twilio.com/blog/2015/02/managing-development-environment-variables-across-multiple-ruby-applications.html" rel="bookmark" title="Permanent Link to Managing Development Environment Variables Across Multiple Ruby Applications" onclick="__gaTracker('send', 'event', 'buildmore-widget', 'https://www.twilio.com/blog/2015/02/managing-development-environment-variables-across-multiple-ruby-applications.html', '');">
          <h5>Managing Development Environment Variables Across Multiple Ruby Applications<h4>
        </a>
                <a href="https://www.twilio.com/blog/2015/02/note-taking-on-the-go-with-evernote-and-twilio-part-one.html" rel="bookmark" title="Permanent Link to Note Taking On the Go With Evernote and Twilio &#8211; Part One" onclick="__gaTracker('send', 'event', 'buildmore-widget', 'https://www.twilio.com/blog/2015/02/note-taking-on-the-go-with-evernote-and-twilio-part-one.html', '');">
          <h5>Note Taking On the Go With Evernote and Twilio &#8211; Part One<h4>
        </a>
        </div>
</article><!-- #post-## -->

			
<div id="disqus_thread">
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'https://www.twilio.com/blog/2016/09/send-sms-messages-like-emails-in-rails-with-textris.html';
    var disqus_identifier = 'https://www.twilio.com/blog/2016/09/18743 https://www.twilio.com/blog/?p=18743';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'twilioblog';
    var disqus_title = "Send SMS messages like emails in Rails with Textris";
        var disqus_config = function () {
        var config = this; // Access to the config object
        config.language = '';

        /*
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            var script = document.createElement('script');
            script.async = true;
            script.src = 'https://www.twilio.com/blog/2016/09/send-sms-messages-like-emails-in-rails-with-textris.html?cf_action=sync_comments&amp;post_id=18743';

            var firstScript = document.getElementsByTagName( "script" )[0];
            firstScript.parentNode.insertBefore(script, firstScript);
        });
                    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "https:\/\/www.twilio.com\/blog\/2016\/09\/send-sms-messages-like-emails-in-rails-with-textris.html\/trackback"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.' + 'disqus.com' + '/embed.js?pname=wordpress&pver=2.74';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area col-md-3 hide-xs" role="complementary">
	<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://www.twilio.com/blog/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside><aside id="text-2" class="widget widget_text">			<div class="textwidget"><p>Power modern communications. Build the next generation of voice and SMS applications.</p>

 <a href="http://twilio.com/try-twilio" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://twilio.com/try-twilio', 'Start Building For Free');" class="btn">Start Building For Free</a></div>
		</aside><style scoped type="text/css">.utcw-8ngloje {word-wrap:break-word}.utcw-8ngloje span,.utcw-8ngloje a{border-style:solid;border-width:1px}.utcw-8ngloje span:hover,.utcw-8ngloje a:hover{border-style:solid;border-width:1px}</style><aside id="utcw-2" class="widget widget_utcw widget_tag_cloud"><h1 class="widget-title">Posts By Stack</h1><div class="utcw-8ngloje tagcloud"><a class="tag-link-22 utcw-tag utcw-tag-net" href="https://www.twilio.com/blog/tag/net" style="font-size:16px" title="40 topics">.NET</a> <a class="tag-link-98 utcw-tag utcw-tag-arduino" href="https://www.twilio.com/blog/tag/arduino" style="font-size:16px" title="21 topics">Arduino</a> <a class="tag-link-598 utcw-tag utcw-tag-java" href="https://www.twilio.com/blog/tag/java" style="font-size:16px" title="14 topics">Java</a> <a class="tag-link-600 utcw-tag utcw-tag-javascript" href="https://www.twilio.com/blog/tag/javascript" style="font-size:16px" title="86 topics">JavaScript</a> <a class="tag-link-847 utcw-tag utcw-tag-php" href="https://www.twilio.com/blog/tag/php" style="font-size:16px" title="57 topics">PHP</a> <a class="tag-link-891 utcw-tag utcw-tag-python" href="https://www.twilio.com/blog/tag/python" style="font-size:16px" title="72 topics">Python</a> <a class="tag-link-969 utcw-tag utcw-tag-ruby" href="https://www.twilio.com/blog/tag/ruby" style="font-size:16px" title="69 topics">Ruby</a> <a class="tag-link-2856 utcw-tag utcw-tag-swift" href="https://www.twilio.com/blog/tag/swift" style="font-size:16px" title="22 topics">Swift</a></div></aside><style scoped type="text/css">.utcw-5dkhj5o {word-wrap:break-word}.utcw-5dkhj5o span,.utcw-5dkhj5o a{border-style:solid;border-width:1px}.utcw-5dkhj5o span:hover,.utcw-5dkhj5o a:hover{border-style:solid;border-width:1px}</style><aside id="utcw-3" class="widget widget_utcw widget_tag_cloud"><h1 class="widget-title">Posts By Product</h1><div class="utcw-5dkhj5o tagcloud"><a class="tag-link-2043 utcw-tag utcw-tag-mms" href="https://www.twilio.com/blog/tag/mms" style="font-size:16px" title="50 topics">MMS</a> <a class="tag-link-3513 utcw-tag utcw-tag-programmable-chat" href="https://www.twilio.com/blog/tag/programmable-chat" style="font-size:16px" title="9 topics">Programmable Chat</a> <a class="tag-link-1537 utcw-tag utcw-tag-sip" href="https://www.twilio.com/blog/tag/sip" style="font-size:16px" title="15 topics">SIP</a> <a class="tag-link-1031 utcw-tag utcw-tag-sms" href="https://www.twilio.com/blog/tag/sms" style="font-size:16px" title="372 topics">SMS</a> <a class="tag-link-2871 utcw-tag utcw-tag-taskrouter" href="https://www.twilio.com/blog/tag/taskrouter" style="font-size:16px" title="8 topics">Task Router</a> <a class="tag-link-1199 utcw-tag utcw-tag-twilio-client" href="https://www.twilio.com/blog/tag/twilio-client" style="font-size:16px" title="32 topics">Twilio Client</a> <a class="tag-link-3032 utcw-tag utcw-tag-twilio-video" href="https://www.twilio.com/blog/tag/twilio-video" style="font-size:16px" title="9 topics">Twilio Video</a> <a class="tag-link-1277 utcw-tag utcw-tag-voice" href="https://www.twilio.com/blog/tag/voice" style="font-size:16px" title="172 topics">Voice</a></div></aside><aside id="text-5" class="widget widget_text">			<div class="textwidget"><a href="http://www.twilio.com/docs/tutorials" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/docs/tutorials', '');"><img src="https://www.twilio.com/blog/wp-content/uploads/2016/07/tutorials.png" style="width: 255px" /></a></div>
		</aside><aside id="categories-3" class="widget widget_categories"><h1 class="widget-title">Categories</h1>		<ul>
	<li class="cat-item cat-item-13"><a href="https://www.twilio.com/blog/all-things-code" >Code, Tutorials and Hacks</a>
</li>
	<li class="cat-item cat-item-5"><a href="https://www.twilio.com/blog/customer-highlights" >Customer Highlights</a>
</li>
	<li class="cat-item cat-item-7"><a href="https://www.twilio.com/blog/developers-drawing-the-owl" >Developers Drawing The Owl</a>
</li>
	<li class="cat-item cat-item-3"><a href="https://www.twilio.com/blog/news" >News</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://www.twilio.com/blog/stories-from-the-road" >Stories From The Road</a>
</li>
	<li class="cat-item cat-item-8"><a href="https://www.twilio.com/blog/inside-twilio" >The Owl’s Nest: Inside Twilio</a>
</li>
		</ul>
</aside><aside id="text-4" class="widget widget_text">			<div class="textwidget"><div class="tagcloud "><a href="http://www.twilio.com/blog/feed" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/blog/feed', 'RSS Feed');">RSS Feed</a></div></div>
		</aside></div><!-- #secondary -->

		</div><!-- .row -->
	</div><!-- #content.container -->

<div class="" id="footer">
	<div class="container">
		<header>
			<div class="banner"></div>
			<div class="border"></div>
			<div class="stitching"></div>
		</header>
    <div class="row sitemap">
      <div class="row">
        <div class="col-md-2 col-md-offset-1">
          <h4><a href="http://www.twilio.com/company">Company</a></h4>
          <ul>
            <li><a href="http://www.twilio.com/company">About Twilio</a></li>
            <li><a href="http://www.twilio.com/company/nine-values">Our Nine Values</a></li>
            <li><a href="http://www.twilio.com/company/leadership-principles">Our Leadership Principles</a></li>
            <li><a href="http://www.twilio.com/company/management">The Team</a></li>
            <li><a href="http://www.twilio.com/press">Press &amp; Media</a></li>
            <li><a href="http://www.twilio.org/">Twilio.org</a></li>
            <li><a href="http://www.twilio.com/company/jobs">Careers</a></li>
          </ul>
        </div>
        <div class="col-md-2">
          <h4><a href="http://www.twilio.com/products">Products</a></h4>
          <ul>
            <li><a href="http://www.twilio.com/voice">Voice</a></li>
            <li><a href="http://www.twilio.com/video">Video</a></li>
            <li><a href="http://www.twilio.com/sms">SMS (Text Messaging)</a></li>
            <li><a href="http://www.twilio.com/mms">MMS (Picture Messaging)</a></li>
            <li><a href="http://www.twilio.com/sms/toll-free">Toll-Free SMS</a></li>
            <li><a href="http://www.twilio.com/sip-trunking">SIP Trunking</a></li>
            <li><a href="http://www.twilio.com/client/mobile">Client Mobile</a></li>
            <li><a href="http://www.twilio.com/webrtc">Client WebRTC</a></li>
            <li><a href="http://www.twilio.com/stun-turn">Network Traversal Service</a></li>
            <li><a href="http://www.twilio.com/taskrouter">TaskRouter</a></li>
            <li><a href="http://www.twilio.com/sms/phone-numbers">Phone Numbers</a></li>
            <li><a href="http://www.twilio.com/sms/shortcodes">Short Codes</a></li>
            <li><a href="http://www.twilio.com/support-plans">Support Plans</a></li>
            <li><a href="http://www.twilio.com/platform">Platform</a></li>
            <li><a href="http://www.twilio.com/lookup">Lookup</a></li>
            <li><a href="http://www.twilio.com/monitor">Monitor</a></li>
            <li><a href="http://www.twilio.com/copilot">Messaging Copilot</a></li>
            <li><a href="http://www.twilio.com/voice/conference">Global Conference</a></li>
            <li><a href="http://www.twilio.com/authy">Authy</a></li>
          </ul>
      </div>
      <div class="col-md-2">
        <h4><a href="http://www.twilio.com/pricing">Pricing</a></h4>
        <ul>
          <li><a href="http://www.twilio.com/voice/pricing">Voice Pricing</a></li>
          <li><a href="http://www.twilio.com/sms/pricing">Messaging Pricing</a></li>
          <li><a href="http://www.twilio.com/sip-trunking/pricing">SIP Trunking Pricing</a></li>
          <li><a href="http://www.twilio.com/client/pricing">Client Pricing</a></li>
          <li><a href="http://www.twilio.com/stun-turn/pricing">Network Traversal Pricing</a></li>
          <li><a href="http://www.twilio.com/taskrouter/pricing">TaskRouter</a></li>
          <li><a href="http://www.twilio.com/lookup#pricing">Lookup</a></li>
          <li><a href="http://www.twilio.com/international">International Coverage</a></li>
        </ul>
      </div>
      <div class="col-md-2">
          <h4><a href="http://www.twilio.com/use-cases">Use Cases</a></h4>
          <ul>
            <li><a href="http://www.twilio.com/customers">Customer Stories</a></li>
            <li><a href="http://www.twilio.com/showcase">Showcase</a></li>
            <li><a href="http://www.twilio.com/use-cases/two-factor-authentication">Two-Factor Authentication</a></li>
            <li><a href="http://www.twilio.com/use-cases/appointment-reminders">Appointment Reminders</a></li>
            <li><a href="http://www.twilio.com/use-cases/dispatch-notifications">Dispatch Notifications</a></li>
            <li><a href="http://www.twilio.com/use-cases/eta-alerts">ETA Alerts</a></li>
            <li><a href="http://www.twilio.com/use-cases/automated-surveys">Automated Surveys</a></li>
            <li><a href="http://www.twilio.com/use-cases/masked-phone-numbers">Masked Phone Numbers</a></li>
            <li><a href="http://www.twilio.com/use-cases/visual-estimates">Visual Estimates</a></li>
            <li><a href="http://www.twilio.com/doers">Developer Network</a></li>
            <li><a href="http://www.twilio.com/webinars">Webinars</a></li>
            <li><a href="http://www.twilio.com/white-papers">White Papers</a></li>
          </ul>
      </div>
      <div class="col-md-2">
          <h4><a href="http://www.twilio.com/api">Api &amp; Docs</a></h4>
          <ul>
            <li><a href="http://www.twilio.com/docs/api">API Documentation</a></li>
            <li><a href="http://www.twilio.com/docs/quickstart">Quickstarts</a></li>
            <li><a href="http://www.twilio.com/docs/howto">How Tos</a></li>
            <li><a href="http://www.twilio.com/docs/libraries">Helper Libraries</a></li>
            <li><a href="http://www.twilio.com/docs/security">Security</a></li>
          </ul>
      </div>
    </div>
		<div class="row clear">
			<footer><span>&copy; 2017 Twilio. All rights reserved. <aside>|</aside><a href="http://www.twilio.com/legal/tos">Terms of Service</a><aside>|</aside><a href="http://www.twilio.com/legal/privacy">Privacy Policy</a></span>
			</footer>
		</div>
	</div>
</div>


</div><!-- #page -->

<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201702'></script>







<script type="text/javascript" defer src="https://www.twilio.com/blog/wp-content/cache/autoptimize/js/autoptimize_30cf8936a215677503cd64ef48677239.js"></script></body>

<!-- Mirrored from www.twilio.com/blog/2016/09/send-sms-messages-like-emails-in-rails-with-textris.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 22:10:06 GMT -->
</html>
