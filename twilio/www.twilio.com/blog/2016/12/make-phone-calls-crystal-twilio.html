<!DOCTYPE html>
<html lang="en-US">

<!-- Mirrored from www.twilio.com/blog/2016/12/make-phone-calls-crystal-twilio.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 22:10:05 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<script type="text/javascript">
(function() {
    var projectId = 3524915770;
    var protocol = ('https:' == document.location.protocol ?
    'https://' : 'http://');
    var scriptTag = document.createElement('script');
    scriptTag.type = 'text/javascript';
    scriptTag.async = true;
    scriptTag.src = protocol + 'cdn.optimizely.com/js/' +
    projectId + '.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(scriptTag, s);
})();
function optimizelyTimeout() {
    window.optimizely = window.optimizely|| [];
    if (!window.optimizely.data) {
    window.optimizely.push("timeout");
    }
}
setTimeout(optimizelyTimeout, 1000);
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://www.twilio.com/blog/xmlrpc.php">
<script type="text/javascript">
var _elqQ = _elqQ || [];
_elqQ.push(['elqSetSiteId', '815114181']);
_elqQ.push(['elqTrackPageView']);
_elqQ.push(['elqUseFirstPartyCookie', 'www.twilio.com']);
(function () {
  function async_load()
  {
    var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;
    s.src = 'http://img03.en25.com/i/elqCfg.min.js';
    var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);
  }
  if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
  else if (window.attachEvent) window.attachEvent('onload', async_load);
})();
</script>
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','http://connect.facebook.net/en_US/fbevents.js');

fbq('init', '467131150158811');
fbq('track', "PageView");</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=467131150158811&amp;ev=PageView&amp;noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->

<style>
@media screen and (max-width: 600px) {
  #signal-header { display: none; }
}
</style>

<link type="text/css" media="all" href="https://www.twilio.com/blog/wp-content/cache/autoptimize/css/autoptimize_7a2cc50131d932d32297f43c61de37cd.css" rel="stylesheet" /><link type="text/css" media="screen" href="https://www.twilio.com/blog/wp-content/cache/autoptimize/css/autoptimize_97ca666341cd9b69002e26c8f2ca5299.css" rel="stylesheet" /><title>Make Phone Calls with Crystal and Twilio &#8211; Twilio Cloud Communications Blog</title>

<!-- This site is optimized with the Yoast WordPress SEO plugin v1.4.13 - http://yoast.com/wordpress/seo/ -->
<link rel="canonical" href="https://www.twilio.com/blog/2016/12/make-phone-calls-crystal-twilio.html" />
<!-- / Yoast WordPress SEO plugin. -->

<link rel='dns-prefetch' href='https://www.twilio.com/blog//s0.wp.com' />
<link rel='dns-prefetch' href='https://www.twilio.com/blog//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Twilio Cloud Communications Blog &raquo; Feed" href="https://www.twilio.com/blog/feed" />
<link rel="alternate" type="application/rss+xml" title="Twilio Cloud Communications Blog &raquo; Comments Feed" href="https://www.twilio.com/blog/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="Twilio Cloud Communications Blog &raquo; Make Phone Calls with Crystal and Twilio Comments Feed" href="https://www.twilio.com/blog/2016/12/make-phone-calls-crystal-twilio.html/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/twilioinc.wpengine.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.2"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>










<!-- This site uses the Google Analytics by Yoast plugin v5.4.7 - Universal enabled - https://yoast.com/wordpress/plugins/google-analytics/ -->
<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','http://www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-2900316-1', 'auto');
	__gaTracker('set', 'forceSSL', true);
	 window.optimizely = window.optimizely || [];
 window.optimizely.push("activateUniversalAnalytics");
	__gaTracker('set', 'dimension4', 'Phil Nash');
	__gaTracker('set', 'dimension5', 'post');
	__gaTracker('set', 'dimension6', 'developers-drawing-the-owl');
	__gaTracker('set', 'dimension7', 'crystal,crystal-lang,Phone Call,shards');
	__gaTracker('set', 'dimension8', '2016-12-02T11:19:04+00:00');
	__gaTracker('send','pageview');

</script>
<!-- / Google Analytics by Yoast -->


<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.4.3","is_admin":"0","ajaxurl":"https:\/\/twilioinc.wpengine.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>

<script type='text/javascript'>
/* <![CDATA[ */
var swiftypeParams = {"engineKey":"UpGyyJZzgUMXHM65YENj"};
/* ]]> */
</script>

<link rel='https://api.w.org/' href='https://www.twilio.com/blog/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.twilio.com/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.twilio.com/blog/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://www.twilio.com/blog/?p=19224' />
<link rel="alternate" type="application/json+oembed" href="https://www.twilio.com/blog/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.twilio.com%2Fblog%2F2016%2F12%2Fmake-phone-calls-crystal-twilio.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.twilio.com/blog/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.twilio.com%2Fblog%2F2016%2F12%2Fmake-phone-calls-crystal-twilio.html&amp;format=xml" />
<link rel="icon" href="https://www.twilio.com/blog/wp-content/uploads/2015/09/cropped-favicon_1141-32x32.png" sizes="32x32" />
<link rel="icon" href="https://www.twilio.com/blog/wp-content/uploads/2015/09/cropped-favicon_1141-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="https://www.twilio.com/blog/wp-content/uploads/2015/09/cropped-favicon_1141-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.twilio.com/blog/wp-content/uploads/2015/09/cropped-favicon_1141-270x270.png" />
</head>

<body class="single single-post postid-19224 single-format-standard group-blog">
<!-- Google Tag Manager -->
<noscript><iframe src="https://www.twilio.com/blog//www.googletagmanager.com/ns.html?id=GTM-W4RVXH"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'http://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-W4RVXH');</script>
<!-- End Google Tag Manager -->

<div id="fb-root"></div>
<script>(function(d, s, id) {
		var js, fjs = d.getElementsByTagName(s)[0];
		if (d.getElementById(id)) return;
		js = d.createElement(s); js.id = id;
		js.src = "http://connect.facebook.net/en_US/sdk.js#xfbml=1&appId=414254592083321&version=v2.0";
		fjs.parentNode.insertBefore(js, fjs);
	}(document, 'script', 'facebook-jssdk'));
window.fbAsyncInit = function() {
  FB.Event.subscribe('edge.create', function(targetUrl) {
    __gaTracker('send', 'social', 'facebook', 'like', targetUrl);
  });
};
window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));

function trackTwitter(intent_event) {
  if (intent_event) {
    var opt_pagePath;
    if (intent_event.target && intent_event.target.nodeName == 'IFRAME') {
          opt_target = extractParamFromUri(intent_event.target.src, 'url');
    }
    __gaTracker('send', 'social', 'twitter', 'tweet', opt_pagePath);
  }
}

function extractParamFromUri(uri, paramName) {
  if (!uri) {
    return;
  }
  var regex = new RegExp('[\\?&#]' + paramName + '=([^&#]*)');
  var params = regex.exec(uri);
  if (params != null) {
    return unescape(params[1]);
  }
  return;
}

//Wrap event bindings - Wait for async js to load
twttr.ready(function (twttr) {
  //event bindings
  twttr.events.bind('tweet', trackTwitter);
});
</script>
<script type="text/javascript">
  window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var n=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(n?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(a,o);for(var r=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["clearEventProperties","identify","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=r(p[c])};
  heap.load("1541905715");
</script>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<nav class="navbar navbar-default" role="navigation">
		<div class="container">
			<!-- Brand and toggle get grouped for better mobile display -->
			<div class="navbar-header">
				<button type="button" class="navbar-toggle hidden-xs" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="https://www.twilio.com/blog/">
					<img src="https://s3.amazonaws.com/ahoy-assets.twilio.com/global/images/wordmark.svg" width="200"> <span class="logo-blog">blog</span>
				</a>
			</div>

			<div class="hidden-xs"><ul id="menu-site-navigation" class="nav navbar-nav pull-right"><li id="menu-item-12202" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12202"><a href="http://www.twilio.com/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/', 'Home');" title="Home">Home</a></li>
<li id="menu-item-12205" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12205"><a href="http://www.twilio.com/blog" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/blog', 'Blog');" title="Blog">Blog</a></li>
<li id="menu-item-12204" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12204"><a href="https://www.twilio.com/docs/howto" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://www.twilio.com/docs/howto', 'Tutorials');" title="Tutorials">Tutorials</a></li>
<li id="menu-item-12206" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12206"><a href="https://www.twilio.com/docs/api" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://www.twilio.com/docs/api', 'Docs');" title="Docs">Docs</a></li>
<li id="menu-item-12207" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12207"><a href="http://www.twilio.com/help" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/help', 'Help');" title="Help">Help</a></li>
<li id="menu-item-12208" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12208"><a href="https://www.twilio.com/login" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://www.twilio.com/login', 'Login');" title="Login">Login</a></li>
<li id="menu-item-12209" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12209"><a href="https://www.twilio.com/try-twilio" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://www.twilio.com/try-twilio', 'Signup');" title="Signup">Signup</a></li>
</ul></div>		</div>
	</nav>

	<div id="content" class="site-content container">
		<div class="row">

	<div id="primary" class="content-area col-md-9">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-19224" class="row post-19224 post type-post status-publish format-standard has-post-thumbnail hentry category-developers-drawing-the-owl tag-crystal tag-crystal-lang tag-phone-call tag-shards">
	<header class="entry-header col-md-12">
		<h2 class="entry-title">Make Phone Calls with Crystal and Twilio</h2>
						<div class="entry-image col-md-12">
        <img width="640" height="240" src="https://www.twilio.com/blog/wp-content/uploads/2016/11/header2-1.png" class="img-responsive wp-post-image" alt="" srcset="https://www.twilio.com/blog/wp-content/uploads/2016/11/header2-1.png 640w, https://www.twilio.com/blog/wp-content/uploads/2016/11/header2-1-300x113.png 300w, https://www.twilio.com/blog/wp-content/uploads/2016/11/header2-1-200x75.png 200w" sizes="(max-width: 640px) 100vw, 640px" />			</div>
      <div class="clear"></div>
			
		<footer class="entry-footer">
			<div class="entry-meta">
					<div class="row">
	<div class="col-md-6">
	<span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://www.twilio.com/blog/author/phil">Phil Nash</a></span></span> on <span class="posted-on"><a href="https://www.twilio.com/blog/2016/12/make-phone-calls-crystal-twilio.html" rel="bookmark"><time class="entry-date published" datetime="2016-12-02T11:19:04+00:00">December 2, 2016</time><time class="updated" datetime="2016-12-03T14:51:39+00:00">December 3, 2016</time></a></span>	</div>
	<div class="col-md-6">
		<div class="social-buttons">
			<div class="fb-like" data-href="https://www.twilio.com/blog/2016/12/make-phone-calls-crystal-twilio.html" data-layout="button" data-action="like" data-show-faces="false" data-share="false"></div>
			<a href="https://twitter.com/share" class="twitter-share-button" data-via="twilio" data-count="none" data-url="https://www.twilio.com/blog/2016/12/make-phone-calls-crystal-twilio.html" data-text="Make Phone Calls with Crystal and Twilio ">Tweet</a>
      <a href="https://twitter.com/twilio" class="twitter-follow-button" data-show-count="false">Follow @twilio</a>
		</div>
	</div>
	</div>
			</div><!-- .entry-meta -->
		</footer><!-- .entry-footer -->
	</header><!-- .entry-header -->

	<div class="entry-content col-md-12">
		<div class="row">
			<div class="col-md-12">
				<p>We&#8217;ve already learned how to send <a href="https://www.twilio.com/blog/2016/11/send-sms-messages-crystal.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/blog/2016/11/send-sms-messages-crystal.html', 'SMS messages with Crystal');">SMS messages with Crystal</a>, a new language that looks like Ruby but runs like C. Doing that required making a simple <a href="https://www.twilio.com/blog/2016/11/send-sms-messages-crystal.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/blog/2016/11/send-sms-messages-crystal.html', 'HTTP request');">HTTP request</a> from our Crystal application to the Twilio API.</p>
<p>Now it&#8217;s time to dig a little deeper and see how to <a href="https://www.twilio.com/docs/api/rest/making-calls" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/docs/api/rest/making-calls', 'make phone calls');">make phone calls</a> with Crystal.  Making a call is going to require not only an HTTP request but also <a href="https://www.twilio.com/docs/api/twiml/twilio_request" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/docs/api/twiml/twilio_request', 'receiving a webhook');">receiving a webhook</a> which we will need to respond to with <a href="https://www.twilio.com/docs/api/twiml" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/docs/api/twiml', 'TwiML');">TwiML</a>.</p>
<h3 id="h.um4ysw1s5v3r">Getting started</h3>
<p>If you want to join in, you&#8217;ll need to install Crystal, there are <a href="https://crystal-lang.org/docs/installation/index.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://crystal-lang.org/docs/installation/index.html', 'installation instructions in the documentation');">installation instructions in the documentation</a>. You will also need <a href="https://www.twilio.com/try-twilio" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/try-twilio', 'a Twilio account, which you can get for free');">a Twilio account, which you can get for free</a> if you don&#8217;t have one yet, and a <a href="https://www.twilio.com/console/phone-numbers/incoming" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/console/phone-numbers/incoming', 'Twilio number');">Twilio number</a> that is capable of making phone calls.</p>
<p>We&#8217;ll use the code from <a href="https://www.twilio.com/blog/2016/11/send-sms-messages-crystal.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/blog/2016/11/send-sms-messages-crystal.html', 'the previous post');">the previous post</a> as the starting point for this project. You can run through that post and learn <a href="https://www.twilio.com/blog/2016/11/send-sms-messages-crystal.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/blog/2016/11/send-sms-messages-crystal.html', 'how to send a text message with Crystal');">how to send a text message with Crystal</a> then come back here to make a call, or just <a href="https://github.com/philnash/crystal-experiments/blob/master/src/sms.cr" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/philnash/crystal-experiments/blob/master/src/sms.cr', 'grab that post&#8217;s completed code from GitHub');">grab that post&#8217;s completed code from GitHub</a>.</p>
<h3 id="h.hzzmho3xreeg">Making a phone call with Crystal</h3>
<p>Let&#8217;s start by creating a new Crystal file to write the code that will make phone calls.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c19af582999749" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
$ touch phone.cr</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c19af582999749-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c19af582999749-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-r">touch</span><span class="crayon-h"> </span><span class="crayon-v">phone</span><span class="crayon-e">.cr</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p>
<p>We&#8217;ll use the code we wrote in the <a href="https://github.com/philnash/crystal-experiments/blob/master/src/sms.cr" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/philnash/crystal-experiments/blob/master/src/sms.cr', 'sms.cr');"><code>sms.cr</code></a> file as the starting point for making phone calls so open that file and copy and paste the code from it into <code>phone.cr</code>.</p>
<p>Now we can make a few modifications so we&#8217;re making calls instead of sending messages.</p>
<p>First, make a simple JSON mapping for our call object. </p>
<p>Next, rename the function from <code>send_sms</code> to <code>make_calls</code> and change the last parameter from <code>body</code> to <code>url</code>.  The <code>url</code> will need to point to an application that can handle incoming HTTP requests. When the call connects, Twilio will make a request, known as a webhook, to the <code>url</code> to find out what to do next. We&#8217;ll see how that is implemented later.</p>
<p>Change the <code>post_form</code> URL so that we&#8217;re calling the <a href="https://www.twilio.com/docs/api/rest/making-calls" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/docs/api/rest/making-calls', 'Calls resource');">Calls resource</a>.</p>
<p>Finally parse the response from Twilio into a Call object. Here&#8217;s the completed code:</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c19c2869032632" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
require "http/client"
require "json"

class Call
  JSON.mapping(
    sid: String
  )
end

class Error
  JSON.mapping(
    message: String,
    status: Int32
  )
end

def make_call(to, from, url)
  client = HTTP::Client.new("api.twilio.com", 443, true) do |client|
    client.basic_auth(ENV["TWILIO_ACCOUNT_SID"], ENV["TWILIO_AUTH_TOKEN"])
    response = client.post_form("/2010-04-01/Accounts/#{ENV["TWILIO_ACCOUNT_SID"]}/Calls.json", {
      "To"   =&gt; to,
      "From" =&gt; from,
      "Url" =&gt; url,
    })
    if response.success?
      call = Call.from_json(response.body)
      puts call.sid
    else
      error = Error.from_json(response.body)
      puts error.status, error.message
    end
  end
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c19c2869032632-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-2">2</div><div class="crayon-num" data-line="crayon-58794ff5c19c2869032632-3">3</div><div class="crayon-num crayon-marked-num crayon-top crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-4">4</div><div class="crayon-num crayon-marked-num" data-line="crayon-58794ff5c19c2869032632-5">5</div><div class="crayon-num crayon-marked-num crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-6">6</div><div class="crayon-num crayon-marked-num" data-line="crayon-58794ff5c19c2869032632-7">7</div><div class="crayon-num crayon-marked-num crayon-bottom crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-8">8</div><div class="crayon-num" data-line="crayon-58794ff5c19c2869032632-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-10">10</div><div class="crayon-num" data-line="crayon-58794ff5c19c2869032632-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-12">12</div><div class="crayon-num" data-line="crayon-58794ff5c19c2869032632-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-14">14</div><div class="crayon-num" data-line="crayon-58794ff5c19c2869032632-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-16">16</div><div class="crayon-num crayon-marked-num crayon-top crayon-bottom" data-line="crayon-58794ff5c19c2869032632-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-18">18</div><div class="crayon-num" data-line="crayon-58794ff5c19c2869032632-19">19</div><div class="crayon-num crayon-marked-num crayon-top crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-20">20</div><div class="crayon-num crayon-marked-num" data-line="crayon-58794ff5c19c2869032632-21">21</div><div class="crayon-num crayon-marked-num crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-22">22</div><div class="crayon-num crayon-marked-num" data-line="crayon-58794ff5c19c2869032632-23">23</div><div class="crayon-num crayon-marked-num crayon-bottom crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-24">24</div><div class="crayon-num" data-line="crayon-58794ff5c19c2869032632-25">25</div><div class="crayon-num crayon-marked-num crayon-top crayon-bottom crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-26">26</div><div class="crayon-num" data-line="crayon-58794ff5c19c2869032632-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-28">28</div><div class="crayon-num" data-line="crayon-58794ff5c19c2869032632-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-30">30</div><div class="crayon-num" data-line="crayon-58794ff5c19c2869032632-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c19c2869032632-32">32</div><div class="crayon-num" data-line="crayon-58794ff5c19c2869032632-33">33</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c19c2869032632-1"><span class="crayon-i">require</span><span class="crayon-h"> </span><span class="crayon-s">"http/client"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c19c2869032632-2"><span class="crayon-i">require</span><span class="crayon-h"> </span><span class="crayon-s">"json"</span></div><div class="crayon-line" id="crayon-58794ff5c19c2869032632-3">&nbsp;</div><div class="crayon-line crayon-marked-line crayon-top crayon-striped-line" id="crayon-58794ff5c19c2869032632-4"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-i">Call</span></div><div class="crayon-line crayon-marked-line" id="crayon-58794ff5c19c2869032632-5"> <span class="crayon-h"> </span><span class="crayon-v">JSON</span><span class="crayon-sy">.</span><span class="crayon-e">mapping</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-marked-line crayon-striped-line" id="crayon-58794ff5c19c2869032632-6"> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-i">sid</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">String</span></div><div class="crayon-line crayon-marked-line" id="crayon-58794ff5c19c2869032632-7"> <span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-marked-line crayon-bottom crayon-striped-line" id="crayon-58794ff5c19c2869032632-8"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-58794ff5c19c2869032632-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c19c2869032632-10"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-i">Error</span></div><div class="crayon-line" id="crayon-58794ff5c19c2869032632-11"> <span class="crayon-h"> </span><span class="crayon-v">JSON</span><span class="crayon-sy">.</span><span class="crayon-e">mapping</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c19c2869032632-12"> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-i">message</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-58794ff5c19c2869032632-13"> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-i">status</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">Int32</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c19c2869032632-14"> <span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-58794ff5c19c2869032632-15"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c19c2869032632-16">&nbsp;</div><div class="crayon-line crayon-marked-line crayon-top crayon-bottom" id="crayon-58794ff5c19c2869032632-17"><span class="crayon-e">def </span><span class="crayon-e">make_call</span><span class="crayon-sy">(</span><span class="crayon-st">to</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">from</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">url</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c19c2869032632-18"> <span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">::</span><span class="crayon-v">Client</span><span class="crayon-sy">.</span><span class="crayon-e">new</span><span class="crayon-sy">(</span><span class="crayon-s">"api.twilio.com"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">443</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">do</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-i">client</span><span class="crayon-o">|</span></div><div class="crayon-line" id="crayon-58794ff5c19c2869032632-19"> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">basic_auth</span><span class="crayon-sy">(</span><span class="crayon-v">ENV</span><span class="crayon-sy">[</span><span class="crayon-s">"TWILIO_ACCOUNT_SID"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ENV</span><span class="crayon-sy">[</span><span class="crayon-s">"TWILIO_AUTH_TOKEN"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-marked-line crayon-top crayon-striped-line" id="crayon-58794ff5c19c2869032632-20"> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">post_form</span><span class="crayon-sy">(</span><span class="crayon-s">"/2010-04-01/Accounts/#{ENV["</span><span class="crayon-i">TWILIO_ACCOUNT_SID</span><span class="crayon-s">"]}/Calls.json"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-marked-line" id="crayon-58794ff5c19c2869032632-21"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"To"</span><span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-st">to</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-marked-line crayon-striped-line" id="crayon-58794ff5c19c2869032632-22"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"From"</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">from</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-marked-line" id="crayon-58794ff5c19c2869032632-23"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"Url"</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">url</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-marked-line crayon-bottom crayon-striped-line" id="crayon-58794ff5c19c2869032632-24"> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-58794ff5c19c2869032632-25"> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-i">success</span><span class="crayon-sy">?</span></div><div class="crayon-line crayon-marked-line crayon-top crayon-bottom crayon-striped-line" id="crayon-58794ff5c19c2869032632-26"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">call</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Call</span><span class="crayon-sy">.</span><span class="crayon-e">from_json</span><span class="crayon-sy">(</span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-i">body</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-58794ff5c19c2869032632-27"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-e">puts </span><span class="crayon-v">call</span><span class="crayon-sy">.</span><span class="crayon-i">sid</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c19c2869032632-28"> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">else</span></div><div class="crayon-line" id="crayon-58794ff5c19c2869032632-29"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Error</span><span class="crayon-sy">.</span><span class="crayon-e">from_json</span><span class="crayon-sy">(</span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-i">body</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c19c2869032632-30"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-e">puts </span><span class="crayon-v">error</span><span class="crayon-sy">.</span><span class="crayon-i">status</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-sy">.</span><span class="crayon-i">message</span></div><div class="crayon-line" id="crayon-58794ff5c19c2869032632-31"> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c19c2869032632-32"> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-58794ff5c19c2869032632-33"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0143 seconds] -->
<p></p>
<p>Add one final line to this file that calls <code>make_call</code> with your own phone number, your Twilio number and the URL set to <code>"https://dl.dropboxusercontent.com/u/2554/crystal-call.xml"</code>.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c19ce134739072" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
make_call(YOUR_NUMBER, YOUR_TWILIO_NUMBER, "https://dl.dropboxusercontent.com/u/2554/crystal-call.xml")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c19ce134739072-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c19ce134739072-1"><span class="crayon-e">make_call</span><span class="crayon-sy">(</span><span class="crayon-i">YOUR_NUMBER</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">YOUR_TWILIO_NUMBER</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"https://dl.dropboxusercontent.com/u/2554/crystal-call.xml"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p>
<p>Save the file, compile and run it.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c19d8127114614" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
$ crystal phone.cr</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c19d8127114614-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c19d8127114614-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">crystal </span><span class="crayon-v">phone</span><span class="crayon-e">.cr</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>You should receive a phone call which then tells you what to do next.</p>
<p>Hint: it tells you to read on.</p>
<p>We&#8217;ve made a call and responded to the incoming webhook using static TwiML. To make more interactive applications it would be better to create dynamic TwiML in Crystal. Let&#8217;s investigate how to do that, first with Crystal&#8217;s <code>HTTP::Server</code> class.</p>
<h3 id="h.9uqn9upy58ia">Building HTTP Servers in Crystal</h3>
<p>Create a new Crystal file for our server.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c19e2398939239" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
$ touch server.cr</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c19e2398939239-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c19e2398939239-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-r">touch</span><span class="crayon-h"> </span><span class="crayon-v">server</span><span class="crayon-e">.cr</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>Open that file and start by requiring the <code>http/server</code> module from the standard library.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c19ec895434844" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
require "http/server"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c19ec895434844-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c19ec895434844-1"><span class="crayon-i">require</span><span class="crayon-h"> </span><span class="crayon-s">"http/server"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p>The <code>HTTP::Server</code> is quite straightforward to get started with. Create an instance of <code>HTTP::Server</code> passing the port you want it to listen on. We also pass a block that will handle incoming requests.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c19f6959679083" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
require "http/server"

server = HTTP::Server.new(3000) do |context|

end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c19f6959679083-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c19f6959679083-2">2</div><div class="crayon-num" data-line="crayon-58794ff5c19f6959679083-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c19f6959679083-4">4</div><div class="crayon-num" data-line="crayon-58794ff5c19f6959679083-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c19f6959679083-1"><span class="crayon-i">require</span><span class="crayon-h"> </span><span class="crayon-s">"http/server"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c19f6959679083-2">&nbsp;</div><div class="crayon-line" id="crayon-58794ff5c19f6959679083-3"><span class="crayon-v">server</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">::</span><span class="crayon-v">Server</span><span class="crayon-sy">.</span><span class="crayon-e">new</span><span class="crayon-sy">(</span><span class="crayon-cn">3000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">do</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-i">context</span><span class="crayon-o">|</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c19f6959679083-4">&nbsp;</div><div class="crayon-line" id="crayon-58794ff5c19f6959679083-5"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0016 seconds] -->
<p></p>
<p>The <code>context</code> is an <a href="https://crystal-lang.org/api/0.20.0/HTTP/Server/Context.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://crystal-lang.org/api/0.20.0/HTTP/Server/Context.html', 'http://www.twilio.com/blog/2016/12/:Server::Context');"><code>HTTP::Server::Context</code></a> that is passed to our handler when the server receives a request. It has references to request and response objects. We can use the response to set the content type to <code>text/xml</code> as we&#8217;ll be returning TwiML.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a00688527497" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
require "http/server"

server = HTTP::Server.new(3000) do |context|
  context.response.content_type = "text/xml" 
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a00688527497-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a00688527497-2">2</div><div class="crayon-num" data-line="crayon-58794ff5c1a00688527497-3">3</div><div class="crayon-num crayon-marked-num crayon-top crayon-bottom crayon-striped-num" data-line="crayon-58794ff5c1a00688527497-4">4</div><div class="crayon-num" data-line="crayon-58794ff5c1a00688527497-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a00688527497-1"><span class="crayon-i">require</span><span class="crayon-h"> </span><span class="crayon-s">"http/server"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a00688527497-2">&nbsp;</div><div class="crayon-line" id="crayon-58794ff5c1a00688527497-3"><span class="crayon-v">server</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">::</span><span class="crayon-v">Server</span><span class="crayon-sy">.</span><span class="crayon-e">new</span><span class="crayon-sy">(</span><span class="crayon-cn">3000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">do</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-i">context</span><span class="crayon-o">|</span></div><div class="crayon-line crayon-marked-line crayon-top crayon-bottom crayon-striped-line" id="crayon-58794ff5c1a00688527497-4"> <span class="crayon-h"> </span><span class="crayon-v">context</span><span class="crayon-sy">.</span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-v">content_type</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"text/xml"</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-58794ff5c1a00688527497-5"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p></p>
<p>Then, for the purposes of this post, we can print our TwiML straight to the response too. To show that this is creating the TwiML dynamically we&#8217;ll print a message that will change over time.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a0a896248466" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
require "http/server"

server = HTTP::Server.new(3000) do |context|
  context.response.content_type = "text/xml" 
  time = Time.now
  message = if time.hour &lt; 12
              "Good morning"
            elsif time.hour &lt; 18
              "Good afternoon"
            else
              "Good night"
            end
  context.response.print "&lt;Response&gt;&lt;Say&gt;#{message} from Crystal!&lt;/Say&gt;&lt;/Response&gt;"
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a0a896248466-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a0a896248466-2">2</div><div class="crayon-num" data-line="crayon-58794ff5c1a0a896248466-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a0a896248466-4">4</div><div class="crayon-num crayon-marked-num crayon-top" data-line="crayon-58794ff5c1a0a896248466-5">5</div><div class="crayon-num crayon-marked-num crayon-striped-num" data-line="crayon-58794ff5c1a0a896248466-6">6</div><div class="crayon-num crayon-marked-num" data-line="crayon-58794ff5c1a0a896248466-7">7</div><div class="crayon-num crayon-marked-num crayon-striped-num" data-line="crayon-58794ff5c1a0a896248466-8">8</div><div class="crayon-num crayon-marked-num" data-line="crayon-58794ff5c1a0a896248466-9">9</div><div class="crayon-num crayon-marked-num crayon-striped-num" data-line="crayon-58794ff5c1a0a896248466-10">10</div><div class="crayon-num crayon-marked-num" data-line="crayon-58794ff5c1a0a896248466-11">11</div><div class="crayon-num crayon-marked-num crayon-striped-num" data-line="crayon-58794ff5c1a0a896248466-12">12</div><div class="crayon-num crayon-marked-num crayon-bottom" data-line="crayon-58794ff5c1a0a896248466-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a0a896248466-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a0a896248466-1"><span class="crayon-i">require</span><span class="crayon-h"> </span><span class="crayon-s">"http/server"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a0a896248466-2">&nbsp;</div><div class="crayon-line" id="crayon-58794ff5c1a0a896248466-3"><span class="crayon-v">server</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">::</span><span class="crayon-v">Server</span><span class="crayon-sy">.</span><span class="crayon-e">new</span><span class="crayon-sy">(</span><span class="crayon-cn">3000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">do</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-i">context</span><span class="crayon-o">|</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a0a896248466-4"> <span class="crayon-h"> </span><span class="crayon-v">context</span><span class="crayon-sy">.</span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-v">content_type</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"text/xml"</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-marked-line crayon-top" id="crayon-58794ff5c1a0a896248466-5"> <span class="crayon-h"> </span><span class="crayon-v">time</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Time</span><span class="crayon-sy">.</span><span class="crayon-i">now</span></div><div class="crayon-line crayon-marked-line crayon-striped-line" id="crayon-58794ff5c1a0a896248466-6"> <span class="crayon-h"> </span><span class="crayon-v">message</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-i">hour</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line crayon-marked-line" id="crayon-58794ff5c1a0a896248466-7"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"Good morning"</span></div><div class="crayon-line crayon-marked-line crayon-striped-line" id="crayon-58794ff5c1a0a896248466-8"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-e">elsif </span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-i">hour</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">18</span></div><div class="crayon-line crayon-marked-line" id="crayon-58794ff5c1a0a896248466-9"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"Good afternoon"</span></div><div class="crayon-line crayon-marked-line crayon-striped-line" id="crayon-58794ff5c1a0a896248466-10"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">else</span></div><div class="crayon-line crayon-marked-line" id="crayon-58794ff5c1a0a896248466-11"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"Good night"</span></div><div class="crayon-line crayon-marked-line crayon-striped-line" id="crayon-58794ff5c1a0a896248466-12"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line crayon-marked-line crayon-bottom" id="crayon-58794ff5c1a0a896248466-13"> <span class="crayon-h"> </span><span class="crayon-v">context</span><span class="crayon-sy">.</span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"&lt;Response&gt;&lt;Say&gt;#{message} from Crystal!&lt;/Say&gt;&lt;/Response&gt;"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a0a896248466-14"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0070 seconds] -->
<p></p>
<p>To finish up with this very simple server we need to tell the server to start listening for incoming connections. We also print a message to the terminal so that we can see the server has started.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a14400508558" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
require "http/server"

server = HTTP::Server.new(3000) do |context|
  context.response.content_type = "text/xml"
  time = Time.now
  message = if time.hour &lt; 12
              "Good morning"
            elsif time.hour &lt; 18
              "Good afternoon"
            else
              "Good night"
            end
  context.response.print "&lt;Response&gt;&lt;Say&gt;#{message} from Crystal!&lt;/Say&gt;&lt;/Response&gt;"
end

puts "Listening on http://0.0.0.0:3000"
server.listen</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a14400508558-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a14400508558-2">2</div><div class="crayon-num" data-line="crayon-58794ff5c1a14400508558-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a14400508558-4">4</div><div class="crayon-num" data-line="crayon-58794ff5c1a14400508558-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a14400508558-6">6</div><div class="crayon-num" data-line="crayon-58794ff5c1a14400508558-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a14400508558-8">8</div><div class="crayon-num" data-line="crayon-58794ff5c1a14400508558-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a14400508558-10">10</div><div class="crayon-num" data-line="crayon-58794ff5c1a14400508558-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a14400508558-12">12</div><div class="crayon-num" data-line="crayon-58794ff5c1a14400508558-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a14400508558-14">14</div><div class="crayon-num" data-line="crayon-58794ff5c1a14400508558-15">15</div><div class="crayon-num crayon-marked-num crayon-top crayon-striped-num" data-line="crayon-58794ff5c1a14400508558-16">16</div><div class="crayon-num crayon-marked-num crayon-bottom" data-line="crayon-58794ff5c1a14400508558-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a14400508558-1"><span class="crayon-i">require</span><span class="crayon-h"> </span><span class="crayon-s">"http/server"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a14400508558-2">&nbsp;</div><div class="crayon-line" id="crayon-58794ff5c1a14400508558-3"><span class="crayon-v">server</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">::</span><span class="crayon-v">Server</span><span class="crayon-sy">.</span><span class="crayon-e">new</span><span class="crayon-sy">(</span><span class="crayon-cn">3000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">do</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-i">context</span><span class="crayon-o">|</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a14400508558-4"> <span class="crayon-h"> </span><span class="crayon-v">context</span><span class="crayon-sy">.</span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-v">content_type</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"text/xml"</span></div><div class="crayon-line" id="crayon-58794ff5c1a14400508558-5"> <span class="crayon-h"> </span><span class="crayon-v">time</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Time</span><span class="crayon-sy">.</span><span class="crayon-i">now</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a14400508558-6"> <span class="crayon-h"> </span><span class="crayon-v">message</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-i">hour</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line" id="crayon-58794ff5c1a14400508558-7"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"Good morning"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a14400508558-8"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-e">elsif </span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-i">hour</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">18</span></div><div class="crayon-line" id="crayon-58794ff5c1a14400508558-9"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"Good afternoon"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a14400508558-10"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">else</span></div><div class="crayon-line" id="crayon-58794ff5c1a14400508558-11"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"Good night"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a14400508558-12"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-58794ff5c1a14400508558-13"> <span class="crayon-h"> </span><span class="crayon-v">context</span><span class="crayon-sy">.</span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"&lt;Response&gt;&lt;Say&gt;#{message} from Crystal!&lt;/Say&gt;&lt;/Response&gt;"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a14400508558-14"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-58794ff5c1a14400508558-15">&nbsp;</div><div class="crayon-line crayon-marked-line crayon-top crayon-striped-line" id="crayon-58794ff5c1a14400508558-16"><span class="crayon-i">puts</span><span class="crayon-h"> </span><span class="crayon-s">"Listening on http://0.0.0.0:3000"</span></div><div class="crayon-line crayon-marked-line crayon-bottom" id="crayon-58794ff5c1a14400508558-17"><span class="crayon-v">server</span><span class="crayon-sy">.</span><span class="crayon-i">listen</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0077 seconds] -->
<p></p>
<p>Compile and run the server:</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a1e303477644" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
$ crystal server.cr</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a1e303477644-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a1e303477644-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">crystal </span><span class="crayon-v">server</span><span class="crayon-e">.cr</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>Open your browser to <a href="http://localhost:3000/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://localhost:3000/', 'http://localhost:3000/');">http://localhost:3000</a> and you&#8217;ll see your TwiML. We can now use this server to drive our call. To do so, we need to open up our development server to external requests. <a href="https://www.twilio.com/blog/2015/09/6-awesome-reasons-to-use-ngrok-when-testing-webhooks.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/blog/2015/09/6-awesome-reasons-to-use-ngrok-when-testing-webhooks.html', 'I like to do this with ngrok, you can find out how to install and use it here');">I like to do this with ngrok, you can find out how to install and use it here</a>. If you have ngrok setup open up a tunnel to port 3000.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a28612925902" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
$ ngrok http 3000</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a28612925902-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a28612925902-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">ngrok </span><span class="crayon-i">http</span><span class="crayon-h"> </span><span class="crayon-cn">3000</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>Copy your ngrok URL and open up <code>phone.cr</code> again. Replace the DropBox link in the call to <code>make_call</code> with your ngrok URL and compile and run <code>phone.cr</code> again.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a32091549470" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
$ crystal phone.cr</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a32091549470-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a32091549470-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">crystal </span><span class="crayon-v">phone</span><span class="crayon-e">.cr</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>This time when your phone rings you&#8217;ll hear the message you wrote in <code>server.cr</code>.</p>
<h3 id="h.8omcni46b3yl">Better servers</h3>
<p>We&#8217;ve built a very primitive server so far using the standard library. We could do the work to build in support for dynamic paths, body parsing, HTTP verbs, etc, but as in any language, it&#8217;s good to see what the community has provided. Crystal comes with an integrated package manager and there are already <a href="http://crystalshards.xyz/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://crystalshards.xyz/', 'a number of packages, known as shards, available');">a number of packages, known as shards, available</a>. </p>
<p>To improve our server offering, we&#8217;re going to replace our basic HTTP server with <a href="http://kemalcr.com/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://kemalcr.com/', 'Kemal');">Kemal</a>, the Crystal equivalent of Ruby&#8217;s <a href="http://www.sinatrarb.com/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.sinatrarb.com/', 'Sinatra');">Sinatra</a>.</p>
<p>This time, we&#8217;re going to generate our project with Crystal&#8217;s <code>init</code> tool. You can initialise an app or a library, we want an app for now.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a3d987576240" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
$ crystal init app phone_server
$ cd phone_server
$ ls
LICENSE        README.md         shard.yml        spec        src</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a3d987576240-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a3d987576240-2">2</div><div class="crayon-num" data-line="crayon-58794ff5c1a3d987576240-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a3d987576240-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a3d987576240-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">crystal </span><span class="crayon-e">init </span><span class="crayon-e">app </span><span class="crayon-i">phone_server</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a3d987576240-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-r">cd</span><span class="crayon-h"> </span><span class="crayon-i">phone_server</span></div><div class="crayon-line" id="crayon-58794ff5c1a3d987576240-3"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-r">ls</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a3d987576240-4"><span class="crayon-i">LICENSE</span><span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-v">README</span><span class="crayon-e">.md</span><span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">shard</span><span class="crayon-e">.yml</span><span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-i">spec</span><span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-i">src</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0028 seconds] -->
<p></p>
<p><code>init</code> gives us a basic project structure including a <code>shard.yml</code> file. Open that up and add the dependency on Kemal.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a47455424805" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">YAML</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
name: phone_server
version: 0.1.0

license: MIT

dependencies:
  kemal:
    github: kemalcr/kemal
    branch: master</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a47455424805-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a47455424805-2">2</div><div class="crayon-num" data-line="crayon-58794ff5c1a47455424805-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a47455424805-4">4</div><div class="crayon-num" data-line="crayon-58794ff5c1a47455424805-5">5</div><div class="crayon-num crayon-marked-num crayon-top crayon-striped-num" data-line="crayon-58794ff5c1a47455424805-6">6</div><div class="crayon-num crayon-marked-num" data-line="crayon-58794ff5c1a47455424805-7">7</div><div class="crayon-num crayon-marked-num crayon-striped-num" data-line="crayon-58794ff5c1a47455424805-8">8</div><div class="crayon-num crayon-marked-num crayon-bottom" data-line="crayon-58794ff5c1a47455424805-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a47455424805-1"><span class="crayon-s ">name</span><span class="">: phone_server</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a47455424805-2"><span class="crayon-s ">version</span><span class="">: 0.1.0</span></div><div class="crayon-line" id="crayon-58794ff5c1a47455424805-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a47455424805-4"><span class="crayon-s ">license</span><span class="">: MIT</span></div><div class="crayon-line" id="crayon-58794ff5c1a47455424805-5">&nbsp;</div><div class="crayon-line crayon-marked-line crayon-top crayon-striped-line" id="crayon-58794ff5c1a47455424805-6"><span class="crayon-s ">dependencies</span><span class="">:</span></div><div class="crayon-line crayon-marked-line" id="crayon-58794ff5c1a47455424805-7"> <span class="crayon-h"> </span><span class="crayon-s ">kemal</span><span class="">:</span></div><div class="crayon-line crayon-marked-line crayon-striped-line" id="crayon-58794ff5c1a47455424805-8"> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s ">github</span><span class="">: kemalcr/kemal</span></div><div class="crayon-line crayon-marked-line crayon-bottom" id="crayon-58794ff5c1a47455424805-9"> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s ">branch</span><span class="">: master</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p></p>
<p>On the command line install the dependencies:</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a51530927843" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
$ shards install</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a51530927843-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a51530927843-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">shards </span><span class="crayon-i">install</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p>Open up <code>src/phone_server.cr</code>. and replace everything in the file with:</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a5b026897616" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
require "kemal"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a5b026897616-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a5b026897616-1"><span class="crayon-i">require</span><span class="crayon-h"> </span><span class="crayon-s">"kemal"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p>By default Twilio makes webhooks via POST request. In Kemal we define routes by the HTTP verb that we want to handle, our simple <code>HTTP::Server</code> responded to everything. To handle the webhook create an endpoint for a POST request at &#8220;/voice&#8221;. Handlers in Kemal get a similar context object to the <code>HTTP::Server</code>.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a65468152932" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
require "kemal"

post "/voice" do |context|

end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a65468152932-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a65468152932-2">2</div><div class="crayon-num crayon-marked-num crayon-top" data-line="crayon-58794ff5c1a65468152932-3">3</div><div class="crayon-num crayon-marked-num crayon-striped-num" data-line="crayon-58794ff5c1a65468152932-4">4</div><div class="crayon-num crayon-marked-num crayon-bottom" data-line="crayon-58794ff5c1a65468152932-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a65468152932-1"><span class="crayon-i">require</span><span class="crayon-h"> </span><span class="crayon-s">"kemal"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a65468152932-2">&nbsp;</div><div class="crayon-line crayon-marked-line crayon-top" id="crayon-58794ff5c1a65468152932-3"><span class="crayon-i">post</span><span class="crayon-h"> </span><span class="crayon-s">"/voice"</span><span class="crayon-h"> </span><span class="crayon-st">do</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-i">context</span><span class="crayon-o">|</span></div><div class="crayon-line crayon-marked-line crayon-striped-line" id="crayon-58794ff5c1a65468152932-4">&nbsp;</div><div class="crayon-line crayon-marked-line crayon-bottom" id="crayon-58794ff5c1a65468152932-5"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p></p>
<p>We can use the response property of the context to set headers.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a6f035926283" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
require "kemal"

post "/voice" do |context|
  context.response.content_type = "text/xml"
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a6f035926283-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a6f035926283-2">2</div><div class="crayon-num" data-line="crayon-58794ff5c1a6f035926283-3">3</div><div class="crayon-num crayon-marked-num crayon-top crayon-bottom crayon-striped-num" data-line="crayon-58794ff5c1a6f035926283-4">4</div><div class="crayon-num" data-line="crayon-58794ff5c1a6f035926283-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a6f035926283-1"><span class="crayon-i">require</span><span class="crayon-h"> </span><span class="crayon-s">"kemal"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a6f035926283-2">&nbsp;</div><div class="crayon-line" id="crayon-58794ff5c1a6f035926283-3"><span class="crayon-i">post</span><span class="crayon-h"> </span><span class="crayon-s">"/voice"</span><span class="crayon-h"> </span><span class="crayon-st">do</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-i">context</span><span class="crayon-o">|</span></div><div class="crayon-line crayon-marked-line crayon-top crayon-bottom crayon-striped-line" id="crayon-58794ff5c1a6f035926283-4"> <span class="crayon-h"> </span><span class="crayon-v">context</span><span class="crayon-sy">.</span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-v">content_type</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"text/xml"</span></div><div class="crayon-line" id="crayon-58794ff5c1a6f035926283-5"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p></p>
<p>Then we just need to return our TwiML as we did in the plain <code>HTTP::Server</code> example.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a79329141887" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
require "kemal"

post "/voice" do |context|
  context.response.content_type = "text/xml"
  time = Time.now
  message = if time.hour &lt; 12
              "Good morning"
            elsif time.hour &lt; 18
              "Good afternoon"
            else
              "Good night"
            end
  "&lt;?xml version="1.0" encoding="UTF-8"?&gt;
  &lt;Response&gt;
    &lt;Say&gt;#{message} from Kemal and Crystal!&lt;/Say&gt;
  &lt;/Response&gt;"
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a79329141887-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a79329141887-2">2</div><div class="crayon-num" data-line="crayon-58794ff5c1a79329141887-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a79329141887-4">4</div><div class="crayon-num" data-line="crayon-58794ff5c1a79329141887-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a79329141887-6">6</div><div class="crayon-num" data-line="crayon-58794ff5c1a79329141887-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a79329141887-8">8</div><div class="crayon-num" data-line="crayon-58794ff5c1a79329141887-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a79329141887-10">10</div><div class="crayon-num" data-line="crayon-58794ff5c1a79329141887-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a79329141887-12">12</div><div class="crayon-num" data-line="crayon-58794ff5c1a79329141887-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a79329141887-14">14</div><div class="crayon-num" data-line="crayon-58794ff5c1a79329141887-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a79329141887-16">16</div><div class="crayon-num" data-line="crayon-58794ff5c1a79329141887-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a79329141887-1"><span class="crayon-i">require</span><span class="crayon-h"> </span><span class="crayon-s">"kemal"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a79329141887-2">&nbsp;</div><div class="crayon-line" id="crayon-58794ff5c1a79329141887-3"><span class="crayon-i">post</span><span class="crayon-h"> </span><span class="crayon-s">"/voice"</span><span class="crayon-h"> </span><span class="crayon-st">do</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-i">context</span><span class="crayon-o">|</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a79329141887-4"> <span class="crayon-h"> </span><span class="crayon-v">context</span><span class="crayon-sy">.</span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-v">content_type</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"text/xml"</span></div><div class="crayon-line" id="crayon-58794ff5c1a79329141887-5"> <span class="crayon-h"> </span><span class="crayon-v">time</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Time</span><span class="crayon-sy">.</span><span class="crayon-i">now</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a79329141887-6"> <span class="crayon-h"> </span><span class="crayon-v">message</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-i">hour</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line" id="crayon-58794ff5c1a79329141887-7"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"Good morning"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a79329141887-8"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-e">elsif </span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-i">hour</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">18</span></div><div class="crayon-line" id="crayon-58794ff5c1a79329141887-9"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"Good afternoon"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a79329141887-10"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">else</span></div><div class="crayon-line" id="crayon-58794ff5c1a79329141887-11"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"Good night"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a79329141887-12"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-58794ff5c1a79329141887-13"> <span class="crayon-h"> </span><span class="crayon-s">"<span class="crayon-ta">&lt;?</span><span class="crayon-e">xml </span><span class="crayon-i">version</span><span class="crayon-o">=</span><span class="crayon-s">"1.0"</span><span class="crayon-h"> </span><span class="crayon-i">encoding</span><span class="crayon-o">=</span><span class="crayon-s">"UTF-8"</span><span class="crayon-ta">?&gt;</span></span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a79329141887-14"><span class="crayon-s">  &lt;Response&gt;</span></div><div class="crayon-line" id="crayon-58794ff5c1a79329141887-15"><span class="crayon-s">    &lt;Say&gt;#{message} from Kemal and Crystal!&lt;/Say&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a79329141887-16"><span class="crayon-s">  &lt;/Response&gt;"</span></div><div class="crayon-line" id="crayon-58794ff5c1a79329141887-17"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0113 seconds] -->
<p></p>
<p>And finally run Kemal.</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a83691651328" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
require "kemal"

post "/voice" do |context|
  context.response.content_type = "text/xml"
  time = Time.now
  message = if time.hour &lt; 12
              "Good morning"
            elsif time.hour &lt; 18
              "Good afternoon"
            else
              "Good night"
            end
  "&lt;?xml version="1.0" encoding="UTF-8"?&gt;
  &lt;Response&gt;
    &lt;Say&gt;#{message} from Kemal and Crystal!&lt;/Say&gt;
  &lt;/Response&gt;"
end

Kemal.run</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a83691651328-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a83691651328-2">2</div><div class="crayon-num" data-line="crayon-58794ff5c1a83691651328-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a83691651328-4">4</div><div class="crayon-num" data-line="crayon-58794ff5c1a83691651328-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a83691651328-6">6</div><div class="crayon-num" data-line="crayon-58794ff5c1a83691651328-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a83691651328-8">8</div><div class="crayon-num" data-line="crayon-58794ff5c1a83691651328-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a83691651328-10">10</div><div class="crayon-num" data-line="crayon-58794ff5c1a83691651328-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a83691651328-12">12</div><div class="crayon-num" data-line="crayon-58794ff5c1a83691651328-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a83691651328-14">14</div><div class="crayon-num" data-line="crayon-58794ff5c1a83691651328-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a83691651328-16">16</div><div class="crayon-num" data-line="crayon-58794ff5c1a83691651328-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a83691651328-18">18</div><div class="crayon-num crayon-marked-num crayon-top crayon-bottom" data-line="crayon-58794ff5c1a83691651328-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a83691651328-1"><span class="crayon-i">require</span><span class="crayon-h"> </span><span class="crayon-s">"kemal"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a83691651328-2">&nbsp;</div><div class="crayon-line" id="crayon-58794ff5c1a83691651328-3"><span class="crayon-i">post</span><span class="crayon-h"> </span><span class="crayon-s">"/voice"</span><span class="crayon-h"> </span><span class="crayon-st">do</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-i">context</span><span class="crayon-o">|</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a83691651328-4"> <span class="crayon-h"> </span><span class="crayon-v">context</span><span class="crayon-sy">.</span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-v">content_type</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"text/xml"</span></div><div class="crayon-line" id="crayon-58794ff5c1a83691651328-5"> <span class="crayon-h"> </span><span class="crayon-v">time</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Time</span><span class="crayon-sy">.</span><span class="crayon-i">now</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a83691651328-6"> <span class="crayon-h"> </span><span class="crayon-v">message</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-i">hour</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line" id="crayon-58794ff5c1a83691651328-7"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"Good morning"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a83691651328-8"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-e">elsif </span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-i">hour</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">18</span></div><div class="crayon-line" id="crayon-58794ff5c1a83691651328-9"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"Good afternoon"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a83691651328-10"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">else</span></div><div class="crayon-line" id="crayon-58794ff5c1a83691651328-11"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-s">"Good night"</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a83691651328-12"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-58794ff5c1a83691651328-13"> <span class="crayon-h"> </span><span class="crayon-s">"<span class="crayon-ta">&lt;?</span><span class="crayon-e">xml </span><span class="crayon-i">version</span><span class="crayon-o">=</span><span class="crayon-s">"1.0"</span><span class="crayon-h"> </span><span class="crayon-i">encoding</span><span class="crayon-o">=</span><span class="crayon-s">"UTF-8"</span><span class="crayon-ta">?&gt;</span></span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a83691651328-14"><span class="crayon-s">  &lt;Response&gt;</span></div><div class="crayon-line" id="crayon-58794ff5c1a83691651328-15"><span class="crayon-s">    &lt;Say&gt;#{message} from Kemal and Crystal!&lt;/Say&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a83691651328-16"><span class="crayon-s">  &lt;/Response&gt;"</span></div><div class="crayon-line" id="crayon-58794ff5c1a83691651328-17"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a83691651328-18">&nbsp;</div><div class="crayon-line crayon-marked-line crayon-top crayon-bottom" id="crayon-58794ff5c1a83691651328-19"><span class="crayon-v">Kemal</span><span class="crayon-sy">.</span><span class="crayon-i">run</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0070 seconds] -->
<p></p>
<p>If you haven&#8217;t already, stop your old server with Ctrl C. Now compile and run the new, Kemal based server:</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a8d249857932" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
$ crystal src/phone_server.cr
[development] Kemal is ready to lead at http://0.0.0.0:3000</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a8d249857932-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794ff5c1a8d249857932-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a8d249857932-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">crystal </span><span class="crayon-i">src</span><span class="crayon-o">/</span><span class="crayon-v">phone_server</span><span class="crayon-e">.cr</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794ff5c1a8d249857932-2"><span class="crayon-sy">[</span><span class="crayon-i">development</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">Kemal </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">ready </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">lead </span><span class="crayon-r">at</span><span class="crayon-h"> </span><span class="crayon-i">http</span><span class="crayon-o">:</span><span class="crayon-c">//0.0.0.0:3000</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p></p>
<p>Hopefully you still have ngrok running, otherwise start it again and copy the ngrok URL to your <code>make_call</code> function in <code>phone.cr</code>. Make sure to add the &#8220;/voice&#8221; path this time. Your URL should look like, &#8220;<a href="http://random.ngrok.io/voice" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://random.ngrok.io/voice', 'http://random.ngrok.io/voice');">http://RANDOM.ngrok.io/voice</a>&#8220;.</p>
<p>Compile and run <code>phone.cr</code> once more. This time when you answer your ringing phone you will hear the message you wrote in your Kemal server.</p>
<h3 id="h.neki224ju6ek">I told you it was fast</h3>
<p>I mentioned in my first post on Crystal that it is blazingly fast. Before you kill your Kemal server I want you to take a note of the response time it reported. Here&#8217;s what I saw:</p>
<p><img alt="The server logs show that the request was served in 54 micro seconds." src="https://www.twilio.com/blog/wp-content/uploads/2016/12/MoNIbOHfYSM8J7vB1ERXGeiMifhjbFyM9tkyBwDlfs3pUyQgY9bF_5FW4UUyekgg10S-6h7e9WAqv5nb0aQOEgxtZcayjWTjKA3jPpoV4jcu0OJA3bao_EQtSzlGg7QUGagoojc.png" class="aligncenter"></p>
<p>Yes, that says 54 micro seconds. I realise this endpoint is very simple, but that sort of raw performance from a framework does impress me. That&#8217;s not all though. This was compiled in debug mode. Compile the application for release with:</p>
<p></p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794ff5c1a98576109906" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
$ crystal build src/phone_server.cr —release</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794ff5c1a98576109906-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794ff5c1a98576109906-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">crystal </span><span class="crayon-e">build </span><span class="crayon-i">src</span><span class="crayon-o">/</span><span class="crayon-v">phone_server</span><span class="crayon-e">.cr</span><span class="crayon-h"> </span>—<span class="crayon-i">release</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p></p>
<p>And then run the executable and things can get even quicker.</p>
<p><img alt="A few runs of the server compiled in release mode show response times of between 22 and 48 micro seconds." src="https://www.twilio.com/blog/wp-content/uploads/2016/12/9vAmf8IVXpxqzEyVJw9_dMR3iJoC9UuHX28flUH-DBpvjowP7HPqYkg9BcylctIV0Tt8DHsJ11VmmeHh9K_KRZ0NU81Q8ze_qruXXKkMhQvf7bk0WhazS3PaO1_fKBPTeHGtCfk.png" class="aligncenter"></p>
<h3 id="h.7uobnqlb0mj5">Take Crystal for a spin</h3>
<p>So there we have it, we&#8217;ve sent <a href="https://www.twilio.com/blog/2016/11/send-sms-messages-crystal.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/blog/2016/11/send-sms-messages-crystal.html', 'SMS messages');">SMS messages</a> and made phone calls with Crystal. We&#8217;ve seen a bit on how to use the <code>HTTP::Client</code>, JSON mappings, the <code>HTTP::Server</code>, shards and Kemal. You can check out all the code we wrote in both blog posts in <a href="https://github.com/philnash/crystal-experiments" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/philnash/crystal-experiments', 'this GitHub repo');">this GitHub repo</a>.</p>
<p>If you want to explore Crystal more then take a look through <a href="https://crystal-lang.org/docs/" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://crystal-lang.org/docs/', 'the documentation');">the documentation</a>, the <a href="https://crystal-lang.org/api/0.19.4/" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://crystal-lang.org/api/0.19.4/', 'standard library');">standard library</a>, <a href="http://kemalcr.com/docs/getting_started/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://kemalcr.com/docs/getting_started/', 'Kemal&#8217;s documentation');">Kemal&#8217;s documentation</a>, the list of available <a href="http://crystalshards.xyz/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://crystalshards.xyz/', 'CrystalShards');">CrystalShards</a>, or even the <a href="https://github.com/crystal-lang/crystal" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/crystal-lang/crystal', 'source code for Crystal');">source code for Crystal</a> (it&#8217;s all written in Crystal!).</p>
<p>Like the look of Crystal? Let me know in the comments below or drop me an <a href="mailto:philnash@twilio.com">email</a> or a note on Twitter at <a href="https://twitter.com/philnash" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://twitter.com/philnash', '@philnash');">@philnash</a>.</p>
			</div>
					</div>
	</div><!-- .entry-content -->

	<footer class="entry-footer col-md-12">
		<div class="entry-meta">
					<div class="social-buttons">
			<div class="fb-like" data-href="https://www.twilio.com/blog/2016/12/make-phone-calls-crystal-twilio.html" data-layout="button" data-action="like" data-show-faces="false" data-share="false"></div>
			<a href="https://twitter.com/share" class="twitter-share-button" data-via="twilio" data-count="none" data-url="https://www.twilio.com/blog/2016/12/make-phone-calls-crystal-twilio.html" data-text="Make Phone Calls with Crystal and Twilio ">Tweet</a>
      <a href="https://twitter.com/twilio" class="twitter-follow-button" data-show-count="false">Follow @twilio</a>
		</div>
<span class="author-avatar"><img alt='' src='https://secure.gravatar.com/avatar/79fac5826d02217e841fd2354db2ae37?s=20&amp;d=mm&amp;r=g' srcset='https://secure.gravatar.com/avatar/79fac5826d02217e841fd2354db2ae37?s=40&amp;d=mm&amp;r=g 2x' class='avatar avatar-20 photo' height='20' width='20' /></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://www.twilio.com/blog/author/phil">Phil Nash</a></span></span> <span class="author-meta author-email"><a href="mailto:pnash@twilio.com">pnash@twilio.com</a></span><span class="author-meta author-twitter"><a href="http://twitter.com/philnash">@philnash<a/></span>		</div>
	</footer><!-- .entry-footer -->

   <div class="build-more"><h3>Use Twilio Tutorials to Start Building</h3>         <a href="https://www.twilio.com/docs/tutorials/walkthrough/call-tracking/php/laravel" onclick="__gaTracker('send', 'event', 'startbuilding-widget', 'https://www.twilio.com/docs/tutorials/walkthrough/call-tracking/php/laravel', '');">
          <h5>Call Tracking</h5>
        </a>
         <a href="https://www.twilio.com/docs/tutorials/walkthrough/server-notifications/php/laravel" onclick="__gaTracker('send', 'event', 'startbuilding-widget', 'https://www.twilio.com/docs/tutorials/walkthrough/server-notifications/php/laravel', '');">
          <h5>SMS and MMS Notifications</h5>
        </a>
         <a href="https://www.twilio.com/docs/tutorials/walkthrough/two-factor-authentication/php/laravel" onclick="__gaTracker('send', 'event', 'startbuilding-widget', 'https://www.twilio.com/docs/tutorials/walkthrough/two-factor-authentication/php/laravel', '');">
          <h5>Two-Factor Authentication with Authy</h5>
        </a>
      
</article><!-- #post-## -->

			
<div id="disqus_thread">
                    <div id="dsq-content">


            <ul id="dsq-comments">
                    <li class="comment even thread-even depth-1" id="dsq-comment-4524">
        <div id="dsq-comment-header-4524" class="dsq-comment-header">
            <cite id="dsq-cite-4524">
                <span id="dsq-author-user-4524">sdogruyol</span>
            </cite>
        </div>
        <div id="dsq-comment-body-4524" class="dsq-comment-body">
            <div id="dsq-comment-message-4524" class="dsq-comment-message"><p>Awesome post! Just a quick note that kemal has moved under kemal organization so you need to use kemalcr/kemal in your shard.yml file :)</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-2" id="dsq-comment-4527">
        <div id="dsq-comment-header-4527" class="dsq-comment-header">
            <cite id="dsq-cite-4527">
http://twitter.com/philnash                <span id="dsq-author-user-4527">philnash</span>
            </cite>
        </div>
        <div id="dsq-comment-body-4527" class="dsq-comment-body">
            <div id="dsq-comment-message-4527" class="dsq-comment-message"><p>Thanks! I have updated.</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-4525">
        <div id="dsq-comment-header-4525" class="dsq-comment-header">
            <cite id="dsq-cite-4525">
https://aligoren.com                <span id="dsq-author-user-4525">Ali</span>
            </cite>
        </div>
        <div id="dsq-comment-body-4525" class="dsq-comment-body">
            <div id="dsq-comment-message-4525" class="dsq-comment-message"><p>Wow! i like this post. Thanks :)</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-2" id="dsq-comment-4528">
        <div id="dsq-comment-header-4528" class="dsq-comment-header">
            <cite id="dsq-cite-4528">
http://twitter.com/philnash                <span id="dsq-author-user-4528">philnash</span>
            </cite>
        </div>
        <div id="dsq-comment-body-4528" class="dsq-comment-body">
            <div id="dsq-comment-message-4528" class="dsq-comment-message"><p>Glad to hear it Ali. Let me know if you build something cool with it!</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
            </ul>


        </div>

    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'https://www.twilio.com/blog/2016/12/make-phone-calls-crystal-twilio.html';
    var disqus_identifier = 'https://www.twilio.com/blog/2016/12/19224 https://www.twilio.com/blog/?p=19224';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'twilioblog';
    var disqus_title = "Make Phone Calls with Crystal and Twilio";
        var disqus_config = function () {
        var config = this; // Access to the config object
        config.language = '';

        /*
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            var script = document.createElement('script');
            script.async = true;
            script.src = 'https://www.twilio.com/blog/2016/12/make-phone-calls-crystal-twilio.html?cf_action=sync_comments&amp;post_id=19224';

            var firstScript = document.getElementsByTagName( "script" )[0];
            firstScript.parentNode.insertBefore(script, firstScript);
        });
                    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "https:\/\/www.twilio.com\/blog\/2016\/12\/make-phone-calls-crystal-twilio.html\/trackback"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.' + 'disqus.com' + '/embed.js?pname=wordpress&pver=2.74';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area col-md-3 hide-xs" role="complementary">
	<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://www.twilio.com/blog/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside><aside id="text-2" class="widget widget_text">			<div class="textwidget"><p>Power modern communications. Build the next generation of voice and SMS applications.</p>

 <a href="http://twilio.com/try-twilio" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://twilio.com/try-twilio', 'Start Building For Free');" class="btn">Start Building For Free</a></div>
		</aside><style scoped type="text/css">.utcw-8ngloje {word-wrap:break-word}.utcw-8ngloje span,.utcw-8ngloje a{border-style:solid;border-width:1px}.utcw-8ngloje span:hover,.utcw-8ngloje a:hover{border-style:solid;border-width:1px}</style><aside id="utcw-2" class="widget widget_utcw widget_tag_cloud"><h1 class="widget-title">Posts By Stack</h1><div class="utcw-8ngloje tagcloud"><a class="tag-link-22 utcw-tag utcw-tag-net" href="https://www.twilio.com/blog/tag/net" style="font-size:16px" title="40 topics">.NET</a> <a class="tag-link-98 utcw-tag utcw-tag-arduino" href="https://www.twilio.com/blog/tag/arduino" style="font-size:16px" title="21 topics">Arduino</a> <a class="tag-link-598 utcw-tag utcw-tag-java" href="https://www.twilio.com/blog/tag/java" style="font-size:16px" title="14 topics">Java</a> <a class="tag-link-600 utcw-tag utcw-tag-javascript" href="https://www.twilio.com/blog/tag/javascript" style="font-size:16px" title="86 topics">JavaScript</a> <a class="tag-link-847 utcw-tag utcw-tag-php" href="https://www.twilio.com/blog/tag/php" style="font-size:16px" title="57 topics">PHP</a> <a class="tag-link-891 utcw-tag utcw-tag-python" href="https://www.twilio.com/blog/tag/python" style="font-size:16px" title="72 topics">Python</a> <a class="tag-link-969 utcw-tag utcw-tag-ruby" href="https://www.twilio.com/blog/tag/ruby" style="font-size:16px" title="69 topics">Ruby</a> <a class="tag-link-2856 utcw-tag utcw-tag-swift" href="https://www.twilio.com/blog/tag/swift" style="font-size:16px" title="22 topics">Swift</a></div></aside><style scoped type="text/css">.utcw-5dkhj5o {word-wrap:break-word}.utcw-5dkhj5o span,.utcw-5dkhj5o a{border-style:solid;border-width:1px}.utcw-5dkhj5o span:hover,.utcw-5dkhj5o a:hover{border-style:solid;border-width:1px}</style><aside id="utcw-3" class="widget widget_utcw widget_tag_cloud"><h1 class="widget-title">Posts By Product</h1><div class="utcw-5dkhj5o tagcloud"><a class="tag-link-2043 utcw-tag utcw-tag-mms" href="https://www.twilio.com/blog/tag/mms" style="font-size:16px" title="50 topics">MMS</a> <a class="tag-link-3513 utcw-tag utcw-tag-programmable-chat" href="https://www.twilio.com/blog/tag/programmable-chat" style="font-size:16px" title="9 topics">Programmable Chat</a> <a class="tag-link-1537 utcw-tag utcw-tag-sip" href="https://www.twilio.com/blog/tag/sip" style="font-size:16px" title="15 topics">SIP</a> <a class="tag-link-1031 utcw-tag utcw-tag-sms" href="https://www.twilio.com/blog/tag/sms" style="font-size:16px" title="372 topics">SMS</a> <a class="tag-link-2871 utcw-tag utcw-tag-taskrouter" href="https://www.twilio.com/blog/tag/taskrouter" style="font-size:16px" title="8 topics">Task Router</a> <a class="tag-link-1199 utcw-tag utcw-tag-twilio-client" href="https://www.twilio.com/blog/tag/twilio-client" style="font-size:16px" title="32 topics">Twilio Client</a> <a class="tag-link-3032 utcw-tag utcw-tag-twilio-video" href="https://www.twilio.com/blog/tag/twilio-video" style="font-size:16px" title="9 topics">Twilio Video</a> <a class="tag-link-1277 utcw-tag utcw-tag-voice" href="https://www.twilio.com/blog/tag/voice" style="font-size:16px" title="172 topics">Voice</a></div></aside><aside id="text-5" class="widget widget_text">			<div class="textwidget"><a href="http://www.twilio.com/docs/tutorials" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/docs/tutorials', '');"><img src="https://www.twilio.com/blog/wp-content/uploads/2016/07/tutorials.png" style="width: 255px" /></a></div>
		</aside><aside id="categories-3" class="widget widget_categories"><h1 class="widget-title">Categories</h1>		<ul>
	<li class="cat-item cat-item-13"><a href="https://www.twilio.com/blog/all-things-code" >Code, Tutorials and Hacks</a>
</li>
	<li class="cat-item cat-item-5"><a href="https://www.twilio.com/blog/customer-highlights" >Customer Highlights</a>
</li>
	<li class="cat-item cat-item-7"><a href="https://www.twilio.com/blog/developers-drawing-the-owl" >Developers Drawing The Owl</a>
</li>
	<li class="cat-item cat-item-3"><a href="https://www.twilio.com/blog/news" >News</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://www.twilio.com/blog/stories-from-the-road" >Stories From The Road</a>
</li>
	<li class="cat-item cat-item-8"><a href="https://www.twilio.com/blog/inside-twilio" >The Owl’s Nest: Inside Twilio</a>
</li>
		</ul>
</aside><aside id="text-4" class="widget widget_text">			<div class="textwidget"><div class="tagcloud "><a href="http://www.twilio.com/blog/feed" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/blog/feed', 'RSS Feed');">RSS Feed</a></div></div>
		</aside></div><!-- #secondary -->

		</div><!-- .row -->
	</div><!-- #content.container -->

<div class="" id="footer">
	<div class="container">
		<header>
			<div class="banner"></div>
			<div class="border"></div>
			<div class="stitching"></div>
		</header>
    <div class="row sitemap">
      <div class="row">
        <div class="col-md-2 col-md-offset-1">
          <h4><a href="http://www.twilio.com/company">Company</a></h4>
          <ul>
            <li><a href="http://www.twilio.com/company">About Twilio</a></li>
            <li><a href="http://www.twilio.com/company/nine-values">Our Nine Values</a></li>
            <li><a href="http://www.twilio.com/company/leadership-principles">Our Leadership Principles</a></li>
            <li><a href="http://www.twilio.com/company/management">The Team</a></li>
            <li><a href="http://www.twilio.com/press">Press &amp; Media</a></li>
            <li><a href="http://www.twilio.org/">Twilio.org</a></li>
            <li><a href="http://www.twilio.com/company/jobs">Careers</a></li>
          </ul>
        </div>
        <div class="col-md-2">
          <h4><a href="http://www.twilio.com/products">Products</a></h4>
          <ul>
            <li><a href="http://www.twilio.com/voice">Voice</a></li>
            <li><a href="http://www.twilio.com/video">Video</a></li>
            <li><a href="http://www.twilio.com/sms">SMS (Text Messaging)</a></li>
            <li><a href="http://www.twilio.com/mms">MMS (Picture Messaging)</a></li>
            <li><a href="http://www.twilio.com/sms/toll-free">Toll-Free SMS</a></li>
            <li><a href="http://www.twilio.com/sip-trunking">SIP Trunking</a></li>
            <li><a href="http://www.twilio.com/client/mobile">Client Mobile</a></li>
            <li><a href="http://www.twilio.com/webrtc">Client WebRTC</a></li>
            <li><a href="http://www.twilio.com/stun-turn">Network Traversal Service</a></li>
            <li><a href="http://www.twilio.com/taskrouter">TaskRouter</a></li>
            <li><a href="http://www.twilio.com/sms/phone-numbers">Phone Numbers</a></li>
            <li><a href="http://www.twilio.com/sms/shortcodes">Short Codes</a></li>
            <li><a href="http://www.twilio.com/support-plans">Support Plans</a></li>
            <li><a href="http://www.twilio.com/platform">Platform</a></li>
            <li><a href="http://www.twilio.com/lookup">Lookup</a></li>
            <li><a href="http://www.twilio.com/monitor">Monitor</a></li>
            <li><a href="http://www.twilio.com/copilot">Messaging Copilot</a></li>
            <li><a href="http://www.twilio.com/voice/conference">Global Conference</a></li>
            <li><a href="http://www.twilio.com/authy">Authy</a></li>
          </ul>
      </div>
      <div class="col-md-2">
        <h4><a href="http://www.twilio.com/pricing">Pricing</a></h4>
        <ul>
          <li><a href="http://www.twilio.com/voice/pricing">Voice Pricing</a></li>
          <li><a href="http://www.twilio.com/sms/pricing">Messaging Pricing</a></li>
          <li><a href="http://www.twilio.com/sip-trunking/pricing">SIP Trunking Pricing</a></li>
          <li><a href="http://www.twilio.com/client/pricing">Client Pricing</a></li>
          <li><a href="http://www.twilio.com/stun-turn/pricing">Network Traversal Pricing</a></li>
          <li><a href="http://www.twilio.com/taskrouter/pricing">TaskRouter</a></li>
          <li><a href="http://www.twilio.com/lookup#pricing">Lookup</a></li>
          <li><a href="http://www.twilio.com/international">International Coverage</a></li>
        </ul>
      </div>
      <div class="col-md-2">
          <h4><a href="http://www.twilio.com/use-cases">Use Cases</a></h4>
          <ul>
            <li><a href="http://www.twilio.com/customers">Customer Stories</a></li>
            <li><a href="http://www.twilio.com/showcase">Showcase</a></li>
            <li><a href="http://www.twilio.com/use-cases/two-factor-authentication">Two-Factor Authentication</a></li>
            <li><a href="http://www.twilio.com/use-cases/appointment-reminders">Appointment Reminders</a></li>
            <li><a href="http://www.twilio.com/use-cases/dispatch-notifications">Dispatch Notifications</a></li>
            <li><a href="http://www.twilio.com/use-cases/eta-alerts">ETA Alerts</a></li>
            <li><a href="http://www.twilio.com/use-cases/automated-surveys">Automated Surveys</a></li>
            <li><a href="http://www.twilio.com/use-cases/masked-phone-numbers">Masked Phone Numbers</a></li>
            <li><a href="http://www.twilio.com/use-cases/visual-estimates">Visual Estimates</a></li>
            <li><a href="http://www.twilio.com/doers">Developer Network</a></li>
            <li><a href="http://www.twilio.com/webinars">Webinars</a></li>
            <li><a href="http://www.twilio.com/white-papers">White Papers</a></li>
          </ul>
      </div>
      <div class="col-md-2">
          <h4><a href="http://www.twilio.com/api">Api &amp; Docs</a></h4>
          <ul>
            <li><a href="http://www.twilio.com/docs/api">API Documentation</a></li>
            <li><a href="http://www.twilio.com/docs/quickstart">Quickstarts</a></li>
            <li><a href="http://www.twilio.com/docs/howto">How Tos</a></li>
            <li><a href="http://www.twilio.com/docs/libraries">Helper Libraries</a></li>
            <li><a href="http://www.twilio.com/docs/security">Security</a></li>
          </ul>
      </div>
    </div>
		<div class="row clear">
			<footer><span>&copy; 2017 Twilio. All rights reserved. <aside>|</aside><a href="http://www.twilio.com/legal/tos">Terms of Service</a><aside>|</aside><a href="http://www.twilio.com/legal/privacy">Privacy Policy</a></span>
			</footer>
		</div>
	</div>
</div>


</div><!-- #page -->

<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201702'></script>







<script type="text/javascript" defer src="https://www.twilio.com/blog/wp-content/cache/autoptimize/js/autoptimize_30cf8936a215677503cd64ef48677239.js"></script></body>

<!-- Mirrored from www.twilio.com/blog/2016/12/make-phone-calls-crystal-twilio.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 22:10:05 GMT -->
</html>
