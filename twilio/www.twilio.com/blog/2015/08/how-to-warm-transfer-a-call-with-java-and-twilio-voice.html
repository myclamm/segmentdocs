<!DOCTYPE html>
<html lang="en-US">

<!-- Mirrored from www.twilio.com/blog/2015/08/how-to-warm-transfer-a-call-with-java-and-twilio-voice.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 22:09:59 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<script type="text/javascript">
(function() {
    var projectId = 3524915770;
    var protocol = ('https:' == document.location.protocol ?
    'https://' : 'http://');
    var scriptTag = document.createElement('script');
    scriptTag.type = 'text/javascript';
    scriptTag.async = true;
    scriptTag.src = protocol + 'cdn.optimizely.com/js/' +
    projectId + '.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(scriptTag, s);
})();
function optimizelyTimeout() {
    window.optimizely = window.optimizely|| [];
    if (!window.optimizely.data) {
    window.optimizely.push("timeout");
    }
}
setTimeout(optimizelyTimeout, 1000);
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://www.twilio.com/blog/xmlrpc.php">
<script type="text/javascript">
var _elqQ = _elqQ || [];
_elqQ.push(['elqSetSiteId', '815114181']);
_elqQ.push(['elqTrackPageView']);
_elqQ.push(['elqUseFirstPartyCookie', 'www.twilio.com']);
(function () {
  function async_load()
  {
    var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;
    s.src = 'http://img03.en25.com/i/elqCfg.min.js';
    var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);
  }
  if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
  else if (window.attachEvent) window.attachEvent('onload', async_load);
})();
</script>
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','http://connect.facebook.net/en_US/fbevents.js');

fbq('init', '467131150158811');
fbq('track', "PageView");</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=467131150158811&amp;ev=PageView&amp;noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->

<style>
@media screen and (max-width: 600px) {
  #signal-header { display: none; }
}
</style>

<link type="text/css" media="all" href="https://www.twilio.com/blog/wp-content/cache/autoptimize/css/autoptimize_7a2cc50131d932d32297f43c61de37cd.css" rel="stylesheet" /><link type="text/css" media="screen" href="https://www.twilio.com/blog/wp-content/cache/autoptimize/css/autoptimize_97ca666341cd9b69002e26c8f2ca5299.css" rel="stylesheet" /><title>How to Warm Transfer a Call with Java and Twilio Voice &#8211; Twilio Cloud Communications Blog</title>

<!-- This site is optimized with the Yoast WordPress SEO plugin v1.4.13 - http://yoast.com/wordpress/seo/ -->
<meta name="description" content="How To Warm Transfer A Call With Java and Twilio"/>
<link rel="canonical" href="https://www.twilio.com/blog/2015/08/how-to-warm-transfer-a-call-with-java-and-twilio-voice.html" />
<!-- / Yoast WordPress SEO plugin. -->

<link rel='dns-prefetch' href='https://www.twilio.com/blog//s0.wp.com' />
<link rel='dns-prefetch' href='https://www.twilio.com/blog//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Twilio Cloud Communications Blog &raquo; Feed" href="https://www.twilio.com/blog/feed" />
<link rel="alternate" type="application/rss+xml" title="Twilio Cloud Communications Blog &raquo; Comments Feed" href="https://www.twilio.com/blog/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="Twilio Cloud Communications Blog &raquo; How to Warm Transfer a Call with Java and Twilio Voice Comments Feed" href="https://www.twilio.com/blog/2015/08/how-to-warm-transfer-a-call-with-java-and-twilio-voice.html/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/twilioinc.wpengine.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.2"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>










<!-- This site uses the Google Analytics by Yoast plugin v5.4.7 - Universal enabled - https://yoast.com/wordpress/plugins/google-analytics/ -->
<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','http://www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-2900316-1', 'auto');
	__gaTracker('set', 'forceSSL', true);
	 window.optimizely = window.optimizely || [];
 window.optimizely.push("activateUniversalAnalytics");
	__gaTracker('set', 'dimension4', 'Chris Hranj');
	__gaTracker('set', 'dimension5', 'post');
	__gaTracker('set', 'dimension6', 'all-things-code');
	__gaTracker('set', 'dimension7', 'How To Warm Transfer A Call With Java and Twilio,Java,Java Twilio,twilio voice,Voice,Warm Transfer');
	__gaTracker('set', 'dimension8', '2015-08-19T12:00:28+00:00');
	__gaTracker('send','pageview');

</script>
<!-- / Google Analytics by Yoast -->


<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.4.3","is_admin":"0","ajaxurl":"https:\/\/twilioinc.wpengine.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>

<script type='text/javascript'>
/* <![CDATA[ */
var swiftypeParams = {"engineKey":"UpGyyJZzgUMXHM65YENj"};
/* ]]> */
</script>

<link rel='https://api.w.org/' href='https://www.twilio.com/blog/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.twilio.com/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.twilio.com/blog/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://www.twilio.com/blog/?p=15742' />
<link rel="alternate" type="application/json+oembed" href="https://www.twilio.com/blog/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.twilio.com%2Fblog%2F2015%2F08%2Fhow-to-warm-transfer-a-call-with-java-and-twilio-voice.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.twilio.com/blog/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.twilio.com%2Fblog%2F2015%2F08%2Fhow-to-warm-transfer-a-call-with-java-and-twilio-voice.html&amp;format=xml" />
<link rel="icon" href="https://www.twilio.com/blog/wp-content/uploads/2015/09/cropped-favicon_1141-32x32.png" sizes="32x32" />
<link rel="icon" href="https://www.twilio.com/blog/wp-content/uploads/2015/09/cropped-favicon_1141-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="https://www.twilio.com/blog/wp-content/uploads/2015/09/cropped-favicon_1141-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.twilio.com/blog/wp-content/uploads/2015/09/cropped-favicon_1141-270x270.png" />
</head>

<body class="single single-post postid-15742 single-format-standard group-blog">
<!-- Google Tag Manager -->
<noscript><iframe src="https://www.twilio.com/blog//www.googletagmanager.com/ns.html?id=GTM-W4RVXH"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'http://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-W4RVXH');</script>
<!-- End Google Tag Manager -->

<div id="fb-root"></div>
<script>(function(d, s, id) {
		var js, fjs = d.getElementsByTagName(s)[0];
		if (d.getElementById(id)) return;
		js = d.createElement(s); js.id = id;
		js.src = "http://connect.facebook.net/en_US/sdk.js#xfbml=1&appId=414254592083321&version=v2.0";
		fjs.parentNode.insertBefore(js, fjs);
	}(document, 'script', 'facebook-jssdk'));
window.fbAsyncInit = function() {
  FB.Event.subscribe('edge.create', function(targetUrl) {
    __gaTracker('send', 'social', 'facebook', 'like', targetUrl);
  });
};
window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));

function trackTwitter(intent_event) {
  if (intent_event) {
    var opt_pagePath;
    if (intent_event.target && intent_event.target.nodeName == 'IFRAME') {
          opt_target = extractParamFromUri(intent_event.target.src, 'url');
    }
    __gaTracker('send', 'social', 'twitter', 'tweet', opt_pagePath);
  }
}

function extractParamFromUri(uri, paramName) {
  if (!uri) {
    return;
  }
  var regex = new RegExp('[\\?&#]' + paramName + '=([^&#]*)');
  var params = regex.exec(uri);
  if (params != null) {
    return unescape(params[1]);
  }
  return;
}

//Wrap event bindings - Wait for async js to load
twttr.ready(function (twttr) {
  //event bindings
  twttr.events.bind('tweet', trackTwitter);
});
</script>
<script type="text/javascript">
  window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var n=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(n?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(a,o);for(var r=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["clearEventProperties","identify","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=r(p[c])};
  heap.load("1541905715");
</script>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<nav class="navbar navbar-default" role="navigation">
		<div class="container">
			<!-- Brand and toggle get grouped for better mobile display -->
			<div class="navbar-header">
				<button type="button" class="navbar-toggle hidden-xs" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="https://www.twilio.com/blog/">
					<img src="https://s3.amazonaws.com/ahoy-assets.twilio.com/global/images/wordmark.svg" width="200"> <span class="logo-blog">blog</span>
				</a>
			</div>

			<div class="hidden-xs"><ul id="menu-site-navigation" class="nav navbar-nav pull-right"><li id="menu-item-12202" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12202"><a href="http://www.twilio.com/" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/', 'Home');" title="Home">Home</a></li>
<li id="menu-item-12205" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12205"><a href="http://www.twilio.com/blog" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/blog', 'Blog');" title="Blog">Blog</a></li>
<li id="menu-item-12204" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12204"><a href="https://www.twilio.com/docs/howto" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://www.twilio.com/docs/howto', 'Tutorials');" title="Tutorials">Tutorials</a></li>
<li id="menu-item-12206" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12206"><a href="https://www.twilio.com/docs/api" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://www.twilio.com/docs/api', 'Docs');" title="Docs">Docs</a></li>
<li id="menu-item-12207" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12207"><a href="http://www.twilio.com/help" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/help', 'Help');" title="Help">Help</a></li>
<li id="menu-item-12208" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12208"><a href="https://www.twilio.com/login" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://www.twilio.com/login', 'Login');" title="Login">Login</a></li>
<li id="menu-item-12209" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12209"><a href="https://www.twilio.com/try-twilio" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://www.twilio.com/try-twilio', 'Signup');" title="Signup">Signup</a></li>
</ul></div>		</div>
	</nav>

	<div id="content" class="site-content container">
		<div class="row">

	<div id="primary" class="content-area col-md-9">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-15742" class="row post-15742 post type-post status-publish format-standard has-post-thumbnail hentry category-all-things-code tag-how-to-warm-transfer-a-call-with-java-and-twilio tag-java tag-java-twilio tag-twilio-voice tag-voice tag-warm-transfer">
	<header class="entry-header col-md-12">
		<h2 class="entry-title">How to Warm Transfer a Call with Java and Twilio Voice</h2>
						<div class="entry-image col-md-12">
        <img width="640" height="263" src="https://www.twilio.com/blog/wp-content/uploads/2015/08/warm-transferes-java2.png" class="img-responsive wp-post-image" alt="warm-transferes-java2" srcset="https://www.twilio.com/blog/wp-content/uploads/2015/08/warm-transferes-java2.png 645w, https://www.twilio.com/blog/wp-content/uploads/2015/08/warm-transferes-java2-300x123.png 300w" sizes="(max-width: 640px) 100vw, 640px" />			</div>
      <div class="clear"></div>
			
		<footer class="entry-footer">
			<div class="entry-meta">
					<div class="row">
	<div class="col-md-6">
	<span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://www.twilio.com/blog/author/chranj">Chris Hranj</a></span></span> on <span class="posted-on"><a href="https://www.twilio.com/blog/2015/08/how-to-warm-transfer-a-call-with-java-and-twilio-voice.html" rel="bookmark"><time class="entry-date published" datetime="2015-08-19T12:00:28+00:00">August 19, 2015</time><time class="updated" datetime="2015-10-07T08:55:44+00:00">October 7, 2015</time></a></span>	</div>
	<div class="col-md-6">
		<div class="social-buttons">
			<div class="fb-like" data-href="https://www.twilio.com/blog/2015/08/how-to-warm-transfer-a-call-with-java-and-twilio-voice.html" data-layout="button" data-action="like" data-show-faces="false" data-share="false"></div>
			<a href="https://twitter.com/share" class="twitter-share-button" data-via="twilio" data-count="none" data-url="https://www.twilio.com/blog/2015/08/how-to-warm-transfer-a-call-with-java-and-twilio-voice.html" data-text="How to Warm Transfer a Call with Java and Twilio Voice ">Tweet</a>
      <a href="https://twitter.com/twilio" class="twitter-follow-button" data-show-count="false">Follow @twilio</a>
		</div>
	</div>
	</div>
			</div><!-- .entry-meta -->
		</footer><!-- .entry-footer -->
	</header><!-- .entry-header -->

	<div class="entry-content col-md-12">
		<div class="row">
			<div class="col-md-12">
				<p>Calling into customer support or similar support lines can lead to some not so great experiences. Often times I find myself being tossed back and forth between different agents with no context of who I am talking to and when I am being transferred. These kinds of calls feel a lot like this:<br />
<img class="&quot; aligncenter" style="width: 357.00px; height: 267.55px; margin-left: 0.00px; margin-top: 10.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="" src="https://www.twilio.com/blog/wp-content/uploads/2015/08/vqU2Vg2Ni48bFFTQE_6GI3TrZzbyOXyRUrPxMkpkG2v4cWFdOyJMIDXlOPQUq31IOqeR8TCPMvCPEvIk8G1I84dTd3G3iyIWJL_irhBwUQcjSlkrULZpSlCLXlUzmfFSEBhwNCk.png" alt="It's always sunny slap" />A better way for agents to handle incoming callers is to use a warm transfer. The term “warm transfer” can mean different things to different people. For this blog post we are going to use this scenario to explain a warm transfer: Agent A (Artemis) is speaking to the caller. Artemis needs to transfer the caller to Agent B (Barnabas). Artemis conferences in Barnabas, introduces the caller to Barnabas and then releases the call.</p>
<p><img class="&quot; aligncenter" style="width: 624.00px; height: 160.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="" src="https://www.twilio.com/blog/wp-content/uploads/2015/08/YUH-IYDf8mNJqBJJwp6SeuIB7HJSQkHM26E7EKPkhGvFbsil4m4CE0uF3hRDMFY7Jdb5F7lQWPt6gCQnJKgD3Wr4Mdhdv4_osewu6fAnN6RGER9kIAR-eJi6S3hiDXt3byc7WiA.png" alt="warm transfer callflow" /></p>
<p>In this blog post we will setup a very simple call center that supports warm transfers using <a href="https://www.twilio.com/docs/java/install" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/docs/java/install', 'Twilio’s Java helper library');">Twilio’s Java helper library</a> and an <a href="http://tomcat.apache.org/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://tomcat.apache.org/', 'Apache Tomcat');">Apache Tomcat</a> server.</p>
<p>If you are only interested in the finished product, all of the code used in this post can be found on Github <a href="https://github.com/Brodan/warm-transfers-java" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/Brodan/warm-transfers-java', 'here');">here</a>.</p>
<h3><a name="h.h1i4dnr5300g"></a>“Charlie Work”</h3>
<p>The first step to building our call center is to set up our environment. Since we are using Tomcat to implement our web server you can follow the <a href="https://www.twilio.com/docs/quickstart/java/devenvironment" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/docs/quickstart/java/devenvironment', 'Twilio Quickstart');">Twilio Quickstart</a> to get started with Tomcat and the Twilio SDK. Take your time and make sure your environment is setup properly before continuing on with this post. If you’ve never used Maven, I suggest following Option 2 in the quickstart and downloading the .jar file directly.</p>
<p>Your file structure should look something like this if you followed along with the quickstart:</p>
<p><img class="alignnone size-full wp-image-15746" src="https://www.twilio.com/blog/wp-content/uploads/2015/08/Screen-Shot-2015-08-18-at-4.07.16-PM.png" alt="Directory Structure" width="355" height="525" srcset="https://www.twilio.com/blog/wp-content/uploads/2015/08/Screen-Shot-2015-08-18-at-4.07.16-PM.png 355w, https://www.twilio.com/blog/wp-content/uploads/2015/08/Screen-Shot-2015-08-18-at-4.07.16-PM-202x300.png 202w" sizes="(max-width: 355px) 100vw, 355px" /></p>
<p>Once we have Tomcat running properly, we can test that our servlets are running locally. Open a terminal, navigate to the top of your project directory and run the following:</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794da722cc5949848615" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
$ sh bin/startup.sh</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794da722cc5949848615-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794da722cc5949848615-1">$ sh bin/startup.sh</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>You might run into an issue saying 
			<span id="crayon-58794da722ce2526684407" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">Cannot find ./bin/catalina.sh</span></span>. We can easily fix this by running the following in our terminal (<a href="http://saw.tl/drupal/tomcat-cannot-find-bincatalinash.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://saw.tl/drupal/tomcat-cannot-find-bincatalinash.html', 'source');">source</a>):</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794da722cf3758951721" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
$ chmod +x bin/*.sh
$ chmod +x bin/*.jar</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794da722cf3758951721-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722cf3758951721-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794da722cf3758951721-1">$ chmod +x bin/*.sh</div><div class="crayon-line crayon-striped-line" id="crayon-58794da722cf3758951721-2">$ chmod +x bin/*.jar</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Once our server has started, navigate to <a href="localhost:8080">localhost:8080</a> in a web browser and we should see the Apache Tomcat landing page:</p>
<p><img class="&quot; aligncenter" style="width: 624.00px; height: 178.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="" src="https://www.twilio.com/blog/wp-content/uploads/2015/08/U3ytwvu3Zkqa71lw6FSjFWAxHyQqsCCXfrpXNSbrxRHyNCQE30wCMWkEGtBqsygpJOmONLALsdA2ox04VnrVVaxY31BDxCxsBkApbwvs0x17XbLVO4rb0MKQOnPph8AY7trlQ6E.png" alt="Tomcat default page" /></p>
<p>Our server is working locally, but we will need to be able to access it publicly so that Twilio can reach it. We can use <a href="https://ngrok.com/" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://ngrok.com/', 'ngrok');">ngrok</a> to do this. Ngrok is a command line tool that can create a public tunnel to access your localhost. If you’ve never used ngrok before consider reading <a href="https://www.twilio.com/blog/2013/10/test-your-webhooks-locally-with-ngrok.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/blog/2013/10/test-your-webhooks-locally-with-ngrok.html', 'this blog post');">this blog post</a> by Kevin Whinnery to get familiar with it. Once you have ngrok installed, run 
			<span id="crayon-58794da722d04797194300" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">$ ngrok http 8080</span></span> in a terminal and navigate to the URL it gives you (see image below) in a browser.</p>
<p><img class="&quot; aligncenter" style="width: 590.00px; height: 253.00px; margin-left: 0.00px; margin-top: 10.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="" src="https://www.twilio.com/blog/wp-content/uploads/2015/08/csL5OY9-u3Q3Dp-nn2sl_u62NliHLEUKRDiknlT9WhpVCcDqnXdwAPa_nIHXCRg-Jg-3F0_ICHUDxQ4R_7m2vX5G7Lgosf_EJ8OuRbFLin4Yx7uurRO9jcBgwzWGz5yz_Xc96FE.png" alt="ngrok running example" /></p>
<p>We should see the same landing page as we did at localhost:8080, meaning our server is now publicly accessible. Before moving on, take a moment to appreciate this cat wearing mittens:<br />
<img class="size-full wp-image-15766 aligncenter" style="margin-top: 10.00px;" src="https://www.twilio.com/blog/wp-content/uploads/2015/08/Kitten-Mittens-™-Imgur.gif" alt="Kitten Mittens ™" width="360" height="203" /></p>
<h3><a name="h.l7x7onkhmspj"></a>“The Gang Hits the Road”</h3>
<p>In order to handle incoming requests we need a map to tell our Tomcat server which Java files handle which requests. We can map servlets to endpoints in our server&#8217;s <strong>web.xml</strong> file, which will be located in <strong>/webapps/twilio/WEB-INF/</strong>. This servlet is going to handle all incoming/outgoing calls to our two agents. Configure this file as such:</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794da722d17734122729" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;web-app xmlns="http://java.sun.com/xml/ns/j2ee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"
    version="2.4"&gt;

    &lt;display-name&gt;Twilio Warm Transfer App&lt;/display-name&gt;

    &lt;servlet&gt;
        &lt;servlet-name&gt;TwilioCallerServlet&lt;/servlet-name&gt;
        &lt;servlet-class&gt;com.twilio.TwilioCallerServlet&lt;/servlet-class&gt;
    &lt;/servlet&gt;

    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;TwilioCallerServlet&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/handle-caller&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
&lt;/web-app&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794da722d17734122729-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d17734122729-2">2</div><div class="crayon-num" data-line="crayon-58794da722d17734122729-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d17734122729-4">4</div><div class="crayon-num" data-line="crayon-58794da722d17734122729-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d17734122729-6">6</div><div class="crayon-num" data-line="crayon-58794da722d17734122729-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d17734122729-8">8</div><div class="crayon-num" data-line="crayon-58794da722d17734122729-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d17734122729-10">10</div><div class="crayon-num" data-line="crayon-58794da722d17734122729-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d17734122729-12">12</div><div class="crayon-num" data-line="crayon-58794da722d17734122729-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d17734122729-14">14</div><div class="crayon-num" data-line="crayon-58794da722d17734122729-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d17734122729-16">16</div><div class="crayon-num" data-line="crayon-58794da722d17734122729-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d17734122729-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794da722d17734122729-1">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d17734122729-2">&lt;web-app xmlns="http://java.sun.com/xml/ns/j2ee"</div><div class="crayon-line" id="crayon-58794da722d17734122729-3">&nbsp;&nbsp;&nbsp;&nbsp;xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d17734122729-4">&nbsp;&nbsp;&nbsp;&nbsp;xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"</div><div class="crayon-line" id="crayon-58794da722d17734122729-5">&nbsp;&nbsp;&nbsp;&nbsp;version="2.4"&gt;</div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d17734122729-6">&nbsp;</div><div class="crayon-line" id="crayon-58794da722d17734122729-7">&nbsp;&nbsp;&nbsp;&nbsp;&lt;display-name&gt;Twilio Warm Transfer App&lt;/display-name&gt;</div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d17734122729-8">&nbsp;</div><div class="crayon-line" id="crayon-58794da722d17734122729-9">&nbsp;&nbsp;&nbsp;&nbsp;&lt;servlet&gt;</div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d17734122729-10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;servlet-name&gt;TwilioCallerServlet&lt;/servlet-name&gt;</div><div class="crayon-line" id="crayon-58794da722d17734122729-11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;servlet-class&gt;com.twilio.TwilioCallerServlet&lt;/servlet-class&gt;</div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d17734122729-12">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/servlet&gt;</div><div class="crayon-line" id="crayon-58794da722d17734122729-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d17734122729-14">&nbsp;&nbsp;&nbsp;&nbsp;&lt;servlet-mapping&gt;</div><div class="crayon-line" id="crayon-58794da722d17734122729-15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;servlet-name&gt;TwilioCallerServlet&lt;/servlet-name&gt;</div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d17734122729-16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;url-pattern&gt;/handle-caller&lt;/url-pattern&gt;</div><div class="crayon-line" id="crayon-58794da722d17734122729-17">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/servlet-mapping&gt;</div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d17734122729-18">&lt;/web-app&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>This mapping tells our web server that when a request to the /handle-caller URL is made it should forward to the 
			<span id="crayon-58794da722d29682794167" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">TwilioCallerServlet</span></span> class. Let’s build this class in a new file now.</p>
<h3><a name="h.m3kpwahljgf9"></a>Building Our Servlet</h3>
<p>Navigate to <strong>/webapps/twilio/WEB-INF/classes/com/twilio </strong>and create a new file called <strong>TwilioCallerServlet.java</strong>. This servlet will return <a href="https://www.twilio.com/docs/api/twiml" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/docs/api/twiml', 'TwiML');">TwiML</a> instructions according to the incoming caller.</p>
<p>We first need to import a number of packages in order to use servlets and the Twilio library. Place the following code at the top of your file:</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794da722d3a815719570" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Java</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
package com.twilio;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

import org.apache.http.message.BasicNameValuePair;
import org.apache.http.NameValuePair;

import com.twilio.sdk.TwilioRestClient;
import com.twilio.sdk.resource.factory.CallFactory;
import com.twilio.sdk.resource.instance.Call;
 
import java.util.ArrayList;
import java.util.List;
 
import com.twilio.sdk.verbs.TwiMLResponse;
import com.twilio.sdk.TwilioRestException;
import com.twilio.sdk.verbs.TwiMLException;
import com.twilio.sdk.verbs.Dial;
import com.twilio.sdk.verbs.Conference;
import com.twilio.sdk.verbs.Gather;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794da722d3a815719570-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d3a815719570-2">2</div><div class="crayon-num" data-line="crayon-58794da722d3a815719570-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d3a815719570-4">4</div><div class="crayon-num" data-line="crayon-58794da722d3a815719570-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d3a815719570-6">6</div><div class="crayon-num" data-line="crayon-58794da722d3a815719570-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d3a815719570-8">8</div><div class="crayon-num" data-line="crayon-58794da722d3a815719570-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d3a815719570-10">10</div><div class="crayon-num" data-line="crayon-58794da722d3a815719570-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d3a815719570-12">12</div><div class="crayon-num" data-line="crayon-58794da722d3a815719570-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d3a815719570-14">14</div><div class="crayon-num" data-line="crayon-58794da722d3a815719570-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d3a815719570-16">16</div><div class="crayon-num" data-line="crayon-58794da722d3a815719570-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d3a815719570-18">18</div><div class="crayon-num" data-line="crayon-58794da722d3a815719570-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d3a815719570-20">20</div><div class="crayon-num" data-line="crayon-58794da722d3a815719570-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d3a815719570-22">22</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794da722d3a815719570-1"><span class="crayon-t">package</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-i">twilio</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d3a815719570-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">javax</span><span class="crayon-sy">.</span><span class="crayon-v">servlet</span><span class="crayon-sy">.</span><span class="crayon-v">http</span><span class="crayon-sy">.</span><span class="crayon-i">HttpServlet</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722d3a815719570-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">javax</span><span class="crayon-sy">.</span><span class="crayon-v">servlet</span><span class="crayon-sy">.</span><span class="crayon-v">http</span><span class="crayon-sy">.</span><span class="crayon-i">HttpServletRequest</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d3a815719570-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">javax</span><span class="crayon-sy">.</span><span class="crayon-v">servlet</span><span class="crayon-sy">.</span><span class="crayon-v">http</span><span class="crayon-sy">.</span><span class="crayon-i">HttpServletResponse</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722d3a815719570-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">java</span><span class="crayon-sy">.</span><span class="crayon-v">io</span><span class="crayon-sy">.</span><span class="crayon-i">IOException</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d3a815719570-6">&nbsp;</div><div class="crayon-line" id="crayon-58794da722d3a815719570-7"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">org</span><span class="crayon-sy">.</span><span class="crayon-v">apache</span><span class="crayon-sy">.</span><span class="crayon-v">http</span><span class="crayon-sy">.</span><span class="crayon-v">message</span><span class="crayon-sy">.</span><span class="crayon-i">BasicNameValuePair</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d3a815719570-8"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">org</span><span class="crayon-sy">.</span><span class="crayon-v">apache</span><span class="crayon-sy">.</span><span class="crayon-v">http</span><span class="crayon-sy">.</span><span class="crayon-i">NameValuePair</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722d3a815719570-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d3a815719570-10"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-v">sdk</span><span class="crayon-sy">.</span><span class="crayon-i">TwilioRestClient</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722d3a815719570-11"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-v">sdk</span><span class="crayon-sy">.</span><span class="crayon-v">resource</span><span class="crayon-sy">.</span><span class="crayon-v">factory</span><span class="crayon-sy">.</span><span class="crayon-i">CallFactory</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d3a815719570-12"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-v">sdk</span><span class="crayon-sy">.</span><span class="crayon-v">resource</span><span class="crayon-sy">.</span><span class="crayon-v">instance</span><span class="crayon-sy">.</span><span class="crayon-i">Call</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722d3a815719570-13"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d3a815719570-14"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">java</span><span class="crayon-sy">.</span><span class="crayon-v">util</span><span class="crayon-sy">.</span><span class="crayon-i">ArrayList</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722d3a815719570-15"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">java</span><span class="crayon-sy">.</span><span class="crayon-v">util</span><span class="crayon-sy">.</span><span class="crayon-i">List</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d3a815719570-16"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-58794da722d3a815719570-17"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-v">sdk</span><span class="crayon-sy">.</span><span class="crayon-v">verbs</span><span class="crayon-sy">.</span><span class="crayon-i">TwiMLResponse</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d3a815719570-18"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-v">sdk</span><span class="crayon-sy">.</span><span class="crayon-i">TwilioRestException</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722d3a815719570-19"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-v">sdk</span><span class="crayon-sy">.</span><span class="crayon-v">verbs</span><span class="crayon-sy">.</span><span class="crayon-i">TwiMLException</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d3a815719570-20"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-v">sdk</span><span class="crayon-sy">.</span><span class="crayon-v">verbs</span><span class="crayon-sy">.</span><span class="crayon-i">Dial</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722d3a815719570-21"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-v">sdk</span><span class="crayon-sy">.</span><span class="crayon-v">verbs</span><span class="crayon-sy">.</span><span class="crayon-i">Conference</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d3a815719570-22"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">twilio</span><span class="crayon-sy">.</span><span class="crayon-v">sdk</span><span class="crayon-sy">.</span><span class="crayon-v">verbs</span><span class="crayon-sy">.</span><span class="crayon-i">Gather</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0118 seconds] -->
<p>We can now create our 
			<span id="crayon-58794da722d4c664741314" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">TwilioCallerServlet</span></span> class. The class will contain a method called 
			<span id="crayon-58794da722d5d712857216" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">service</span></span> that will handle incoming HTTP requests and create HTTP responses. Place the following code after your imports:</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794da722d6e804996333" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Java</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
public class TwilioCallerServlet extends HttpServlet {

    public void service(HttpServletRequest request, HttpServletResponse response) throws IOException {

        TwiMLResponse twiml = new TwiMLResponse();
        // Dial verb allows callers to enter conference.
        Dial dial = new Dial();
        dial.setHangupOnStar(true);
        // Conference will be named SupportRoom.
        Conference conf = new Conference("SupportRoom");
        conf.setBeep(Conference.BEEP_TRUE);

        try {
            dial.append(conf);  
            twiml.append(dial);
        } catch (TwiMLException e) {
            e.printStackTrace();
        }
        // Respond with TwiML
        response.setContentType("application/xml");
        response.getWriter().print(twiml.toXML());    
    }
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794da722d6e804996333-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d6e804996333-2">2</div><div class="crayon-num" data-line="crayon-58794da722d6e804996333-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d6e804996333-4">4</div><div class="crayon-num" data-line="crayon-58794da722d6e804996333-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d6e804996333-6">6</div><div class="crayon-num" data-line="crayon-58794da722d6e804996333-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d6e804996333-8">8</div><div class="crayon-num" data-line="crayon-58794da722d6e804996333-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d6e804996333-10">10</div><div class="crayon-num" data-line="crayon-58794da722d6e804996333-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d6e804996333-12">12</div><div class="crayon-num" data-line="crayon-58794da722d6e804996333-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d6e804996333-14">14</div><div class="crayon-num" data-line="crayon-58794da722d6e804996333-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d6e804996333-16">16</div><div class="crayon-num" data-line="crayon-58794da722d6e804996333-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d6e804996333-18">18</div><div class="crayon-num" data-line="crayon-58794da722d6e804996333-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d6e804996333-20">20</div><div class="crayon-num" data-line="crayon-58794da722d6e804996333-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722d6e804996333-22">22</div><div class="crayon-num" data-line="crayon-58794da722d6e804996333-23">23</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794da722d6e804996333-1"><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">TwilioCallerServlet</span><span class="crayon-h"> </span><span class="crayon-r">extends</span><span class="crayon-h"> </span><span class="crayon-e">HttpServlet</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d6e804996333-2">&nbsp;</div><div class="crayon-line" id="crayon-58794da722d6e804996333-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">service</span><span class="crayon-sy">(</span><span class="crayon-e">HttpServletRequest </span><span class="crayon-i">request</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">HttpServletResponse </span><span class="crayon-i">response</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-m">throws</span><span class="crayon-h"> </span><span class="crayon-e">IOException</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d6e804996333-4">&nbsp;</div><div class="crayon-line" id="crayon-58794da722d6e804996333-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">TwiMLResponse </span><span class="crayon-v">twiml</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">TwiMLResponse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d6e804996333-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Dial verb allows callers to enter conference.</span></div><div class="crayon-line" id="crayon-58794da722d6e804996333-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Dial </span><span class="crayon-v">dial</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Dial</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d6e804996333-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dial</span><span class="crayon-sy">.</span><span class="crayon-e">setHangupOnStar</span><span class="crayon-sy">(</span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722d6e804996333-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Conference will be named SupportRoom.</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d6e804996333-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Conference </span><span class="crayon-v">conf</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Conference</span><span class="crayon-sy">(</span><span class="crayon-s">"SupportRoom"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722d6e804996333-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">conf</span><span class="crayon-sy">.</span><span class="crayon-e">setBeep</span><span class="crayon-sy">(</span><span class="crayon-v">Conference</span><span class="crayon-sy">.</span><span class="crayon-i">BEEP_TRUE</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d6e804996333-12">&nbsp;</div><div class="crayon-line" id="crayon-58794da722d6e804996333-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d6e804996333-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dial</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-i">conf</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-58794da722d6e804996333-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">twiml</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-i">dial</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d6e804996333-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">catch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">TwiMLException</span><span class="crayon-h"> </span><span class="crayon-i">e</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-58794da722d6e804996333-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-e">printStackTrace</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d6e804996333-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-58794da722d6e804996333-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Respond with TwiML</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d6e804996333-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-e">setContentType</span><span class="crayon-sy">(</span><span class="crayon-s">"application/xml"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722d6e804996333-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-e">getWriter</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">twiml</span><span class="crayon-sy">.</span><span class="crayon-e">toXML</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722d6e804996333-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-58794da722d6e804996333-23"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0100 seconds] -->
<p>This code creates a new 
			<span id="crayon-58794da722d7f391357013" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">TwiMLResponse()</span></span> object and appends a <a href="https://www.twilio.com/docs/api/twiml/dial" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/docs/api/twiml/dial', 'Dial');">Dial</a> verb and a <a href="https://www.twilio.com/docs/api/twiml/conference" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/docs/api/twiml/conference', 'Conference');">Conference</a> noun to it. This means that when this TwiML is prepared by Twilio, the caller will be placed in a conference named “SupportRoom”. If you wish to learn more about TwiML verbs see the Twilio documentation <a href="https://www.twilio.com/docs/api/twiml#verbs" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/docs/api/twiml#verbs', 'here');">here</a>.</p>
<h3><a name="h.3nwxt88xvqkr"></a>Testing Our Servlet</h3>
<p>Before we move on let’s make sure that our 
			<span id="crayon-58794da722d91876304755" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">TwilioCallerServlet</span></span> is functional and returning the correct TwiML. We need to compile our Java files before our Tomcat server can use them. During compilation you must specify the classpath of the jar file containing the Twilio SDK. Navigate to the top of your project directory and run this command to compile all of your java files:</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794da722da2145274090" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
$ javac -cp lib/servlet-api.jar:webapps/twilio/WEB-INF/lib/twilio-java-sdk-4.4.5-jar-with-dependencies.jar webapps/twilio/WEB-INF/classes/com/twilio/*.java</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794da722da2145274090-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794da722da2145274090-1">$ javac -cp lib/servlet-api.jar:webapps/twilio/WEB-INF/lib/twilio-java-sdk-4.4.5-jar-with-dependencies.jar webapps/twilio/WEB-INF/classes/com/twilio/*.java</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>If you are receiving compilation errors then the classpaths specified in your command are not correct or you are running the command from the wrong directory.</p>
<p>Now we need to restart the Tomcat server for our changes to take effect. Do this by running 
			<span id="crayon-58794da722db4175725774" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">$ sh bin/shutdown.sh</span></span> and then running 
			<span id="crayon-58794da722dc7211052112" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">$ sh bin/startup.sh</span></span> again. Remember you’ll need to restart your server any time you recompile your Java files for the changes to take effect.</p>
<p>Navigate to <a href="http://localhost:8080/twilio/handle-caller" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://localhost:8080/twilio/handle-caller', 'http://localhost:8080/twilio/handle-caller');">http://localhost:8080/twilio/handle-caller</a> in your browser and you should see the following:</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794da722dda138259474" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
&lt;Response&gt;
    &lt;Dial hangupOnStar="true"&gt;
        &lt;Conference beep="true"&gt;SupportRoom&lt;/Conference&gt;
    &lt;/Dial&gt;
&lt;/Response&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794da722dda138259474-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722dda138259474-2">2</div><div class="crayon-num" data-line="crayon-58794da722dda138259474-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722dda138259474-4">4</div><div class="crayon-num" data-line="crayon-58794da722dda138259474-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794da722dda138259474-1">&lt;Response&gt;</div><div class="crayon-line crayon-striped-line" id="crayon-58794da722dda138259474-2">&nbsp;&nbsp;&nbsp;&nbsp;&lt;Dial hangupOnStar="true"&gt;</div><div class="crayon-line" id="crayon-58794da722dda138259474-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Conference beep="true"&gt;SupportRoom&lt;/Conference&gt;</div><div class="crayon-line crayon-striped-line" id="crayon-58794da722dda138259474-4">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Dial&gt;</div><div class="crayon-line" id="crayon-58794da722dda138259474-5">&lt;/Response&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<h3><a name="h.cbr51fwpdgea"></a>Expanding Our Servlet</h3>
<p>Now let’s define a couple of constants that our servlet is going to need later on. Place the following lines directly below your class definition and above the 
			<span id="crayon-58794da722deb138431883" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">service</span></span> function:</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794da722dfd399088240" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Java</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
final String ACCOUNT_SID = "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"; // Found on your Twilio Dashboard
final String AUTH_TOKEN = "YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY"; // Found on your Twilio Dashboard
final String CALL_ENDPOINT = "http://XXXXXXXX.ngrok.io/twilio/handle-caller"; // Paste URL generated by ngrok
final String ARTEMIS_NUMBER = "+15555555555"; // The first agent's number
final String BARNABAS_NUMBER = "+15555555555"; // The second agent's number
final String SUPPORT_NUMBER = "+15555555555"; // Twilio number</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794da722dfd399088240-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722dfd399088240-2">2</div><div class="crayon-num" data-line="crayon-58794da722dfd399088240-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722dfd399088240-4">4</div><div class="crayon-num" data-line="crayon-58794da722dfd399088240-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722dfd399088240-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794da722dfd399088240-1"><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">ACCOUNT_SID</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Found on your Twilio Dashboard</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722dfd399088240-2"><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">AUTH_TOKEN</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY"</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Found on your Twilio Dashboard</span></div><div class="crayon-line" id="crayon-58794da722dfd399088240-3"><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">CALL_ENDPOINT</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"http://XXXXXXXX.ngrok.io/twilio/handle-caller"</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Paste URL generated by ngrok</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722dfd399088240-4"><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">ARTEMIS_NUMBER</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"+15555555555"</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// The first agent's number</span></div><div class="crayon-line" id="crayon-58794da722dfd399088240-5"><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">BARNABAS_NUMBER</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"+15555555555"</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// The second agent's number</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722dfd399088240-6"><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">SUPPORT_NUMBER</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"+15555555555"</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Twilio number</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0046 seconds] -->
<p>Replace each variable with the appropriate data: Your 
			<span id="crayon-58794da722e0e688324618" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">ACCOUNT_SID</span></span> and 
			<span id="crayon-58794da722e20154307234" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">AUTH_TOKEN</span></span> can be found on your Twilio account dashboard. 
			<span id="crayon-58794da722e31622713946" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">CALL_ENDPOINT</span></span> will be the URL generated by your ngrok server with your servlet mapping appended to it (For example: <em>http://229cd6dd.ngrok.io/twilio/handle-caller</em>). 
			<span id="crayon-58794da722e44258329041" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">ARTEMIS_NUMBER</span></span> is the phone number of your first agent. This is the number that will answer all incoming calls to your Twilio number. 
			<span id="crayon-58794da722e55815739781" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">BARNABAS_NUMBER</span></span> is the phone number that will receive the warm transfer from Artemis. Lastly, 
			<span id="crayon-58794da722e67309005714" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">SUPPORT_NUMBER</span></span> is your Twilio number that callers will call into.</p>
<p>Now let’s add some additional logic to handle agent transfers and outgoing calls. Add the following code above your 
			<span id="crayon-58794da722e79573900226" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-e">setContentType</span><span class="crayon-sy">(</span><span class="crayon-s">"application/xml"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></span></span> line:</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794da722e8a307517727" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Java</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
// Check if any key presses were made.
String digits = request.getParameter("Digits");
// If digits were pressed, Artemis needs to conference Barnabas.
if (digits != null &amp;&amp; digits.equals("1")) {
    // Call Barnabas to bring into conference.
    makeCall(CALL_ENDPOINT, BARNABAS_NUMBER, SUPPORT_NUMBER);
}
else {
    // Check if incoming call is coming directly to our Support Number.
    if(request.getParameter("To").equals(SUPPORT_NUMBER)) {
        // Call Artemis to connect to incoming caller.
        makeCall(CALL_ENDPOINT, ARTEMIS_NUMBER, request.getParameter("From"));
    }
    // Check if the incoming call is coming to Artemis.
    else if(request.getParameter("To").equals(ARTEMIS_NUMBER)) {
        // Append Gather to Artemis's TwiML
        Gather gather = new Gather();
        gather.setAction(CALL_ENDPOINT);
        gather.setNumDigits(1);
        try {
            twiml.append(gather);
        } catch (TwiMLException e) {
            e.printStackTrace();
        }
    }
    // Calls coming to Barnabas will receive the same TwiML as the initial caller.
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794da722e8a307517727-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722e8a307517727-2">2</div><div class="crayon-num" data-line="crayon-58794da722e8a307517727-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722e8a307517727-4">4</div><div class="crayon-num" data-line="crayon-58794da722e8a307517727-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722e8a307517727-6">6</div><div class="crayon-num" data-line="crayon-58794da722e8a307517727-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722e8a307517727-8">8</div><div class="crayon-num" data-line="crayon-58794da722e8a307517727-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722e8a307517727-10">10</div><div class="crayon-num" data-line="crayon-58794da722e8a307517727-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722e8a307517727-12">12</div><div class="crayon-num" data-line="crayon-58794da722e8a307517727-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722e8a307517727-14">14</div><div class="crayon-num" data-line="crayon-58794da722e8a307517727-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722e8a307517727-16">16</div><div class="crayon-num" data-line="crayon-58794da722e8a307517727-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722e8a307517727-18">18</div><div class="crayon-num" data-line="crayon-58794da722e8a307517727-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722e8a307517727-20">20</div><div class="crayon-num" data-line="crayon-58794da722e8a307517727-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722e8a307517727-22">22</div><div class="crayon-num" data-line="crayon-58794da722e8a307517727-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722e8a307517727-24">24</div><div class="crayon-num" data-line="crayon-58794da722e8a307517727-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722e8a307517727-26">26</div><div class="crayon-num" data-line="crayon-58794da722e8a307517727-27">27</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794da722e8a307517727-1"><span class="crayon-c">// Check if any key presses were made.</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722e8a307517727-2"><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">digits</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-e">getParameter</span><span class="crayon-sy">(</span><span class="crayon-s">"Digits"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722e8a307517727-3"><span class="crayon-c">// If digits were pressed, Artemis needs to conference Barnabas.</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722e8a307517727-4"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">digits</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">digits</span><span class="crayon-sy">.</span><span class="crayon-e">equals</span><span class="crayon-sy">(</span><span class="crayon-s">"1"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-58794da722e8a307517727-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Call Barnabas to bring into conference.</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722e8a307517727-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">makeCall</span><span class="crayon-sy">(</span><span class="crayon-i">CALL_ENDPOINT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">BARNABAS_NUMBER</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">SUPPORT_NUMBER</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722e8a307517727-7"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722e8a307517727-8"><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-58794da722e8a307517727-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Check if incoming call is coming directly to our Support Number.</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722e8a307517727-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-e">getParameter</span><span class="crayon-sy">(</span><span class="crayon-s">"To"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">equals</span><span class="crayon-sy">(</span><span class="crayon-i">SUPPORT_NUMBER</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-58794da722e8a307517727-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Call Artemis to connect to incoming caller.</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722e8a307517727-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">makeCall</span><span class="crayon-sy">(</span><span class="crayon-i">CALL_ENDPOINT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">ARTEMIS_NUMBER</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-e">getParameter</span><span class="crayon-sy">(</span><span class="crayon-s">"From"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722e8a307517727-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722e8a307517727-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Check if the incoming call is coming to Artemis.</span></div><div class="crayon-line" id="crayon-58794da722e8a307517727-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-e">getParameter</span><span class="crayon-sy">(</span><span class="crayon-s">"To"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">equals</span><span class="crayon-sy">(</span><span class="crayon-i">ARTEMIS_NUMBER</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722e8a307517727-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Append Gather to Artemis's TwiML</span></div><div class="crayon-line" id="crayon-58794da722e8a307517727-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Gather </span><span class="crayon-v">gather</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Gather</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722e8a307517727-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">gather</span><span class="crayon-sy">.</span><span class="crayon-e">setAction</span><span class="crayon-sy">(</span><span class="crayon-i">CALL_ENDPOINT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722e8a307517727-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">gather</span><span class="crayon-sy">.</span><span class="crayon-e">setNumDigits</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722e8a307517727-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-58794da722e8a307517727-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">twiml</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-i">gather</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722e8a307517727-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">catch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">TwiMLException</span><span class="crayon-h"> </span><span class="crayon-i">e</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-58794da722e8a307517727-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-e">printStackTrace</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722e8a307517727-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-58794da722e8a307517727-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722e8a307517727-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Calls coming to Barnabas will receive the same TwiML as the initial caller.</span></div><div class="crayon-line" id="crayon-58794da722e8a307517727-27"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0110 seconds] -->
<p>Our servlet is checking if a “1” was entered into the keypad by our first agent (Artemis) after disconnecting from the conference. If it was, our second agent (Barnabas) will be dialed and Artemis will be reconnected to the conference.</p>
<p>If no input was sent, we must check where the incoming call is coming from. If a regular caller is dialing into your Twilio number, they must be connected with Artemis. Artemis will be sent different TwiML that contains a <a href="https://www.twilio.com/docs/api/twiml/gather" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://www.twilio.com/docs/api/twiml/gather', 'Gather');">Gather</a> verb to collect input from the keypad. Combined with the 
			<span id="crayon-58794da722e9d918497068" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">setHangupOnStar</span></span> attribute, this allows Artemis to press “*1” to dial Barnabas.</p>
<p>You’ll notice we haven’t defined the 
			<span id="crayon-58794da722eae439661676" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">makeCall</span></span> function. Let’s add this function right before the class’s closing bracket. The following code will make calls for us using a 
			<span id="crayon-58794da722ec0366839105" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">TwilioRestClient</span></span>:</p><!-- Crayon Syntax Highlighter v2.4.3 -->

		<div id="crayon-58794da722ed1777055421" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover expand" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 16px !important; line-height: 24px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Java</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:2; -o-tab-size:2; -webkit-tab-size:2; tab-size:2; font-size: 16px !important; line-height: 24px !important;">
public void makeCall(String url, String to, String from) {
    try {
        TwilioRestClient client = new TwilioRestClient(ACCOUNT_SID, AUTH_TOKEN);

        List&lt;NameValuePair&gt; params = new ArrayList&lt;NameValuePair&gt;();
        params.add(new BasicNameValuePair("Url", url));
        params.add(new BasicNameValuePair("To", to));
        params.add(new BasicNameValuePair("From", from));
         
        CallFactory callFactory = client.getAccount().getCallFactory();
        Call call = callFactory.create(params);
    }
    catch (TwilioRestException e) {
            System.out.println(e.getErrorMessage());
    }
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-num" data-line="crayon-58794da722ed1777055421-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722ed1777055421-2">2</div><div class="crayon-num" data-line="crayon-58794da722ed1777055421-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722ed1777055421-4">4</div><div class="crayon-num" data-line="crayon-58794da722ed1777055421-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722ed1777055421-6">6</div><div class="crayon-num" data-line="crayon-58794da722ed1777055421-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722ed1777055421-8">8</div><div class="crayon-num" data-line="crayon-58794da722ed1777055421-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722ed1777055421-10">10</div><div class="crayon-num" data-line="crayon-58794da722ed1777055421-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722ed1777055421-12">12</div><div class="crayon-num" data-line="crayon-58794da722ed1777055421-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722ed1777055421-14">14</div><div class="crayon-num" data-line="crayon-58794da722ed1777055421-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-58794da722ed1777055421-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 24px !important;"><div class="crayon-line" id="crayon-58794da722ed1777055421-1"><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">makeCall</span><span class="crayon-sy">(</span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-i">url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-st">to</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-i">from</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722ed1777055421-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-58794da722ed1777055421-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">TwilioRestClient </span><span class="crayon-v">client</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">TwilioRestClient</span><span class="crayon-sy">(</span><span class="crayon-i">ACCOUNT_SID</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">AUTH_TOKEN</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722ed1777055421-4">&nbsp;</div><div class="crayon-line" id="crayon-58794da722ed1777055421-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">List</span><span class="crayon-e ">&lt;NameValuePair&gt;</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-i">ArrayList</span><span class="crayon-e ">&lt;NameValuePair&gt;</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722ed1777055421-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">params</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">BasicNameValuePair</span><span class="crayon-sy">(</span><span class="crayon-s">"Url"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">url</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722ed1777055421-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">params</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">BasicNameValuePair</span><span class="crayon-sy">(</span><span class="crayon-s">"To"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-st">to</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722ed1777055421-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">params</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">BasicNameValuePair</span><span class="crayon-sy">(</span><span class="crayon-s">"From"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">from</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722ed1777055421-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722ed1777055421-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">CallFactory </span><span class="crayon-v">callFactory</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">getAccount</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">getCallFactory</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722ed1777055421-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Call </span><span class="crayon-v">call</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">callFactory</span><span class="crayon-sy">.</span><span class="crayon-e">create</span><span class="crayon-sy">(</span><span class="crayon-i">params</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722ed1777055421-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-58794da722ed1777055421-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">catch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">TwilioRestException</span><span class="crayon-h"> </span><span class="crayon-i">e</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722ed1777055421-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">out</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-e">getErrorMessage</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58794da722ed1777055421-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-58794da722ed1777055421-16"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0095 seconds] -->
<p></p>
<h3><a name="h.a5gwp0akfs2s"></a>“Frank&#8217;s Back in Business”</h3>
<p>The last step is to buy a Twilio phone number and configure it to reach out to our 
			<span id="crayon-58794da722ee4306087831" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">TwilioCallerServlet</span></span> servlet. From the Twilio account dashboard, follow the animation below to purchase a new number. This number will serve as our support line.<br />
<img class="&quot; aligncenter" style="width: 624.00px; height: 538.67px; margin-left: 0.00px; margin-top: 10.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="" src="https://www.twilio.com/blog/wp-content/uploads/2015/08/qdNSwfiwrnavJgqtJuJuoVeL4HxHlcr4SANe6qTv3jipUxZpJXeXrDp-0AA7YbdlkQEBHyF27nOaAJJSZDUr3C-65wivmIIFjBR_bgSCOgA5OrDK01vpKRkC6rzqOfEVePubYX8.png" alt="Buying a Twilio Number" /></p>
<p>In the Setup Number screen, under Voice, set your ‘Request URL’ to the 
			<span id="crayon-58794da722ef7962576560" class="crayon-syntax crayon-syntax-inline  crayon-theme-github crayon-theme-github-inline crayon-font-consolas" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;"><span class="crayon-pre crayon-code" style="font-size: 16px !important; line-height: 24px !important;font-size: 16px !important;">CALL_ENDPOINT</span></span> URL we used in our code and click save:</p>
<p><img class="&quot; aligncenter" style="width: 624.00px; height: 206.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="" src="https://www.twilio.com/blog/wp-content/uploads/2015/08/UDnz8hWwm6roEbGWGfHEXMqZlPqqmtPCovwmIaj6Ky3VYYLNUxVRH9cqWoeQjoV3nBUtOatCIX0JtzjqXLygzPOma-c7PwNgr5rPT7EmtVVn7SkLsP2QzKzb-xRTnsE5QsNAoq0.png" alt="Configuring a Twilio Number" /></p>
<p>Remember to restart your Tomcat server and make sure your ngrok tunnel is online. You can test out your application by having someone call your Twilio number. Your first agent (Artemis) will receive a phone call and be placed into a conference with the caller. When Artemis presses &#8220;*1&#8221;, your second agent (Barnabas) will then receive a call and be placed into the same conference. This allows Artemis to introduce the caller before handing them off to Barnabas.</p>
<h3><a name="h.cjwq2wusm3fm"></a>It&#8217;s Always Servlet in Philadelphia</h3>
<p>Congratulations! You’ve now built a call center that supports warm transferring incoming callers. With warm transfers, your callers will now feel more like this:</p>
<p><img class="&quot; aligncenter" style="width: 463.50px; height: 232.57px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="" src="https://www.twilio.com/blog/wp-content/uploads/2015/08/tysfbGYfhBN2QM_YnaoPYidZYP6GVJxBlLMnRcU8fho_YHfXQeI4ijYyPD2h_fH4yVDBE8GIsmFihLtXSNF3yXJZITK_lXAan-lihEBLwZU87WUaQbLjQ8clnH2_0giDdQ3Tf5I.png" alt="It's Always Sunny dancing" /></p>
<p>Note: This is a very simple implementation of a call center and it can be improved in many ways. Keep your eyes peeled for future Java posts that expand on what we’ve built here.</p>
<p>If you ran into any issues or have feedback on this tutorial, please don’t hesitate to leave a comment below or reach out to me via Twitter <a href="https://twitter.com/brodan_" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://twitter.com/brodan_', '@brodan_');">@brodan_</a> or email me at <a class="c4" href="mailto:chranj@twilio.com">chranj@twilio.com</a>.</p>
			</div>
					</div>
	</div><!-- .entry-content -->

	<footer class="entry-footer col-md-12">
		<div class="entry-meta">
					<div class="social-buttons">
			<div class="fb-like" data-href="https://www.twilio.com/blog/2015/08/how-to-warm-transfer-a-call-with-java-and-twilio-voice.html" data-layout="button" data-action="like" data-show-faces="false" data-share="false"></div>
			<a href="https://twitter.com/share" class="twitter-share-button" data-via="twilio" data-count="none" data-url="https://www.twilio.com/blog/2015/08/how-to-warm-transfer-a-call-with-java-and-twilio-voice.html" data-text="How to Warm Transfer a Call with Java and Twilio Voice ">Tweet</a>
      <a href="https://twitter.com/twilio" class="twitter-follow-button" data-show-count="false">Follow @twilio</a>
		</div>
<span class="author-avatar"><img alt='' src='https://secure.gravatar.com/avatar/4c2a0ab72cfccecf425a1d9ba30add78?s=20&amp;d=mm&amp;r=g' srcset='https://secure.gravatar.com/avatar/4c2a0ab72cfccecf425a1d9ba30add78?s=40&amp;d=mm&amp;r=g 2x' class='avatar avatar-20 photo' height='20' width='20' /></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://www.twilio.com/blog/author/chranj">Chris Hranj</a></span></span> <span class="author-meta author-email"><a href="mailto:chranj@twilio.com">chranj@twilio.com</a></span>		</div>
	</footer><!-- .entry-footer -->

   <div class="build-more"><h3>Build More With Java</h3>        <a href="https://www.twilio.com/docs/tutorials/walkthrough/server-notifications/java/spark" onclick="__gaTracker('send', 'event', 'buildmore-widget', 'https://www.twilio.com/docs/tutorials/walkthrough/server-notifications/java/spark', '');">
          <h5>SMS and MMS Notifications with Java</h5>
        </a>
              <a href="https://www.twilio.com/blog/2015/09/getting-started-with-gradle-and-the-spark-framework-3.html" rel="bookmark" title="Permanent Link to Getting Started with Gradle and the Spark Framework" onclick="__gaTracker('send', 'event', 'buildmore-widget', 'https://www.twilio.com/blog/2015/09/getting-started-with-gradle-and-the-spark-framework-3.html', '');">
          <h5>Getting Started with Gradle and the Spark Framework<h4>
        </a>
                <a href="https://www.twilio.com/blog/2015/10/create-a-standalone-voicemail-using-java-and-twilio.html" rel="bookmark" title="Permanent Link to Create a Standalone Voicemail Using Java and Twilio" onclick="__gaTracker('send', 'event', 'buildmore-widget', 'https://www.twilio.com/blog/2015/10/create-a-standalone-voicemail-using-java-and-twilio.html', '');">
          <h5>Create a Standalone Voicemail Using Java and Twilio<h4>
        </a>
                <a href="https://www.twilio.com/blog/2015/11/getting-started-with-spring-mvc-and-twilio.html" rel="bookmark" title="Permanent Link to Getting started with Spring MVC and Twilio" onclick="__gaTracker('send', 'event', 'buildmore-widget', 'https://www.twilio.com/blog/2015/11/getting-started-with-spring-mvc-and-twilio.html', '');">
          <h5>Getting started with Spring MVC and Twilio<h4>
        </a>
        </div>
</article><!-- #post-## -->

			
<div id="disqus_thread">
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'https://www.twilio.com/blog/2015/08/how-to-warm-transfer-a-call-with-java-and-twilio-voice.html';
    var disqus_identifier = 'https://www.twilio.com/blog/2015/08/15742 http://twilioinc.wpengine.com/?p=15742';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'twilioblog';
    var disqus_title = "How to Warm Transfer a Call with Java and Twilio Voice";
        var disqus_config = function () {
        var config = this; // Access to the config object
        config.language = '';

        /*
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            var script = document.createElement('script');
            script.async = true;
            script.src = 'https://www.twilio.com/blog/2015/08/how-to-warm-transfer-a-call-with-java-and-twilio-voice.html?cf_action=sync_comments&amp;post_id=15742';

            var firstScript = document.getElementsByTagName( "script" )[0];
            firstScript.parentNode.insertBefore(script, firstScript);
        });
                    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "https:\/\/www.twilio.com\/blog\/2015\/08\/how-to-warm-transfer-a-call-with-java-and-twilio-voice.html\/trackback"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.' + 'disqus.com' + '/embed.js?pname=wordpress&pver=2.74';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area col-md-3 hide-xs" role="complementary">
	<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://www.twilio.com/blog/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside><aside id="text-2" class="widget widget_text">			<div class="textwidget"><p>Power modern communications. Build the next generation of voice and SMS applications.</p>

 <a href="http://twilio.com/try-twilio" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://twilio.com/try-twilio', 'Start Building For Free');" class="btn">Start Building For Free</a></div>
		</aside><style scoped type="text/css">.utcw-8ngloje {word-wrap:break-word}.utcw-8ngloje span,.utcw-8ngloje a{border-style:solid;border-width:1px}.utcw-8ngloje span:hover,.utcw-8ngloje a:hover{border-style:solid;border-width:1px}</style><aside id="utcw-2" class="widget widget_utcw widget_tag_cloud"><h1 class="widget-title">Posts By Stack</h1><div class="utcw-8ngloje tagcloud"><a class="tag-link-22 utcw-tag utcw-tag-net" href="https://www.twilio.com/blog/tag/net" style="font-size:16px" title="40 topics">.NET</a> <a class="tag-link-98 utcw-tag utcw-tag-arduino" href="https://www.twilio.com/blog/tag/arduino" style="font-size:16px" title="21 topics">Arduino</a> <a class="tag-link-598 utcw-tag utcw-tag-java" href="https://www.twilio.com/blog/tag/java" style="font-size:16px" title="14 topics">Java</a> <a class="tag-link-600 utcw-tag utcw-tag-javascript" href="https://www.twilio.com/blog/tag/javascript" style="font-size:16px" title="86 topics">JavaScript</a> <a class="tag-link-847 utcw-tag utcw-tag-php" href="https://www.twilio.com/blog/tag/php" style="font-size:16px" title="57 topics">PHP</a> <a class="tag-link-891 utcw-tag utcw-tag-python" href="https://www.twilio.com/blog/tag/python" style="font-size:16px" title="72 topics">Python</a> <a class="tag-link-969 utcw-tag utcw-tag-ruby" href="https://www.twilio.com/blog/tag/ruby" style="font-size:16px" title="69 topics">Ruby</a> <a class="tag-link-2856 utcw-tag utcw-tag-swift" href="https://www.twilio.com/blog/tag/swift" style="font-size:16px" title="22 topics">Swift</a></div></aside><style scoped type="text/css">.utcw-5dkhj5o {word-wrap:break-word}.utcw-5dkhj5o span,.utcw-5dkhj5o a{border-style:solid;border-width:1px}.utcw-5dkhj5o span:hover,.utcw-5dkhj5o a:hover{border-style:solid;border-width:1px}</style><aside id="utcw-3" class="widget widget_utcw widget_tag_cloud"><h1 class="widget-title">Posts By Product</h1><div class="utcw-5dkhj5o tagcloud"><a class="tag-link-2043 utcw-tag utcw-tag-mms" href="https://www.twilio.com/blog/tag/mms" style="font-size:16px" title="50 topics">MMS</a> <a class="tag-link-3513 utcw-tag utcw-tag-programmable-chat" href="https://www.twilio.com/blog/tag/programmable-chat" style="font-size:16px" title="9 topics">Programmable Chat</a> <a class="tag-link-1537 utcw-tag utcw-tag-sip" href="https://www.twilio.com/blog/tag/sip" style="font-size:16px" title="15 topics">SIP</a> <a class="tag-link-1031 utcw-tag utcw-tag-sms" href="https://www.twilio.com/blog/tag/sms" style="font-size:16px" title="372 topics">SMS</a> <a class="tag-link-2871 utcw-tag utcw-tag-taskrouter" href="https://www.twilio.com/blog/tag/taskrouter" style="font-size:16px" title="8 topics">Task Router</a> <a class="tag-link-1199 utcw-tag utcw-tag-twilio-client" href="https://www.twilio.com/blog/tag/twilio-client" style="font-size:16px" title="32 topics">Twilio Client</a> <a class="tag-link-3032 utcw-tag utcw-tag-twilio-video" href="https://www.twilio.com/blog/tag/twilio-video" style="font-size:16px" title="9 topics">Twilio Video</a> <a class="tag-link-1277 utcw-tag utcw-tag-voice" href="https://www.twilio.com/blog/tag/voice" style="font-size:16px" title="172 topics">Voice</a></div></aside><aside id="text-5" class="widget widget_text">			<div class="textwidget"><a href="http://www.twilio.com/docs/tutorials" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/docs/tutorials', '');"><img src="https://www.twilio.com/blog/wp-content/uploads/2016/07/tutorials.png" style="width: 255px" /></a></div>
		</aside><aside id="categories-3" class="widget widget_categories"><h1 class="widget-title">Categories</h1>		<ul>
	<li class="cat-item cat-item-13"><a href="https://www.twilio.com/blog/all-things-code" >Code, Tutorials and Hacks</a>
</li>
	<li class="cat-item cat-item-5"><a href="https://www.twilio.com/blog/customer-highlights" >Customer Highlights</a>
</li>
	<li class="cat-item cat-item-7"><a href="https://www.twilio.com/blog/developers-drawing-the-owl" >Developers Drawing The Owl</a>
</li>
	<li class="cat-item cat-item-3"><a href="https://www.twilio.com/blog/news" >News</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://www.twilio.com/blog/stories-from-the-road" >Stories From The Road</a>
</li>
	<li class="cat-item cat-item-8"><a href="https://www.twilio.com/blog/inside-twilio" >The Owl’s Nest: Inside Twilio</a>
</li>
		</ul>
</aside><aside id="text-4" class="widget widget_text">			<div class="textwidget"><div class="tagcloud "><a href="http://www.twilio.com/blog/feed" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://www.twilio.com/blog/feed', 'RSS Feed');">RSS Feed</a></div></div>
		</aside></div><!-- #secondary -->

		</div><!-- .row -->
	</div><!-- #content.container -->

<div class="" id="footer">
	<div class="container">
		<header>
			<div class="banner"></div>
			<div class="border"></div>
			<div class="stitching"></div>
		</header>
    <div class="row sitemap">
      <div class="row">
        <div class="col-md-2 col-md-offset-1">
          <h4><a href="http://www.twilio.com/company">Company</a></h4>
          <ul>
            <li><a href="http://www.twilio.com/company">About Twilio</a></li>
            <li><a href="http://www.twilio.com/company/nine-values">Our Nine Values</a></li>
            <li><a href="http://www.twilio.com/company/leadership-principles">Our Leadership Principles</a></li>
            <li><a href="http://www.twilio.com/company/management">The Team</a></li>
            <li><a href="http://www.twilio.com/press">Press &amp; Media</a></li>
            <li><a href="http://www.twilio.org/">Twilio.org</a></li>
            <li><a href="http://www.twilio.com/company/jobs">Careers</a></li>
          </ul>
        </div>
        <div class="col-md-2">
          <h4><a href="http://www.twilio.com/products">Products</a></h4>
          <ul>
            <li><a href="http://www.twilio.com/voice">Voice</a></li>
            <li><a href="http://www.twilio.com/video">Video</a></li>
            <li><a href="http://www.twilio.com/sms">SMS (Text Messaging)</a></li>
            <li><a href="http://www.twilio.com/mms">MMS (Picture Messaging)</a></li>
            <li><a href="http://www.twilio.com/sms/toll-free">Toll-Free SMS</a></li>
            <li><a href="http://www.twilio.com/sip-trunking">SIP Trunking</a></li>
            <li><a href="http://www.twilio.com/client/mobile">Client Mobile</a></li>
            <li><a href="http://www.twilio.com/webrtc">Client WebRTC</a></li>
            <li><a href="http://www.twilio.com/stun-turn">Network Traversal Service</a></li>
            <li><a href="http://www.twilio.com/taskrouter">TaskRouter</a></li>
            <li><a href="http://www.twilio.com/sms/phone-numbers">Phone Numbers</a></li>
            <li><a href="http://www.twilio.com/sms/shortcodes">Short Codes</a></li>
            <li><a href="http://www.twilio.com/support-plans">Support Plans</a></li>
            <li><a href="http://www.twilio.com/platform">Platform</a></li>
            <li><a href="http://www.twilio.com/lookup">Lookup</a></li>
            <li><a href="http://www.twilio.com/monitor">Monitor</a></li>
            <li><a href="http://www.twilio.com/copilot">Messaging Copilot</a></li>
            <li><a href="http://www.twilio.com/voice/conference">Global Conference</a></li>
            <li><a href="http://www.twilio.com/authy">Authy</a></li>
          </ul>
      </div>
      <div class="col-md-2">
        <h4><a href="http://www.twilio.com/pricing">Pricing</a></h4>
        <ul>
          <li><a href="http://www.twilio.com/voice/pricing">Voice Pricing</a></li>
          <li><a href="http://www.twilio.com/sms/pricing">Messaging Pricing</a></li>
          <li><a href="http://www.twilio.com/sip-trunking/pricing">SIP Trunking Pricing</a></li>
          <li><a href="http://www.twilio.com/client/pricing">Client Pricing</a></li>
          <li><a href="http://www.twilio.com/stun-turn/pricing">Network Traversal Pricing</a></li>
          <li><a href="http://www.twilio.com/taskrouter/pricing">TaskRouter</a></li>
          <li><a href="http://www.twilio.com/lookup#pricing">Lookup</a></li>
          <li><a href="http://www.twilio.com/international">International Coverage</a></li>
        </ul>
      </div>
      <div class="col-md-2">
          <h4><a href="http://www.twilio.com/use-cases">Use Cases</a></h4>
          <ul>
            <li><a href="http://www.twilio.com/customers">Customer Stories</a></li>
            <li><a href="http://www.twilio.com/showcase">Showcase</a></li>
            <li><a href="http://www.twilio.com/use-cases/two-factor-authentication">Two-Factor Authentication</a></li>
            <li><a href="http://www.twilio.com/use-cases/appointment-reminders">Appointment Reminders</a></li>
            <li><a href="http://www.twilio.com/use-cases/dispatch-notifications">Dispatch Notifications</a></li>
            <li><a href="http://www.twilio.com/use-cases/eta-alerts">ETA Alerts</a></li>
            <li><a href="http://www.twilio.com/use-cases/automated-surveys">Automated Surveys</a></li>
            <li><a href="http://www.twilio.com/use-cases/masked-phone-numbers">Masked Phone Numbers</a></li>
            <li><a href="http://www.twilio.com/use-cases/visual-estimates">Visual Estimates</a></li>
            <li><a href="http://www.twilio.com/doers">Developer Network</a></li>
            <li><a href="http://www.twilio.com/webinars">Webinars</a></li>
            <li><a href="http://www.twilio.com/white-papers">White Papers</a></li>
          </ul>
      </div>
      <div class="col-md-2">
          <h4><a href="http://www.twilio.com/api">Api &amp; Docs</a></h4>
          <ul>
            <li><a href="http://www.twilio.com/docs/api">API Documentation</a></li>
            <li><a href="http://www.twilio.com/docs/quickstart">Quickstarts</a></li>
            <li><a href="http://www.twilio.com/docs/howto">How Tos</a></li>
            <li><a href="http://www.twilio.com/docs/libraries">Helper Libraries</a></li>
            <li><a href="http://www.twilio.com/docs/security">Security</a></li>
          </ul>
      </div>
    </div>
		<div class="row clear">
			<footer><span>&copy; 2017 Twilio. All rights reserved. <aside>|</aside><a href="http://www.twilio.com/legal/tos">Terms of Service</a><aside>|</aside><a href="http://www.twilio.com/legal/privacy">Privacy Policy</a></span>
			</footer>
		</div>
	</div>
</div>


</div><!-- #page -->

<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201702'></script>







<script type="text/javascript" defer src="https://www.twilio.com/blog/wp-content/cache/autoptimize/js/autoptimize_30cf8936a215677503cd64ef48677239.js"></script></body>

<!-- Mirrored from www.twilio.com/blog/2015/08/how-to-warm-transfer-a-call-with-java-and-twilio-voice.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 22:09:59 GMT -->
</html>
