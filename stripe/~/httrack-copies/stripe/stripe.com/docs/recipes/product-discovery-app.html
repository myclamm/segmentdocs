<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from stripe.com/docs/recipes/product-discovery-app by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 23:49:30 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    
    <meta charset="utf-8">
    <meta name="google-site-verification" content="f0LCrdI6z4Fo8zld4sHCgo5SiUE4EYYRUa6KVeX3Mw8" />
    <meta name="csrf-token" content="YoigOAkUACywVyVmWCdUmv0sp9Xkk2w3KnhhG8ohAon7ErRFD9HEaX0TAXmUL2Hh1FIpUrg_rZdrzWszb_bI-A==">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Building a Product Discovery App</title>

    <meta name="description" content="Stripe is a suite of APIs that powers commerce for businesses of all sizes.">


    <link rel="shortcut icon" href="../../favicon.ico">

    <link rel="apple-touch-icon-precomposed" href="../../img/apple-touch-icon/180x180.png">
    <link rel="icon" href="../../img/apple-touch-icon/180x180.png">


    <link rel="image_src" type="image/png" href="../../img/v3/home/social.png">

    <meta property="og:title" content="Building a Product Discovery App">
    <meta property="og:url" content="product-discovery-app.html">
    <meta property="og:description" content="Stripe is a suite of APIs that powers commerce for businesses of all sizes.">
    <meta property="og:image" content="../../img/v3/home/social.png">

      <meta name="twitter:card" content="summary">
      <meta name="twitter:image" content="../../img/v3/home/twitter.png">
    <meta name="twitter:site" content="@stripe">
    <meta name="twitter:title" content="Building a Product Discovery App">
    <meta name="twitter:description" content="Stripe is a suite of APIs that powers commerce for businesses of all sizes.">


    <script type="application/json" id="strut_files">{&quot;v3/shared/navigation_ie10.css&quot;:&quot;/assets/v3/shared/navigation_ie10-ec238f46e7cb9867e3c1b529e2cfa37b.css&quot;}</script>

    

    

    <link rel="stylesheet" href="../../assets/v3/default-ef2bff54073622b9e08cf24466b5668f.css">
    <link rel="stylesheet" href="../../assets/v3/shared/common-d0fb03fa2d48fcf29010779ca9a12b2c.css">
    <link rel="stylesheet" href="../../assets/v3/documentation/base-47c1fd7d3d670e4e08df8f5a67b20dea.css">
    <link rel="stylesheet" href="../../assets/v3/shared/prism_light-6d08c6ec0d72453693d775c3b96629c0.css">
    
      <link rel="stylesheet" href="../../assets/v3/documentation/connect_button-32eb736084ce624a104acae94437b9e2.css">

    <meta name="viewport" content="width=1060">
    <meta name="robots" content="noarchive">
  </head>
  <body class="">
    
    <div id="docs">
      <div id="sidebar">
        <div class="logo">
          <a class="site" href="../../index.html" title="Stripe"></a>
          <a class="extension" href="../../docs.html">docs</a>
        </div>
        <div class="nav-border"></div>
        <nav>
          <h1 class="home"><a href="../../docs.html">Home</a></h1>
          <h1 class="payments"><a class="toggle-content">Payments</a></h1>
<ul class='hidden' data-hidden=true>
    <li>
      <a href="../quickstart.html">Quickstart</a>
    </li>
    <li class="category">Collecting payment details
    </li>
    <li>
      <a href="../checkout/tutorial.html">Checkout</a>
      <ul class='hidden' data-hidden=true>
    <li>
      <a href="../checkout.html">Reference</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../custom-form.html">Stripe.js</a>
      <ul class='hidden' data-hidden=true>
    <li>
      <a href="../stripe.html">Reference</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../mobile/ios.html">iOS</a>
    </li>
    <li>
      <a href="../mobile/android.html">Android</a>
    </li>
    <li class="category">Charges
    </li>
    <li>
      <a href="../charges.html">Creating Charges</a>
    </li>
    <li>
      <a href="../declines.html">Declines &amp; Failed Payments</a>
    </li>
    <li>
      <a href="../disputes.html">Disputes</a>
      <ul class='hidden' data-hidden=true>
    <li>
      <a href="../disputes/evidence.html">Submitting Evidence</a>
    </li>
    <li>
      <a href="../disputes/types.html">Types</a>
    </li>
    <li>
      <a href="../disputes/faq.html">FAQ</a>
    </li>
</ul>

    </li>
    <li class="category">Products &amp; Orders
    </li>
    <li>
      <a href="../orders.html">Orders</a>
      <ul class='hidden' data-hidden=true>
    <li>
      <a href="../orders/guide.html">Guide</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../orders/tax-integration.html">Tax Integrations</a>
    </li>
    <li>
      <a href="../orders/shipping-integration.html">Shipping Integrations</a>
    </li>
    <li>
      <a href="../sources.html">Getting Started</a>
    </li>
    <li>
      <a href="../sources/payment-methods.html">Payment Methods</a>
      <ul class='hidden' data-hidden=true>
    <li>
      <a href="../sources/cards.html">Cards</a>
    </li>
    <li>
      <a href="../sources/3d-secure.html">3D Secure</a>
    </li>
    <li>
      <a href="../sources/bancontact.html">Bancontact</a>
    </li>
    <li>
      <a href="../sources/giropay.html">Giropay</a>
    </li>
    <li>
      <a href="../sources/ideal.html">iDEAL</a>
    </li>
    <li>
      <a href="../sources/sepa-direct-debit.html">SEPA Direct Debit</a>
    </li>
    <li>
      <a href="../sources/sofort.html">Sofort</a>
    </li>
</ul>

    </li>
    <li class="category">Other Payment Methods
    </li>
    <li>
      <a href="../ach.html">ACH</a>
    </li>
    <li>
      <a href="../apple-pay.html">Apple Pay</a>
      <ul class='hidden' data-hidden=true>
    <li>
      <a href="../apple-pay/apps.html">Apple Pay in Apps</a>
    </li>
    <li>
      <a href="../apple-pay/web.html">Apple Pay on the Web</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../alipay.html">Alipay</a>
    </li>
    <li>
      <a href="../bitcoin.html">Bitcoin</a>
    </li>
    <li class='separator'>
      <a href="../testing.html">Testing</a>
    </li>
</ul>

          <h1 class="subscriptions"><a class="toggle-content">Subscriptions</a></h1>
<ul class='hidden' data-hidden=true>
    <li>
      <a href="../subscriptions/quickstart.html">Quickstart</a>
    </li>
    <li>
      <a href="../subscriptions/creating.html">Creating Subscriptions</a>
      <ul data-collapsable=false>
    <li>
      <a href="../subscriptions/discounts.html">Applying Discounts</a>
    </li>
    <li>
      <a href="../subscriptions/trials.html">Using Trial Periods</a>
    </li>
    <li>
      <a href="../subscriptions/quantities.html">Setting Quantities</a>
    </li>
    <li>
      <a href="../subscriptions/taxes.html">Adding Taxes</a>
    </li>
    <li>
      <a href="../subscriptions/multiple.html">Multiple Subscriptions</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../subscriptions/lifecycle.html">Lifecycle &amp; Events</a>
    </li>
    <li>
      <a href="../subscriptions/webhooks.html">Using Webhooks</a>
    </li>
    <li>
      <a href="../subscriptions/changing.html">Changing Subscriptions</a>
      <ul data-collapsable=false>
    <li>
      <a href="../subscriptions/upgrading-downgrading.html">Upgrading &amp; Downgrading</a>
    </li>
    <li>
      <a href="../subscriptions/billing-cycle.html">Billing Cycle</a>
    </li>
    <li>
      <a href="../subscriptions/canceling-pausing.html">Canceling &amp; Pausing</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../subscriptions/invoices.html">Working with Invoices</a>
      <ul data-collapsable=false>
</ul>

    </li>
    <li>
      <a href="../subscriptions/plans.html">Managing Plans</a>
    </li>
    <li>
      <a href="../subscriptions/testing.html">Testing</a>
    </li>
</ul>

          <h1 class="connect"><a class="toggle-content">Connect</a></h1>
<ul class='hidden' data-hidden=true>
    <li>
      <a href="../connect.html">Overview</a>
    </li>
    <li>
      <a href="../connect/connecting-to-accounts.html">Connecting to Accounts</a>
      <ul data-collapsable=false>
    <li>
      <a href="../connect/authentication.html">Authentication</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../connect/standalone-accounts.html">Standalone Accounts</a>
      <ul data-collapsable=false>
    <li>
      <a href="../connect/reference.html">OAuth Reference</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../connect/managed-accounts.html">Managed Accounts</a>
      <ul data-collapsable=false>
    <li>
      <a href="../connect/updating-accounts.html">Updating Accounts</a>
    </li>
    <li>
      <a href="../connect/identity-verification.html">Identity Verification</a>
    </li>
    <li>
      <a href="../connect/required-verification-information.html">Verification Fields</a>
    </li>
    <li>
      <a href="../connect/testing-verification.html">Testing Verification</a>
    </li>
    <li>
      <a href="../connect/bank-transfers.html">Bank Transfers</a>
    </li>
    <li>
      <a href="../connect/migrating.html">Migrating Recipients</a>
    </li>
    <li>
      <a href="../connect/best-practices.html">Best Practices</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../connect/payments-fees.html">Payments and Fees</a>
    </li>
    <li>
      <a href="../connect/special-case-transfers.html">Special-case Transfers</a>
    </li>
    <li class='separator'>
      <a href="../connect/testing.html">Testing</a>
    </li>
</ul>

          <h1 class="relay"><a class="toggle-content">Relay</a></h1>
<ul class='hidden' data-hidden=true>
    <li>
      <a href="../relay.html">Selling in Other Apps</a>
    </li>
    <li>
      <a href="../relay/apps-guide.html">Accepting Orders in Your App</a>
      <ul data-collapsable=false>
    <li>
      <a href="../relay/apps-error-guide.html">Error Handling</a>
    </li>
</ul>

    </li>
</ul>

          <h1 class="radar"><a class="toggle-content">Radar</a></h1>
<ul class='hidden' data-hidden=true>
    <li>
      <a href="../radar.html">Overview</a>
    </li>
    <li>
      <a href="../radar/risk-evaluation.html">Risk Evaluation</a>
    </li>
    <li>
      <a href="../radar/review.html">Review</a>
      <ul data-collapsable=false>
    <li>
      <a href="../radar/review/auth-and-capture.html">Uncaptured Payments</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../radar/rules.html">Rules</a>
      <ul data-collapsable=false>
    <li>
      <a href="../radar/rules/reference.html">Reference</a>
    </li>
</ul>

    </li>
    <li class='separator'>
      <a href="../radar/testing.html">Testing</a>
    </li>
</ul>

          <h1 class="account"><a class="toggle-content">Account</a></h1>
<ul class='hidden' data-hidden=true>
    <li>
      <a href="../dashboard.html">Your Account</a>
    </li>
    <li>
      <a href="../checklist.html">Going Live Checklist</a>
    </li>
    <li>
      <a href="../transfers.html">Getting Paid</a>
    </li>
    <li>
      <a href="../reporting.html">Reporting</a>
    </li>
</ul>

          <h1 class="api"><a class="toggle-content">Development</a></h1>
<ul class='hidden' data-hidden=true>
    <li>
      <a href="../libraries.html">API Libraries</a>
    </li>
    <li>
      <a href="../upgrades.html">API Upgrades</a>
    </li>
    <li>
      <a href="../webhooks.html">Webhooks</a>
    </li>
    <li>
      <a href="../building-integrations.html">Integrations</a>
    </li>
    <li>
      <a href="../recipes.html">Recipes</a>
    </li>
    <li>
      <a href="../security.html">Security</a>
    </li>
</ul>


          <h1 class="references"><a href="../api.html" class="external" target="_blank">API Reference</a></h1>
        </nav>
      </div>
      <div id="content-wrapper" tabindex="0">
        <div class="overlay"></div>
        <header id="main-header">
          <nav>
            <ul class="external">
              <li><a href="https://support.stripe.com/">Support</a></li>

              <li class="button">
                <a data-adroll-segment='submit_two' href="https://dashboard.stripe.com/login">Sign in</a>
              </li>
            </ul>
          </nav>
        </header>
        <article id="content">
          
<header>
  <h1>Building a Product Discovery App</h1>
  <p>Learn how to develop and test your own product discovery app using <a href="../../relay.html">Relay</a> and the <a href="https://bestbuy.com/">Best Buy</a> product catalog. If you need help after reading this, check out our answers to <a href="https://support.stripe.com/search?q=relay">common questions</a> or chat live with other developers in <a href="irc://irc.freenode.net/stripe">#stripe</a> on freenode.
</p>
</header>

<section>
  <aside class="note">
    <h3>More recipes</h3>
    <p>Check out our <a href="../recipes.html">other recipes</a> and discover more ways to integrate Stripe.</p>
  </aside>

  <div id="best_buy-logo-modal" alt="Best Buy logo" class="caption-image right"></div>

<p>The <a href="../orders.html">Orders API</a> expands what Stripe users can do beyond processing charges:</p>

<ul>
  <li><em>Sellers</em> can represent a product catalog in Stripe and accept orders.</li>
  <li><em>App Developers</em> can render products from and submit orders to sellers, acting as new sales channels for them.</li>
</ul>

<p>Through Relay, otherwise complex processes–accessing product feeds, selling products for other businesses, and accepting payments–are reduced to simple and direct API calls.</p>

<p>The following steps walk through the development of a product-discovery application that provides a “Buy Button” experience. With a quick and obvious user workflow, an HTML link–embedded on a web page, shared through social media, or shown within a mobile app–can be the foundation of a complete ordering process.</p>

<p>In a normal workflow, as described in the <a href="../relay/apps-guide.html">Relay API for Apps</a> guide, an app developer creates a platform using <a href="../connect.html">Stripe Connect</a> and is then granted access to other Stripe accounts through an <a href="../connect/standalone-accounts.html">OAuth flow</a>. To make it easy to get started building Relay-powered apps, <a href="https://bestbuy.com/">Best Buy</a> makes their product inventory accessible to app developers in test mode.</p></section>

<section>
<h2 id="connect-to-best-buy">Connect to Best Buy</h2>

<aside class="note">
  <h3>Demo your product catalog</h3>
  <p>Please <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#114;&#101;&#108;&#097;&#121;&#045;&#097;&#112;&#112;&#045;&#098;&#101;&#115;&#116;&#098;&#117;&#121;&#064;&#115;&#116;&#114;&#105;&#112;&#101;&#046;&#099;&#111;&#109;">contact us</a> if you’d like to also make your catalog available to users for easy testing purposes as Best Buy has done.</p>
</aside>

<p>With a live application, you would invite sellers to connect their Stripe accounts to your platform. Doing so allows you to access their product catalog and place orders for them directly from your app. For the purpose of this recipe, we automated the connection process using the <em>Best Buy Demo</em> account. The connection gives you the following permissions:</p>

<ul>
  <li>Read-only access to Products and SKUs</li>
  <li>Write access to create and pay for Orders</li>
</ul>

<p>Please note that the connection is created in test mode only (no live orders can be processed), webhooks are disabled, and access is limited to the Relay API endpoints. In order to start creating live mode orders, you will need Best Buy to authenticate your app. Please reach out to <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#114;&#101;&#108;&#097;&#121;&#045;&#097;&#112;&#112;&#043;&#098;&#101;&#115;&#116;&#098;&#117;&#121;&#064;&#115;&#116;&#114;&#105;&#112;&#101;&#046;&#099;&#111;&#109;">&#114;&#101;&#108;&#097;&#121;&#045;&#097;&#112;&#112;&#043;&#098;&#101;&#115;&#116;&#098;&#117;&#121;&#064;&#115;&#116;&#114;&#105;&#112;&#101;&#046;&#099;&#111;&#109;</a> to request a connection.</p>

    <p>
      <a href="javascript:connect()" class="connect-button"><span>Connect the Relay Demo account to your platform</span></a>
    </p>

<p>After automatically connecting, you should be all set to retrieve and use the <em>Relay Demo</em> product catalog as described in the following sections.</p>

<p>If you’ve used Connect before, you may have noticed no API key was returned as part of the connection process. Instead, you can use the <code>Stripe-Account</code> header to make requests on behalf of the <em>Relay Demo</em> account, whose ID is <code>acct_16TZFyGRAn672XBM</code>. Using the <code>Stripe-Account</code> header is described in more detail in <a href="../connect/authentication.html">Authentication with Connect</a>.</p></section>

<section>
<h2 id="retrieve-products-and-skus">Retrieve products and SKUs</h2>

<p>After connecting to the <em>Relay Demo</em> account, the next step is to discover the products they’ve made available for sale. Do so by hitting the “list all products” endpoint, passing along a value of true for the <code>active</code> parameter. (Sellers can make products inactive to make them unavailable for purchase.)</p>

<p>The “list all products” endpoint uses the standard Stripe <a href="../api.html#pagination">pagination</a>:</p>
<div class="code">
  <nav class="nav-filename icon-terminal">
    Terminal
  </nav>
  <pre class="language-curl numbered" ><code>curl https://api.stripe.com/v1/products?active=true \
   -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \
   -H &quot;Stripe-Account: acct_16TZFyGRAn672XBM&quot;
</code></pre>
</div>

<p>You’ll find available products in the <code>data</code> property of the API response.</p>
<div class="code">
  <pre class="language-javascript numbered" ><code>{
  &quot;object&quot;: &quot;list&quot;,
  &quot;has_more&quot;: true,
  &quot;url&quot;: &quot;/v1/products&quot;,
  &quot;data&quot;: [
   {
     &quot;id&quot;: &quot;4397400&quot;,
     &quot;livemode&quot;: false,
     &quot;created&quot;: 1445541476,
     &quot;updated&quot;: 1446082438,
     &quot;object&quot;: &quot;product&quot;,
     &quot;active&quot;: true,
     &quot;name&quot;: &quot;Google - Chromecast (2015 Model) - Black&quot;,
     &quot;caption&quot;: &quot;Allows you to stream shows, movies, music, sports and games to your TV; compatible with most Apple&amp;#174; iOS and Android phones and tablets, Mac and Windows laptops and Chromebooks&quot;,
     &quot;description&quot;: &quot;Google Chromecast (2015 Model): Enjoy a world of entertainment with Google Chromecast (2015). Just connect to your HDTV&#39;s HDMI interface and your home Wi-Fi network to get started. You can stream your favorite apps from your compatible phone, tablet or laptop, plus use your phone as a remote to search, play and pause content.\nWhat&#39;s included:\n- Chromecast (2015 Model)\n- Power cable, power adapter\n&quot;,
     &quot;url&quot;: &quot;http://www.bestbuy.com/site/google-chromecast-2015-model-black/4397400.p?id=1219757973565&amp;skuId=4397400&amp;cmp=RMX&amp;ky=1uW6SrOhtsDwV32tCtCxtuDpj7SNO9ptQ&quot;,
     &quot;attributes&quot;: [],
     &quot;shippable&quot;: true,
     &quot;package_dimensions&quot;: null,
     &quot;metadata&quot;: {
       &quot;best_buy.product_id&quot;: &quot;1219757973565&quot;
     },
     &quot;images&quot;: [
       &quot;http://img.bbystatic.com/BestBuy_US/images/products/4397/4397400_sb.jpg&quot;,
       &quot;http://img.bbystatic.com/BestBuy_US/images/products/4397/4397400_sa.jpg&quot;,
       &quot;http://img.bbystatic.com/BestBuy_US/images/products/4397/4397400fp.gif&quot;,
       &quot;http://img.bbystatic.com/BestBuy_US/images/products/4397/4397400_sc.jpg&quot;
     ],
     &quot;skus&quot;: {
       &quot;url&quot;: &quot;/v1/skus?product=4397400&amp;active=true&quot;,
       &quot;total_count&quot;: 1,
       &quot;has_more&quot;: false,
       &quot;data&quot;: [
         {
           &quot;updated&quot;: 1445541476,
           &quot;product&quot;: &quot;4397400&quot;,
           &quot;price&quot;: 3500,
           &quot;package_dimensions&quot;: null,
           &quot;metadata&quot;: null,
           &quot;livemode&quot;: false,
           &quot;inventory&quot;: {
             &quot;value&quot;: &quot;in_stock&quot;,
             &quot;type&quot;: &quot;bucket&quot;,
             &quot;quantity&quot;: null
           },
           &quot;image&quot;: null,
           &quot;currency&quot;: &quot;usd&quot;,
           &quot;created&quot;: 1445541476,
           &quot;attributes&quot;: null,
           &quot;active&quot;: true,
           &quot;object&quot;: &quot;sku&quot;,
           &quot;id&quot;: &quot;4397400&quot;
         }
       ],
       &quot;object&quot;: &quot;list&quot;
     },
     ...
   }
  ]
}</code></pre>
</div>

<p>A <em>Product</em> is a representation of something you sell. Each variant of a product is called a SKUs (pronounced “skew”, short for <a href="https://en.wikipedia.org/wiki/Stock_keeping_unit">Stock Keeping Unit</a>). SKUs are what customers actually puchase. As an example a product is a pair of “Nike Free 5.0”, and the SKUs are the different sizes and colors. To process orders on behalf of sellers (such as Best Buy, in this example), you’ll need to know not just the available products, but also the available SKUs.</p>

<p>As a convenience, <a href="../api.html#sku_object">SKU objects</a> are automatically expanded in the product objects returned by the API. For each acceptable product attribute–size, color, etc., SKUs have specified values–small/medium, tan/blue, etc. SKUs also contain inventory and price information. When you create an order, you order a specific SKU and not just a product</p>

<p>Depending on your app discovery mechanism, you may cache the products and SKUs in your app or database to present them to yours users, but make sure to get up-to-date information from the Relay API as products and SKUs availability may change regularly.</p>  <div id="spring-static-modal" alt="Spring Experience" class="caption-image right"></div>
</section>

<section>
<h2 id="order-workflow">Order workflow</h2>

<p>Now that you have access to and knowledge of the <em>Relay Demo</em> product catalog, you can create orders through your app. There are a few steps in the process; each will be explained in detail.</p>

<ul>
  <li><strong>Present products for purchase</strong>: Render product information (price, availability) and a Buy option to users.</li>
  <li><strong>Allow user to choose between variants (SKUs)</strong>, if need be: If the product has been identified but not the precise SKU (e.g., size, color, and so forth) a dialog should be presented to the user to select a specific SKU or list of SKUs to purchase.</li>
  <li><strong>Create customers in Stripe</strong>: For ease of repeat purchases, we encourage you to create customer records in Stripe and then use these records as the basis of orders. As the <em>Relay Demo</em> products are shippable, the customer’s shipping information should be attached to his profile.</li>
  <li><strong>Create the order</strong>: Create the order in Stripe by providing the items to be purchased and the customer information. Order creation returns computed tax and shipping information that can be presented back to the user for confirmation.</li>
  <li><strong>Collect payment information</strong>: Collect the customer’s payment details. You can do so at any time prior to paying for the order.</li>
  <li><strong>Pay for the order</strong>: Using the collected payment information.</li>
</ul>

<h3 id="present-products-for-purchase">Present products for purchase</h3>

<p>With the product and SKU information in hand, you can present individual items or a catalog to your users for consideration. <a href="../api.html#product_object">Products</a> can have multiple images, short captions, long-form descriptions, and associated URLs. Combine these as you see fit in ways that match your app’s feel and intent.</p>

<p>Through clickable buttons, images, or links, your users can indicate a desire to purchase an item. If a product comes in multiple variations (i.e., has multiple SKUs), additional interface elements can be used to identify the specific variant to buy. Once a specific SKU is identified, an order can be created. (If a product only comes in one variant, then you’ll already know the SKU to use, but orders are always made using SKU IDs, not product IDs.)</p>

<h3 id="create-a-customer-in-stripe">Create a customer in Stripe</h3>

<p>Creating reusable customer profiles is central to having a seamless e-commerce experience in your app. By creating customer profiles, repeat purchases can be made with a simple button click and a confirmation; no additional information need be provided.</p>

<p>The Relay endpoints work harmoniously with our <a href="../api.html#customers">Customer objects</a>. An app like yours can create customers in Stripe, and use these customer objects on behalf of the seller (<em>Relay Demo</em> here) to create and pay orders. These customer profiles should be created on <em>your</em> account and they belong to your platform only (here <em>Relay Demo</em> would not have access to them).</p>

<p>After you’ve collected the customer’s email and shipping information but before creating the order, create the customer in your Stripe account:</p>
<div class="code">
  <nav class="nav-filename icon-terminal">
    Terminal
  </nav>
  <pre class="language-curl numbered" ><code>curl https://api.stripe.com/v1/customers \
   -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \
   -d email=&quot;jenny@ros.en&quot; \
   -d shipping[name]=&quot;Jenny Rosen&quot; \
   -d shipping[address][line1]=&quot;1234 Main Street&quot; \
   -d shipping[address][city]=&quot;San Francisco&quot; \
   -d shipping[address][state]=CA \
   -d shipping[address][postal_code]=12345 \
   -d shipping[address][country]=US \
   -d shipping[phone]=8008675309
</code></pre>
</div>

<p>Notice that the request does not include the <code>Stripe-Account</code> header (as in the product fetching request), as this API call is made on behalf of your own account.</p>

<h3 id="create-an-order">Create an order</h3>

<p>Creating an order consists of providing one or more SKUs and the customer’s information. All of these details will be made available to the seller so they may fulfill the order. Given that the <em>Relay Demo</em> products are shippable, a shipping address should also be passed at order creation so the shipping rates can be computed. For this reason, the customer’s shipping information was stored as part of the customer profile above, and the customer profile can be used directly for order creation.</p>

<p>As the order is created in the seller’s Stripe account, you’ll again identify the seller in the request using the <code>Stripe-Account</code> header while using one of your own <code>customer</code> ID.</p>
<div class="code">
  <nav class="nav-filename icon-terminal">
    Terminal
  </nav>
  <pre class="language-curl numbered" ><code>curl https://api.stripe.com/v1/orders \
   -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \
   -H &quot;Stripe-Account: acct_16TZFyGRAn672XBM&quot; \
   -d items[][type]=sku \
   -d items[][parent]=4397400 \
   -d items[][quantity]=1 \
   -d currency=usd \
   -d customer=cus_c5ja2cD4Tq7zNy
</code></pre>
</div>

<p>When the create order request is made, Stripe will compute and factor in appropriate shipping and tax costs, and return an <code>Order</code> object to you. At this point, you can present the total to the customer as well as shipping options.</p>
<div class="code">
  <pre class="language-javascript numbered" ><code>{
  &quot;id&quot;: &quot;or_17ZqJVGRAn672XBM7eOtn9kX&quot;,
  &quot;object&quot;: &quot;order&quot;,
  &quot;amount&quot;: 3780,
  &quot;application&quot;: null,
  &quot;application_fee&quot;: null,
  &quot;charge&quot;: null,
  &quot;created&quot;: 1454366309,
  &quot;currency&quot;: &quot;usd&quot;,
  &quot;customer&quot;: &quot;cus_7pVJlGxBibLVuJ&quot;,
  &quot;email&quot;: &quot;jenny@ros.en&quot;,
  &quot;updated&quot;: 1454366312,
  &quot;status&quot;: &quot;created&quot;,
  &quot;shipping_methods&quot;: [
    {
      &quot;description&quot;: &quot;Standard shipping&quot;,
      &quot;currency&quot;: &quot;usd&quot;,
      &quot;amount&quot;: 0,
      &quot;id&quot;: &quot;Standard&quot;,
      &quot;delivery_estimate&quot;: {
        &quot;type&quot;: &quot;exact&quot;,
        &quot;date&quot;: &quot;2017-01-18&quot;
      }
    },
    {
      &quot;description&quot;: &quot;Expedited shipping&quot;,
      &quot;currency&quot;: &quot;usd&quot;,
      &quot;amount&quot;: 1199,
      &quot;id&quot;: &quot;Expedited&quot;,
      &quot;delivery_estimate&quot;: {
        &quot;type&quot;: &quot;exact&quot;,
        &quot;date&quot;: &quot;2017-01-16&quot;
      }
    },
    {
      &quot;description&quot;: &quot;Express shipping&quot;,
      &quot;currency&quot;: &quot;usd&quot;,
      &quot;amount&quot;: 1998,
      &quot;id&quot;: &quot;Express&quot;,
      &quot;delivery_estimate&quot;: {
        &quot;type&quot;: &quot;exact&quot;,
        &quot;date&quot;: &quot;2017-01-14&quot;
      }
    }
  ],
  &quot;shipping&quot;: {
    &quot;phone&quot;: &quot;8008675309&quot;,
    &quot;name&quot;: &quot;Jenny Rosen&quot;,
    &quot;address&quot;: {
      &quot;state&quot;: &quot;CA&quot;,
      &quot;postal_code&quot;: &quot;12345&quot;,
      &quot;line2&quot;: null,
      &quot;line1&quot;: &quot;1234 Main Street&quot;,
      &quot;country&quot;: &quot;US&quot;,
      &quot;city&quot;: &quot;San Francisco&quot;
    }
  },
  &quot;selected_shipping_method&quot;: &quot;Standard&quot;,
  &quot;metadata&quot;: null,
  &quot;livemode&quot;: false,
  &quot;items&quot;: [
    {
      &quot;type&quot;: &quot;sku&quot;,
      &quot;quantity&quot;: 1,
      &quot;parent&quot;: &quot;4397400&quot;,
      &quot;description&quot;: &quot;Google - Chromecast (2015 Model) - Black&quot;,
      &quot;currency&quot;: &quot;usd&quot;,
      &quot;amount&quot;: 3500,
      &quot;object&quot;: &quot;order_item&quot;
    },
    {
      &quot;type&quot;: &quot;tax&quot;,
      &quot;quantity&quot;: null,
      &quot;parent&quot;: null,
      &quot;description&quot;: &quot;Sales Tax&quot;,
      &quot;currency&quot;: &quot;usd&quot;,
      &quot;amount&quot;: 280,
      &quot;object&quot;: &quot;order_item&quot;
    },
    {
      &quot;type&quot;: &quot;shipping&quot;,
      &quot;quantity&quot;: null,
      &quot;parent&quot;: &quot;Standard&quot;,
      &quot;description&quot;: &quot;Standard shipping&quot;,
      &quot;currency&quot;: &quot;usd&quot;,
      &quot;amount&quot;: 0,
      &quot;object&quot;: &quot;order_item&quot;
    }
  ]
}</code></pre>
</div>

<p>Stripe will automatically notify the seller of the order’s creation.</p>

<h3 id="collect-payment-information">Collect payment information</h3>

<p>At some point before attempting to pay for the order, you’ll want to add a payment method to the customer record. The card information should be securely taken and tokenized–within your app–using our <a href="../mobile/ios.html">iOS</a> or <a href="../mobile/android.html">Android</a> integration. As this recipe only uses Best Buy in test mode, you can simply add a <a href="../testing.html#cards">test card</a> directly.</p>
<div class="code">
  <nav class="nav-filename icon-terminal">
    Terminal
  </nav>
  <pre class="language-curl numbered" ><code>curl https://api.stripe.com/v1/customers/cus_PeJApdoYnPE53R \
   -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \
   -d source[object]=card \
   -d source[number]=4242424242424242 \
   -d source[exp_month]=01 \
   -d source[exp_year]=2038
</code></pre>
</div>

<p>With a stored customer profile and a payment method, you’ll be able to use that customer object to create and pay for orders. Subsequent orders can be processed without needing to ask for billing or payment information again.</p>

<p>In a normal workflow, you may also consider relying on <a href="../apple-pay/apps.html">Apple Pay</a> for a seamless payment experience on iOS. Using Apple Pay, you would be able to attach the retrieved token to the customer and specify it as the source to use while paying the order.</p>

<h3 id="pay-for-the-order">Pay for the order</h3>

<p>The final step is to accept a payment method from the customer–if you haven’t already–and pay for the order. If you’re storing customers in Stripe, the payment method will have already been stored as well (per the above), and you can just provide the Stripe customer ID in the pay request. Also if you already specified a customer with valid payment information while creating the order, you must specify the same customer here or simply omit it.</p>
<div class="code">
  <nav class="nav-filename icon-terminal">
    Terminal
  </nav>
  <pre class="language-curl numbered" ><code>curl https://api.stripe.com/v1/orders/or_9m9Te6clFbsEWF6SOQ8io6JU/pay \
   -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \
   -H &quot;Stripe-Account: acct_16TZFyGRAn672XBM&quot; \
   -d customer=cus_TRf74xyXFIyafx
</code></pre>
</div>

<p>Stripe will automatically notify the seller that the order was paid for. You should notify the customer that the order was placed and that he should expect a receipt from the seller.</p></section>

<section>
  <h2>Get in touch</h2>
  <p>If you notice anything surprising, or have feedback or more importantly questions, please [get in touch!](mailto:relay@stripe.com)</p>
</section>

<section>
  <h2>More about Relay</h2>
  <p>Looking to learn more about Relay? Check out these other guides:</p>
<ul class="next-steps">
    <li><a href="../orders.html"><span>Orders API Overview</a></li>
    <li><a href="../relay/apps-guide.html"><span>Relay API for Apps</a></li>
    <li><a href="selling-on-twitter.html"><span>Selling on Twitter with Relay</a></li>
</ul>

</section>

<script type="text/javascript">
  function connect() {
    $.get("/relay/relay-demo/connect", function() {
      location.reload()
    })
  }
  function disconnect() {
    $.get("/relay/relay-demo/disconnect", function() {
      location.reload()
    })
  }
</script>


          <footer>
  <h2>Questions?</h2>
  <p>We're always happy to help with code or other questions you might have! <a href="https://support.stripe.com/">Search</a> our site for more information, <a href="https://support.stripe.com/email">send us an email</a>, or <a href="../../contact/sales.html">get in touch</a> with our sales team!</p>
</footer>

        </article>
      </div>
    </div>

    <div id="loading-bar"></div>

    <script src="../../assets/external/jquery.min-94df374d2ad5d02ae136584dc008fb1c.js"></script>
    <script src="../../assets/prism-aa9f4cb7aff3f31b5394455bcbea0d8b.js"></script>
    <script src="../../assets/external/dynamics.min-14579f80273a61e6d0f4f45484e20dc7.js"></script>
    <script src="../../assets/jquery.cookie-d7482a1bbfda18d981eda4398666acdd.js"></script>
    <script src="../../assets/documentation-84c208e01668170139f2f511cfc37644.js"></script>
    <script>
      parseKey("sk_test_BQokikJOvBiI2HlWgH4olfQ2", "secret-key", null);
      parseKey("pk_test_6pRNASCoBOKtIshFeQd4XMUh", "publishable-key", null);
    </script>
      <script type="text/javascript" src="https://js.stripe.com/v2/"></script>

    
    <script src="../../assets/config-aead70c07cdca45cec67e4141bf18edc.js"></script>
    
<script type="application/json" id="analytics_config">{&quot;mixpanel&quot;:{&quot;identifier&quot;:&quot;eb71b6171a4f7ed97de9b7a0395b7ca5&quot;},&quot;ga&quot;:{},&quot;trackpage&quot;:true}</script>

<script src="https://js.stripe.com/internal/v2/analytics.min.js"></script>
<script src="../../assets/analytics-e800ab0ba76de2b697ea3f61c673695b.js"></script>
<script src="https://js.stripe.com/v2/m.js"></script>
<script src="../../assets/mirador_ping-6bba7d3d9fbb1e991b7f0f8fab43b2b1.js"></script>

    <script type="text/javascript">
    if ('Analytics' in window) {
      Analytics.viewed("docs", {
        docs_version: "2",
      });
    }
    </script>
  </body>

<!-- Mirrored from stripe.com/docs/recipes/product-discovery-app by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 23:49:30 GMT -->
</html>
