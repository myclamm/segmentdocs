<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from stripe.com/docs/subscriptions/invoices by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 23:47:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    
    <meta charset="utf-8">
    <meta name="google-site-verification" content="f0LCrdI6z4Fo8zld4sHCgo5SiUE4EYYRUa6KVeX3Mw8" />
    <meta name="csrf-token" content="D1xtPGM3Pe8XZlI7iTFqq1gd1KFndWoLUV9sCCKYxAKWxnlBZfL5qtoidiRFOV_QcWNaJjvZq6sQ6mYgh08Ocw==">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Working with Invoices</title>

    <meta name="description" content="Stripe is a suite of APIs that powers commerce for businesses of all sizes.">


    <link rel="shortcut icon" href="../../favicon.ico">

    <link rel="apple-touch-icon-precomposed" href="../../img/apple-touch-icon/180x180.png">
    <link rel="icon" href="../../img/apple-touch-icon/180x180.png">


    <link rel="image_src" type="image/png" href="../../img/v3/home/social.png">

    <meta property="og:title" content="Working with Invoices">
    <meta property="og:url" content="invoices.html">
    <meta property="og:description" content="Stripe is a suite of APIs that powers commerce for businesses of all sizes.">
    <meta property="og:image" content="../../img/v3/home/social.png">

      <meta name="twitter:card" content="summary">
      <meta name="twitter:image" content="../../img/v3/home/twitter.png">
    <meta name="twitter:site" content="@stripe">
    <meta name="twitter:title" content="Working with Invoices">
    <meta name="twitter:description" content="Stripe is a suite of APIs that powers commerce for businesses of all sizes.">


    <script type="application/json" id="strut_files">{&quot;v3/shared/navigation_ie10.css&quot;:&quot;/assets/v3/shared/navigation_ie10-ec238f46e7cb9867e3c1b529e2cfa37b.css&quot;}</script>

    

    

    <link rel="stylesheet" href="../../assets/v3/default-ef2bff54073622b9e08cf24466b5668f.css">
    <link rel="stylesheet" href="../../assets/v3/shared/common-d0fb03fa2d48fcf29010779ca9a12b2c.css">
    <link rel="stylesheet" href="../../assets/v3/documentation/base-47c1fd7d3d670e4e08df8f5a67b20dea.css">
    <link rel="stylesheet" href="../../assets/v3/shared/prism_light-6d08c6ec0d72453693d775c3b96629c0.css">
    
    
    <meta name="viewport" content="width=1060">
    <meta name="robots" content="noarchive">
  </head>
  <body class="">
    
    <div id="docs">
      <div id="sidebar">
        <div class="logo">
          <a class="site" href="../../index.html" title="Stripe"></a>
          <a class="extension" href="../../docs.html">docs</a>
        </div>
        <div class="nav-border"></div>
        <nav>
          <h1 class="home"><a href="../../docs.html">Home</a></h1>
          <h1 class="payments"><a class="toggle-content">Payments</a></h1>
<ul class='hidden' data-hidden=true>
    <li>
      <a href="../quickstart.html">Quickstart</a>
    </li>
    <li class="category">Collecting payment details
    </li>
    <li>
      <a href="../checkout/tutorial.html">Checkout</a>
      <ul class='hidden' data-hidden=true>
    <li>
      <a href="../checkout.html">Reference</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../custom-form.html">Stripe.js</a>
      <ul class='hidden' data-hidden=true>
    <li>
      <a href="../stripe.html">Reference</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../mobile/ios.html">iOS</a>
    </li>
    <li>
      <a href="../mobile/android.html">Android</a>
    </li>
    <li class="category">Charges
    </li>
    <li>
      <a href="../charges.html">Creating Charges</a>
    </li>
    <li>
      <a href="../declines.html">Declines &amp; Failed Payments</a>
    </li>
    <li>
      <a href="../disputes.html">Disputes</a>
      <ul class='hidden' data-hidden=true>
    <li>
      <a href="../disputes/evidence.html">Submitting Evidence</a>
    </li>
    <li>
      <a href="../disputes/types.html">Types</a>
    </li>
    <li>
      <a href="../disputes/faq.html">FAQ</a>
    </li>
</ul>

    </li>
    <li class="category">Products &amp; Orders
    </li>
    <li>
      <a href="../orders.html">Orders</a>
      <ul class='hidden' data-hidden=true>
    <li>
      <a href="../orders/guide.html">Guide</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../orders/tax-integration.html">Tax Integrations</a>
    </li>
    <li>
      <a href="../orders/shipping-integration.html">Shipping Integrations</a>
    </li>
    <li>
      <a href="../sources.html">Getting Started</a>
    </li>
    <li>
      <a href="../sources/payment-methods.html">Payment Methods</a>
      <ul class='hidden' data-hidden=true>
    <li>
      <a href="../sources/cards.html">Cards</a>
    </li>
    <li>
      <a href="../sources/3d-secure.html">3D Secure</a>
    </li>
    <li>
      <a href="../sources/bancontact.html">Bancontact</a>
    </li>
    <li>
      <a href="../sources/giropay.html">Giropay</a>
    </li>
    <li>
      <a href="../sources/ideal.html">iDEAL</a>
    </li>
    <li>
      <a href="../sources/sepa-direct-debit.html">SEPA Direct Debit</a>
    </li>
    <li>
      <a href="../sources/sofort.html">Sofort</a>
    </li>
</ul>

    </li>
    <li class="category">Other Payment Methods
    </li>
    <li>
      <a href="../ach.html">ACH</a>
    </li>
    <li>
      <a href="../apple-pay.html">Apple Pay</a>
      <ul class='hidden' data-hidden=true>
    <li>
      <a href="../apple-pay/apps.html">Apple Pay in Apps</a>
    </li>
    <li>
      <a href="../apple-pay/web.html">Apple Pay on the Web</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../alipay.html">Alipay</a>
    </li>
    <li>
      <a href="../bitcoin.html">Bitcoin</a>
    </li>
    <li class='separator'>
      <a href="../testing.html">Testing</a>
    </li>
</ul>

          <h1 class="subscriptions"><a class="toggle-content">Subscriptions</a></h1>
<ul>
    <li>
      <a href="quickstart.html">Quickstart</a>
    </li>
    <li>
      <a href="creating.html">Creating Subscriptions</a>
      <ul data-collapsable=false>
    <li>
      <a href="discounts.html">Applying Discounts</a>
    </li>
    <li>
      <a href="trials.html">Using Trial Periods</a>
    </li>
    <li>
      <a href="quantities.html">Setting Quantities</a>
    </li>
    <li>
      <a href="taxes.html">Adding Taxes</a>
    </li>
    <li>
      <a href="multiple.html">Multiple Subscriptions</a>
    </li>
</ul>

    </li>
    <li>
      <a href="lifecycle.html">Lifecycle &amp; Events</a>
    </li>
    <li>
      <a href="webhooks.html">Using Webhooks</a>
    </li>
    <li>
      <a href="changing.html">Changing Subscriptions</a>
      <ul data-collapsable=false>
    <li>
      <a href="upgrading-downgrading.html">Upgrading &amp; Downgrading</a>
    </li>
    <li>
      <a href="billing-cycle.html">Billing Cycle</a>
    </li>
    <li>
      <a href="canceling-pausing.html">Canceling &amp; Pausing</a>
    </li>
</ul>

    </li>
    <li>
      <a class='selected' href="invoices.html">Working with Invoices</a>
      <ul data-collapsable=false>
</ul>

    </li>
    <li>
      <a href="plans.html">Managing Plans</a>
    </li>
    <li>
      <a href="testing.html">Testing</a>
    </li>
</ul>

          <h1 class="connect"><a class="toggle-content">Connect</a></h1>
<ul class='hidden' data-hidden=true>
    <li>
      <a href="../connect.html">Overview</a>
    </li>
    <li>
      <a href="../connect/connecting-to-accounts.html">Connecting to Accounts</a>
      <ul data-collapsable=false>
    <li>
      <a href="../connect/authentication.html">Authentication</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../connect/standalone-accounts.html">Standalone Accounts</a>
      <ul data-collapsable=false>
    <li>
      <a href="../connect/reference.html">OAuth Reference</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../connect/managed-accounts.html">Managed Accounts</a>
      <ul data-collapsable=false>
    <li>
      <a href="../connect/updating-accounts.html">Updating Accounts</a>
    </li>
    <li>
      <a href="../connect/identity-verification.html">Identity Verification</a>
    </li>
    <li>
      <a href="../connect/required-verification-information.html">Verification Fields</a>
    </li>
    <li>
      <a href="../connect/testing-verification.html">Testing Verification</a>
    </li>
    <li>
      <a href="../connect/bank-transfers.html">Bank Transfers</a>
    </li>
    <li>
      <a href="../connect/migrating.html">Migrating Recipients</a>
    </li>
    <li>
      <a href="../connect/best-practices.html">Best Practices</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../connect/payments-fees.html">Payments and Fees</a>
    </li>
    <li>
      <a href="../connect/special-case-transfers.html">Special-case Transfers</a>
    </li>
    <li class='separator'>
      <a href="../connect/testing.html">Testing</a>
    </li>
</ul>

          <h1 class="relay"><a class="toggle-content">Relay</a></h1>
<ul class='hidden' data-hidden=true>
    <li>
      <a href="../relay.html">Selling in Other Apps</a>
    </li>
    <li>
      <a href="../relay/apps-guide.html">Accepting Orders in Your App</a>
      <ul data-collapsable=false>
    <li>
      <a href="../relay/apps-error-guide.html">Error Handling</a>
    </li>
</ul>

    </li>
</ul>

          <h1 class="radar"><a class="toggle-content">Radar</a></h1>
<ul class='hidden' data-hidden=true>
    <li>
      <a href="../radar.html">Overview</a>
    </li>
    <li>
      <a href="../radar/risk-evaluation.html">Risk Evaluation</a>
    </li>
    <li>
      <a href="../radar/review.html">Review</a>
      <ul data-collapsable=false>
    <li>
      <a href="../radar/review/auth-and-capture.html">Uncaptured Payments</a>
    </li>
</ul>

    </li>
    <li>
      <a href="../radar/rules.html">Rules</a>
      <ul data-collapsable=false>
    <li>
      <a href="../radar/rules/reference.html">Reference</a>
    </li>
</ul>

    </li>
    <li class='separator'>
      <a href="../radar/testing.html">Testing</a>
    </li>
</ul>

          <h1 class="account"><a class="toggle-content">Account</a></h1>
<ul class='hidden' data-hidden=true>
    <li>
      <a href="../dashboard.html">Your Account</a>
    </li>
    <li>
      <a href="../checklist.html">Going Live Checklist</a>
    </li>
    <li>
      <a href="../transfers.html">Getting Paid</a>
    </li>
    <li>
      <a href="../reporting.html">Reporting</a>
    </li>
</ul>

          <h1 class="api"><a class="toggle-content">Development</a></h1>
<ul class='hidden' data-hidden=true>
    <li>
      <a href="../libraries.html">API Libraries</a>
    </li>
    <li>
      <a href="../upgrades.html">API Upgrades</a>
    </li>
    <li>
      <a href="../webhooks.html">Webhooks</a>
    </li>
    <li>
      <a href="../building-integrations.html">Integrations</a>
    </li>
    <li>
      <a href="../recipes.html">Recipes</a>
    </li>
    <li>
      <a href="../security.html">Security</a>
    </li>
</ul>


          <h1 class="references"><a href="../api.html" class="external" target="_blank">API Reference</a></h1>
        </nav>
      </div>
      <div id="content-wrapper" tabindex="0">
        <div class="overlay"></div>
        <header id="main-header">
          <nav>
            <ul class="external">
              <li><a href="https://support.stripe.com/">Support</a></li>

              <li class="button">
                <a data-adroll-segment='submit_two' href="https://dashboard.stripe.com/login">Sign in</a>
              </li>
            </ul>
          </nav>
        </header>
        <article id="content">
          <header>
  <h1>Working with Invoices</h1>
  <p>Learn how to manipulate invoices, the basis for recurring charges. If you need help after reading this, check out our answers to <a href="https://support.stripe.com/search?q=subscriptions+invoice">common questions</a> or chat live with other developers in <a href="irc://irc.freenode.net/stripe">#stripe</a> on freenode.
</p>
</header>

<section>
  <aside class="note">
    <h3>What invoices are not</h3>
    <p>Stripe uses invoices solely as a mechanism for subscriptions. Invoices at Stripe are not documents you generate, send to a customer, and then have them pay.</p>
  </aside>

<p>Subscriptions at Stripe are charged through invoices. For every period in a billing cycle, we generate an <a href="../api.html#invoices">invoice</a> that represents the amount the customer owes.</p>

<p>Subscription invoices are prebilled, meaning customers pay at the start of a billing cycle. Assuming an amount is due on an invoice, we then attempt to charge the customer using a previously stored payment method (e.g., a credit card).</p>

<p>Stripe generates and pays invoices automatically, per your <a href="lifecycle.html#settings">subscription settings</a>. But you may want to familiarize yourself with:</p>

<ul>
  <li>Adding <a href="#adding-invoice-items">invoice items</a></li>
  <li>The <a href="#invoice-states">states</a> an invoice can be in</li>
  <li>How to <a href="#previewing">preview</a> an upcoming invoice</li>
  <li>Manually <a href="#generating-invoices">generating invoices</a></li>
  <li><a href="#holding-review">Holding invoices</a> for review</li>
</ul></section>


<section>
<h2 id="adding-invoice-items">Adding invoice items</h2>

<p>The total amount due on an invoice is the sum of its <a href="../api.html#invoiceitems">invoice items</a>, which are listed as separate line items. The invoices Stripe generates automatically includes invoice items such as the base plan cost or a proration (after <a href="changing.html">changing a subscription</a>). But you can add more invoice items to change the amount the customer will be charged.</p><div class="images">
  <div class="image full">
      <img src="../../img/documentation/subscriptions/invoice_items.png" width="100%" />
  </div>
</div>
<p>Any positive invoice item amount–an integer in the smallest currency unit (e.g., cents or Yen)–increases the total of the applicable invoice. To discount an invoice, use a negative amount (or apply a <a href="discounts.html">coupon</a>).</p>

<p>Invoice items are always added to the next invoice to be charged. For example, if a customer is billed on the 1st of each month, any invoice item generated during the month is added to the invoice generated on the 1st of the following month. Consequently, an invoice always reflects the cost of the subscription for the <em>upcoming</em> billing period plus any invoice items from the <em>previous</em> billing period.</p>

<p>When Stripe automatically generates an invoice for a recurring payment, your site is notified via webhooks (an <code>invoice.created</code> event). Stripe  waits approximately an hour before attempting to pay that invoice. In that time, you can add invoice items to the recently-created invoice so that the forthcoming payment covers it.</p>

<p>You can also create invoice items at any point in the billing cycle, of course, and you can create as many invoice items as you want:</p>
  <div class="tabs tabs-code animated" data-platform=server>
    <nav class="nav-languages">
        <a data-language="curl"
            class="selected">curl</a>
        <a data-language="ruby"
           >Ruby</a>
        <a data-language="python"
           >Python</a>
        <a data-language="php"
           >PHP</a>
        <a data-language="java"
           >Java</a>
        <a data-language="node"
           >Node</a>
        <a data-language="go"
           >Go</a>
    </nav>
    <div class="tabs-content">
      <div class="code">
  <pre class="language-curl numbered selected" ><code>curl https://api.stripe.com/v1/invoiceitems \
   -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \
   -d customer=cus_3R1W8PG2DmsmM9 \
   -d amount=1000 \
   -d currency=usd \
   -d description=&quot;One-time setup fee&quot;
</code></pre>
</div>
<div class="code">
  <pre class="language-ruby numbered" ><code># Set your secret key: remember to change this to your live secret key in production
# See your keys here: https://dashboard.stripe.com/account/apikeys
Stripe.api_key = &quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2&quot;

Stripe::InvoiceItem.create(
  :customer =&gt; &quot;cus_3R1W8PG2DmsmM9&quot;,
  :amount =&gt; 1000,
  :currency =&gt; &quot;usd&quot;,
  :description =&gt; &quot;One-time setup fee&quot;,
)
</code></pre>
</div>
<div class="code">
  <pre class="language-python numbered" ><code># Set your secret key: remember to change this to your live secret key in production
# See your keys here: https://dashboard.stripe.com/account/apikeys
stripe.api_key = &quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2&quot;

stripe.Invoiceitem.create(
  customer=&quot;cus_3R1W8PG2DmsmM9&quot;,
  amount=1000,
  currency=&quot;usd&quot;,
  description=&quot;One-time setup fee&quot;,
)
</code></pre>
</div>
<div class="code">
  <pre class="language-php numbered" ><code>// Set your secret key: remember to change this to your live secret key in production
// See your keys here: https://dashboard.stripe.com/account/apikeys
\Stripe\Stripe::setApiKey(&quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2&quot;);

\Stripe\Invoiceitem::create(array(
  &quot;customer&quot; =&gt; &quot;cus_3R1W8PG2DmsmM9&quot;,
  &quot;amount&quot; =&gt; 1000,
  &quot;currency&quot; =&gt; &quot;usd&quot;,
  &quot;description&quot; =&gt; &quot;One-time setup fee&quot;,
));
</code></pre>
</div>
<div class="code">
  <pre class="language-java numbered" ><code>// Set your secret key: remember to change this to your live secret key in production
// See your keys here: https://dashboard.stripe.com/account/apikeys
Stripe.apiKey = &quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2&quot;;

Map&lt;String, Object&gt; params = new HashMap&lt;String, Object&gt;();
params.put(&quot;customer&quot;, &quot;cus_3R1W8PG2DmsmM9&quot;);
params.put(&quot;amount&quot;, 1000);
params.put(&quot;currency&quot;, &quot;usd&quot;);
params.put(&quot;description&quot;, &quot;One-time setup fee&quot;);

InvoiceItem.create(params);
</code></pre>
</div>
<div class="code">
  <pre class="language-javascript numbered" ><code>// Set your secret key: remember to change this to your live secret key in production
// See your keys here: https://dashboard.stripe.com/account/apikeys
var stripe = require(&quot;stripe&quot;)(&quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2&quot;);

stripe.invoiceItems.create({
  customer: &quot;cus_3R1W8PG2DmsmM9&quot;,
  amount: 1000,
  currency: &quot;usd&quot;,
  description: &quot;One-time setup fee&quot;,
}, function(err, invoiceItem) {
  // asynchronously called
});
</code></pre>
</div>
<div class="code">
  <pre class="language-go numbered" ><code>// Set your secret key: remember to change this to your live secret key in production
// See your keys here: https://dashboard.stripe.com/account/apikeys
stripe.Key = &quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2&quot;

params := &amp;stripe.InvoiceItemParams{
  Customer: &quot;cus_3R1W8PG2DmsmM9&quot;,
  Amount: 1000,
  Currency: &quot;usd&quot;,
  Description: &quot;One-time setup fee&quot;,
}
invoiceItem, err := invoiceItem.New(params)
</code></pre>
</div>

    </div>
  </div>

<p>The <code>customer</code>, <code>amount</code>, and <code>currency</code> parameters are required. You can optionally include an <code>invoice</code> parameter to apply the invoice item to a specific invoice.</p>

<p>Should you need to include a one-time charge or discount to the first subscription invoice, you can do so by adding an invoice item to the <em>customer</em> before creating the subscription (the above code would work as it doesn’t specify an invoice). The created invoice item will be attached to the customer and automatically included in the first invoice created.</p>

<p>Invoice items have some unique behaviors:</p>

<ul>
  <li>Invoice items are always charged when the billing period ends even if the subscription is canceled. Canceling a customer’s subscription only means the customer isn’t billed again <em>if no invoice items exist</em>.</li>
  <li>Invoice items are not prorated when a customer’s subscription is changed.</li>
</ul></section>

<section>
  <h2 id="invoice-states">Invoice states</h2>
<p>Invoices, like <a href="lifecycle.html#states">subscriptions</a>, have <a href="../api.html#invoice_object">meaningful properties</a> that reflect the invoice’s status:</p>

<ul>
  <li><code>attempt_count</code></li>
  <li><code>attempted</code></li>
  <li><code>closed</code></li>
  <li><code>forgiven</code></li>
  <li><code>next_payment_attempt</code></li>
  <li><code>paid</code></li>
</ul>

<p>The values of these attributes differ for the first invoice on a new subscription, subsequent invoices, and for invoices with payment failures. You can also manually change an invoice’s state.</p>

<h3 id="new-subscription-invoices">New subscription invoices</h3>

<p>When you subscribe a customer to a plan, the API call immediately:</p>

<ul>
  <li>Creates an invoice</li>
  <li>Attempts to pay the invoice</li>
  <li>Closes the invoice</li>
</ul>

<p>The first invoice on a subscription is effectively closed from the moment it’s created. If the payment succeeds or no payment is required, the invoice is also marked as <code>paid</code> and the subscription is created. If the payment fails, the subscription attempt fails, too, and no invoice or subscription exists.</p>

<p>Any API call that results in a new subscription, such as upgrading or downgrading the plan, also creates a new invoice that is closed from the onset.</p>

<p>With a closed invoice, you cannot add invoice items or make other modifications that affect the amount due. (You can still add invoice items to the customer, however, which apply to the next invoice.)</p>

<h3 id="subscription-renewal-invoices">Subscription renewal invoices</h3>

<p>When a subscription is updated automatically, instead of via the API, the invoice behavior is a bit different. Stripe:</p>

<ul>
  <li>Creates an invoice</li>
  <li>Leaves the invoice open for about an hour</li>
  <li>Attempts to pay the invoice</li>
  <li>Closes the invoice if the payment succeeds</li>
</ul>

<p>When the invoice is created, you’ll receive via <a href="webhooks.html">webhooks</a> an <code>invoice.created</code> event. This time, the invoice’s <code>closed</code> attribute will be <strong>false</strong>, which means it’s open for modification via invoice items.</p>

<h3 id="invoices-with-failed-payment-attempts">Invoices with failed payment attempts</h3>  <aside class="note">
    <h3>Delinquent customers</h3>
    <p>The <code>delinquent</code> property of the <a href="../api.html#customer_object">Customer object</a> reflects the success of the most recent invoice payment attempt.</p>
  </aside>
<p>When payment on a subscription renewal invoice fails, the properties of that invoice is dictated by your <a href="lifecycle.html#settings">subscription settings</a>. Each time a payment attempt fails, the <code>attempt_count</code> is incremented and the <code>next_payment_attempt</code> value is set according to your retry settings.</p>

<p>When the maximum number of payment attempts have been made, the subscription:</p>

<ul>
  <li>Remains <strong>past_due</strong>, generating more, open invoices with payment attempts</li>
  <li>Is marked as <strong>unpaid</strong>, generating more, closed invoices without payment attempts</li>
  <li>Is <strong>canceled</strong>, generating no new invoices</li>
</ul>

<p>Once a payment attempt has been made on an invoice, the invoice cannot be modified.</p>

<h3 id="manual-state-changes">Manual state changes</h3>

<p>You can change an invoice’s state by manually marking it as closed or by closing and forgiving it. Subsequent payment attempts are never made on closed or forgiven invoices. Forgiving an invoice instructs us to update the subscription status as if the invoice was successfully paid. Once an invoice has been forgiven, it cannot be unforgiven or reopened.</p></section>

<section>
<h2 id="previewing">Previewing upcoming invoices</h2>

<p>The <a href="../api.html#retrieve_invoice">retrieve invoice</a> API call provides a mechanism for viewing an existing invoice, but Stripe also provides an endpoint for <a href="../api.html#upcoming_invoice">previewing the next upcoming invoice</a>. This preview reflects the base plan cost, pending invoice items, discounts, and any existing customer balance.</p>

<p>When fetching the preview, you can also see what the invoice would look like if you changed the subscription by:</p>

<ul>
  <li>Swapping the underlying plan</li>
  <li>Altering the quantity</li>
  <li>Applying a trial period</li>
  <li>Adding a coupon</li>
</ul>

<p>The <a href="upgrading-downgrading.html#previewing-prorations">previewing prorations</a> documentation provides an example usage.</p></section>


<section>
  <h2 id="generating-invoices">Manually generating invoices</h2>
  <aside class="note">
    <h3>Taxes and generated invoices</h3>
    <p>When you manually generate an invoice, Stripe does not apply the <a href="taxes.html">taxes</a> you may have established on the subscription. If taxes should apply, manually add the tax on the invoice itself (as a flat amount or percent).</p>
  </aside>
<p>At the end of a billing cycle, Stripe automatically creates an invoice containing both a line item for the customer’s subscription (going forward) and any invoice items that had been left pending on the customer. However, when the customer has pending invoice items, you can also request that an invoice be generated at any time. Generating a one-off invoice does not affect the customer’s standard billing schedule, but it does pull in any pending invoice items that would have been added to the regularly scheduled invoice.</p>

<p>Manually generating invoices can be helpful when you want to request immediate payment of prorations created when you upgraded your customer’s subscription (e.g., upgrading a user from a $10 per month plan to a $20 per month plan mid-month triggers proration invoice items in the net of approximately $5). However, by default, these prorations simply remain pending on the customer until the end of the month. If you’d like the customer to be billed immediately, you can always request creation of an invoice after upgrading.</p>

<p>You manually generate an invoice via the API using the <a href="../api.html#create_invoice">create invoice method</a> or from the <a href="https://dashboard.stripe.com/customers">Dashboard</a>, using the <strong>Invoice Now</strong> button in the Pending Invoice Items pane.</p>
  <div class="tabs tabs-code animated" data-platform=server>
    <nav class="nav-languages">
        <a data-language="curl"
            class="selected">curl</a>
        <a data-language="ruby"
           >Ruby</a>
        <a data-language="python"
           >Python</a>
        <a data-language="php"
           >PHP</a>
        <a data-language="java"
           >Java</a>
        <a data-language="node"
           >Node</a>
        <a data-language="go"
           >Go</a>
    </nav>
    <div class="tabs-content">
      <div class="code">
  <pre class="language-curl numbered selected" ><code>curl https://api.stripe.com/v1/invoices \
   -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \
   -d customer=cus_9CQ7bS9zi2gBTP
</code></pre>
</div>
<div class="code">
  <pre class="language-ruby numbered" ><code># Set your secret key: remember to change this to your live secret key in production
# See your keys here: https://dashboard.stripe.com/account/apikeys
Stripe.api_key = &quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2&quot;

Stripe::Invoice.create(
  :customer =&gt; &quot;cus_9CQ7bS9zi2gBTP&quot;,
)
</code></pre>
</div>
<div class="code">
  <pre class="language-python numbered" ><code># Set your secret key: remember to change this to your live secret key in production
# See your keys here: https://dashboard.stripe.com/account/apikeys
stripe.api_key = &quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2&quot;

stripe.Invoice.create(
  customer=&quot;cus_9CQ7bS9zi2gBTP&quot;,
)
</code></pre>
</div>
<div class="code">
  <pre class="language-php numbered" ><code>// Set your secret key: remember to change this to your live secret key in production
// See your keys here: https://dashboard.stripe.com/account/apikeys
\Stripe\Stripe::setApiKey(&quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2&quot;);

\Stripe\Invoice::create(array(
  &quot;customer&quot; =&gt; &quot;cus_9CQ7bS9zi2gBTP&quot;,
));
</code></pre>
</div>
<div class="code">
  <pre class="language-java numbered" ><code>// Set your secret key: remember to change this to your live secret key in production
// See your keys here: https://dashboard.stripe.com/account/apikeys
Stripe.apiKey = &quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2&quot;;

Map&lt;String, Object&gt; params = new HashMap&lt;String, Object&gt;();
params.put(&quot;customer&quot;, &quot;cus_9CQ7bS9zi2gBTP&quot;);

Invoice invoice = Invoice.create(params);
</code></pre>
</div>
<div class="code">
  <pre class="language-javascript numbered" ><code>// Set your secret key: remember to change this to your live secret key in production
// See your keys here: https://dashboard.stripe.com/account/apikeys
var stripe = require(&quot;stripe&quot;)(&quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2&quot;);

stripe.invoices.create({
  customer: &quot;cus_9CQ7bS9zi2gBTP&quot;,
}, function(err, invoice) {
  // asynchronously called
});
</code></pre>
</div>
<div class="code">
  <pre class="language-go numbered" ><code>// Set your secret key: remember to change this to your live secret key in production
// See your keys here: https://dashboard.stripe.com/account/apikeys
stripe.Key = &quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2&quot;

params := &amp;stripe.InvoiceParams{
  Customer: &quot;cus_9CQ7bS9zi2gBTP&quot;,
}
invoice, err := invoice.New(params)
</code></pre>
</div>

    </div>
  </div>

<p>Note that manually creating an invoice does not lead to a <em>synchronous</em> attempt to pay the invoice. Payment is automatically attempted between 1 and 2 hours after the invoice is created. You can also request immediate payment of an invoice at any time using a <a href="../api.html#pay_invoice">pay invoice</a> API call.</p></section>

<section>
<h2 id="holding-review">Holding an invoice for review</h2>

<p>Rather than automatically charging the customer for the invoice items at the end of a billing period, you can hold the invoice for a review process. To do so:</p>

<ol>
  <li><a href="../api.html#update_invoice">Close the invoice</a> within one hour of receiving the <code>invoice.created</code> event. This prevents Stripe from automatically charging your customer for the invoice amount.</li>
  <li>Review the invoice.</li>
  <li>Once you are ready to charge the customer, <a href="../api.html#update_invoice">reopen the invoice</a>.</li>
  <li>Finally, <a href="../api.html#pay_invoice">pay the invoice</a>.</li>
</ol>

<p>Note that once you close the invoice, you must later trigger a payment attempt on it. Simply re-opening the invoice is not enough.</p></section>

<section>
  <h2>Next steps</h2>
  <p>Congrats! You've learned more about working with invoices. Some documentation you might want to read next:</p>
<ul class="next-steps">
    <li><a href="lifecycle.html"><span>Lifecycle &amp; Events</a></li>
    <li><a href="discounts.html"><span>Applying Discounts</a></li>
    <li><a href="../api.html#invoices"><span>Invoice API</a></li>
</ul>
</section>


          <footer>
  <h2>Questions?</h2>
  <p>We're always happy to help with code or other questions you might have! <a href="https://support.stripe.com/">Search</a> our site for more information, <a href="https://support.stripe.com/email">send us an email</a>, or <a href="../../contact/sales.html">get in touch</a> with our sales team!</p>
</footer>

        </article>
      </div>
    </div>

    <div id="loading-bar"></div>

    <script src="../../assets/external/jquery.min-94df374d2ad5d02ae136584dc008fb1c.js"></script>
    <script src="../../assets/prism-aa9f4cb7aff3f31b5394455bcbea0d8b.js"></script>
    <script src="../../assets/external/dynamics.min-14579f80273a61e6d0f4f45484e20dc7.js"></script>
    <script src="../../assets/jquery.cookie-d7482a1bbfda18d981eda4398666acdd.js"></script>
    <script src="../../assets/documentation-84c208e01668170139f2f511cfc37644.js"></script>
    <script>
      parseKey("sk_test_BQokikJOvBiI2HlWgH4olfQ2", "secret-key", null);
      parseKey("pk_test_6pRNASCoBOKtIshFeQd4XMUh", "publishable-key", null);
    </script>
      <script type="text/javascript" src="https://js.stripe.com/v2/"></script>

    
    <script src="../../assets/config-aead70c07cdca45cec67e4141bf18edc.js"></script>
    
<script type="application/json" id="analytics_config">{&quot;mixpanel&quot;:{&quot;identifier&quot;:&quot;eb71b6171a4f7ed97de9b7a0395b7ca5&quot;},&quot;ga&quot;:{},&quot;trackpage&quot;:true}</script>

<script src="https://js.stripe.com/internal/v2/analytics.min.js"></script>
<script src="../../assets/analytics-e800ab0ba76de2b697ea3f61c673695b.js"></script>
<script src="https://js.stripe.com/v2/m.js"></script>
<script src="../../assets/mirador_ping-6bba7d3d9fbb1e991b7f0f8fab43b2b1.js"></script>

    <script type="text/javascript">
    if ('Analytics' in window) {
      Analytics.viewed("docs", {
        docs_version: "2",
      });
    }
    </script>
  </body>

<!-- Mirrored from stripe.com/docs/subscriptions/invoices by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 23:47:48 GMT -->
</html>
