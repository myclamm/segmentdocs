(function(){"use strict";function h(e){var t=document.querySelector("meta[name=csrf-token]").getAttribute("content"),n=new XMLHttpRequest;n.open("POST.html",c),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.setRequestHeader("x-stripe-csrf-token",t),n.send(JSON.stringify({email:e}))}function p(e){var t=document.querySelector(".subscribe"),n=document.querySelector(".subscribe form [name=email]");e.preventDefault(),h(n.value),t.classList.add("success")}function d(){var e=document.querySelector(".subscribe form");e.addEventListener("submit",p)}var e=document.querySelector("#toc .current-guide ul"),t=[].slice.call(document.querySelectorAll("#content h1")),n=null,r=.5;t.forEach(function(t){var n=document.createElement("li");e.appendChild(n),n.innerHTML='<a href="#'+t.getAttribute("id")+'">'+t.innerText+"</a>"}),window.addEventListener("scroll",function(){var e=t.filter(function(e){return 1-e.getBoundingClientRect().top/window.innerHeight>r});n!=e[e.length-1]&&(n=e[e.length-1],t.forEach(function(e){e==n?document.querySelector('#toc a[href="#'+e.getAttribute("id")+'"]').classList.add("current"):document.querySelector('#toc a[href="#'+e.getAttribute("id")+'"]').classList.remove("current")}))});var i=document.querySelector("#image-container"),s=i.querySelector(".overlay"),o=i.querySelector(".image"),u,a=function(e,t){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),i={x:n.left-r.left,y:n.top-r.top},s=n.width/r.width;return{translation:i,scale:s}},f=function(e,t){i.style.pointerEvents="all",u=e,o.querySelector("img").setAttribute("src",u.getAttribute("src")),o.querySelector("img").style.willChange="transform",setTimeout(function(){o.style.transform="none";var e=a(u,o);o.style.transform="translate("+e.translation.x+"px,"+e.translation.y+"px) scale("+e.scale+")",u.style.opacity="0",o.style.opacity="1",animate({el:o,translateX:[e.translation.x,0],translateY:[e.translation.y,0],scale:[e.scale,1],duration:t,easing:"easeOutElastic 100"}),animate({el:o.querySelector(".shadow"),opacity:[0,1],duration:t,easing:"easeOutElastic 100"}),animate({el:s,opacity:[0,1],duration:t,easing:"easeOutElastic 100",complete:function(){o.querySelector("img").style.willChange="auto"}})},10)},l=function(e){if(u){i.style.pointerEvents="none";var t=a(u,o);animate({el:o,translateX:[0,t.translation.x],translateY:[0,t.translation.y],scale:[1,t.scale],duration:e,easing:"easeOutElastic 100"}),animate({el:o.querySelector(".shadow"),opacity:[1,0],duration:e,easing:"easeOutElastic 100"}),animate({el:s,opacity:[1,0],duration:e,easing:"easeOutElastic 100",complete:function(){u.style.opacity="1",o.style.opacity="0",u=null,o.querySelector("img").style.willChange="auto"}})}};document.addEventListener("click",function(e){e.target.classList.contains("expandable")?f(e.target,500):e.target==i&&l(500)}),document.addEventListener("keyup",function(e){e.keyCode==27&&l(500)}),Stickyfill.add(document.getElementById("toc"));var c="/atlas/subscribe";d()})();