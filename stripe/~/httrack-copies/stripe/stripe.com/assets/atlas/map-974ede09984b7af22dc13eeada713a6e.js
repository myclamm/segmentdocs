(function(){function i(t){var n=e.querySelector('[rel="'+t+'-video"]'),r=n.querySelector("iframe");n.classList.add("shown"),$f(r).api("play"),$f(r).addEvent("finish",o),document.body.classList.add("map-video-open")}function s(){t.forEach(function(e){var t=e.querySelector("iframe");$f(t).api("pause"),$f(t).removeEvent("finish"),e.classList.remove("shown")})}function o(){n=setTimeout(function(){f()},500),r=null,s(),document.body.classList.remove("map-video-open")}function u(){o()}function a(e){n&&clearTimeout(n),r=e,f(),e.classList.add("open")}function f(){var e=document.body.querySelector(".marker.open");e&&e!==r&&e.classList.remove("open")}function l(e,t){var n=e.querySelector(".poster");n.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),i(t),a(e)})}function c(){e=document.querySelector("[rel=map-video-backdrop]"),t=[].slice.call(e.querySelectorAll(".map-video-container")),e.addEventListener("click",u)}var e,t,n,r;c(),window.atlasMapVideo={listen:l}})(),function(){"use strict";function b(){N(),p.removeEventListener("mousemove",b)}function w(){return JSON.parse(document.getElementById("atlas-map-info").innerText)}function E(e){var t=n.filter(function(t){return t!==e}),r=t[Math.floor(Math.random()*t.length)];r.classList.add("open-demo-mode")}function S(){var e=document.querySelector(".marker.open-demo-mode");e&&e.classList.remove("open-demo-mode")}function x(){var e=document.querySelector(".marker.open-demo-mode");S(),E(e)}function T(){E(),e=setInterval(x,3500)}function N(){clearInterval(e),S()}var e,t=[],n=[],r=w(),i=5,s=2,o={orange:"#FFA27B",pink:"#F6A4EB",cyan:"#68D4F8",blue:"#7795F8"},u=[{x:26,y:33,color:o.cyan},{x:24,y:45,color:o.cyan},{x:67,y:18,color:o.cyan},{x:58,y:39,color:o.cyan},{x:82,y:30,color:o.cyan},{x:94,y:32,color:o.pink},{x:96,y:34,color:o.blue},{x:107,y:42,color:o.cyan},{x:114,y:25,color:o.cyan},{x:13,y:29,color:o.pink,interactive:!0,poster:"/img/atlas/map/photos/kinedu.jpg",logo:"/img/atlas/map/logos/kinedu.svg",description:r.descriptions.kinedu,link:"https://medium.com/built-on-stripe/kinedu-changing-the-world-through-early-childhood-education-718815c81a5f#.go4g5twsc"},{x:14,y:32,color:o.orange,interactive:!0,poster:"/img/atlas/map/photos/platzi.png",logo:"/img/atlas/map/logos/platzi.svg",description:r.descriptions.platzi,video:!0,videoName:"platzi"},{x:39,y:51,color:o.blue,interactive:!0,poster:"/img/atlas/map/photos/trakto.jpg",logo:"/img/atlas/map/logos/trakto.svg",description:r.descriptions.trakto,link:"https://medium.com/@pauloblob/the-future-of-the-american-dream-is-an-api-1f28e46b1762#.lddwq2vww",useInDemoMode:!0},{x:35,y:61,color:o.orange,interactive:!0,poster:"",logo:"/img/atlas/map/logos/tradefit.svg",description:r.descriptions.tradefit,useInDemoMode:!0},{x:76,y:23,color:o.orange,interactive:!0,poster:"/img/atlas/map/photos/boni.jpg",logo:"/img/atlas/map/logos/boni@2x.png",logoSize:{width:91,height:33},description:r.descriptions.boni},{x:72,y:29,color:o.pink,interactive:!0,poster:"/img/atlas/map/photos/coterique.png",logo:"/img/atlas/map/logos/coterique.svg",description:r.descriptions.coterique,video:!0,videoName:"coterique"},{x:61,y:39,color:o.blue,interactive:!0,poster:"/img/atlas/map/photos/hotels.png",logo:"/img/atlas/map/logos/hotels.svg",description:r.descriptions.hotels_ng},{x:76,y:43,color:o.orange,interactive:!0,poster:"/img/atlas/map/photos/ongair.jpg",logo:"/img/atlas/map/logos/ongair@2x.png",logoSize:{width:113,height:42},description:r.descriptions.ongair},{x:110,y:31,color:o.blue,interactive:!0,poster:"/img/atlas/map/photos/easyship.jpg",link:"https://medium.com/built-on-stripe/unlocking-international-shipping-24103619698f#.jakcjemd5",logo:"/img/atlas/map/logos/easyship.svg",description:r.descriptions.easyship},{x:112,y:41,color:o.orange,interactive:!0,poster:"/img/atlas/map/photos/katsana.png",logo:"/img/atlas/map/logos/katsana@2x.png",logoSize:{width:130,height:21},description:r.descriptions.katsana},{x:75,y:31,color:o.blue,interactive:!0,poster:"/img/atlas/map/photos/instabug.png",logo:"/img/atlas/map/logos/instabug.svg",description:r.descriptions.instabug,video:!0,videoName:"instabug"},{x:70,y:58,color:o.pink,interactive:!0,description:r.descriptions.crowd_digital,logo:"/img/atlas/map/logos/crowd_digital.svg",link:"https://medium.com/@michael.wissekerke/b3731c1d3fe#.2nj36obe4",linebreakBeforeLink:!0,useInDemoMode:!0},{x:94,y:35,color:o.orange,interactive:!0,description:r.descriptions.deducely,logo:"/img/atlas/map/logos/deducely.svg",poster:"/img/atlas/map/photos/deducely.png",link:"https://medium.com/@123aswin123/how-to-bootstrap-a-tech-company-with-almost-zero-cash-13f4862ac114#.m1gj4yf1i"},{x:31,y:61,color:o.blue,interactive:!0,description:r.descriptions.kwema,logo:"/img/atlas/map/logos/kwema@2x.png",logoSize:{width:112,height:40},useInDemoMode:!0,link:"https://medium.com/@Kwema/how-kwema-developed-the-jewelry-that-can-save-lives-3a0db0dd69df#.lq1l7m1rv",useInDemoMode:!0},{x:94,y:32,color:o.pink,interactive:!0,link:"https://medium.com/built-on-stripe/the-story-of-coursebirdie-cdd284090ea7#.g2osdtip0",logo:"/img/atlas/map/logos/coursebirdie@2x.png",logoSize:{width:150,height:30},description:r.descriptions.coursebirdie,useInDemoMode:!0,linebreakBeforeLink:!0},{x:29,y:34,color:o.pink,interactive:!0,description:r.descriptions.carepoint,link:"https://medium.com/@sajclarke/streamlining-healthcare-to-save-lives-e4d40cf6c2ea#.r3j3qhmi1",logo:"/img/atlas/map/logos/carepoint@2x.png",logoSize:{width:60,height:60},useInDemoMode:!0}],a=function(e,t){var n={width:-1,height:-1};for(var r=0;r<v.length;r++)v[r][0]>n.width&&(n.width=v[r][0]),v[r][1]>n.height&&(n.height=v[r][1]);return n},f=function(e){return{width:e.width*(i+s)-s,height:e.height*(i+s)-s}},l=function(e){return{x:e.x*(i+s)+i/2,y:e.y*(i+s)+i/2}},c=function(e){return{x:(e.x-i/2)/(i+s),y:(e.y-i/2)/(i+s)}},h=function(e){var t=document.createElement("div");t.classList.add("popover");var n=document.createElement("div");n.classList.add("content"),t.appendChild(n);if(e.poster&&e.poster.length>0){var i=document.createElement("a");i.classList.add("poster"),i.style.backgroundImage="url("+e.poster+")",n.appendChild(i)}if(e.video){var s=document.createElement("div");s.classList.add("play"),i.appendChild(s),n.classList.add("with-video")}if(e.logo&&e.logo.length>0){var o=document.createElement("img");o.classList.add("logo"),o.src=e.logo,e.logo.indexOf(".png")>-1&&(o.style.width=e.logoSize.width+"px"),n.appendChild(o)}if(e.description&&e.description.length>0){var u=document.createElement("p");u.innerHTML=e.description,n.appendChild(u)}if(e.link&&e.link.length>0){var a=document.createElement("a");a.classList.add("learn-more"),a.innerText=r.link_text,a.setAttribute("href",e.link),e.linebreakBeforeLink&&(u.innerHTML+="<br>",a.classList.add("after-line-break")),u.appendChild(a)}return t},p=document.querySelector("#map aside"),d=p.querySelector("svg"),v=[].slice.call(d.querySelectorAll("circle")),m=-1;v.forEach(function(e){var r={x:parseFloat(e.getAttributeNS(null,"cx")),y:parseFloat(e.getAttributeNS(null,"cy"))},s=c(r);u.forEach(function(o){if(o.x==s.x&&o.y==s.y){e.setAttribute("fill",o.color);if(o.interactive){m++,e.setAttribute("r",i);var a=l({x:o.x,y:o.y-1}),f=d.querySelector('[cx="'+a.x+'"][cy="'+a.y+'"]');f&&(f.style.display="none");var c=l({x:o.x,y:o.y+1}),v=d.querySelector('[cx="'+c.x+'"][cy="'+c.y+'"]');v&&(v.style.display="none");var g=l({x:o.x-1,y:o.y}),y=d.querySelector('[cx="'+g.x+'"][cy="'+g.y+'"]');y&&(y.style.display="none");var b=l({x:o.x+1,y:o.y}),w=d.querySelector('[cx="'+b.x+'"][cy="'+b.y+'"]');w&&(w.style.display="none");var E=4,S=document.createElement("div");S.classList.add("marker"),S.style.width=i*2*E+"px",S.style.height=i*2*E+"px",S.style.transform="translate("+Math.round(r.x-i*E)+"px, "+Math.round(r.y-i*E)+"px)",p.appendChild(S);var x=document.createElement("div");x.classList.add("pulse"),x.style.backgroundColor=o.color,S.appendChild(x),setTimeout(function(){S.classList.add("animated")},(m%2==0?m:u.length-m)*250);var T=h(o);S.appendChild(T),t.push(S),o.useInDemoMode&&n.push(S),o.video&&window.atlasMapVideo.listen(S,o.videoName)}}})});var g=!1,y=document.querySelector("p.debug");y.style.display="none",document.addEventListener("keyup",function(e){e.keyCode==27&&e.altKey&&(g=!g,y.style.display=g?"inline":"none")}),document.addEventListener("mouseover",function(e){if(g&&e.target.nodeName=="circle"){e.target.setAttribute("fill","red");var t=c({x:parseFloat(e.target.getAttributeNS(null,"cx")),y:parseFloat(e.target.getAttributeNS(null,"cy"))});y.innerText="("+t.x+", "+t.y+")"}}),document.addEventListener("mouseout",function(e){g&&e.target.nodeName=="circle"&&e.target.setAttribute("fill","#E4ECF2"),y.innerText="(-, -)"}),p.addEventListener("mousemove",b),T()}();