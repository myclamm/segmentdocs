<!doctype html>
<!--[if lt IE 7]> <html class="lt-ie9 lt-ie8 lt-ie7 documentation"> <![endif]-->
<!--[if IE 7]> <html class="lt-ie9 lt-ie8 documentation"> <![endif]-->
<!--[if IE 8]> <html class="lt-ie9 documentation"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en" class="documentation"> <!--<![endif]-->


<html xmlns="http://www.w3.org/1999/xhtml">
  
<!-- Mirrored from documentation.mailgun.com/user_manual.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 14 Jan 2017 00:06:49 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>User Manual &#8212; Mailgun API  documentation</title>
    
    <link rel="stylesheet" href="_static/adctheme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="Mailgun API  documentation" href="index-2.html" />
    <link rel="next" title="Libraries" href="libraries.html" />
    <link rel="prev" title="How to start tracking email events" href="quickstart-events.html" />
    <link media="only screen and (max-device-width: 480px)" href="_static/mobile.css" type="text/css" rel="stylesheet" />

    <link rel="icon" type="image/png" href="_static/img/favicon.png" />

    <!-- <link rel="stylesheet" href="_static/docs.css" /> -->
    <link rel="stylesheet" href="https://www.mailgun.com/static/css/main.css" />
    <meta name="viewport" content="width=device-width">
    
 

<!-- i2a tracking code-->
<script type="text/javascript"
  src="_static/i2a.js">
</script>

<!-- GA pageLoadVars -->
<script type="text/javascript">
    var pageLoadVars = {
      'visitor_type' : 'Customer',
      'customer_type' : "",
      'coupon_id' : "",
      'signup_state' : 'Inactive',
      'bamGAVPV' : "",
      'customer_action': []
    }
</script>


  </head>
  <body role="document">

<!-- Google Tag Manager -->
<noscript><iframe src="http://www.googletagmanager.com/ns.html?id=GTM-WN2J6"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script type="text/javascript" src="_static/google_tag_manager.js"></script>

<!-- SVG Icons -->
<svg display="none" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="517" height="32" viewBox="0 0 517 32">
<defs>
<g id="icon-search">
  <path class="path1" d="M0 14.857q0-2.554 0.991-4.884t2.679-4.018 4.018-2.679 4.884-0.991 4.884 0.991 4.018 2.679 2.679 4.018 0.991 4.884q0 3.929-2.214 7.125l6.125 6.125q0.661 0.661 0.661 1.607 0 0.929-0.679 1.607t-1.607 0.679q-0.964 0-1.607-0.679l-6.125-6.107q-3.196 2.214-7.125 2.214-2.554 0-4.884-0.991t-4.018-2.679-2.679-4.018-0.991-4.884zM4.571 14.857q0 3.304 2.348 5.652t5.652 2.348 5.652-2.348 2.348-5.652-2.348-5.652-5.652-2.348-5.652 2.348-2.348 5.652z"></path>
</g>
<g id="icon-menu">
  <path class="path1" d="M0 26.286v-2.286q0-0.464 0.339-0.804t0.804-0.339h25.143q0.464 0 0.804 0.339t0.339 0.804v2.286q0 0.464-0.339 0.804t-0.804 0.339h-25.143q-0.464 0-0.804-0.339t-0.339-0.804zM0 17.143v-2.286q0-0.464 0.339-0.804t0.804-0.339h25.143q0.464 0 0.804 0.339t0.339 0.804v2.286q0 0.464-0.339 0.804t-0.804 0.339h-25.143q-0.464 0-0.804-0.339t-0.339-0.804zM0 8v-2.286q0-0.464 0.339-0.804t0.804-0.339h25.143q0.464 0 0.804 0.339t0.339 0.804v2.286q0 0.464-0.339 0.804t-0.804 0.339h-25.143q-0.464 0-0.804-0.339t-0.339-0.804z"></path>
</g>
<g id="icon-dropdown">
  <path d="M124.452,10.121 L118.343,4.01 C116.225,2.001 113.753,0.996 110.93,0.996 C108.05,0.996 105.606,2.001 103.596,4.01 L64,43.607 L24.404,4.011 C22.394,2.002 19.95,0.997 17.071,0.997 C14.247,0.997 11.775,2.002 9.657,4.011 L3.628,10.122 C1.564,12.185 0.532,14.657 0.532,17.536 C0.532,20.469 1.565,22.913 3.628,24.868 L56.667,77.907 C58.623,79.971 61.066,81.003 64,81.003 C66.879,81.003 69.35,79.971 71.413,77.907 L124.452,24.868 C126.462,22.858 127.468,20.414 127.468,17.536 C127.468,14.711 126.462,12.24 124.452,10.121 L124.452,10.121 Z" id="Shape" sketch:type="MSShapeGroup"></path>
</g>
</defs></svg>

<header>
  <div class="container">
      <a href="http://www.mailgun.com/" class="logo">Mailgun - Email Automation by Rackspace</a>
      <nav class="header-nav" id="js-header-nav">
          <a href="http://www.mailgun.com/pricing" class="pricing-link"><b>Pricing</b></a>
          <a href="http://www.mailgun.com/customers" class="customers-link"><b>Customers</b></a>
          <div class="dropdown">
                    <a href="http://www.mailgun.com/sending-email" class="js-dropdown-toggle"><b>Features <svg class="icon icon-dropdown" viewBox="0 0 128 80"><use xlink:href="#icon-dropdown"></use></svg>
</b></a>
                    <nav class="dropdown-menu">
                        <a href="http://www.mailgun.com/sending-email">Sending email</a>
                        <a href="http://www.mailgun.com/inbound-routing">Inbound routing</a>
                        <a href="http://www.mailgun.com/analytics">Tracking &amp; analytics</a>
                        <a href="http://www.mailgun.com/email-validation">Email validation</a>
                        <a href="http://www.mailgun.com/deliverability">Deliverability</a>
                    </nav>
                </div>
                <div class="dropdown">
                    <a href="http://resources.mailgun.com/index.html" class="js-dropdown-toggle resources-link"><b>Resources <svg class="icon icon-dropdown active" viewBox="0 0 128 80"><use xlink:href="#icon-dropdown"></use></svg>
</b></a>
                    <nav class="dropdown-menu">
                        <a href="index.html">Docs</a>
                        <a href="http://resources.mailgun.com/index.html">Guides</a>
                        <a href="http://blog.mailgun.com/">Blog</a>
                    </nav>
                </div>
                <a href="http://www.mailgun.com/managed" class="managed-link"><b>Managed</b></a>
                <a href="http://www.mailgun.com/contact" class="contact-link"><b>Contact</b></a>
          <a href="https://www.mailgun.com/sessions/new" class="login-link"><b>Log in</b></a>
          <a href="https://www.mailgun.com/signup" class="signup-link"><b>Sign Up</b></a>
      </nav>
      <button id="js-show-nav"><svg class="icon icon-menu" viewBox="0 0 30 32"><use xlink:href="#icon-menu"></use></svg></button>
  </div>
</header>

<div id="body">
  <section class="subnav">
    <div class="container">
      <a href="https://github.com/mailgun/documentation" class="edit-docs-link" onclick="mixpanel.track('Clicked Edit Docs Link');">Edit</a>
      <ul id="headerButtons" class="nav nav-pills">
        <li class="lang-label">
          Code sample preference:
        </li>
        <li class="lang">
          <a href="#" id="lang_bash" >curl</a>
        </li>
        <li class="lang">
          <a href="#" id="lang_rb" >Ruby</a>
        </li>
        <li class="lang">
          <a href="#" id="lang_py" >Python</a>
        </li>
        <li class="lang">
          <a href="#" id="lang_php" >PHP</a>
        </li>
        <li class="lang">
          <a href="#" id="lang_java" >Java</a>
        </li>
        <li class="lang">
          <a href="#" id="lang_csharp" >C#</a>
        </li>
        <li class="lang">
          <a href="#" id="lang_go" >Go</a>
        </li>
        <div id="searchbox" style="display: none" class="search-box">
          
          <form>
            <svg class="icon icon-search" viewBox="0 0 32 32"><use xlink:href="#icon-search"></use></svg>
            <input type="search" id="st-search-input" class="prettysearch search-input" autofocus />
          <!--<form class="search" action="search.html" method="get">-->
            <!--<div class="search-wrapper">
              <span class="search-left"></span>
              <input class="prettysearch" type="text" name="q" size="18"/>
              <span class="search-right">&nbsp;</span>
            </div>
            <input type="submit" value="Search" class="searchbutton" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />-->
          </form>
        </div>
        <script type="text/javascript">$('#searchbox').show(0);</script>

        <!--
        <li id="page_buttons">
          <div class="headerButton"><a href="libraries.html" title="Libraries" accesskey="N">next</a></div>
          <div class="headerButton"><a href="quickstart-events.html" title="How to start tracking email events" accesskey="P">previous</a></div>
        </li>
        -->
      </ul>
    </div>
  </section>

  <section class="main">

    <div class="container">


  
  <aside id="sphinxsidebar" class="docs-sidebar">
    <div class="sphinxsidebarwrapper">
      <!-- <ul><li class="toctree-l1"><a href="index.html">Main Page</a></li></ul> -->
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">User Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pricing-features-overview">Pricing &amp; Features Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#verifying-your-domain">Verifying Your Domain</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sending-messages">Sending Messages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sending-via-api">Sending via API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sending-via-smtp">Sending via SMTP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#message-queue">Message Queue</a></li>
<li class="toctree-l3"><a class="reference internal" href="#batch-sending">Batch Sending</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mailing-lists">Mailing Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scheduling-delivery">Scheduling Delivery</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sending-in-test-mode">Sending in Test Mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tracking-messages">Tracking Messages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#events">Events</a></li>
<li class="toctree-l3"><a class="reference internal" href="#webhooks">Webhooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#attaching-data-to-messages">Attaching Data to Messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tagging">Tagging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tracking-opens">Tracking Opens</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tracking-clicks">Tracking Clicks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tracking-unsubscribes">Tracking Unsubscribes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tracking-spam-complaints">Tracking Spam Complaints</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tracking-bounces">Tracking Bounces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tracking-failures">Tracking Failures</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tracking-deliveries">Tracking Deliveries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stats">Stats</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#receiving-forwarding-and-storing-messages">Receiving, Forwarding and Storing Messages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#routes">Routes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#credentials">Credentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spam-filter">Spam Filter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#smtp-protocol">SMTP Protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#smtp-relay">SMTP Relay</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-standard-email-clients">Using Standard Email Clients</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tls-sending-connection-settings">TLS Sending Connection Settings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="libraries.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="faqs.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="best_practices.html">Email Best Practices</a></li>
</ul>

      <div class="admonition note">You can find your API Key in your <a href="https://mailgun.com/cp" target="_blank">Control Panel</a></div>
    </div>
  </aside>

  

    <div class="document">
  <div id="st-results-container"></div>
        <div class="documentwrapper">
          <div class="bodywrapper">
            <div class="body">
              
  <div class="section" id="user-manual">
<span id="id1"></span><h1>User Manual<a class="headerlink" href="#user-manual" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This document is meant to be an overview of all of the capabilities of
Mailgun and how you can best leverage those capabilities.  It is
organized around the three major features that Mailgun provides:</p>
<ul class="simple">
<li><a class="reference internal" href="#sending-messages">Sending Messages</a></li>
<li><a class="reference internal" href="#id9">Tracking Messages</a></li>
<li><a class="reference internal" href="#receiving-forwarding-and-storing-messages">Receiving, Forwarding and Storing Messages</a></li>
</ul>
<p>At the heart of Mailgun is the API.  Most of the Mailgun service can be
accessed through the RESTful HTTP API without the need to install any
libraries. However, we have written <a class="reference internal" href="wrappers.html#libraries"><span class="std std-ref">Libraries</span></a> for many popular languages.
Be sure to check out the additional capabilities provided by using our libraries.</p>
<p>You can also access many Mailgun features through your Mailgun Control
Panel using your browser and logging in at <a class="reference external" href="https://mailgun.com/cp">https://mailgun.com/cp</a>.</p>
<p>In addition to the API, Mailgun supports the standard SMTP protocol.  We have included some <a class="reference internal" href="#smtp"><span class="std std-ref">instructions</span></a> on how to use Mailgun, via SMTP, at the end of the User Manual.</p>
<p>If you are anxious to get started right away, feel free to check
out the <span class="xref std std-ref">quickstart</span> or <a class="reference internal" href="api_reference.html#api-reference"><span class="std std-ref">API Reference</span></a>.  There are
also <a class="reference internal" href="faqs.html#faqs"><span class="std std-ref">FAQ</span></a> and <a class="reference internal" href="best_practices.html#best-practices"><span class="std std-ref">Email Best Practices</span></a> that you can reference.</p>
<p>Finally, always feel free to <a class="reference external" href="https://mailgun.com/app/support">contact our Support Team</a>.</p>
</div>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>We&#8217;ve tried to make the sign-up and on-boarding process as intuitive as possible.
However, there are a few things to mention.</p>
<div class="section" id="pricing-features-overview">
<h3>Pricing &amp; Features Overview<a class="headerlink" href="#pricing-features-overview" title="Permalink to this headline">¶</a></h3>
<p><strong>Pricing</strong></p>
<p>Pricing is a usage-based, monthly subscription.
Usage is based on outbound messages and number dedicated IP addresses
used.  There is no charge for inbound messages.
As your volume increases your price per message decreases according
to the pricing calculator on our <a class="reference external" href="http://www.mailgun.com/pricing">pricing page</a>.</p>
<p>If you are a high volume sender or if you are interested in a custom contract,
you can contact <a class="reference external" href="mailto:sales&#37;&#52;&#48;mailgunhq&#46;com">sales<span>&#64;</span>mailgunhq<span>&#46;</span>com</a> for more details.</p>
<p><strong>Features</strong></p>
<p>All of Mailgun&#8217;s features are available to both free and paid accounts.</p>
<p>There are some limitations if you have not given us your payment information:</p>
<ul class="simple">
<li>There is a limit of 10,000 emails per month.</li>
<li>Data for Logs and the Events API are stored for 2 days.</li>
</ul>
<p>If you have given us your payment information, there is no limit on number of messages
sent and/or received and data retention for Logs and the Events API is at least 30 days.</p>
</div>
<div class="section" id="verifying-your-domain">
<h3>Verifying Your Domain<a class="headerlink" href="#verifying-your-domain" title="Permalink to this headline">¶</a></h3>
<p>Each new Mailgun account is automatically provisioned with a <strong>sandbox domain</strong>
<code class="docutils literal"><span class="pre">sandbox&lt;uniq-alpha-numeric-string&gt;&#64;mailgun.org</span></code>. This domain is to be used
for <strong>testing only</strong>. It allows both sending and receiving messages; and also
tracking can be enabled for it. But it only allows sending to a list of up to 5
<a class="reference external" href="https://help.mailgun.com/hc/en-us/articles/217531258-Authorized-Recipients">authorized recipients</a>.
This limitation is also in effect for routes that are triggered by messages
addressed to the sandbox domain and mailing lists created under that domain.</p>
<p>To be able to use Mailgun in production a custom domain(s) has to be created
and verified with Mailgun.</p>
<p>Verifying your domain is easy. Start by adding a domain or subdomain you own in
the <code class="docutils literal"><span class="pre">Domains</span></code> tab of the Mailgun control panel. Next add two <strong>TXT</strong> DNS
records found in the <strong>Domain Verification &amp; DNS</strong> section on the domain
information page of the Mailgun control panel at your DNS provider:</p>
<ul class="simple">
<li>SPF: Sending server IP validation. Used by majority of email service
providers. <a class="reference external" href="http://www.openspf.org/Introduction">Learn about SPF</a>.</li>
<li>DKIM: Like SPF, but uses cryptographic methods for validation. Supported
by many email service providers. This is the record that Mailgun references
make sure that the domain actually belongs to you.
<a class="reference external" href="http://www.dkim.org/#introduction">Learn about DKIM</a></li>
</ul>
<p>Once you&#8217;ve added the two <strong>TXT</strong> records and they&#8217;ve propagated, your domain
will be verified. In the Mailgun control panel verified domains are marked by a
green <code class="docutils literal"><span class="pre">Verified</span></code> badge next to their name.</p>
<p>If it has been awhile since you have configured the DNS records but the domain
is still reported as <code class="docutils literal"><span class="pre">Unverified</span></code>, then try pressing the <strong>Check DNS Records Now</strong>
button on the domain information page. If that does not help either, then
please create a support ticket.</p>
<p><strong>Other DNS records</strong></p>
<ul class="simple">
<li><strong>CNAME</strong> DNS record with value <cite>mailgun.org</cite>, should be added if you want
Mailgun to track <strong>clicks</strong>, <strong>opens</strong>, and <strong>unsubscribes</strong>.</li>
<li><strong>MX</strong> DNS records are required if you want Mailgun to receive and route/store
messages addressed to the domain recipients. You need to configure 2 <strong>MX</strong>
records with values <code class="docutils literal"><span class="pre">10</span> <span class="pre">mxa.mailgun.org</span></code> and <code class="docutils literal"><span class="pre">10</span> <span class="pre">mxb.mailgun.org</span></code>. We
recommend adding them even if you do not plan the domain to get inbound
messages, because having <strong>MX</strong> DNS records configured may improve
deliverability of messages sent from the domain.
<a class="reference external" href="http://en.wikipedia.org/wiki/MX_record">Learn about MX DNS records</a></li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Do not configure <strong>MX</strong> DNS records if you already have another
provider handling inbound mail delivery for the domain.</p>
</div>
<p><strong>DNS Records Summary</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="5%" />
<col width="15%" />
<col width="76%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Required</th>
<th class="head">Purpose</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>TXT</td>
<td>Yes</td>
<td>Domain verification (SPF)</td>
<td><code class="docutils literal"><span class="pre">v=spf1</span> <span class="pre">include:mailgun.org</span> <span class="pre">~all</span></code></td>
</tr>
<tr class="row-odd"><td>TXT</td>
<td>Yes</td>
<td>Domain verification (DKIM)</td>
<td><em>Find this record in Domain Verification &amp; DNS section in the domain information page for a particular domain in the Mailgun control pannel</em></td>
</tr>
<tr class="row-even"><td>CNAME</td>
<td>&nbsp;</td>
<td>Enables tracking</td>
<td><code class="docutils literal"><span class="pre">mailgun.org</span></code></td>
</tr>
<tr class="row-odd"><td>MX</td>
<td>&nbsp;</td>
<td>Enables receiving</td>
<td><code class="docutils literal"><span class="pre">10</span> <span class="pre">mxa.mailgun.org</span></code></td>
</tr>
<tr class="row-even"><td>MX</td>
<td>&nbsp;</td>
<td>Enables receiving</td>
<td><code class="docutils literal"><span class="pre">10</span> <span class="pre">mxb.mailgun.org</span></code></td>
</tr>
</tbody>
</table>
<p><strong>Common DNS Provider Documentation</strong></p>
<p>Common providers are listed below. If yours is not listed, contact your DNS
provider for assistance:</p>
<ul class="simple">
<li>GoDaddy: <a class="reference external" href="https://www.godaddy.com/help/add-an-mx-record-19234">MX</a> - <a class="reference external" href="https://www.godaddy.com/help/add-a-cname-record-19236">CNAME</a> - <a class="reference external" href="https://www.godaddy.com/help/add-a-txt-record-19232">TXT</a></li>
<li>NameCheap: <a class="reference external" href="https://www.namecheap.com/support/knowledgebase/subcategory.aspx/10/dns-questions">All Records</a></li>
<li>Network Solutions: <a class="reference external" href="http://www.networksolutions.com/support/mx-records-mail-servers-2/">MX</a> - <a class="reference external" href="http://www.networksolutions.com/support/cname-records-host-aliases-2/">CNAME</a> - <a class="reference external" href="http://www.networksolutions.com/support/how-to-manage-advanced-dns-records/">TXT</a></li>
<li>Rackspace Email &amp; Apps: <a class="reference external" href="http://www.rackspace.com/apps/support/portal/1172">All Records</a></li>
<li>Rackspace Cloud DNS: <a class="reference external" href="http://www.rackspace.com/knowledge_center/article/rackspace-cloud-dns">Developer Guide</a></li>
<li>Amazon Route 53: <a class="reference external" href="http://docs.aws.amazon.com/Route53/latest/DeveloperGuide/R53Console.html">Developer Guide</a></li>
</ul>
</div>
</div>
<div class="section" id="sending-messages">
<span id="um-sending-messages"></span><h2>Sending Messages<a class="headerlink" href="#sending-messages" title="Permalink to this headline">¶</a></h2>
<p>There are two ways to send messages using Mailgun:</p>
<ul class="simple">
<li>HTTP API</li>
<li>SMTP</li>
</ul>
<p>Both methods work great and support the same feature set,  so choose one
based on your preferences and requirements.</p>
<div class="section" id="sending-via-api">
<h3>Sending via API<a class="headerlink" href="#sending-via-api" title="Permalink to this headline">¶</a></h3>
<p>When sending via HTTP API, Mailgun offers two options:</p>
<ul class="simple">
<li>You can send emails in <a class="reference external" href="http://en.wikipedia.org/wiki/MIME">MIME</a> format, but this would require you to use a MIME building
library for your programming language.</li>
<li>You can submit the individual parts of your messages to Mailgun, such as text
and html parts, attachments, and so on. This doesn&#8217;t require any MIME knowledge on your part.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Mailgun supports maximum messages size of 50MB.</p>
</div>
<p>See <a class="reference internal" href="api-sending.html#api-sending-messages"><span class="std std-ref">sending messages</span></a> section in our API Reference for a full
list of message sending options.</p>
<div class="section" id="examples-sending-messages-via-http">
<h4>Examples: sending messages via HTTP<a class="headerlink" href="#examples-sending-messages-via-http" title="Permalink to this headline">¶</a></h4>
<p>Sending mails using Mailgun API is extremely simple: as simple as performing an
HTTP POST request to an API URL.</p>
<p>Sending a plain text message:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages <span class="se">\</span>
    -F <span class="nv">from</span><span class="o">=</span><span class="s1">&#39;Excited User &lt;mailgun@YOUR_DOMAIN_NAME&gt;&#39;</span> <span class="se">\</span>
    -F <span class="nv">to</span><span class="o">=</span>YOU@YOUR_DOMAIN_NAME <span class="se">\</span>
    -F <span class="nv">to</span><span class="o">=</span>bar@example.com <span class="se">\</span>
    -F <span class="nv">subject</span><span class="o">=</span><span class="s1">&#39;Hello&#39;</span> <span class="se">\</span>
    -F <span class="nv">text</span><span class="o">=</span><span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">SendSimple</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">Form</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Form</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;from&quot;</span><span class="o">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;alice@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;subject&quot;</span><span class="o">,</span> <span class="s">&quot;Hello&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;text&quot;</span><span class="o">,</span> <span class="s">&quot;Testing out some Mailgun awesomeness!&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/messages&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s2">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">;</span>

<span class="c1"># Make the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">sendMessage</span><span class="p">(</span><span class="nv">$domain</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;from&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Excited User &lt;mailgun@YOUR_DOMAIN_NAME&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;to&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;Baz &lt;YOU@YOUR_DOMAIN_NAME&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subject&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span>
    <span class="s1">&#39;text&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_simple_message</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;Excited User &lt;mailgun@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
              <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bar@example.com&quot;</span><span class="p">,</span> <span class="s2">&quot;YOU@YOUR_DOMAIN_NAME&quot;</span><span class="p">],</span>
              <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
              <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_simple_message</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
  <span class="ss">:from</span> <span class="o">=&gt;</span> <span class="s2">&quot;Excited User &lt;mailgun@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
  <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="s2">&quot;bar@example.com, YOU@YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span>
  <span class="ss">:subject</span> <span class="o">=&gt;</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
  <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">SendSimpleMessageChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">SendSimpleMessage</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">SendSimpleMessage</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;{domain}/messages&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;from&quot;</span><span class="p">,</span> <span class="s">&quot;Excited User &lt;mailgun@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;bar@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;YOU@YOUR_DOMAIN_NAME&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;subject&quot;</span><span class="p">,</span> <span class="s">&quot;Hello&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">,</span> <span class="s">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">SendSimpleMessage</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="nx">publicApiKey</span><span class="p">)</span>
  <span class="nx">m</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">NewMessage</span><span class="p">(</span>
    <span class="s">&quot;Excited User &lt;mailgun@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
    <span class="s">&quot;Hello&quot;</span><span class="p">,</span>
    <span class="s">&quot;Testing some Mailgun awesomeness!&quot;</span><span class="p">,</span>
    <span class="s">&quot;YOU@YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span>
  <span class="p">)</span>
  <span class="nx">_</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">Send</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample response:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="s2">&quot;Queued. Thank you.&quot;</span><span class="p">,</span>
  <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;20111114174239.25659.5817@samples.mailgun.org&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sending a message with HTML and text parts. This example also attaches two files to the message:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages <span class="se">\</span>
    -F <span class="nv">from</span><span class="o">=</span><span class="s1">&#39;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&#39;</span> <span class="se">\</span>
    -F <span class="nv">to</span><span class="o">=</span><span class="s1">&#39;foo@example.com&#39;</span> <span class="se">\</span>
    -F <span class="nv">cc</span><span class="o">=</span><span class="s1">&#39;bar@example.com&#39;</span> <span class="se">\</span>
    -F <span class="nv">bcc</span><span class="o">=</span><span class="s1">&#39;baz@example.com&#39;</span> <span class="se">\</span>
    -F <span class="nv">subject</span><span class="o">=</span><span class="s1">&#39;Hello&#39;</span> <span class="se">\</span>
    -F <span class="nv">text</span><span class="o">=</span><span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span> <span class="se">\</span>
    --form-string <span class="nv">html</span><span class="o">=</span><span class="s1">&#39;&lt;html&gt;HTML version of the body&lt;/html&gt;&#39;</span> <span class="se">\</span>
    -F <span class="nv">attachment</span><span class="o">=</span>@files/cartman.jpg <span class="se">\</span>
    -F <span class="nv">attachment</span><span class="o">=</span>@files/cartman.png
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.glassfish.jersey.media.multipart.FormDataMultiPart</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.glassfish.jersey.media.multipart.file.FileDataBodyPart</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">SendComplexMessage</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">FormDataMultiPart</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FormDataMultiPart</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;from&quot;</span><span class="o">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;alice@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;bob@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;cc&quot;</span><span class="o">,</span> <span class="s">&quot;joe@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;subject&quot;</span><span class="o">,</span> <span class="s">&quot;Hello&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;text&quot;</span><span class="o">,</span> <span class="s">&quot;Testing out some Mailgun awesomeness!&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;html&quot;</span><span class="o">,</span> <span class="s">&quot;&lt;html&gt;HTML version of the body&lt;/html&gt;&quot;</span><span class="o">);</span>

        <span class="n">String</span> <span class="n">file_separator</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&quot;file.separator&quot;</span><span class="o">);</span>

        <span class="n">File</span> <span class="n">txtFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="n">file_separator</span> <span class="o">+</span>
            <span class="s">&quot;files&quot;</span> <span class="o">+</span> <span class="n">file_separator</span> <span class="o">+</span> <span class="s">&quot;test.txt&quot;</span><span class="o">);</span>
        <span class="n">form</span><span class="o">.</span><span class="na">bodyPart</span><span class="o">(</span><span class="k">new</span> <span class="n">FileDataBodyPart</span><span class="o">(</span><span class="s">&quot;attachment&quot;</span><span class="o">,</span> <span class="n">txtFile</span><span class="o">,</span>
            <span class="n">MediaType</span><span class="o">.</span><span class="na">TEXT_PLAIN_TYPE</span><span class="o">));</span>

        <span class="n">File</span> <span class="n">jpgFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="n">file_separator</span> <span class="o">+</span>
            <span class="s">&quot;files&quot;</span> <span class="o">+</span> <span class="n">file_separator</span> <span class="o">+</span> <span class="s">&quot;test.jpg&quot;</span><span class="o">);</span>
        <span class="n">form</span><span class="o">.</span><span class="na">bodyPart</span><span class="o">(</span><span class="k">new</span> <span class="n">FileDataBodyPart</span><span class="o">(</span><span class="s">&quot;attachment&quot;</span><span class="o">,</span> <span class="n">jpgFile</span><span class="o">,</span>
            <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_OCTET_STREAM_TYPE</span><span class="o">));</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/messages&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">MULTIPART_FORM_DATA_TYPE</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s2">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">;</span>

<span class="c1"># Make the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">sendMessage</span><span class="p">(</span><span class="nv">$domain</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;from&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;to&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;foo@example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cc&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;baz@example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bcc&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;bar@example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subject&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span>
    <span class="s1">&#39;text&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span><span class="p">,</span>
    <span class="s1">&#39;html&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;&lt;html&gt;HTML version of the body&lt;/html&gt;&#39;</span>
<span class="p">),</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;attachment&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;/path/to/file.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/file.txt&#39;</span><span class="p">)</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_complex_message</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">files</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;attachment&quot;</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;files/test.jpg&quot;</span><span class="p">)),</span>
               <span class="p">(</span><span class="s2">&quot;attachment&quot;</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;files/test.txt&quot;</span><span class="p">))],</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
              <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;foo@example.com&quot;</span><span class="p">,</span>
              <span class="s2">&quot;cc&quot;</span><span class="p">:</span> <span class="s2">&quot;baz@example.com&quot;</span><span class="p">,</span>
              <span class="s2">&quot;bcc&quot;</span><span class="p">:</span> <span class="s2">&quot;bar@example.com&quot;</span><span class="p">,</span>
              <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
              <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">,</span>
              <span class="s2">&quot;html&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;html&gt;HTML version of the body&lt;/html&gt;&quot;</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_complex_message</span>
  <span class="n">data</span> <span class="o">=</span> <span class="no">Multimap</span><span class="o">.</span><span class="n">new</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:from</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:to</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;foo@example.com&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:cc</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;baz@example.com&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:bcc</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;bar@example.com&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:subject</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Hello&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:text</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:html</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;html&gt;HTML version of the body&lt;/html&gt;&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:attachment</span><span class="o">]</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;files&quot;</span><span class="p">,</span> <span class="s2">&quot;test.jpg&quot;</span><span class="p">))</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:attachment</span><span class="o">]</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;files&quot;</span><span class="p">,</span> <span class="s2">&quot;test.txt&quot;</span><span class="p">))</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span> <span class="n">data</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">SendComplexMessageChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">SendComplexMessage</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">SendComplexMessage</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;{domain}/messages&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;from&quot;</span><span class="p">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;foo@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;cc&quot;</span><span class="p">,</span> <span class="s">&quot;baz@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;bcc&quot;</span><span class="p">,</span> <span class="s">&quot;bar@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;subject&quot;</span><span class="p">,</span> <span class="s">&quot;Hello&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">,</span> <span class="s">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;html&quot;</span><span class="p">,</span>
                              <span class="s">&quot;&lt;html&gt;HTML version of the body&lt;/html&gt;&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddFile</span> <span class="p">(</span><span class="s">&quot;attachment&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="p">.</span><span class="n">Combine</span> <span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;test.jpg&quot;</span><span class="p">));</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddFile</span> <span class="p">(</span><span class="s">&quot;attachment&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="p">.</span><span class="n">Combine</span> <span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;test.txt&quot;</span><span class="p">));</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">SendComplexMessage</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="nx">m</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">NewMessage</span><span class="p">(</span>
    <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
    <span class="s">&quot;Hello&quot;</span><span class="p">,</span>
    <span class="s">&quot;Testing some Mailgun awesomeness!&quot;</span><span class="p">,</span>
    <span class="s">&quot;foo@example.com&quot;</span><span class="p">,</span>
  <span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">AddCC</span><span class="p">(</span><span class="s">&quot;baz@example.com&quot;</span><span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">AddBCC</span><span class="p">(</span><span class="s">&quot;bar@example.com&quot;</span><span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">SetHtml</span><span class="p">(</span><span class="s">&quot;&lt;html&gt;HTML version of the body&lt;/html&gt;&quot;</span><span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">AddAttachment</span><span class="p">(</span><span class="s">&quot;files/test.jpg&quot;</span><span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">AddAttachment</span><span class="p">(</span><span class="s">&quot;files/test.txt&quot;</span><span class="p">)</span>
  <span class="nx">_</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">Send</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sending a MIME message which you pre-build yourself using a MIME library of your choice:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages.mime <span class="se">\</span>
    -F <span class="nv">to</span><span class="o">=</span><span class="s1">&#39;bob@example.com&#39;</span> <span class="se">\</span>
    -F <span class="nv">message</span><span class="o">=</span>@files/message.mime
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.glassfish.jersey.media.multipart.FormDataMultiPart</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.glassfish.jersey.media.multipart.file.FileDataBodyPart</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">SendMIMEMessage</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">FormDataMultiPart</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FormDataMultiPart</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;alice@example.com&quot;</span><span class="o">);</span>

        <span class="n">String</span> <span class="n">file_separator</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&quot;file.separator&quot;</span><span class="o">);</span>

        <span class="n">File</span> <span class="n">mimeFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">&quot;files&quot;</span> <span class="o">+</span> <span class="n">file_separator</span> <span class="o">+</span> <span class="s">&quot;message.mime&quot;</span><span class="o">);</span>
        <span class="n">form</span><span class="o">.</span><span class="na">bodyPart</span><span class="o">(</span><span class="k">new</span> <span class="n">FileDataBodyPart</span><span class="o">(</span><span class="s">&quot;message&quot;</span><span class="o">,</span> <span class="n">mimeFile</span><span class="o">,</span>
            <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_OCTET_STREAM_TYPE</span><span class="o">));</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/messages&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">MULTIPART_FORM_DATA_TYPE</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s2">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">;</span>

<span class="c1"># Make the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">sendMessage</span><span class="p">(</span>
    <span class="nv">$domain</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;from&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;to&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;foo@example.com&#39;</span>
    <span class="p">),</span>
    <span class="s1">&#39;&lt;Pass fully formed MIME string here&gt;&#39;</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_mime_message</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages.mime&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;bar@example.com&quot;</span><span class="p">},</span>
        <span class="n">files</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;files/message.mime&quot;</span><span class="p">)})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_mime_message</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages.mime&quot;</span><span class="p">,</span>
  <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="s2">&quot;bar@example.com&quot;</span><span class="p">,</span>
  <span class="ss">:message</span> <span class="o">=&gt;</span> <span class="no">File</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;files&quot;</span><span class="p">,</span> <span class="s2">&quot;message.mime&quot;</span><span class="p">))</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">SendMimeMessageChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">SendMimeMessage</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">SendMimeMessage</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;{domain}/messages.mime&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;bar@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddFile</span> <span class="p">(</span><span class="s">&quot;message&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="p">.</span><span class="n">Combine</span> <span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;message.mime&quot;</span><span class="p">));</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">SendMimeMessage</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="nx">mimeMsgReader</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Open</span><span class="p">(</span><span class="s">&quot;files/message.mime&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">err</span>
  <span class="p">}</span>
  <span class="nx">m</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">NewMIMEMessage</span><span class="p">(</span><span class="nx">mimeMsgReader</span><span class="p">,</span> <span class="s">&quot;bar@example.com&quot;</span><span class="p">)</span>
  <span class="nx">_</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">Send</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span>
<span class="p">}</span>
</pre></div>
</div>
<p>An example of how to toggle tracking on a per-message basis. Note the <code class="docutils literal"><span class="pre">o:tracking</span></code> option. This will disable link rewriting for this message:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages <span class="se">\</span>
    -F <span class="nv">from</span><span class="o">=</span><span class="s1">&#39;Sender Bob &lt;sbob@YOUR_DOMAIN_NAME&gt;&#39;</span> <span class="se">\</span>
    -F <span class="nv">to</span><span class="o">=</span><span class="s1">&#39;alice@example.com&#39;</span> <span class="se">\</span>
    -F <span class="nv">subject</span><span class="o">=</span><span class="s1">&#39;Hello&#39;</span> <span class="se">\</span>
    -F <span class="nv">text</span><span class="o">=</span><span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span> <span class="se">\</span>
    -F o:tracking<span class="o">=</span>False
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">SendNoTracking</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">Form</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Form</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;from&quot;</span><span class="o">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;alice@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;bob@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;subject&quot;</span><span class="o">,</span> <span class="s">&quot;Hello&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;text&quot;</span><span class="o">,</span> <span class="s">&quot;Testing out some Mailgun awesomeness!&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;o:tracking&quot;</span><span class="o">,</span> <span class="s">&quot;false&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/messages&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s2">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">;</span>

<span class="c1"># Make the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">sendMessage</span><span class="p">(</span><span class="nv">$domain</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;from&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;to&#39;</span>         <span class="o">=&gt;</span> <span class="s1">&#39;foo@example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subject&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span>
    <span class="s1">&#39;text&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span><span class="p">,</span>
    <span class="s1">&#39;o:tracking&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_message_no_tracking</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
              <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bar@example.com&quot;</span><span class="p">,</span> <span class="s2">&quot;baz@example.com&quot;</span><span class="p">],</span>
              <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
              <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">,</span>
              <span class="s2">&quot;o:tracking&quot;</span><span class="p">:</span> <span class="bp">False</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_message_no_tracking</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
  <span class="ss">:from</span> <span class="o">=&gt;</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
  <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="s2">&quot;bar@example.com, baz@example.com&quot;</span><span class="p">,</span>
  <span class="ss">:subject</span> <span class="o">=&gt;</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
  <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">,</span>
  <span class="s2">&quot;o:tracking&quot;</span> <span class="o">=&gt;</span> <span class="kp">false</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">SendMessageNoTrackingChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">SendMessageNoTracking</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">SendMessageNoTracking</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;{domain}/messages&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;from&quot;</span><span class="p">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;bar@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;baz@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;subject&quot;</span><span class="p">,</span> <span class="s">&quot;Hello&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">,</span> <span class="s">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;o:tracking&quot;</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">SendMessageNoTracking</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="nx">m</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">NewMessage</span><span class="p">(</span>
    <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
    <span class="s">&quot;Hello&quot;</span><span class="p">,</span>
    <span class="s">&quot;Testing some Mailgun awesomeness!&quot;</span><span class="p">,</span>
    <span class="s">&quot;foo@example.com&quot;</span><span class="p">,</span>
  <span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">SetTracking</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
  <span class="nx">_</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">Send</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span>
<span class="p">}</span>
</pre></div>
</div>
<p>An example of how to set message delivery time using the <code class="docutils literal"><span class="pre">o:deliverytime</span></code> option:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages <span class="se">\</span>
    -F <span class="nv">from</span><span class="o">=</span><span class="s1">&#39;Sender Bob &lt;sbob@YOUR_DOMAIN_NAME&gt;&#39;</span> <span class="se">\</span>
    -F <span class="nv">to</span><span class="o">=</span><span class="s1">&#39;alice@example.com&#39;</span> <span class="se">\</span>
    -F <span class="nv">subject</span><span class="o">=</span><span class="s1">&#39;Hello&#39;</span> <span class="se">\</span>
    -F <span class="nv">text</span><span class="o">=</span><span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span> <span class="se">\</span>
    -F o:deliverytime<span class="o">=</span><span class="s1">&#39;Fri, 14 Oct 2011 23:10:10 -0000&#39;</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">SendScheduled</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">Form</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Form</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;from&quot;</span><span class="o">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;alice@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;subject&quot;</span><span class="o">,</span> <span class="s">&quot;Hello&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;text&quot;</span><span class="o">,</span> <span class="s">&quot;Testing out some Mailgun awesomeness!&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;o:deliverytime&quot;</span><span class="o">,</span> <span class="s">&quot;Fri, 14 Oct 2011 23:10:10 -0000&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/messages&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s2">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">;</span>

<span class="c1"># Make the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">sendMessage</span><span class="p">(</span><span class="nv">$domain</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;from&#39;</span>           <span class="o">=&gt;</span> <span class="s1">&#39;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;to&#39;</span>             <span class="o">=&gt;</span> <span class="s1">&#39;Baz &lt;baz@example.com&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subject&#39;</span>        <span class="o">=&gt;</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span>
    <span class="s1">&#39;text&#39;</span>           <span class="o">=&gt;</span> <span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span><span class="p">,</span>
    <span class="s1">&#39;o:deliverytime&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Fri, 25 Oct 2013 23:10:10 -0000&#39;</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_scheduled_message</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
              <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;bar@example.com&quot;</span><span class="p">,</span>
              <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
              <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">,</span>
              <span class="s2">&quot;o:deliverytime&quot;</span><span class="p">:</span> <span class="s2">&quot;Fri, 25 Oct 2011 23:10:10 -0000&quot;</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_scheduled_message</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
  <span class="ss">:from</span> <span class="o">=&gt;</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
  <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="s2">&quot;bar@example.com&quot;</span><span class="p">,</span>
  <span class="ss">:subject</span> <span class="o">=&gt;</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
  <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="s2">&quot;Testing some Mailgun awesomeness!&quot;</span><span class="p">,</span>
  <span class="s2">&quot;o:deliverytime&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Fri, 25 Oct 2011 23:10:10 -0000&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">SendScheduledMessageChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">SendScheduledMessage</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">SendScheduledMessage</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;{domain}/messages&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;from&quot;</span><span class="p">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;bar@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;subject&quot;</span><span class="p">,</span> <span class="s">&quot;Hello&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">,</span> <span class="s">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;o:deliverytime&quot;</span><span class="p">,</span>
                              <span class="s">&quot;Fri, 14 Oct 2011 23:10:10 -0000&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">SendScheduledMessage</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="nx">publicApiKey</span><span class="p">)</span>
  <span class="nx">m</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">NewMessage</span><span class="p">(</span>
    <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
    <span class="s">&quot;Hello&quot;</span><span class="p">,</span>
    <span class="s">&quot;Testing some Mailgun awesomeness!&quot;</span><span class="p">,</span>
    <span class="s">&quot;bar@example.com&quot;</span><span class="p">,</span>
  <span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">SetDeliveryTime</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Now</span><span class="p">().</span><span class="nx">Add</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Minute</span><span class="p">))</span>
  <span class="nx">_</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">Send</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span>
<span class="p">}</span>
</pre></div>
</div>
<p>An example of how to tag a message with the <code class="docutils literal"><span class="pre">o:tag</span></code> option:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages <span class="se">\</span>
    -F <span class="nv">from</span><span class="o">=</span><span class="s1">&#39;Sender Bob &lt;sbob@YOUR_DOMAIN_NAME&gt;&#39;</span> <span class="se">\</span>
    -F <span class="nv">to</span><span class="o">=</span><span class="s1">&#39;alice@example.com&#39;</span> <span class="se">\</span>
    -F <span class="nv">subject</span><span class="o">=</span><span class="s1">&#39;Hello&#39;</span> <span class="se">\</span>
    -F <span class="nv">text</span><span class="o">=</span><span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span> <span class="se">\</span>
    -F o:tag<span class="o">=</span><span class="s1">&#39;September newsletter&#39;</span> <span class="se">\</span>
    -F o:tag<span class="o">=</span><span class="s1">&#39;newsletters&#39;</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">SendTagged</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">Form</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Form</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;from&quot;</span><span class="o">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;alice@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;subject&quot;</span><span class="o">,</span> <span class="s">&quot;Hello&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;text&quot;</span><span class="o">,</span> <span class="s">&quot;Testing out some Mailgun awesomeness!&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;o:tag&quot;</span><span class="o">,</span> <span class="s">&quot;September newsletter&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;o:tag&quot;</span><span class="o">,</span> <span class="s">&quot;newsletters&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/messages&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s2">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">;</span>

<span class="c1"># Make the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">sendMessage</span><span class="p">(</span><span class="nv">$domain</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;from&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;to&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;Baz &lt;baz@example.com&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subject&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span>
    <span class="s1">&#39;text&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span><span class="p">,</span>
    <span class="s1">&#39;o:tag&#39;</span>   <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Tag1&#39;</span><span class="p">,</span> <span class="s1">&#39;Tag2&#39;</span><span class="p">)</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_tagged_message</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
              <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;bar@example.com&quot;</span><span class="p">,</span>
              <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
              <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">,</span>
              <span class="s2">&quot;o:tag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;September newsletter&quot;</span><span class="p">,</span> <span class="s2">&quot;newsletters&quot;</span><span class="p">]})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_tagged_message</span>
  <span class="n">data</span> <span class="o">=</span> <span class="no">Multimap</span><span class="o">.</span><span class="n">new</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:from</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:to</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;bar@example.com&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:subject</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Hello&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:text</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="s2">&quot;o:tag&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;September newsletter&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="s2">&quot;o:tag&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;newsletters&quot;</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span> <span class="n">data</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">SendTaggedMessageChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">SendTaggedMessage</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">SendTaggedMessage</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;{domain}/messages&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;from&quot;</span><span class="p">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;bar@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;subject&quot;</span><span class="p">,</span> <span class="s">&quot;Hello&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">,</span> <span class="s">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;o:tag&quot;</span><span class="p">,</span> <span class="s">&quot;September newsletter&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;o:tag&quot;</span><span class="p">,</span> <span class="s">&quot;newsletters&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">SendTaggedMessage</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="nx">m</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">NewMessage</span><span class="p">(</span>
    <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
    <span class="s">&quot;Hello&quot;</span><span class="p">,</span>
    <span class="s">&quot;Testing some Mailgun awesomeness!&quot;</span><span class="p">,</span>
    <span class="s">&quot;bar@example.com&quot;</span><span class="p">,</span>
  <span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">AddTag</span><span class="p">(</span><span class="s">&quot;FooTag&quot;</span><span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">AddTag</span><span class="p">(</span><span class="s">&quot;BarTag&quot;</span><span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">AddTag</span><span class="p">(</span><span class="s">&quot;BlortTag&quot;</span><span class="p">)</span>
  <span class="nx">_</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">Send</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span>
<span class="p">}</span>
</pre></div>
</div>
<p>An example of how to send a message with custom connection settings:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages <span class="se">\</span>
    -F <span class="nv">from</span><span class="o">=</span><span class="s1">&#39;Sender Bob &lt;sbob@YOUR_DOMAIN_NAME&gt;&#39;</span> <span class="se">\</span>
    -F <span class="nv">to</span><span class="o">=</span><span class="s1">&#39;alice@example.com&#39;</span> <span class="se">\</span>
    -F <span class="nv">subject</span><span class="o">=</span><span class="s1">&#39;Hello&#39;</span> <span class="se">\</span>
    -F <span class="nv">text</span><span class="o">=</span><span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span> <span class="se">\</span>
    -F o:require-tls<span class="o">=</span>True <span class="se">\</span>
    -F o:skip-verification<span class="o">=</span>False
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">SendRequireTLS</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">Form</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Form</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;from&quot;</span><span class="o">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;alice@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;bob@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;subject&quot;</span><span class="o">,</span> <span class="s">&quot;Hello&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;text&quot;</span><span class="o">,</span> <span class="s">&quot;Testing out some Mailgun awesomeness!&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;o:require-tls&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;o:skip-verification&quot;</span><span class="o">,</span> <span class="s">&quot;false&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/messages&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s2">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">;</span>

<span class="c1"># Make the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">sendMessage</span><span class="p">(</span><span class="nv">$domain</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;from&#39;</span>                <span class="o">=&gt;</span> <span class="s1">&#39;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;to&#39;</span>                  <span class="o">=&gt;</span> <span class="s1">&#39;foo@example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subject&#39;</span>             <span class="o">=&gt;</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span>
    <span class="s1">&#39;text&#39;</span>                <span class="o">=&gt;</span> <span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span><span class="p">,</span>
    <span class="s1">&#39;o:require-tls&#39;</span>       <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">&#39;o:skip-verification&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_require_tls</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
              <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bar@example.com&quot;</span><span class="p">,</span> <span class="s2">&quot;baz@example.com&quot;</span><span class="p">],</span>
              <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
              <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">,</span>
              <span class="s2">&quot;o:require-tls&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
              <span class="s2">&quot;o:skip-verification&quot;</span><span class="p">:</span> <span class="bp">False</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_require_tls</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
  <span class="ss">:from</span> <span class="o">=&gt;</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
  <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="s2">&quot;bar@example.com, baz@example.com&quot;</span><span class="p">,</span>
  <span class="ss">:subject</span> <span class="o">=&gt;</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
  <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">,</span>
  <span class="s2">&quot;o:require-tls&quot;</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
  <span class="s2">&quot;o:skip-verification&quot;</span> <span class="o">=&gt;</span> <span class="kp">false</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">SendConnectionChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">SendWithTLS</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">SendWithTLS</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;{domain}/messages&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;from&quot;</span><span class="p">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;bar@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;baz@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;subject&quot;</span><span class="p">,</span> <span class="s">&quot;Hello&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">,</span> <span class="s">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;o:require-tls&quot;</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;o:skip-verification&quot;</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="c1">// Coming soon</span>
</pre></div>
</div>
</div>
<div class="section" id="sending-inline-images">
<span id="inline-image"></span><h4>Sending Inline Images<a class="headerlink" href="#sending-inline-images" title="Permalink to this headline">¶</a></h4>
<p>Mailgun assigns content-id to each image passed via <code class="docutils literal"><span class="pre">inline</span></code> API parameter, so
it can be referenced in HTML part.</p>
<p>Example of sending inline image. Note how image is referenced in HTML part simply by the filename:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages <span class="se">\</span>
    -F <span class="nv">from</span><span class="o">=</span><span class="s1">&#39;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&#39;</span> <span class="se">\</span>
    -F <span class="nv">to</span><span class="o">=</span><span class="s1">&#39;alice@example.com&#39;</span> <span class="se">\</span>
    -F <span class="nv">subject</span><span class="o">=</span><span class="s1">&#39;Hello&#39;</span> <span class="se">\</span>
    -F <span class="nv">text</span><span class="o">=</span><span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span> <span class="se">\</span>
    --form-string <span class="nv">html</span><span class="o">=</span><span class="s1">&#39;&lt;html&gt;Inline image here: &lt;img src=&quot;cid:cartman.jpg&quot;&gt;&lt;/html&gt;&#39;</span> <span class="se">\</span>
    -F <span class="nv">inline</span><span class="o">=</span>@files/cartman.jpg
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.glassfish.jersey.media.multipart.FormDataMultiPart</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.glassfish.jersey.media.multipart.file.FileDataBodyPart</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">SendInlineImage</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">FormDataMultiPart</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FormDataMultiPart</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;from&quot;</span><span class="o">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;alice@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;bob@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;cc&quot;</span><span class="o">,</span> <span class="s">&quot;joe@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;subject&quot;</span><span class="o">,</span> <span class="s">&quot;Hello&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;text&quot;</span><span class="o">,</span> <span class="s">&quot;Testing out some Mailgun awesomeness!&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">&quot;html&quot;</span><span class="o">,</span> <span class="s">&quot;&lt;html&gt;Inline image here: &lt;img src=\&quot;cid:test.jpg\&quot;&gt;&lt;/html&gt;&quot;</span><span class="o">);</span>

        <span class="n">String</span> <span class="n">file_separator</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&quot;file.separator&quot;</span><span class="o">);</span>

        <span class="n">File</span> <span class="n">jpgFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">&quot;files&quot;</span> <span class="o">+</span> <span class="n">file_separator</span> <span class="o">+</span> <span class="s">&quot;test.jpg&quot;</span><span class="o">);</span>
        <span class="n">form</span><span class="o">.</span><span class="na">bodyPart</span><span class="o">(</span><span class="k">new</span> <span class="n">FileDataBodyPart</span><span class="o">(</span><span class="s">&quot;inline&quot;</span><span class="o">,</span> <span class="n">jpgFile</span><span class="o">,</span>
            <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_OCTET_STREAM_TYPE</span><span class="o">));</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/messages&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">MULTIPART_FORM_DATA_TYPE</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s2">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">;</span>

<span class="c1"># Make the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">sendMessage</span><span class="p">(</span><span class="nv">$domain</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;from&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;to&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;foo@example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cc&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;baz@example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bcc&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;bar@example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subject&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span>
    <span class="s1">&#39;text&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span><span class="p">,</span>
    <span class="s1">&#39;html&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;&lt;html&gt;Inline image: &lt;img src=&quot;cid:test.jpg&quot;&gt;&lt;/html&gt;&#39;</span>
<span class="p">),</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;inline&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;/path/to/test.jpg&#39;</span><span class="p">)</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_inline_image</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">files</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;inline&quot;</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;files/test.jpg&quot;</span><span class="p">))],</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
              <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;bar@example.com&quot;</span><span class="p">,</span>
              <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
              <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">,</span>
              <span class="s2">&quot;html&quot;</span><span class="p">:</span> <span class="s1">&#39;&lt;html&gt;Inline image here: &lt;img src=&quot;cid:test.jpg&quot;&gt;&lt;/html&gt;&#39;</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_inline_image</span>
  <span class="n">data</span> <span class="o">=</span> <span class="no">Multimap</span><span class="o">.</span><span class="n">new</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:from</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:to</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;bar@example.com&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:subject</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Hello&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:text</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:html</span><span class="o">]</span> <span class="o">=</span> <span class="s1">&#39;&lt;html&gt;Inline image here: &lt;img src=&quot;cid:test.jpg&quot;&gt;&lt;/html&gt;&#39;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:inline</span><span class="o">]</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;files&quot;</span><span class="p">,</span> <span class="s2">&quot;test.jpg&quot;</span><span class="p">))</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span> <span class="n">data</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">SendInlineImageChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">SendInlineImage</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">SendInlineImage</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;{domain}/messages&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;from&quot;</span><span class="p">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;baz@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;subject&quot;</span><span class="p">,</span> <span class="s">&quot;Hello&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">,</span> <span class="s">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;html&quot;</span><span class="p">,</span>
                              <span class="s">&quot;&lt;html&gt;Inline image here: &lt;img src=\&quot;cid:test.jpg\&quot;&gt;&lt;/html&gt;&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddFile</span> <span class="p">(</span><span class="s">&quot;inline&quot;</span><span class="p">,</span> <span class="s">&quot;files/test.jpg&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">SendInlineImage</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="nx">m</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">NewMessage</span><span class="p">(</span>
    <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
    <span class="s">&quot;Hello&quot;</span><span class="p">,</span>
    <span class="s">&quot;Testing some Mailgun awesomeness!&quot;</span><span class="p">,</span>
    <span class="s">&quot;foo@example.com&quot;</span><span class="p">,</span>
  <span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">AddCC</span><span class="p">(</span><span class="s">&quot;baz@example.com&quot;</span><span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">AddBCC</span><span class="p">(</span><span class="s">&quot;bar@example.com&quot;</span><span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">SetHtml</span><span class="p">(</span><span class="s">&quot;&lt;html&gt;HTML version of the body&lt;/html&gt;&quot;</span><span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">AddInline</span><span class="p">(</span><span class="s">&quot;files/test.jpg&quot;</span><span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">AddInline</span><span class="p">(</span><span class="s">&quot;files/test.txt&quot;</span><span class="p">)</span>
  <span class="nx">_</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">Send</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span>
 <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sending-via-smtp">
<h3>Sending via SMTP<a class="headerlink" href="#sending-via-smtp" title="Permalink to this headline">¶</a></h3>
<p>Mailgun supports sending via SMTP. Our servers listen on ports <code class="docutils literal"><span class="pre">25</span></code>, <code class="docutils literal"><span class="pre">465</span></code> (SSL/TLS), <code class="docutils literal"><span class="pre">587</span></code> (STARTTLS), and <code class="docutils literal"><span class="pre">2525</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Some ISPs are blocking or throttling SMTP port 25. We recommend using #587 instead.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Google Compute Engine allows port <code class="docutils literal"><span class="pre">2525</span></code> for SMTP submission.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">IP addresses for HTTP and SMTP API endpoints will change frequently and subjected to change without notice. Ensure there are no IP-based ACLs that would prevent communication to new IP addresses that may be added or removed at any time.</p>
</div>
<p>Use &#8220;plain text&#8221; SMTP authentication and the credentials from the domain details
page in your Control Panel which can be found by clicking on a domain in the Domains
Tab. For enhanced security, use TLS encryption.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <a class="reference internal" href="#smtp">SMTP</a> to learn how to configure the most popular SMTP software and email clients to work with Mailgun</p>
</div>
<p id="passing-sending-options"><strong>Passing Sending Options</strong></p>
<p>When sending a message via SMTP you can pass additional sending options via
custom  <a class="reference external" href="http://en.wikipedia.org/wiki/MIME">MIME</a> headers listed in the table below.</p>
<div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Header</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>X-Mailgun-Tag</td>
<td>Tag string used for aggregating stats. See <a class="reference internal" href="#tagging"><span class="std std-ref">Tagging</span></a>
for more information. You can mark a message with several
categories by setting multiple <code class="docutils literal"><span class="pre">X-Mailgun-Tag</span></code> headers.</td>
</tr>
<tr class="row-odd"><td>X-Mailgun-Campaign-Id</td>
<td>Id of the campaign the message belongs to. See
<span class="xref std std-ref">um-campaign-analytics</span> for details.
You can assign a message to several campaigns by setting
multiple different <code class="docutils literal"><span class="pre">X-Mailgun-Campaign-Id</span></code> headers.</td>
</tr>
<tr class="row-even"><td>X-Mailgun-Dkim</td>
<td>Enables/disables DKIM signatures on per-message basis.
Use <code class="docutils literal"><span class="pre">yes</span></code> or <code class="docutils literal"><span class="pre">no</span></code>.</td>
</tr>
<tr class="row-odd"><td>X-Mailgun-Deliver-By</td>
<td>Desired time of delivery. See <a class="reference internal" href="#id8">Scheduling Delivery</a> and
<a class="reference internal" href="api-intro.html#date-format"><span class="std std-ref">Date Format</span></a>.</td>
</tr>
<tr class="row-even"><td>X-Mailgun-Drop-Message</td>
<td>Enables sending in test mode. Pass <code class="docutils literal"><span class="pre">yes</span></code> if needed.
See <a class="reference internal" href="#manual-testmode"><span class="std std-ref">Sending in Test Mode</span></a>.</td>
</tr>
<tr class="row-odd"><td>X-Mailgun-Track</td>
<td>Toggles tracking on a per-message basis, see
<a class="reference internal" href="#tracking-messages"><span class="std std-ref">Tracking Messages</span></a> for details.
Pass <code class="docutils literal"><span class="pre">yes</span></code> or <code class="docutils literal"><span class="pre">no</span></code>.</td>
</tr>
<tr class="row-even"><td>X-Mailgun-Track-Clicks</td>
<td>Toggles clicks tracking on a per-message basis. Has higher
priority than domain-level setting. Pass <code class="docutils literal"><span class="pre">yes</span></code>, <code class="docutils literal"><span class="pre">no</span></code>
or <code class="docutils literal"><span class="pre">htmlonly</span></code>.</td>
</tr>
<tr class="row-odd"><td>X-Mailgun-Track-Opens</td>
<td>Toggles opens tracking on a per-message basis. Has higher
priority than domain-level setting. Pass <code class="docutils literal"><span class="pre">yes</span></code> or <code class="docutils literal"><span class="pre">no</span></code>.</td>
</tr>
<tr class="row-even"><td>X-Mailgun-Require-TLS</td>
<td>Use this header to control TLS connection settings.
See <a class="reference internal" href="#tls-sending"><span class="std std-ref">TLS Sending Connection Settings</span></a></td>
</tr>
<tr class="row-odd"><td>X-Mailgun-Skip-Verification</td>
<td>Use this header to control TLS connection settings.
See <a class="reference internal" href="#tls-sending"><span class="std std-ref">TLS Sending Connection Settings</span></a></td>
</tr>
<tr class="row-even"><td>X-Mailgun-Recipient-Variables</td>
<td>Use this header to substitute recipient variables referenced
in a batched mail message.  See <a class="reference internal" href="#batch-sending"><span class="std std-ref">Batch Sending</span></a></td>
</tr>
<tr class="row-odd"><td>X-Mailgun-Variables</td>
<td>Use this header to attach a custom JSON data to the message.
See <a class="reference internal" href="#manual-customdata"><span class="std std-ref">Attaching Data to Messages</span></a> for more information.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="message-queue">
<h3>Message Queue<a class="headerlink" href="#message-queue" title="Permalink to this headline">¶</a></h3>
<p>When you submit messages for delivery Mailgun places them in a message queue.</p>
<ul class="simple">
<li>You can submit a large amount of messages and Mailgun will automatically queue the
delivery in compliance with the receiving domains&#8217; guidelines and maximum allowed
sending rate optimized for each ESP (email service provider) such as Yahoo, GMail, etc.</li>
<li>The Queue is dynamic so as you send more messages, your sending rates will increase,
assuming you are sending quality traffic.  (See <a class="reference internal" href="best_practices.html#best-practices"><span class="std std-ref">Email Best Practices</span></a> about warming
up IP addresses.) Do not get discouraged if your messages take longer to be delivered
at the beginning. As your reputation grows, your sending rate will grow too.</li>
</ul>
<p>The queueing algorithms are one of the most important features of Mailgun.  If you try to send bulk mailings all at once, most ISPs will block you, or worse, just drop your messages without telling you.  In addition, it is important to gradually increase your sending rates according to many factors, including consistency of traffic, IP address sending history, and domain reputation.</p>
</div>
<div class="section" id="batch-sending">
<span id="id6"></span><h3>Batch Sending<a class="headerlink" href="#batch-sending" title="Permalink to this headline">¶</a></h3>
<p>Mailgun supports the ability send to a group of recipients through a single API call or SMTP session.  This is achieved by either:</p>
<ul class="simple">
<li>Using Batch Sending by specifying multiple recipient email addresses as <code class="docutils literal"><span class="pre">to</span></code> parameters and using Recipient Variables.</li>
<li>Using <a class="reference internal" href="#mailing-lists"><span class="std std-ref">Mailing Lists</span></a> with Template Variables.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">It is important when using Batch Sending to also use Recipient Variables. This tells Mailgun to send each recipient an individual email with only their email in the <code class="docutils literal"><span class="pre">to</span></code> field. If they are not used, all recipients&#8217; email addresses will show up in the <code class="docutils literal"><span class="pre">to</span></code> field for each recipient.</p>
</div>
<p id="recipient-variables"><strong>Recipient Variables</strong></p>
<p>Recipient Variables are custom variables that you define, which you can then reference in the message body. They give you the ability to send a custom message to each recipient while still using a single API Call (or SMTP session).</p>
<p>To access a recipient variable within your email, simply reference %recipient.yourkey%. For example, consider the following JSON:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;user1@example.com&quot;</span> <span class="o">:</span> <span class="p">{</span><span class="s2">&quot;unique_id&quot;</span><span class="o">:</span> <span class="s2">&quot;ABC123456789&quot;</span><span class="p">},</span>
  <span class="s2">&quot;user2@example.com&quot;</span> <span class="o">:</span> <span class="p">{</span><span class="s2">&quot;unique_id&quot;</span><span class="o">:</span> <span class="s2">&quot;ZXY987654321&quot;</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To reference the above variables within your email, use %recipient.unique_id%.</p>
<p>Recipient Variables allow you to:</p>
<ul class="simple">
<li>Submit a message template;</li>
<li>Include multiple recipients; and</li>
<li>Include a set of key:value pairs with unique data for each recipient.</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages <span class="se">\</span>
    -F <span class="nv">from</span><span class="o">=</span><span class="s1">&#39;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&#39;</span> <span class="se">\</span>
    -F <span class="nv">to</span><span class="o">=</span>alice@example.com <span class="se">\</span>
    -F <span class="nv">to</span><span class="o">=</span>bob@example.com <span class="se">\</span>
    -F recipient-variables<span class="o">=</span><span class="s1">&#39;{&quot;bob@example.com&quot;: {&quot;first&quot;:&quot;Bob&quot;, &quot;id&quot;:1}, &quot;alice@example.com&quot;: {&quot;first&quot;:&quot;Alice&quot;, &quot;id&quot;: 2}}&#39;</span> <span class="se">\</span>
    -F <span class="nv">subject</span><span class="o">=</span><span class="s1">&#39;Hey, %recipient.first%&#39;</span> <span class="se">\</span>
    -F <span class="nv">text</span><span class="o">=</span><span class="s1">&#39;If you wish to unsubscribe, click http://mailgun/unsubscribe/%recipient.id%&#39;</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">SendTemplate</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">Form</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Form</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;from&quot;</span><span class="o">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;alice@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;bob@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;subject&quot;</span><span class="o">,</span> <span class="s">&quot;Hello, %recipient.first%!&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;text&quot;</span><span class="o">,</span> <span class="s">&quot;If you wish to unsubscribe, click &lt;http://mailgun.com/unsubscribe/%recipient.id%&gt;&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;recipient-variables&quot;</span><span class="o">,</span> <span class="s">&quot;{\&quot;bob@example.com\&quot;: {\&quot;first\&quot;:\&quot;Bob\&quot;, \&quot;id\&quot;:1}, \&quot;alice@example.com\&quot;: {\&quot;first\&quot;:\&quot;Alice\&quot;, \&quot;id\&quot;: 2}}&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/messages&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s2">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">;</span>

<span class="c1"># Make the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">sendMessage</span><span class="p">(</span><span class="nv">$domain</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;from&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;to&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;bob@example.com, alice@example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subject&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Hey %recipient.first%&#39;</span><span class="p">,</span>
    <span class="s1">&#39;text&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;If you wish to unsubscribe,</span>
<span class="s1">                          click http://mailgun/unsubscribe/%recipient.id%&#39;</span><span class="p">,</span>
            <span class="s1">&#39;recipient-variables&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;{&quot;bob@example.com&quot;: {&quot;first&quot;:&quot;Bob&quot;, &quot;id&quot;:1},</span>
<span class="s1">                                       &quot;alice@example.com&quot;: {&quot;first&quot;:&quot;Alice&quot;, &quot;id&quot;: 2}}&#39;</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_template_message</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
              <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;alice@example.com, bob@example.com&quot;</span><span class="p">],</span>
              <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Hey, </span><span class="si">%r</span><span class="s2">ecipient.first%&quot;</span><span class="p">,</span>
              <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;If you wish to unsubscribe, click http://mailgun/unsubscribe/</span><span class="si">%r</span><span class="s2">ecipient.id%&#39;&quot;</span><span class="p">,</span>
              <span class="s2">&quot;recipient-variables&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;{&quot;bob@example.com&quot;: {&quot;first&quot;:&quot;Bob&quot;, &quot;id&quot;:1}, &#39;</span>
                                      <span class="s1">&#39;&quot;alice@example.com&quot;: {&quot;first&quot;:&quot;Alice&quot;, &quot;id&quot;: 2}}&#39;</span><span class="p">)})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_template_message</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
  <span class="ss">:from</span> <span class="o">=&gt;</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
  <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="s2">&quot;alice@example.com, bob@example.com&quot;</span><span class="p">,</span>
  <span class="ss">:subject</span> <span class="o">=&gt;</span> <span class="s2">&quot;Hey, %recipient.first%&quot;</span><span class="p">,</span>
  <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="s2">&quot;If you wish to unsubscribe, click http://mailgun/unsubscribe/%recipient.id%&#39;&quot;</span><span class="p">,</span>
  <span class="ss">:&#39;recipient-variables&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;{&quot;bob@example.com&quot;: {&quot;first&quot;:&quot;Bob&quot;, &quot;id&quot;:1}, &quot;alice@example.com&quot;: {&quot;first&quot;:&quot;Alice&quot;, &quot;id&quot;: 2}}&#39;</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">SendTemplateMessageChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">SendTemplateMessage</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">SendTemplateMessage</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;{domain}/messages&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;from&quot;</span><span class="p">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;alice@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;bob@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;subject&quot;</span><span class="p">,</span> <span class="s">&quot;Hey, %recipient.first%&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">,</span>
                              <span class="s">&quot;If you wish to unsubscribe, click http://mailgun/unsubscribe/%recipient.id%&#39;&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;recipient-variables&quot;</span><span class="p">,</span>
                              <span class="s">&quot;{\&quot;bob@example.com\&quot;: {\&quot;first\&quot;:\&quot;Bob\&quot;, \&quot;id\&quot;:1}, \&quot;alice@example.com\&quot;: {\&quot;first\&quot;:\&quot;Alice\&quot;, \&quot;id\&quot;: 2}}&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span>var recipients = []struct {
  Id          int
  Name, Email string
}{
  {1, &quot;Bob&quot;, bob@example.com&quot;},
  {2, &quot;Alice&quot;, alice@example.com&quot;},
}

func SendTemplateMessage(domain, apiKey string) (string, error) {
  mg := mailgun.NewMailgun(domain, apiKey, &quot;&quot;)
  m := mg.NewMessage(
    &quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;,
    &quot;Hey %recipient.first%&quot;,
    &quot;If you wish to unsubscribe, click http://mailgun/unsubscribe/%recipient.id%&quot;,
  ) // IMPORTANT: No To:-field recipients!
  for _, recipient := range recipients {
    err := m.AddRecipientAndVariables(recipient.Email, map[string]interface{}{
      &quot;name&quot;: recipient.Name,
      &quot;id&quot;:   recipient.Id,
    })
    if err != nil {
      return &quot;&quot;, err
    }
  }
  _, id, err = mg.Send(m)
  return id, err
}
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The maximum number of recipients allowed for Batch Sending is 1,000.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Recipient variables should be set as a valid JSON-encoded dictionary, where key is a plain recipient address and value is a dictionary with variables.</p>
</div>
<p>In the example above, Alice and Bob both will get personalized subject lines &#8220;Hey, Alice&#8221; and &#8220;Hey, Bob&#8221; and unique unsubscribe links.</p>
<p>When sent via SMTP, recipient variables can be included by adding the following header to your email, &#8220;X-Mailgun-Recipient-Variables: {&#8220;my_message_id&#8221;: 123}&#8221;.</p>
<p>Example:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>X-Mailgun-Recipient-Variables: {&quot;bob@example.com&quot;: {&quot;first&quot;:&quot;Bob&quot;, &quot;id&quot;:1}, &quot;alice@example.com&quot;: {&quot;first&quot;:&quot;Alice&quot;, &quot;id&quot;: 2}}
From: me@example.com
To: alice@example.com, bob@example.com
Date: 29 Mar 2016 00:23:35 -0700
Subject: Hello, %recipient.first%!
Message-Id: &lt;20160329071939.35138.9413.6915422C@example.com&gt;
Content-Type: text/plain; charset=&quot;us-ascii&quot;
Content-Transfer-Encoding: quoted-printable

Hi, %recipient.first%,
=20
Please review your profile at example.com/orders/%recipient.id%.
=20
Thanks,
Example.com Team
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The value of the &#8220;X-Mailgun-Recipient-Variables&#8221; header should be valid JSON string,
otherwise Mailgun won&#8217;t be able to parse it.  If your &#8220;X-Mailgun-Recipient-Variables&#8221; header exceeds
998 characters, you should use <a class="reference external" href="https://tools.ietf.org/html/rfc2822#page-11">folding</a> to
spread the variables over multiple lines.</p>
</div>
<p>They can also supplied through a special construct, called a variables container.</p>
<p>To contain variables you create the following MIME construct:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>multipart/mailgun-variables
--application/json (base64 encoded)
--message/rfc822
----original-message
</pre></div>
</div>
<p>In this construct, JSON will be Base64 encoded and will be stored inside the part body, which will handle recipient variables containing special characters.</p>
<p>Example:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>Content-Type: multipart/mailgun-variables; boundary=&quot;8686cc907910484e9d21c54776cd791c&quot;
Mime-Version: 1.0
From: bob@bob-mg
Date: Thu, 26 Jul 2012 15:43:07 +0000
Message-Id: &lt;20120726154307.29852.44460@definebox.com&gt;
Sender: bob=bob-mg@definebox.com

--8686cc907910484e9d21c54776cd791c
Mime-Version: 1.0
Content-Type: application/json
Content-Transfer-Encoding: base64

eyJkZXNjcmlwdGlvbiI6ICJrbGl6aGVudGFzIn0=

--8686cc907910484e9d21c54776cd791c
Content-Type: message/rfc822
Mime-Version: 1.0

Date: Thu, 26 Jul 2012 19:42:55 +0400
To: %recipient.description% &lt;support@mailgunhq.com&gt;
From: bob@bob-mg
Subject: (rackspace) Hello
 MSK 2012 support@mailgunhq.com %recipient.description%
Message-Id: &lt;20120726154302.29322.40670@definebox.com&gt;

support@mailgunhq.com %recipient.description%

--8686cc907910484e9d21c54776cd791c--
</pre></div>
</div>
</div>
<div class="section" id="mailing-lists">
<span id="id7"></span><h3>Mailing Lists<a class="headerlink" href="#mailing-lists" title="Permalink to this headline">¶</a></h3>
<p>Mailing Lists provide a convenient way to send to multiple recipients by using an alias email address. Mailgun sends a copy of the message sent to the alias address to each subscribed member of the Mailing List. You can create and maintain your subscriber lists using the API or Control Panel. In addition, you can use Template Variables to create a unique message for each member of the Mailing List.</p>
<p><strong>Overview</strong></p>
<p>To use Mailing Lists you create a Mailing List address, like <code class="docutils literal"><span class="pre">devs&#64;example.com</span></code> and add
member addresses to it. Each time you send a message to <code class="docutils literal"><span class="pre">devs&#64;example.com</span></code>, a copy
of it is delivered to each subscribed member.</p>
<p><strong>Managing a list</strong></p>
<p>You can create Mailing Lists using the Mailing List tab in the Control Panel or through the API.
We support a couple of formats to make your life easier:
you can upload a CSV file with members, use JSON or use form-like file upload.</p>
<p>Creating a mailing list through the API:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/lists <span class="se">\</span>
    -F <span class="nv">address</span><span class="o">=</span><span class="s1">&#39;LIST@YOUR_DOMAIN_NAME&#39;</span> <span class="se">\</span>
    -F <span class="nv">description</span><span class="o">=</span><span class="s1">&#39;Mailgun developers list&#39;</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">CreateMailingList</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">Form</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Form</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;address&quot;</span><span class="o">,</span> <span class="s">&quot;LIST@YOUR_DOMAIN_NAME&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;description&quot;</span><span class="o">,</span> <span class="s">&quot;LIST_DESCRIPTION&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/lists&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>

<span class="c1"># Issue the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s2">&quot;lists&quot;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;address&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;LIST@YOUR_DOMAIN_NAME&#39;</span><span class="p">,</span>
    <span class="s1">&#39;description&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Mailgun Dev List&#39;</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_mailing_list</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/lists&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;api&#39;</span><span class="p">,</span> <span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;address&#39;</span><span class="p">:</span> <span class="s1">&#39;LIST@YOUR_DOMAIN_NAME&#39;</span><span class="p">,</span>
              <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;Mailgun developers list&quot;</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_mailing_list</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span> <span class="p">\</span>
                  <span class="s2">&quot;@api.mailgun.net/v3/lists&quot;</span><span class="p">,</span>
                  <span class="ss">:address</span> <span class="o">=&gt;</span> <span class="s1">&#39;LIST@YOUR_DOMAIN_NAME&#39;</span><span class="p">,</span>
                  <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">&quot;Mailgun developers list&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">CreateMailingListChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">CreateMailingList</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">CreateMailingList</span> <span class="p">()</span>
    <span class="p">{</span>

        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;lists&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;address&quot;</span><span class="p">,</span> <span class="s">&quot;LIST@YOUR_DOMAIN_NAME&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;description&quot;</span><span class="p">,</span> <span class="s">&quot;Mailgun developers list&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">CreateMailingList</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">mailgun</span><span class="p">.</span><span class="nx">List</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="nx">protoList</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">List</span><span class="p">{</span>
    <span class="nx">Address</span><span class="p">:</span>     <span class="s">&quot;LIST@YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span>
    <span class="nx">Name</span><span class="p">:</span>        <span class="s">&quot;dev&quot;</span><span class="p">,</span>
    <span class="nx">Description</span><span class="p">:</span> <span class="s">&quot;Mailgun developers list.&quot;</span><span class="p">,</span>
    <span class="nx">AccessLevel</span><span class="p">:</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">Members</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">CreateList</span><span class="p">(</span><span class="nx">protoList</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Adding a member through the API:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/lists/LIST@YOUR_DOMAIN_NAME/members <span class="se">\</span>
    -F <span class="nv">subscribed</span><span class="o">=</span>True <span class="se">\</span>
    -F <span class="nv">address</span><span class="o">=</span><span class="s1">&#39;bar@example.com&#39;</span> <span class="se">\</span>
    -F <span class="nv">name</span><span class="o">=</span><span class="s1">&#39;Bob Bar&#39;</span> <span class="se">\</span>
    -F <span class="nv">description</span><span class="o">=</span><span class="s1">&#39;Developer&#39;</span> <span class="se">\</span>
    -F <span class="nv">vars</span><span class="o">=</span><span class="s1">&#39;{&quot;age&quot;: 26}&#39;</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">AddListMember</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">Form</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Form</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;address&quot;</span><span class="o">,</span> <span class="s">&quot;bob@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;subscribed&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="s">&quot;Bob Bar&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;description&quot;</span><span class="o">,</span> <span class="s">&quot;developer&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;vars&quot;</span><span class="o">,</span> <span class="s">&quot;{\&quot;age\&quot;: 26}&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/lists/{list}@{domain}/members&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;list&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_LIST_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$listAddress</span> <span class="o">=</span> <span class="s1">&#39;LIST@YOUR_DOMAIN_NAME&#39;</span><span class="p">;</span>

<span class="c1"># Issue the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s2">&quot;lists/</span><span class="si">$listAddress</span><span class="s2">/members&quot;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;address&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;bar@example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span>        <span class="o">=&gt;</span> <span class="s1">&#39;Bob Bar&#39;</span><span class="p">,</span>
    <span class="s1">&#39;description&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Developer&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subscribed&#39;</span>  <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">&#39;vars&#39;</span>        <span class="o">=&gt;</span> <span class="s1">&#39;{&quot;age&quot;: 26}&#39;</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_list_member</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/lists/LIST@YOUR_DOMAIN_NAME/members&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;api&#39;</span><span class="p">,</span> <span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;subscribed&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
              <span class="s1">&#39;address&#39;</span><span class="p">:</span> <span class="s1">&#39;bar@example.com&#39;</span><span class="p">,</span>
              <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Bob Bar&#39;</span><span class="p">,</span>
              <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer&#39;</span><span class="p">,</span>
              <span class="s1">&#39;vars&#39;</span><span class="p">:</span> <span class="s1">&#39;{&quot;age&quot;: 26}&#39;</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_list_member</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span> <span class="p">\</span>
                  <span class="s2">&quot;@api.mailgun.net/v3/lists/LIST@YOUR_DOMAIN_NAME/members&quot;</span><span class="p">,</span>
                  <span class="ss">:subscribed</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
                  <span class="ss">:address</span> <span class="o">=&gt;</span> <span class="s1">&#39;bar@example.com&#39;</span><span class="p">,</span>
                  <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s1">&#39;Bob Bar&#39;</span><span class="p">,</span>
                  <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s1">&#39;Developer&#39;</span><span class="p">,</span>
                  <span class="ss">:vars</span> <span class="o">=&gt;</span> <span class="s1">&#39;{&quot;age&quot;: 26}&#39;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">AddListMemberChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">AddListMember</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">AddListMember</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;lists/{list}/members&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;list&quot;</span><span class="p">,</span> <span class="s">&quot;LIST@YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span>
                              <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;address&quot;</span><span class="p">,</span> <span class="s">&quot;bar@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;subscribed&quot;</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="s">&quot;Bob Bar&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;description&quot;</span><span class="p">,</span> <span class="s">&quot;Developer&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;vars&quot;</span><span class="p">,</span> <span class="s">&quot;{\&quot;age\&quot;: 26}&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">AddListMember</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="nx">memberJoe</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">Member</span><span class="p">{</span>
    <span class="nx">Address</span><span class="p">:</span>    <span class="s">&quot;joe@example.com&quot;</span><span class="p">,</span>
    <span class="nx">Name</span><span class="p">:</span>       <span class="s">&quot;Joe Example&quot;</span><span class="p">,</span>
    <span class="nx">Subscribed</span><span class="p">:</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">Subscribed</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">CreateMember</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="s">&quot;mailingList@example.com&quot;</span><span class="p">,</span> <span class="nx">memberJoe</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can attach a JSON dictionary with the structured data to each member
of the mailing list and reference that data in the message body using Template Variables (see <code class="docutils literal"><span class="pre">vars</span></code> parameter in the example above).</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There are two modes available when adding a new member: strict and
upsert. Strict will raise an error in case the member already
exists, upsert will update an existing member if it&#8217;s here or insert
a new one. Learn how to toggle between the the modes and skip
malformed addresses in the <a class="reference internal" href="api-mailinglists.html#api-mailinglists"><span class="std std-ref">Mailing Lists</span></a> API section.</p>
</div>
<p><strong>Sending to a list</strong></p>
<p>You can set the access level of Mailing Lists to:</p>
<ul class="simple">
<li>Only allow the administrator to post to the list (limited to an API call or authenticated SMTP session);</li>
<li>Allow Mailing List members to post to the list; or</li>
<li>Allow anybody to post to the list.</li>
</ul>
<p><strong>Campaigns</strong></p>
<p>Mailing lists are integrated with <span class="xref std std-ref">um-campaign-analytics</span>. Each
message sent to a list with a Campaign ID will be tracked and
reported. In this case, the mailing list will have detailed analytics for
all recipients that can be retrieved via API or seen in the Campaign tab of
the Control Panel.</p>
<p id="template-variables"><strong>Template Variables</strong></p>
<p>There are some pre-defined variables you can use to
personalize your message to each recipient. When adding members to a Mailing List you can also define
your own variables in addition to these pre-defined variables by using the <code class="docutils literal"><span class="pre">vars</span></code> parameter.</p>
<div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>%recipient%</td>
<td>Full recipient spec, like &#8220;Bob &lt;<a class="reference external" href="mailto:bob&#37;&#52;&#48;example&#46;com">bob<span>&#64;</span>example<span>&#46;</span>com</a>&gt;&#8221; (for using as value for &#8220;To&#8221; MIME header).</td>
</tr>
<tr class="row-odd"><td>%recipient_email%</td>
<td>Recipient&#8217;s email address, like <a class="reference external" href="mailto:bob&#37;&#52;&#48;example&#46;com">bob<span>&#64;</span>example<span>&#46;</span>com</a>.</td>
</tr>
<tr class="row-even"><td>%recipient_name%</td>
<td>Recipient&#8217;s full name, like &#8220;John Q. Public&#8221;.</td>
</tr>
<tr class="row-odd"><td>%recipient_fname%</td>
<td>Recipient&#8217;s first name.</td>
</tr>
<tr class="row-even"><td>%recipient_lname%</td>
<td>Recipient&#8217;s last name.</td>
</tr>
<tr class="row-odd"><td>%unsubscribe_url%</td>
<td>A generated URL which allows users to unsubscribe from messages.</td>
</tr>
<tr class="row-even"><td>%mailing_list_unsubscribe_url%</td>
<td>A generated URL which allows users to unsubscribe from mailing lists.</td>
</tr>
<tr class="row-odd"><td>%unsubscribe_email%</td>
<td>An email address which can be used for automatic unsubscription by adding it to List-Unsubscribe MIME header.</td>
</tr>
<tr class="row-even"><td>%recipient.yourvar%</td>
<td>Accessing a custom datavalue. (see <a class="reference internal" href="#manual-customdata"><span class="std std-ref">Attaching Data to Messages</span></a>)</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Unsubscribing</strong></p>
<p>For managing unsubscribes in Mailing Lists, you can use <code class="docutils literal"><span class="pre">%mailing_list_unsubscribe_url%</span></code>.
We will generate the unique link to unsubscribe from the mailing list.
Once a recipient clicks on the unsubscribe link, we mark the recipient as
&#8220;unsubscribed&#8221; from this list and they won&#8217;t get any further emails addressed
to this list. Note, that you can still override the &#8220;unsubscribe&#8221; setting via
the API or the Control Panel (in case of user error or accidental unsubscribe,
for example). You can also manually unsubscribe the customer without using any
links via the API or in the Control Panel. Read more in the <a class="reference internal" href="api-mailinglists.html#api-mailinglists"><span class="std std-ref">Mailing Lists</span></a>
API section.</p>
<p><strong>Mailing Lists and Routes</strong></p>
<p>Mailing Lists work independently from Routes.
If there is a Mailing List or Route with the same address, the incoming message will hit the Route and Mailing List simultaneously. This can be pretty convenient for processing replies to the Mailing List and integrating into things like forums
or commenting systems.</p>
</div>
<div class="section" id="scheduling-delivery">
<span id="id8"></span><h3>Scheduling Delivery<a class="headerlink" href="#scheduling-delivery" title="Permalink to this headline">¶</a></h3>
<p>Mailgun also allows you to request a specific time for your message delivery by
using the <code class="docutils literal"><span class="pre">o:deliverytime</span></code> parameter if sending via the API, or
<code class="docutils literal"><span class="pre">X-Mailgun-Deliver-By</span></code> MIME header if sending via SMTP.</p>
<p>While messages are not guaranteed to arrive at exactly the requested time due to
the dynamic nature of the queue, Mailgun will do its best.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Messages can be scheduled for a maximum of 3 days in the future.</p>
</div>
<p><strong>Scheduling Delivery API Example</strong></p>
<p>Supply <span class="target" id="index-0"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc2822.html#section-3.3"><strong>RFC 2822#section-3.3</strong></a> or <a class="reference external" href="http://en.wikipedia.org/wiki/Unix_time">Unix epoch</a>
time to schedule your message:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages <span class="se">\</span>
    -F <span class="nv">from</span><span class="o">=</span><span class="s1">&#39;Sender Bob &lt;sbob@YOUR_DOMAIN_NAME&gt;&#39;</span> <span class="se">\</span>
    -F <span class="nv">to</span><span class="o">=</span><span class="s1">&#39;alice@example.com&#39;</span> <span class="se">\</span>
    -F <span class="nv">subject</span><span class="o">=</span><span class="s1">&#39;Hello&#39;</span> <span class="se">\</span>
    -F <span class="nv">text</span><span class="o">=</span><span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span> <span class="se">\</span>
    -F o:deliverytime<span class="o">=</span><span class="s1">&#39;Fri, 14 Oct 2011 23:10:10 -0000&#39;</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">SendScheduled</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">Form</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Form</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;from&quot;</span><span class="o">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;alice@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;subject&quot;</span><span class="o">,</span> <span class="s">&quot;Hello&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;text&quot;</span><span class="o">,</span> <span class="s">&quot;Testing out some Mailgun awesomeness!&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;o:deliverytime&quot;</span><span class="o">,</span> <span class="s">&quot;Fri, 14 Oct 2011 23:10:10 -0000&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/messages&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s2">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">;</span>

<span class="c1"># Make the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">sendMessage</span><span class="p">(</span><span class="nv">$domain</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;from&#39;</span>           <span class="o">=&gt;</span> <span class="s1">&#39;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;to&#39;</span>             <span class="o">=&gt;</span> <span class="s1">&#39;Baz &lt;baz@example.com&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subject&#39;</span>        <span class="o">=&gt;</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span>
    <span class="s1">&#39;text&#39;</span>           <span class="o">=&gt;</span> <span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span><span class="p">,</span>
    <span class="s1">&#39;o:deliverytime&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Fri, 25 Oct 2013 23:10:10 -0000&#39;</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_scheduled_message</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
              <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;bar@example.com&quot;</span><span class="p">,</span>
              <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
              <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">,</span>
              <span class="s2">&quot;o:deliverytime&quot;</span><span class="p">:</span> <span class="s2">&quot;Fri, 25 Oct 2011 23:10:10 -0000&quot;</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_scheduled_message</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
  <span class="ss">:from</span> <span class="o">=&gt;</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
  <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="s2">&quot;bar@example.com&quot;</span><span class="p">,</span>
  <span class="ss">:subject</span> <span class="o">=&gt;</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
  <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="s2">&quot;Testing some Mailgun awesomeness!&quot;</span><span class="p">,</span>
  <span class="s2">&quot;o:deliverytime&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Fri, 25 Oct 2011 23:10:10 -0000&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">SendScheduledMessageChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">SendScheduledMessage</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">SendScheduledMessage</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;{domain}/messages&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;from&quot;</span><span class="p">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;bar@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;subject&quot;</span><span class="p">,</span> <span class="s">&quot;Hello&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">,</span> <span class="s">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;o:deliverytime&quot;</span><span class="p">,</span>
                              <span class="s">&quot;Fri, 14 Oct 2011 23:10:10 -0000&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">SendScheduledMessage</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="nx">publicApiKey</span><span class="p">)</span>
  <span class="nx">m</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">NewMessage</span><span class="p">(</span>
    <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
    <span class="s">&quot;Hello&quot;</span><span class="p">,</span>
    <span class="s">&quot;Testing some Mailgun awesomeness!&quot;</span><span class="p">,</span>
    <span class="s">&quot;bar@example.com&quot;</span><span class="p">,</span>
  <span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">SetDeliveryTime</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Now</span><span class="p">().</span><span class="nx">Add</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Minute</span><span class="p">))</span>
  <span class="nx">_</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">Send</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="sending-in-test-mode">
<span id="manual-testmode"></span><h3>Sending in Test Mode<a class="headerlink" href="#sending-in-test-mode" title="Permalink to this headline">¶</a></h3>
<p>You can send messages in test mode by setting <code class="docutils literal"><span class="pre">o:testmode</span></code> parameter to <code class="docutils literal"><span class="pre">true</span></code>.
When you do this, Mailgun will accept the message but will not send it.
This is useful for testing purposes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You are charged for messages sent in test mode.</p>
</div>
</div>
</div>
<div class="section" id="tracking-messages">
<span id="id9"></span><h2>Tracking Messages<a class="headerlink" href="#tracking-messages" title="Permalink to this headline">¶</a></h2>
<p>Once you start sending and receiving messages, it&#8217;s important to track what&#8217;s happening with them. We try to make tracking your messages as easy as possible through Events, Stats and Campaigns.</p>
<p>In addition, Mailgun permanently stores when a message can not be delivered due to a hard bounce (permanent failure) or when a recipient unsubscribes or complains of spam. In these cases, Mailgun will not attempt to deliver to these recipients in the future, in order to protect your sending reputation.</p>
<p>Mailgun provides a variety of methods to access data on your emails:</p>
<ul class="simple">
<li>View and search Events through the Logs tab in the Control Panel to see every event that has happened to every message. You can search by fields like recipient, subject line and even fields that don&#8217;t show up in the Logs, like message-id. Data is stored for at least 30 days for paid accounts and at least 2 days for free accounts.</li>
<li>Access data on Events programmatically through the <a class="reference internal" href="api-events.html#api-events"><span class="std std-ref">Events API</span></a>.  Data is stored for at least 30 days for paid accounts and at least 2 days for free accounts.</li>
<li>View, search and edit tables for Bounces, Unsubscribes and Spam Complaints in <a class="reference external" href="https://mailgun.com/app/suppressions">Suppression Lists</a> or their respective APIs (<a class="reference internal" href="api-suppressions.html#api-bounces"><span class="std std-ref">Bounces API</span></a>, <a class="reference internal" href="api-suppressions.html#api-unsubscribes"><span class="std std-ref">Unsubscribes API</span></a>, <a class="reference internal" href="api-suppressions.html#api-complaints"><span class="std std-ref">Complaints API</span></a>). Data is stored indefinitely.</li>
<li>Access statistics aggregated by tags in the Tracking tab of the Control Panel or the <a class="reference internal" href="api-stats.html#api-stats"><span class="std std-ref">Stats API</span></a>. Data is stored for at least 6 months.</li>
<li>Create Campaigns and access detailed analytics on those Campaigns through the Control Panel or the <a class="reference internal" href="api-campaigns.html#api-campaigns"><span class="std std-ref">Campaigns API</span></a>. Data is stored for at least 6 months other than the delivered event which is stored for 2 weeks.</li>
<li>Receive notifications of events through a Webhook each time an Event happens and store the data on your side.</li>
</ul>
<p><strong>Enable Tracking</strong></p>
<p>Event tracking is automatically enabled except for Unsubscribes, Opens and Clicks.</p>
<p>You can enable Unsubscribes tracking for your domain via the &#8220;Domains&#8221; tab of the Control Panel.
You can also manage unsubscribes per message by using unsubscribe variables (see <a class="reference internal" href="#tracking-unsubscribes">Tracking Unsubscribes</a>)</p>
<p>You can enable Opens &amp; Clicks tracking on two levels: per sending domain and per message.</p>
<ul class="simple">
<li>You can enable Open &amp; Click tracking on per domain basis under the “Domain Settings” subsection on the domain info page.</li>
<li>Tracking can also be toggled by setting <code class="docutils literal"><span class="pre">o:tracking</span></code>, <code class="docutils literal"><span class="pre">o:tracking-clicks</span></code> and <code class="docutils literal"><span class="pre">o:tracking-opens</span></code> parameters when sending your message. This will override the domain-level setting.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You will also have to point CNAME records to mailgun.org for Mailgun to rewrite links and track opens. In addition, there needs to be an html part of message for Mailgun to track opens (see <a class="reference internal" href="#tracking-opens">Tracking Opens</a> and <a class="reference internal" href="#tracking-clicks">Tracking Clicks</a> for more detail).</p>
</div>
<div class="section" id="events">
<h3>Events<a class="headerlink" href="#events" title="Permalink to this headline">¶</a></h3>
<p>Mailgun keeps track of every event that happens to every message (both inbound and outbound) and stores this data for at least 30 days for paid accounts and 2 days for free accounts.</p>
<p>Below is the table of events that Mailgun tracks.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Event</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>accepted</td>
<td>Mailgun accepted the request to send/forward the email and the message
has been placed in queue.</td>
</tr>
<tr class="row-odd"><td>rejected</td>
<td>Mailgun rejected the request to send/forward the email.</td>
</tr>
<tr class="row-even"><td>delivered</td>
<td>Mailgun sent the email and it was accepted by the recipient
email server.</td>
</tr>
<tr class="row-odd"><td>failed</td>
<td>Mailgun could not deliver the email to the recipient email server.</td>
</tr>
<tr class="row-even"><td>opened</td>
<td>The email recipient opened the email and enabled image
viewing. Open tracking must be enabled in the Mailgun control
panel, and the CNAME record must be pointing to mailgun.org.</td>
</tr>
<tr class="row-odd"><td>clicked</td>
<td>The email recipient clicked on a link in the email.
Click tracking must be enabled in the Mailgun control
panel, and the CNAME record must be pointing to mailgun.org.</td>
</tr>
<tr class="row-even"><td>unsubscribed</td>
<td>The email recipient clicked on the unsubscribe link.
Unsubscribe tracking must be enabled in the Mailgun control
panel.</td>
</tr>
<tr class="row-odd"><td>complained</td>
<td>The email recipient clicked on the spam complaint button within
their email client. Feedback loops enable the notification to
be received by Mailgun.</td>
</tr>
<tr class="row-even"><td>stored</td>
<td>Mailgun has stored an incoming message</td>
</tr>
</tbody>
</table>
<p>You can access Events through a few interfaces:</p>
<ul class="simple">
<li>Webhooks (we POST data to your URL).</li>
<li>The Events API (you GET data through the API).</li>
<li>The Logs Tab of the Control Panel (GUI).</li>
</ul>
<p id="manual-events-api"><strong>Events API</strong></p>
<p>You can programmatically query and download events through the <a class="reference internal" href="api-events.html#api-events"><span class="std std-ref">Events API</span></a>.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> -G <span class="se">\</span>
      https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/events <span class="se">\</span>
      --data-urlencode <span class="nv">begin</span><span class="o">=</span><span class="s1">&#39;Fri, 3 May 2013 09:00:00 -0000&#39;</span> <span class="se">\</span>
      --data-urlencode <span class="nv">ascending</span><span class="o">=</span>yes <span class="se">\</span>
      --data-urlencode <span class="nv">limit</span><span class="o">=</span><span class="m">25</span> <span class="se">\</span>
      --data-urlencode <span class="nv">pretty</span><span class="o">=</span>yes <span class="se">\</span>
      --data-urlencode <span class="nv">recipient</span><span class="o">=</span>joe@example.com
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">GetLogs</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/events&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">&quot;begin&quot;</span><span class="o">,</span> <span class="mi">50</span><span class="o">);</span>
            <span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">&quot;ascending&quot;</span><span class="o">,</span> <span class="s">&quot;yes&quot;</span><span class="o">);</span>
            <span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">&quot;limit&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
            <span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">&quot;pretty&quot;</span><span class="o">,</span> <span class="s">&quot;yes&quot;</span><span class="o">);</span>
            <span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">&quot;recipient&quot;</span><span class="o">,</span> <span class="s">&quot;joe@example.com&quot;</span><span class="o">);</span>
            <span class="o">.</span><span class="na">request</span><span class="o">()</span>
            <span class="o">.</span><span class="na">buildGet</span><span class="o">()</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s1">&#39;YOUR_DOMAIN_NAME&#39;</span><span class="p">;</span>
<span class="nv">$queryString</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;begin&#39;</span>        <span class="o">=&gt;</span> <span class="s1">&#39;Fri, 3 May 2013 09:00:00 -0000&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ascending&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;limit&#39;</span>        <span class="o">=&gt;</span>  <span class="mi">25</span><span class="p">,</span>
    <span class="s1">&#39;pretty&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subject&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;test&#39;</span>
<span class="p">);</span>

<span class="c1"># Make the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$domain</span><span class="s2">/events&quot;</span><span class="p">,</span> <span class="nv">$queryString</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_logs</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/events&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;begin&quot;</span>       <span class="p">:</span> <span class="s2">&quot;Fri, 3 May 2013 09:00:00 -0000&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ascending&quot;</span>   <span class="p">:</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
                <span class="s2">&quot;limit&quot;</span>       <span class="p">:</span>  <span class="mi">25</span><span class="p">,</span>
                <span class="s2">&quot;pretty&quot;</span>      <span class="p">:</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
                <span class="s2">&quot;recipient&quot;</span> <span class="p">:</span> <span class="s2">&quot;joe@example.com&quot;</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_logs</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">get</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/YOUR_DOMAIN_NAME/events&quot;</span><span class="p">,</span>
   <span class="ss">:params</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="ss">:&#39;begin&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;Fri, 3 May 2013 09:00:00 -0000&#39;</span><span class="p">,</span>
    <span class="ss">:&#39;ascending&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span>
    <span class="ss">:&#39;limit&#39;</span>       <span class="o">=&gt;</span>  <span class="mi">25</span><span class="p">,</span>
    <span class="ss">:&#39;pretty&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span>
    <span class="ss">:&#39;recipient&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;joe@example.com&#39;</span>
   <span class="p">}</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">EventsDateTimeRecipientChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">EventsDateTimeRecipient</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">EventsDateTimeRecipient</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;{domain}/events&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;begin&quot;</span><span class="p">,</span> <span class="s">&quot;Fri, 3 May 2013 09:00:00 -0000&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;ascending&quot;</span><span class="p">,</span> <span class="s">&quot;yes&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;limit&quot;</span><span class="p">,</span> <span class="m">25</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;pretty&quot;</span><span class="p">,</span> <span class="s">&quot;yes&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;recipient&quot;</span><span class="p">,</span> <span class="s">&quot;joe@example.com&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">GetLog</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">([]</span><span class="nx">mailgun</span><span class="p">.</span><span class="nx">Event</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="nx">ei</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">NewEventIterator</span><span class="p">()</span>
  <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ei</span><span class="p">.</span><span class="nx">GetFirstPage</span><span class="p">(</span><span class="nx">mailgun</span><span class="p">.</span><span class="nx">GetEventsOptions</span><span class="p">{</span>
    <span class="nx">Begin</span><span class="p">:</span>          <span class="nx">time</span><span class="p">.</span><span class="nx">Now</span><span class="p">().</span><span class="nx">Add</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span> <span class="o">*</span> <span class="nx">Time</span><span class="p">.</span><span class="nx">Minute</span><span class="p">),</span>
    <span class="nx">ForceAscending</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">Limit</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
    <span class="nx">Filter</span><span class="p">:</span>         <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">{</span>
      <span class="s">&quot;recipient&quot;</span><span class="p">:</span> <span class="s">&quot;joe@example.com&quot;</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">err</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">ei</span><span class="p">.</span><span class="nx">Events</span><span class="p">(),</span> <span class="kc">nil</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample response:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;items&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;tags&quot;</span><span class="o">:</span> <span class="p">[],</span>
      <span class="s2">&quot;timestamp&quot;</span><span class="o">:</span> <span class="mf">1376325780.160809</span><span class="p">,</span>
      <span class="s2">&quot;envelope&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;sender&quot;</span><span class="o">:</span> <span class="s2">&quot;me@samples.mailgun.org&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transport&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;event&quot;</span><span class="o">:</span> <span class="s2">&quot;accepted&quot;</span><span class="p">,</span>
      <span class="s2">&quot;campaigns&quot;</span><span class="o">:</span> <span class="p">[],</span>
      <span class="s2">&quot;user-variables&quot;</span><span class="o">:</span> <span class="p">{},</span>
      <span class="s2">&quot;flags&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;is-authenticated&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">&quot;is-test-mode&quot;</span><span class="o">:</span> <span class="kc">false</span>
      <span class="p">},</span>
      <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;headers&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;to&quot;</span><span class="o">:</span> <span class="s2">&quot;user@example.com&quot;</span><span class="p">,</span>
          <span class="s2">&quot;message-id&quot;</span><span class="o">:</span> <span class="s2">&quot;20130812164300.28108.52546@samples.mailgun.org&quot;</span><span class="p">,</span>
          <span class="s2">&quot;from&quot;</span><span class="o">:</span> <span class="s2">&quot;Excited User &lt;me@samples.mailgun.org&gt;&quot;</span><span class="p">,</span>
          <span class="s2">&quot;subject&quot;</span><span class="o">:</span> <span class="s2">&quot;Hello&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;attachments&quot;</span><span class="o">:</span> <span class="p">[],</span>
        <span class="s2">&quot;recipients&quot;</span><span class="o">:</span> <span class="p">[</span>
          <span class="s2">&quot;user@example.com&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;size&quot;</span><span class="o">:</span> <span class="mi">69</span>
      <span class="p">},</span>
      <span class="s2">&quot;recipient&quot;</span><span class="o">:</span> <span class="s2">&quot;user@example.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;method&quot;</span><span class="o">:</span> <span class="s2">&quot;http&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;paging&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;next&quot;</span><span class="o">:</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/samples.mailgun.org/events/W3siY...&quot;</span><span class="p">,</span>
    <span class="s2">&quot;previous&quot;</span><span class="o">:</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/samples.mailgun.org/events/Lkawm...&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="webhooks">
<span id="id10"></span><h3>Webhooks<a class="headerlink" href="#webhooks" title="Permalink to this headline">¶</a></h3>
<p>Mailgun can make an HTTP POST to your URLs when events occur with your messages. If you would like Mailgun to POST event notifications, you need to provide a callback URL in the Webhooks tab of the Control Panel. Webhooks are at the domain level so you can provide a unique URL for each domain by using the domain drop down selector.</p>
<p>You can read more about the data that is posted in the appropriate section below (<a class="reference internal" href="#tracking-opens">Tracking Opens</a>, <a class="reference internal" href="#tracking-clicks">Tracking Clicks</a>, <a class="reference internal" href="#tracking-unsubscribes">Tracking Unsubscribes</a>, <a class="reference internal" href="#tracking-spam-complaints">Tracking Spam Complaints</a>, <a class="reference internal" href="#tracking-bounces">Tracking Bounces</a>, <a class="reference internal" href="#tracking-failures">Tracking Failures</a>, <a class="reference internal" href="#tracking-deliveries">Tracking Deliveries</a>). We recommend using <a class="reference external" href="http://bin.mailgun.net/">http://bin.mailgun.net/</a> for creating temporary URLs to test and debug your webhooks.</p>
<p>For Webhook POSTs, Mailgun listens for the following codes from your server and reacts accordingly:</p>
<ul class="simple">
<li>If Mailgun receives a <code class="docutils literal"><span class="pre">200</span> <span class="pre">(Success)</span></code> code it will determine the webhook POST is successful and not retry.</li>
<li>If Mailgun receives a <code class="docutils literal"><span class="pre">406</span> <span class="pre">(Not</span> <span class="pre">Acceptable)</span></code> code, Mailgun will determine the POST is rejected and not retry.</li>
<li>For any other code, Mailgun will retry POSTing according to the schedule below for Webhooks other than the delivery notification.</li>
</ul>
<p>If your application is unable to process the webhook request but you do not return a 406 error code, Mailgun will retry (other than for delivery notification) during 8 hours at the following intervals before stop trying: 10 minutes, 10 minutes, 15 minutes, 30 minutes, 1 hour, 2 hour and 4 hours.</p>
<p>The Webhooks API endpoint allows you to programmatically manipulate the webhook
URLs defined for a specific domain. Head over to the <a class="reference internal" href="api-webhooks.html#api-webhooks"><span class="std std-ref">Webhooks</span></a> API endpoint documentation.</p>
<p id="securing-webhooks"><strong>Securing Webhooks</strong></p>
<p>To ensure the authenticity of event requests, Mailgun signs them and posts the signature
along with other webhook parameters:</p>
<div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="8%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>timestamp</td>
<td>int</td>
<td>Number of seconds passed since January 1, 1970.</td>
</tr>
<tr class="row-odd"><td>token</td>
<td>string</td>
<td>Randomly generated string with length 50.</td>
</tr>
<tr class="row-even"><td>signature</td>
<td>string</td>
<td>String with hexadecimal digits generate by HMAC algorithm.</td>
</tr>
</tbody>
</table>
</div>
<p>To verify the webhook is originating from Mailgun you need to:</p>
<ul class="simple">
<li>Concatenate timestamp and token values.</li>
<li>Encode the resulting string with the HMAC algorithm (using your API Key as a key and SHA256 digest mode).</li>
<li>Compare the resulting hexdigest to the signature.</li>
<li>Optionally, you can cache the token value locally and not honor any subsequent request with the same token. This will prevent replay attacks.</li>
<li>Optionally, you can check if the timestamp is not too far from the current time.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Due to potentially large size of posted data, Mailgun computes an authentication
signature based on a limited set of HTTP headers.</p>
</div>
<p>Below is a Python code sample used to verify the signature:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hashlib</span><span class="o">,</span> <span class="nn">hmac</span>

<span class="k">def</span> <span class="nf">verify</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">signature</span><span class="p">):</span>
    <span class="n">hmac_digest</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">api_key</span><span class="p">,</span>
                           <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;{}{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">token</span><span class="p">),</span>
                           <span class="n">digestmod</span><span class="o">=</span><span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="nb">unicode</span><span class="p">(</span><span class="n">signature</span><span class="p">),</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">hmac_digest</span><span class="p">))</span>
</pre></div>
</div>
<p>And here&#8217;s a sample in Ruby:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span></span><span class="nb">require</span> <span class="s1">&#39;openssl&#39;</span>

<span class="k">def</span> <span class="nf">verify</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">signature</span><span class="p">)</span>
  <span class="n">digest</span> <span class="o">=</span> <span class="no">OpenSSL</span><span class="o">::</span><span class="no">Digest</span><span class="o">::</span><span class="no">SHA256</span><span class="o">.</span><span class="n">new</span>
  <span class="n">data</span> <span class="o">=</span> <span class="o">[</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">token</span><span class="o">].</span><span class="n">join</span>
  <span class="n">signature</span> <span class="o">==</span> <span class="no">OpenSSL</span><span class="o">::</span><span class="no">HMAC</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>And here&#8217;s a sample in PHP:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="k">private</span> <span class="k">function</span> <span class="nf">verify</span><span class="p">(</span><span class="nv">$apiKey</span><span class="p">,</span> <span class="nv">$token</span><span class="p">,</span> <span class="nv">$timestamp</span><span class="p">,</span> <span class="nv">$signature</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//check if the timestamp is fresh</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">time</span><span class="p">()</span><span class="o">-</span><span class="nv">$timestamp</span><span class="o">&gt;</span><span class="mi">15</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">//returns true if signature is valid</span>
    <span class="k">return</span> <span class="nb">hash_hmac</span><span class="p">(</span><span class="s1">&#39;sha256&#39;</span><span class="p">,</span> <span class="nv">$timestamp</span><span class="o">.</span><span class="nv">$token</span><span class="p">,</span> <span class="nv">$apiKey</span><span class="p">)</span> <span class="o">===</span> <span class="nv">$signature</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="attaching-data-to-messages">
<span id="manual-customdata"></span><h3>Attaching Data to Messages<a class="headerlink" href="#attaching-data-to-messages" title="Permalink to this headline">¶</a></h3>
<p>When sending, you can attach data to your messages by passing custom data to the API or SMTP endpoints.
The data will be represented as a header within the email, <code class="docutils literal"><span class="pre">X-Mailgun-Variables</span></code>. The data
is formatted in JSON and included in any webhook events related to the email containing the custom data. Several
such headers may be included and their values will be combined.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">-</span><span class="n">Mailgun</span><span class="o">-</span><span class="n">Variables</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;first_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Smith&quot;</span><span class="p">}</span>
<span class="n">X</span><span class="o">-</span><span class="n">Mailgun</span><span class="o">-</span><span class="n">Variables</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;my_message_id&quot;</span><span class="p">:</span> <span class="mi">123</span><span class="p">}</span>
</pre></div>
</div>
<p>To add this header to your message:</p>
<p>API: Pass the following parameter, &#8220;v:my-custom-data&#8221; =&gt; &#8220;{&#8220;my_message_id&#8221;: 123}&#8221;.</p>
<p>SMTP: Add the following header to your email, &#8220;X-Mailgun-Variables: {&#8220;my_message_id&#8221;: 123}&#8221;.</p>
<p>You can also use values from your recipient variables to provide a custom variable per a recipient using
templating. For example when sending via the API:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;v:Recipient-Id&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%r</span><span class="s1">ecipient.id%&#39;</span><span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The value of the &#8220;X-Mailgun-Variables&#8221; header should be valid JSON string,
otherwise Mailgun won&#8217;t be able to parse it.  If your X-Mailgun-Variables header exceeds
998 characters, you should use <a class="reference external" href="https://tools.ietf.org/html/rfc2822#page-11">folding</a> to
spread the variables over multiple lines.</p>
</div>
</div>
<div class="section" id="tagging">
<span id="id12"></span><h3>Tagging<a class="headerlink" href="#tagging" title="Permalink to this headline">¶</a></h3>
<p>Sometimes it&#8217;s helpful to categorize your outgoing email traffic based on some
criteria, perhaps separate signup emails from password recovery emails or from
user comments. Mailgun lets you tag each outgoing message with a custom value.
When you access stats on you messages, they will be aggregated by these tags.</p>
<p><strong>Tagging Code Samples</strong></p>
<p>Supply one or more <code class="docutils literal"><span class="pre">o:tag</span></code> parameters to tag the message.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages <span class="se">\</span>
    -F <span class="nv">from</span><span class="o">=</span><span class="s1">&#39;Sender Bob &lt;sbob@YOUR_DOMAIN_NAME&gt;&#39;</span> <span class="se">\</span>
    -F <span class="nv">to</span><span class="o">=</span><span class="s1">&#39;alice@example.com&#39;</span> <span class="se">\</span>
    -F <span class="nv">subject</span><span class="o">=</span><span class="s1">&#39;Hello&#39;</span> <span class="se">\</span>
    -F <span class="nv">text</span><span class="o">=</span><span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span> <span class="se">\</span>
    -F o:tag<span class="o">=</span><span class="s1">&#39;September newsletter&#39;</span> <span class="se">\</span>
    -F o:tag<span class="o">=</span><span class="s1">&#39;newsletters&#39;</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">SendTagged</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">Form</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Form</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;from&quot;</span><span class="o">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;alice@example.com&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;subject&quot;</span><span class="o">,</span> <span class="s">&quot;Hello&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;text&quot;</span><span class="o">,</span> <span class="s">&quot;Testing out some Mailgun awesomeness!&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;o:tag&quot;</span><span class="o">,</span> <span class="s">&quot;September newsletter&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;o:tag&quot;</span><span class="o">,</span> <span class="s">&quot;newsletters&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/messages&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s2">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">;</span>

<span class="c1"># Make the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">sendMessage</span><span class="p">(</span><span class="nv">$domain</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;from&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;to&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;Baz &lt;baz@example.com&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subject&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span>
    <span class="s1">&#39;text&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Testing some Mailgun awesomness!&#39;</span><span class="p">,</span>
    <span class="s1">&#39;o:tag&#39;</span>   <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Tag1&#39;</span><span class="p">,</span> <span class="s1">&#39;Tag2&#39;</span><span class="p">)</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_tagged_message</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
              <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;bar@example.com&quot;</span><span class="p">,</span>
              <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
              <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">,</span>
              <span class="s2">&quot;o:tag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;September newsletter&quot;</span><span class="p">,</span> <span class="s2">&quot;newsletters&quot;</span><span class="p">]})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">send_tagged_message</span>
  <span class="n">data</span> <span class="o">=</span> <span class="no">Multimap</span><span class="o">.</span><span class="n">new</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:from</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:to</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;bar@example.com&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:subject</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Hello&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:text</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Testing some Mailgun awesomness!&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="s2">&quot;o:tag&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;September newsletter&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="s2">&quot;o:tag&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;newsletters&quot;</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/YOUR_DOMAIN_NAME/messages&quot;</span><span class="p">,</span> <span class="n">data</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">SendTaggedMessageChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">SendTaggedMessage</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">SendTaggedMessage</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;{domain}/messages&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;from&quot;</span><span class="p">,</span> <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="s">&quot;bar@example.com&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;subject&quot;</span><span class="p">,</span> <span class="s">&quot;Hello&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">,</span> <span class="s">&quot;Testing some Mailgun awesomness!&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;o:tag&quot;</span><span class="p">,</span> <span class="s">&quot;September newsletter&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;o:tag&quot;</span><span class="p">,</span> <span class="s">&quot;newsletters&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">SendTaggedMessage</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="nx">m</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">NewMessage</span><span class="p">(</span>
    <span class="s">&quot;Excited User &lt;YOU@YOUR_DOMAIN_NAME&gt;&quot;</span><span class="p">,</span>
    <span class="s">&quot;Hello&quot;</span><span class="p">,</span>
    <span class="s">&quot;Testing some Mailgun awesomeness!&quot;</span><span class="p">,</span>
    <span class="s">&quot;bar@example.com&quot;</span><span class="p">,</span>
  <span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">AddTag</span><span class="p">(</span><span class="s">&quot;FooTag&quot;</span><span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">AddTag</span><span class="p">(</span><span class="s">&quot;BarTag&quot;</span><span class="p">)</span>
  <span class="nx">m</span><span class="p">.</span><span class="nx">AddTag</span><span class="p">(</span><span class="s">&quot;BlortTag&quot;</span><span class="p">)</span>
  <span class="nx">_</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">Send</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A single message may be marked with up to 3 tags.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Tags are case insensitive and should be ascii only. Maximum tag length is 128 characters.</p>
</div>
</div>
<div class="section" id="tracking-opens">
<span id="um-tracking-opens"></span><h3>Tracking Opens<a class="headerlink" href="#tracking-opens" title="Permalink to this headline">¶</a></h3>
<p>Mailgun can keep track of every time a recipient opens your messages. You can see when Opens happen in the Logs tab or see aggregate counters of opens in the Tracking tab of the Control Panel.  In addition, you can be notified through a webhook or get the data programmatically through the <a class="reference internal" href="api-events.html#api-events"><span class="std std-ref">Events API</span></a>.</p>
<p>You can enable Open tracking by clicking on the checkbox in the Tracking tab of your Control Panel or using the <code class="docutils literal"><span class="pre">o:tracking</span></code> or <code class="docutils literal"><span class="pre">o:tracking-opens</span></code> parameters when sending a message. You will also have to add the appropriate CNAME records to your DNS as specified in the &#8216;Domain&#8217; tab of your Control Panel.</p>
<p>Opens are tracked by including a transparent .png file, which will only work if there is
an HTML component to the email (i.e., text only emails will not track opens). You should
note that many email service providers disable images by default, so this data will only
show up if the recipient clicks on display images button in his/her email.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="http://www.returnpath.net/">Return Path</a> certification allows your images to be enabled by default at many ISPs.  Please contact us if you would like to get your IP Address certified.</p>
</div>
<p><strong>Opens Webhook</strong></p>
<p>You can specify a webhook URL in the &#8216;Webhooks&#8217; tab of your Control Panel. When a user opens
one of your emails, your URL will be called with the following parameters.</p>
<div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>event</td>
<td>Event name (&#8220;opened&#8221;).</td>
</tr>
<tr class="row-odd"><td>recipient</td>
<td>Recipient who opened.</td>
</tr>
<tr class="row-even"><td>domain</td>
<td>Domain that sent the original message.</td>
</tr>
<tr class="row-odd"><td>ip</td>
<td>IP address the event originated from.</td>
</tr>
<tr class="row-even"><td>country</td>
<td>Two-letter <a class="reference external" href="http://dev.maxmind.com/static/csv/codes/iso3166.csv">country code</a> (as specified by <a class="reference external" href="http://www.iso.org/iso/country_codes.htm">ISO3166</a>) the event came from or
&#8216;unknown&#8217; if it couldn&#8217;t be determined.</td>
</tr>
<tr class="row-odd"><td>region</td>
<td>Two-letter or two-digit <a class="reference external" href="http://dev.maxmind.com/static/csv/codes/maxmind/region.csv">region code</a> or &#8216;unknown&#8217; if it couldn&#8217;t be determined.</td>
</tr>
<tr class="row-even"><td>city</td>
<td>Name of the city the event came from or &#8216;unknown&#8217; if it couldn&#8217;t be determined.</td>
</tr>
<tr class="row-odd"><td>user-agent</td>
<td><a class="reference external" href="http://en.wikipedia.org/wiki/User_agent">User agent</a> string of the client triggered the event.</td>
</tr>
<tr class="row-even"><td>device-type</td>
<td>Device type the email was opened on. Can be &#8216;desktop&#8217;, &#8216;mobile&#8217;, &#8216;tablet&#8217;, &#8216;other&#8217;
or &#8216;unknown&#8217;.</td>
</tr>
<tr class="row-odd"><td>client-type</td>
<td>Type of software the email was opened in, e.g. &#8216;browser&#8217;, &#8216;mobile browser&#8217;,
&#8216;email client&#8217;.</td>
</tr>
<tr class="row-even"><td>client-name</td>
<td>Name of the client software, e.g. &#8216;Thunderbird&#8217;, &#8216;Chrome&#8217;, &#8216;Firefox&#8217;.</td>
</tr>
<tr class="row-odd"><td>client-os</td>
<td>OS family running the client software, e.g. &#8216;Linux&#8217;, &#8216;Windows&#8217;, &#8216;OSX&#8217;.</td>
</tr>
<tr class="row-even"><td>campaign-id</td>
<td>The id of campaign triggering the event.</td>
</tr>
<tr class="row-odd"><td>campaign-name</td>
<td>The name of campaign triggering the event.</td>
</tr>
<tr class="row-even"><td>tag</td>
<td>Message tag, if message was tagged. See <a class="reference internal" href="#tagging"><span class="std std-ref">Tagging</span></a></td>
</tr>
<tr class="row-odd"><td>mailing-list</td>
<td>The address of mailing list the original message was sent to.</td>
</tr>
<tr class="row-even"><td>&#8220;custom variables&#8221;</td>
<td>Your own custom JSON object included in the header (see <a class="reference internal" href="#manual-customdata"><span class="std std-ref">Attaching Data to Messages</span></a>).</td>
</tr>
<tr class="row-odd"><td>timestamp</td>
<td>Number of seconds passed since January 1, 1970 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-even"><td>token</td>
<td>Randomly generated string with length 50 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-odd"><td>signature</td>
<td>String with hexadecimal digits generate by HMAC algorithm (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="tracking-clicks">
<span id="um-tracking-clicks"></span><h3>Tracking Clicks<a class="headerlink" href="#tracking-clicks" title="Permalink to this headline">¶</a></h3>
<p>Mailgun can keep track of every time a recipient clicks on links in your messages. You can see when clicks happen in the Logs tab or see aggregate counters of clicks in the Tracking tab of the Control Panel.  In addition, you can be notified through a webhook or get the data programmatically through the <a class="reference internal" href="api-events.html#api-events"><span class="std std-ref">Events API</span></a>.</p>
<p>You can enable click tracking by clicking on the checkbox in the Tracking tab of your Control Panel or using the <code class="docutils literal"><span class="pre">o:tracking</span></code> or <code class="docutils literal"><span class="pre">o:tracking-clicks</span></code> parameters when sending a message. You will also have to add the appropriate CNAME records to your DNS as specified in the Domains tab of your Control Panel. If you enable Click tracking, links will be overwritten and pointed to our servers so we can track clicks. You can specify that you only want links rewritten in the HTML part of a message with the parameter <code class="docutils literal"><span class="pre">o:tracking-clicks</span></code> and passing <code class="docutils literal"><span class="pre">htmlonly</span></code>.</p>
<p><strong>Clicks Webhook</strong></p>
<p>You can specify a webhook URL in the &#8216;Webhooks&#8217; tab of your Control Panel. Every time
a user clicks on a link inside of your messages, your URL will be called with
the following parameters:</p>
<div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>event</td>
<td>Event name (&#8220;clicked&#8221;).</td>
</tr>
<tr class="row-odd"><td>recipient</td>
<td>Recipient who clicked.</td>
</tr>
<tr class="row-even"><td>domain</td>
<td>Domain that sent the original message.</td>
</tr>
<tr class="row-odd"><td>ip</td>
<td>IP address the event originated from.</td>
</tr>
<tr class="row-even"><td>country</td>
<td>Two-letter <a class="reference external" href="http://dev.maxmind.com/static/csv/codes/iso3166.csv">country code</a> (as specified by <a class="reference external" href="http://www.iso.org/iso/country_codes.htm">ISO3166</a>) the event came from or
&#8216;unknown&#8217; if it couldn&#8217;t be determined.</td>
</tr>
<tr class="row-odd"><td>region</td>
<td>Two-letter or two-digit <a class="reference external" href="http://dev.maxmind.com/static/csv/codes/maxmind/region.csv">region code</a> or &#8216;unknown&#8217; if it couldn&#8217;t be determined.</td>
</tr>
<tr class="row-even"><td>city</td>
<td>Name of the city the event came from or &#8216;unknown&#8217; if it couldn&#8217;t be determined.</td>
</tr>
<tr class="row-odd"><td>user-agent</td>
<td><a class="reference external" href="http://en.wikipedia.org/wiki/User_agent">User agent</a> string of the client triggered the event.</td>
</tr>
<tr class="row-even"><td>device-type</td>
<td>Device type the link was clicked on. Can be &#8216;desktop&#8217;, &#8216;mobile&#8217;, &#8216;tablet&#8217;, &#8216;other&#8217;
or &#8216;unknown&#8217;.</td>
</tr>
<tr class="row-odd"><td>client-type</td>
<td>Type of software the link was opened in, e.g. &#8216;browser&#8217;, &#8216;mobile browser&#8217;,
&#8216;email client&#8217;.</td>
</tr>
<tr class="row-even"><td>client-name</td>
<td>Name of the client software, e.g. &#8216;Thunderbird&#8217;, &#8216;Chrome&#8217;, &#8216;Firefox&#8217;.</td>
</tr>
<tr class="row-odd"><td>client-os</td>
<td>OS family running the client software, e.g. &#8216;Linux&#8217;, &#8216;Windows&#8217;, &#8216;OSX&#8217;.</td>
</tr>
<tr class="row-even"><td>campaign-id</td>
<td>The id of campaign triggering the event.</td>
</tr>
<tr class="row-odd"><td>campaign-name</td>
<td>The name of campaign triggering the event.</td>
</tr>
<tr class="row-even"><td>tag</td>
<td>Message tag, if it was tagged. See <a class="reference internal" href="#tagging"><span class="std std-ref">Tagging</span></a>.</td>
</tr>
<tr class="row-odd"><td>url</td>
<td>The URL that was clicked.</td>
</tr>
<tr class="row-even"><td>mailing-list</td>
<td>The address of mailing list the original message was sent to.</td>
</tr>
<tr class="row-odd"><td>&#8220;custom variables&#8221;</td>
<td>Your own custom JSON object included in the header (see <a class="reference internal" href="#manual-customdata"><span class="std std-ref">Attaching Data to Messages</span></a>).</td>
</tr>
<tr class="row-even"><td>timestamp</td>
<td>Number of seconds passed since January 1, 1970 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-odd"><td>token</td>
<td>Randomly generated string with length 50 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-even"><td>signature</td>
<td>String with hexadecimal digits generate by HMAC algorithm (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="tracking-unsubscribes">
<span id="um-tracking-unsubscribes"></span><h3>Tracking Unsubscribes<a class="headerlink" href="#tracking-unsubscribes" title="Permalink to this headline">¶</a></h3>
<p>Mailgun can keep track of every time a recipient requests to be unsubscribed from
your mailings.  If you enable unsubscribe tracking, Mailgun will insert unsubscribe links and remove those recipients
from your mailings automatically for you.</p>
<p>You can see when usubscribes happen in the Logs tab or see aggregate counters of unsubscribes in the Tracking tab of the Control Panel.  In addition, you can be notified through a webhook or get the data programmatically through the <a class="reference internal" href="api-events.html#api-events"><span class="std std-ref">Events API</span></a> or the <a class="reference internal" href="api-suppressions.html#api-bounces"><span class="std std-ref">Bounces API</span></a>.</p>
<p>Mailgun supports three types of unsubscribes: domain, <a class="reference internal" href="#tagging"><span class="std std-ref">tag</span></a> or <a class="reference internal" href="#mailing-lists"><span class="std std-ref">Mailing Lists</span></a> levels.</p>
<ul class="simple">
<li>Domain level: Once recipient selects to unsubscribe from domain, he will not receive any more messages from this sending domain.</li>
<li>Tag level: Sometimes you need to separate traffic by types, for example provide newsletter mailings, security updates mailings and so on.
Recipients may want to unsubscribe from your newsletters but still receive security updates.
For this purpose you can use tags: mark your messages by setting approriate <code class="docutils literal"><span class="pre">X-Mailgun-Tag</span></code> header and use
special <code class="docutils literal"><span class="pre">%tag_unsubscribe_url%</span></code> variable (see below).</li>
<li>Mailing Lists level: If a recipient unsubscribes from a Mailing List, they will still be a member of the Mailing List but will be flagged as unsubscribed and Mailgun will no longer send messages from that Mailing List to the unsubscribed recipient.</li>
</ul>
<p><strong>Auto-Handling</strong></p>
<p>You can enable Mailgun&#8217;s Unsubscribe functionality by turning it on in the settings area for your
domain. We will automatically prevent future emails being sent to recipients that have unsubscribed.
You can edit the unsubscribed address list from your Control Panel or through the API.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Before enabling, you will need to configure the required DNS entries provided in your Control Panel.</p>
</div>
<p>Mailgun provides you with several unsubscribe variables:</p>
<div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>%unsubscribe_url%</td>
<td>link to unsubscribe recipient from all messages sent by given domain</td>
</tr>
<tr class="row-odd"><td>%tag_unsubscribe_url%</td>
<td>link to unsubscribe from all tags provided in the message</td>
</tr>
<tr class="row-even"><td>%mailing_list_unsubscribe_url%</td>
<td>link to unsubscribe from future messages sent to a mailing list</td>
</tr>
</tbody>
</table>
</div>
<p>If you include these variables in your emails, any recipient that clicks on the
url will be automatically unsubscribed and those email addresses will be blocked
from receiving future emails from that domain or message tag as appropriate.</p>
<p>Mailgun can automatically provide an unsubscribe footer in each email you send. You can customize
your unsubscribe footer by editing the settings in the control panel.</p>
<p>To enable/disable unsubscribes programmaticaly per message you can do the following:</p>
<ul class="simple">
<li>Enable unsubscription feature for your domain.</li>
<li>Remove text in the html and text footer templates so they won&#8217;t be appended automatically.</li>
<li>Insert a variable in the html and text bodies of your email when you need unsubscribe links.</li>
<li>This variable will be replaced by the corresponding unsubscribe link.</li>
</ul>
<p>In the &#8220;Suppressions&#8221; tab of the Control Panel or through the API you can also:</p>
<ul class="simple">
<li>View/get a list of unsubscribed addresses.</li>
<li>Remove an unsubscribed address from the list.</li>
<li>Add a new unsubscribed address.</li>
</ul>
<p>Take a look at <a class="reference internal" href="api-suppressions.html#api-unsubscribes"><span class="std std-ref">Unsubscribes section</span></a> of the API reference
to learn how to programmatically manage lists of unsubscribed users.</p>
<p><strong>Unsubscribes Webhook</strong></p>
<p>You can specify a webhook URL in the &#8216;Webhooks&#8217; tab of your Control Panel.
When a user unsubscribes, Mailgun will invoke the webhook with the following parameters:</p>
<div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>event</td>
<td>Event name (&#8220;unsubscribed&#8221;).</td>
</tr>
<tr class="row-odd"><td>recipient</td>
<td>Recipient who unsubscribed.</td>
</tr>
<tr class="row-even"><td>domain</td>
<td>Domain that sent the original message.</td>
</tr>
<tr class="row-odd"><td>ip</td>
<td>IP address the event originated from.</td>
</tr>
<tr class="row-even"><td>country</td>
<td>Two-letter <a class="reference external" href="http://dev.maxmind.com/static/csv/codes/iso3166.csv">country code</a> (as specified by <a class="reference external" href="http://www.iso.org/iso/country_codes.htm">ISO3166</a>) the event came from or
&#8216;unknown&#8217; if it couldn&#8217;t be determined.</td>
</tr>
<tr class="row-odd"><td>region</td>
<td>Two-letter or two-digit <a class="reference external" href="http://dev.maxmind.com/static/csv/codes/maxmind/region.csv">region code</a> or &#8216;unknown&#8217; if it couldn&#8217;t be determined.</td>
</tr>
<tr class="row-even"><td>city</td>
<td>Name of the city the event came from or &#8216;unknown&#8217; if it couldn&#8217;t be determined.</td>
</tr>
<tr class="row-odd"><td>user-agent</td>
<td><a class="reference external" href="http://en.wikipedia.org/wiki/User_agent">User agent</a> string of the client triggered the event.</td>
</tr>
<tr class="row-even"><td>device-type</td>
<td>Device type the person unsubscribed on. Can be &#8216;desktop&#8217;, &#8216;mobile&#8217;, &#8216;tablet&#8217;, &#8216;other&#8217;
or &#8216;unknown&#8217;.</td>
</tr>
<tr class="row-odd"><td>client-type</td>
<td>Type of software the unsubscribe link was clicked in, e.g. &#8216;browser&#8217;, &#8216;mobile browser&#8217;,
&#8216;email client&#8217;.</td>
</tr>
<tr class="row-even"><td>client-name</td>
<td>Name of the client software, e.g. &#8216;Thunderbird&#8217;, &#8216;Chrome&#8217;, &#8216;Firefox&#8217;.</td>
</tr>
<tr class="row-odd"><td>client-os</td>
<td>OS family running the client software, e.g. &#8216;Linux&#8217;, &#8216;Windows&#8217;, &#8216;OSX&#8217;.</td>
</tr>
<tr class="row-even"><td>campaign-id</td>
<td>The id of the campaign that recipient has unsubscribed from.</td>
</tr>
<tr class="row-odd"><td>campaign-name</td>
<td>The name of campaign triggering the event.</td>
</tr>
<tr class="row-even"><td>tag</td>
<td>Message tag, if it was tagged. See <a class="reference internal" href="#tagging"><span class="std std-ref">Tagging</span></a>.</td>
</tr>
<tr class="row-odd"><td>mailing-list</td>
<td>The address of mailing list the original message was sent to.</td>
</tr>
<tr class="row-even"><td>&#8220;custom variables&#8221;</td>
<td>Your own custom JSON object included in the header (see <a class="reference internal" href="#manual-customdata"><span class="std std-ref">Attaching Data to Messages</span></a>).</td>
</tr>
<tr class="row-odd"><td>timestamp</td>
<td>Number of seconds passed since January 1, 1970 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-even"><td>token</td>
<td>Randomly generated string with length 50 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-odd"><td>signature</td>
<td>String with hexadecimal digits generate by HMAC algorithm (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="tracking-spam-complaints">
<span id="um-tracking-spam-complaints"></span><h3>Tracking Spam Complaints<a class="headerlink" href="#tracking-spam-complaints" title="Permalink to this headline">¶</a></h3>
<p>Mailgun automatically keeps track of every time a recipient complains that a
message is spam.</p>
<p>You can see when complaints happen in the Logs tab or see aggregate counters of complaints in the Tracking tab of the Control Panel.  In addition, you can be notified through a webhook or get the data programmatically through the <a class="reference internal" href="api-events.html#api-events"><span class="std std-ref">Events API</span></a> or the <a class="reference internal" href="api-suppressions.html#api-complaints"><span class="std std-ref">Complaints API</span></a>.</p>
<p>Email service providers (&#8220;ESPs&#8221;) are very sensitive to users clicking on spam
complaint buttons and it&#8217;s important to monitor that activity to maintain a
good sending reputation. While, not every ESP supports Feedback Loop (&#8220;FBL&#8221;)
notifications, we make sure that you get data on all of the ones that do.
We will remove recipients from future messages if a complaint has been filed
by that recipient. This is necessary to maintain your reputation and not have
your emails automatically sent to spam folders.</p>
<p>Spam Complaint tracking is always enabled.</p>
<p>Mailgun provides <a class="reference internal" href="api-suppressions.html#api-complaints"><span class="std std-ref">Spam complaints API</span></a> to programmatically
manage the lists of users who have complained.</p>
<p><strong>Spam Complaints Webhook</strong></p>
<p>You can specify a webhook URL in the &#8216;Webhooks&#8217; tab in the control panel.
When a user reports one of your emails as spam, Mailgun will invoke the
webhook with the following parameters:</p>
<div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>event</td>
<td>Event name (&#8220;complained&#8221;).</td>
</tr>
<tr class="row-odd"><td>recipient</td>
<td>Recipient who clicked spam.</td>
</tr>
<tr class="row-even"><td>domain</td>
<td>Domain that sent the original message.</td>
</tr>
<tr class="row-odd"><td>message-headers</td>
<td>String list of all MIME headers of the original message dumped to a JSON string (order of headers preserved).</td>
</tr>
<tr class="row-even"><td>campaign-id</td>
<td>The id of campaign triggering the event.</td>
</tr>
<tr class="row-odd"><td>campaign-name</td>
<td>The name of campaign triggering the event.</td>
</tr>
<tr class="row-even"><td>tag</td>
<td>Message tag, if it was tagged. See <a class="reference internal" href="#tagging"><span class="std std-ref">Tagging</span></a>.</td>
</tr>
<tr class="row-odd"><td>mailing-list</td>
<td>The address of mailing list the original message was sent to.</td>
</tr>
<tr class="row-even"><td>&#8220;custom variables&#8221;</td>
<td>Your own custom JSON object included in the header (see <a class="reference internal" href="#manual-customdata"><span class="std std-ref">Attaching Data to Messages</span></a>).</td>
</tr>
<tr class="row-odd"><td>timestamp</td>
<td>Number of seconds passed since January 1, 1970 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-even"><td>token</td>
<td>Randomly generated string with length 50 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-odd"><td>signature</td>
<td>String with hexadecimal digits generate by HMAC algorithm (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-even"><td>attachment-x</td>
<td>attached file (‘x’ stands for number of the attachment). Attachments are
included if the recipient ESP includes them in the bounce message. They are
handled as file uploads, encoded as multipart/form-data.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="tracking-bounces">
<span id="um-tracking-bounces"></span><h3>Tracking Bounces<a class="headerlink" href="#tracking-bounces" title="Permalink to this headline">¶</a></h3>
<p>An email message is said to &#8220;bounce&#8221; if it is rejected by the recipient SMTP
server.</p>
<p>With respect to failure persistence Mailgun classifies bounces into the
following two groups:</p>
<ul class="simple">
<li>Hard bounces (permanent failure): Recipient is not found and the recipient
email server specifies the recipient does not exist. Mailgun stops attempting
delivery to invalid recipients after one Hard Bounce. These addresses are
added to the table in the Bounces tab and Mailgun will not attempt delivery
in the future.</li>
<li>Soft bounces (temporary failure): Email is not delivered because the mailbox
is full or for other reasons. These addresses are not added to the table in
the Bounces tab.</li>
</ul>
<p>With respect to when the recipient SMTP server rejected an incoming message
Mailgun classifies bounces into the following two groups:</p>
<ul class="simple">
<li>Immediate bounce: An email message is rejected by the recipient SMTP server
during the SMTP session.</li>
<li>Delayed (asynchronous) bounce: The recipient SMTP server accepts an email
message during the SMTP session. After some time it will then send a
Non-Delivery Report email message to the message sender.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the case of a bounce Mailgun will retry to deliver the message
only if the bounce was both Immediate and Soft. After several unsuccessful
attempts Mailgun will quit retrying in order to maintain your sending
reputation.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Mailgun can track delayed bounces but only if the domain, that the
email message was sent from, has MX records pointing to Mailgun. Otherwise NDR
email messages won&#8217;t reach Mailgun. Please refer to
<span class="xref std std-ref">Verifying Your Domain</span> for details on how to do that.</p>
</div>
<p>You can see when bounces happen in the Logs tab or see aggregate counters of
bounces in the Tracking tab of the Control Panel. In addition, you can be
notified through a webhook or get the data programmatically through the
<a class="reference internal" href="api-events.html#api-events"><span class="std std-ref">Events API</span></a> or the <a class="reference internal" href="api-suppressions.html#api-bounces"><span class="std std-ref">Bounces API</span></a>.</p>
<p>Mailgun provides <a class="reference internal" href="api-suppressions.html#api-bounces"><span class="std std-ref">Bounces API</span></a> to programmatically
manage the lists of hard bounces.</p>
<p><strong>Bounce Event Webhook</strong></p>
<p>You can specify a webhook URL in the &#8216;Webhooks&#8217; tab of your Control Panel.
If you do, every time a message experiences a hard bounce, your URL will be invoked with the following parameters:</p>
<div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>event</td>
<td>Event name (&#8220;bounced&#8221;).</td>
</tr>
<tr class="row-odd"><td>recipient</td>
<td>Recipient who could not be reached.</td>
</tr>
<tr class="row-even"><td>domain</td>
<td>Domain that sent the original message.</td>
</tr>
<tr class="row-odd"><td>message-headers</td>
<td>String list of all MIME headers of the original message dumped to a JSON string (order of headers preserved).</td>
</tr>
<tr class="row-even"><td>code</td>
<td>SMTP bounce error code in form (X.X.X).</td>
</tr>
<tr class="row-odd"><td>error</td>
<td>SMTP bounce error string.</td>
</tr>
<tr class="row-even"><td>notification</td>
<td>Detailed reason for bouncing (optional).</td>
</tr>
<tr class="row-odd"><td>campaign-id</td>
<td>The id of campaign triggering the event.</td>
</tr>
<tr class="row-even"><td>campaign-name</td>
<td>The name of campaign triggering the event.</td>
</tr>
<tr class="row-odd"><td>tag</td>
<td>Message tag, if it was tagged. See <a class="reference internal" href="#tagging"><span class="std std-ref">Tagging</span></a>.</td>
</tr>
<tr class="row-even"><td>mailing-list</td>
<td>The address of mailing list the original message was sent to.</td>
</tr>
<tr class="row-odd"><td>&#8220;custom variables&#8221;</td>
<td>Your own custom JSON object included in the header (see <a class="reference internal" href="#manual-customdata"><span class="std std-ref">Attaching Data to Messages</span></a>).</td>
</tr>
<tr class="row-even"><td>timestamp</td>
<td>Number of seconds passed since January 1, 1970 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-odd"><td>token</td>
<td>Randomly generated string with length 50 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-even"><td>signature</td>
<td>String with hexadecimal digits generate by HMAC algorithm
(see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-odd"><td>attachment-x</td>
<td>attached file (‘x’ stands for number of the attachment). Attachments are
included if the recipient ESP includes them in the bounce message. They are
handled as file uploads, encoded as multipart/form-data.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="tracking-failures">
<span id="um-tracking-failures"></span><h3>Tracking Failures<a class="headerlink" href="#tracking-failures" title="Permalink to this headline">¶</a></h3>
<p>Mailgun tracks all delivery failures. Failures consist of both Hard Bounces (permanent failures) and Soft Bounces (temporary failures).</p>
<p>You can see when failures happen in the Logs tab.  In addition, you can be notified through a webhook when a message is dropped (i.e., stop retries) or get the data programmatically through the <a class="reference internal" href="api-events.html#api-events"><span class="std std-ref">Events API</span></a>.</p>
<p><strong>Drop Event Webhook</strong></p>
<p>In the Webhooks tab, you can specify a URL to be notified every time a message is dropped.
There are a few reasons why Mailgun needs to stop attempting to deliver messages and drop them.
The most common reason is that Mailgun received a Hard bounce or repeatedly received Soft bounces and continuing attempting to deliver may hurt your reputation with the receiving ESP.  Also, if the address is on one of the &#8216;do not send lists&#8217; because that recipient
had previously bounced, unsubscribed, or complained of spam, we will not attempt delivery and drop the message.  If one of
these events occur we will POST the following parameters to your URL:</p>
<div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>event</td>
<td>Event name (&#8220;dropped&#8221;).</td>
</tr>
<tr class="row-odd"><td>recipient</td>
<td>Intended recipient.</td>
</tr>
<tr class="row-even"><td>domain</td>
<td>Domain that sent the original message.</td>
</tr>
<tr class="row-odd"><td>message-headers</td>
<td>String list of all MIME headers of the original message dumped to a JSON string (order of headers preserved).</td>
</tr>
<tr class="row-even"><td>reason</td>
<td>Reason for failure. Can be one either &#8220;hardfail&#8221; or &#8220;old&#8221;. See below.</td>
</tr>
<tr class="row-odd"><td>code</td>
<td>ESP response code, e.g. if the message was blocked as a spam (optional).</td>
</tr>
<tr class="row-even"><td>description</td>
<td>Detailed explanation of why the messages was dropped</td>
</tr>
<tr class="row-odd"><td>&#8220;custom variables&#8221;</td>
<td>Your own custom JSON object included in the header (see <a class="reference internal" href="#manual-customdata"><span class="std std-ref">Attaching Data to Messages</span></a>).</td>
</tr>
<tr class="row-even"><td>timestamp</td>
<td>Number of seconds passed since January 1, 1970 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-odd"><td>token</td>
<td>Randomly generated string with length 50 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-even"><td>signature</td>
<td>String with hexadecimal digits generate by HMAC algorithm (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-odd"><td>attachment-x</td>
<td>attached file (‘x’ stands for number of the attachment). Attachments are
included if the recipient ESP includes them in the bounce message. They are
handled as file uploads, encoded as multipart/form-data.</td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">old</span></code> indicates that Mailgun tried to deliver the message unsuccessfully for more than 8 hours.</li>
<li><code class="docutils literal"><span class="pre">hardfail</span></code> not delivering to an address that previously bounced, unsubscribed, or complained.</li>
</ul>
</div>
<div class="section" id="tracking-deliveries">
<span id="um-tracking-deliveries"></span><h3>Tracking Deliveries<a class="headerlink" href="#tracking-deliveries" title="Permalink to this headline">¶</a></h3>
<p>Mailgun tracks all successful deliveries of messages. A successful delivery occurs when the recipient email server responds that it has accepted the message.</p>
<p>You can see when deliveries happen in the Logs tab.  In addition, you can be notified through a webhook when a message is delivered or get the data programmatically through the <a class="reference internal" href="api-events.html#api-events"><span class="std std-ref">Events API</span></a>.</p>
<p><strong>Delivered Event Webhook</strong></p>
<p>In the Webhooks tab, you can specify a URL to be notified every time a
message is delivered. If the message is successfully delivered to the intended
recipient, we will POST the following parameters to your URL:</p>
<div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>event</td>
<td>Event name (&#8220;delivered&#8221;).</td>
</tr>
<tr class="row-odd"><td>recipient</td>
<td>Intended recipient.</td>
</tr>
<tr class="row-even"><td>domain</td>
<td>Domain that sent the original message.</td>
</tr>
<tr class="row-odd"><td>message-headers</td>
<td>String list of all MIME headers dumped to a JSON string (order of headers preserved).</td>
</tr>
<tr class="row-even"><td>Message-Id</td>
<td>String id of the original message delivered to the recipient.</td>
</tr>
<tr class="row-odd"><td>&#8220;custom variables&#8221;</td>
<td>Your own custom JSON object included in the header of the original message (see <a class="reference internal" href="#manual-customdata"><span class="std std-ref">Attaching Data to Messages</span></a>).</td>
</tr>
<tr class="row-even"><td>timestamp</td>
<td>Number of seconds passed since January 1, 1970 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-odd"><td>token</td>
<td>Randomly generated string with length 50 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-even"><td>signature</td>
<td>String with hexadecimal digits generate by HMAC algorithm (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Unlike other event webhooks (due to frequency of delivered events), Delivered Event will only POST once, right after delivery, and won’t attempt again in case of failure to POST successfully.</p>
</div>
</div>
<div class="section" id="stats">
<h3>Stats<a class="headerlink" href="#stats" title="Permalink to this headline">¶</a></h3>
<p>Stats provide you with the summary of the events that occur with your messages and can be aggregated by tag, see <a class="reference internal" href="#tagging">Tagging</a> above.</p>
<p>You can see your current statistics in the control panel, or download them using <a class="reference internal" href="api-stats.html#api-stats"><span class="std std-ref">the API</span></a></p>
</div>
</div>
<div class="section" id="receiving-forwarding-and-storing-messages">
<h2>Receiving, Forwarding and Storing Messages<a class="headerlink" href="#receiving-forwarding-and-storing-messages" title="Permalink to this headline">¶</a></h2>
<p>Mailgun allows you to receive emails through Routes. Routes will accept emails and then perform an action which can include:</p>
<ul class="simple">
<li>Forwarding the email to a different email address.</li>
<li>POSTing the data in the email to a URL.</li>
<li>Storing the email temporarily for subsequent retrieval through a GET request.</li>
</ul>
<div class="section" id="routes">
<span id="um-routes"></span><h3>Routes<a class="headerlink" href="#routes" title="Permalink to this headline">¶</a></h3>
<p>You can define a list of routes to handle incoming emails. This idea of routes is
borrowed from MVC web frameworks like Django or Ruby on Rails: if a message matches
a route expression, Mailgun can forward it to your application via HTTP or
to another email address or store the message temporarily (3 days) for subsequent retrieval.</p>
<p>You can define routes visually in the Control Panel, or programmatically using
<a class="reference internal" href="api-routes.html#api-routes"><span class="std std-ref">the Routes API.</span></a></p>
<p>A Route is a pair of filter+action. Each incoming message is passed to a filter
expression, and if it evaluates to true, the action is executed.</p>
<p>Each Route can be assigned a priority. Routes are evaluated in the order of priority, with lower numbers having a higher priority. The default is for all Routes to be evaluated (even if a higher priority Route is triggered). To avoid this you can use a <code class="docutils literal"><span class="pre">stop()</span></code> action (see below).</p>
<p>Here&#8217;s a more formal list of route properties:</p>
<div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Priority</td>
<td>Integer indicating the priority of route execution. Lower numbers have higher priority.</td>
</tr>
<tr class="row-odd"><td>Filter</td>
<td>Filters available in routes - <code class="docutils literal"><span class="pre">match_recipient()</span> <span class="pre">match_header()</span> <span class="pre">catchall()</span></code> (see below for description).</td>
</tr>
<tr class="row-even"><td>Actions</td>
<td>Type of action to take when a filter is triggered - <code class="docutils literal"><span class="pre">forward()</span> <span class="pre">store()</span> <span class="pre">stop()</span></code> (see below for description).</td>
</tr>
<tr class="row-odd"><td>Description</td>
<td>Arbitrary string to describe the route (shown in the Control Panel UI)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="route-filters">
<h4>Route Filters<a class="headerlink" href="#route-filters" title="Permalink to this headline">¶</a></h4>
<p>Route filters are expressions that determine when an action is triggered. You can create a filter based on the recipient of the incoming email, the headers in the incoming email or use a catch-all filter. Filters support regular expressions in the pattern to give you a lot of flexibility when creating them.</p>
<p><strong>match_recipient(pattern)</strong></p>
<p>Matches the SMTP recipient of the incoming message against the regular expression pattern.
For example this filter will match messages going to <a class="reference external" href="mailto:foo&#37;&#52;&#48;bar&#46;com">foo<span>&#64;</span>bar<span>&#46;</span>com</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">match_recipient</span><span class="p">(</span><span class="s2">&quot;foo@bar.com&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use Python-style regular expression in your filter.
For example, this will match all messages coming to any recipient at &#64;bar.com:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">match_recipient</span><span class="p">(</span><span class="s2">&quot;.*@bar.com&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Another example, handling plus addressing for a specific recipient:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">match_recipient</span><span class="p">(</span><span class="s2">&quot;^chris\+(.*)@example.com$&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Mailgun supports regexp captures in filters. This allows you to use captured values
inside of your actions. The example below captures the local name (the part of email before &#64;)
and passes it as a <code class="docutils literal"><span class="pre">mailbox</span></code> parameter to an application URL:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">route</span> <span class="nb">filter</span> <span class="p">:</span> <span class="n">match_recipient</span><span class="p">(</span><span class="s2">&quot;(.*)@bar.com&quot;</span><span class="p">)</span>
<span class="n">route</span> <span class="n">action</span> <span class="p">:</span> <span class="n">forward</span><span class="p">(</span><span class="s2">&quot;http://myhost.com/post/?mailbox=</span><span class="se">\1</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use named captures as well:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">route</span> <span class="nb">filter</span> <span class="p">:</span> <span class="n">match_recipient</span><span class="p">(</span><span class="s2">&quot;(?P&lt;user&gt;.*?)@(?P&lt;domain&gt;.*)&quot;</span><span class="p">)</span>
<span class="n">route</span> <span class="n">action</span> <span class="p">:</span> <span class="n">forward</span><span class="p">(</span><span class="s2">&quot;http://mycallback.com/domains/\g&lt;domain&gt;/users/\g&lt;user&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>match_header(header, pattern)</strong></p>
<p>Similar to <code class="docutils literal"><span class="pre">match_recipient</span></code> but instead of looking at a message recipient, it applies
the pattern to an arbitrary MIME header of the message.</p>
<p>The example below matches any message with a word &#8220;support&#8221; in its subject:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">match_header</span><span class="p">(</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="s2">&quot;.*support&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The example below matches any message against several keywords:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">match_header</span><span class="p">(</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="s1">&#39;(.*)(urgent|help|asap)(.*)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The example below will match any messages deemed spam (if spam filtering is enabled):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">match_header</span><span class="p">(</span><span class="s1">&#39;X-Mailgun-Sflag&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>match_recipient(pattern) AND match_header(header, pattern)</strong></p>
<p>The example below will match any recipient for a domain, then match if the message is in English:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">match_recipient</span><span class="p">(</span><span class="s1">&#39;^(.*)@example.com$&#39;</span><span class="p">)</span> <span class="ow">and</span>
<span class="n">match_header</span><span class="p">(</span><span class="s2">&quot;Content-Language&quot;</span><span class="p">,</span> <span class="s2">&quot;^(.*)en-US(.*)$&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>catch_all()</strong></p>
<p>Matches if no preceeding routes matched. Usually you need to use it in a route
with a lowest priority, to make sure it evaluates last.</p>
</div>
<div class="section" id="route-actions">
<h4>Route Actions<a class="headerlink" href="#route-actions" title="Permalink to this headline">¶</a></h4>
<p>If a route expression evaluates to true, Mailgun executes the corresponding action.
Currently you can use the following three actions in your routes: <code class="docutils literal"><span class="pre">forward()</span></code>, <code class="docutils literal"><span class="pre">store()</span></code> and <code class="docutils literal"><span class="pre">stop()</span></code>.</p>
<p><strong>forward(destination)</strong></p>
<p>Forwards the message to a specified destination, which can be another email address or a URL.
A few examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">forward</span><span class="p">(</span><span class="s2">&quot;mailbox@myapp.com&quot;</span><span class="p">)</span>
<span class="n">forward</span><span class="p">(</span><span class="s2">&quot;http://myapp.com/messages&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can combine multiple destinations separating them by a comma:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">forward</span><span class="p">(</span><span class="s2">&quot;http://myapp.com/messages, mailbox@myapp.com&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you forward messages to another email address, then you should disable click tracking, open tracking and unsubscribes, by editing your domain settings in the Control Panel. If these features are enabled, the content of each message is modified by Mailgun before forwarding, which invalidates the DKIM signature. If the message comes from a domain publishing a DMARC policy (like Yahoo! Mail), the message will be rejected as spam by the forwarding destination.</p>
</div>
<p><strong>store(notification endpoint)</strong></p>
<p>Stores the message temporarily (for up to 3 days) on Mailgun&#8217;s servers so that you can retrieve it later.  This is helpful for large attachments that may cause time-outs or if you just want to retrieve them later to reduce the frequency of hits on your server.</p>
<p>You can specify a URL and we will notify you when the email arrives along with a URL where you can use to retrieve the message:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">store</span><span class="p">(</span><span class="n">notify</span><span class="o">=</span><span class="s2">&quot;http://mydomain.com/callback&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you don&#8217;t specify a URL with the notify parameter, the message will still be stored and you can get the message later through the <a class="reference internal" href="api-sending.html#api-sending-messages"><span class="std std-ref">Messages API</span></a>. You can see a full list of parameters we will post/return to you below.</p>
<p><strong>stop()</strong></p>
<p>Simply stops the priority waterfall so the subsequent routes will not be evaluated. Without a stop() action executed, all lower priority Routes will also be evaluated.</p>
</div>
<div class="section" id="receiving-messages-via-http-through-a-forward-action">
<h4>Receiving Messages via HTTP through a forward() action<a class="headerlink" href="#receiving-messages-via-http-through-a-forward-action" title="Permalink to this headline">¶</a></h4>
<p>When you specify a URL of your application as a route destination through a forward() action, Mailgun will perform an
HTTP POST request into it using one of two following formats:</p>
<ul class="simple">
<li>Fully parsed: Mailgun will parse the message, transcode it into UTF-8 encoding, process attachments,
and attempt to separate quoted parts from the actual message. This is the preferred option.</li>
<li>Raw MIME: message is posted as-is. In this case you are responsible for parsing MIME.
To receive raw MIME messages, the destination URL must end with <code class="docutils literal"><span class="pre">mime</span></code>.</li>
</ul>
<p>For Route POSTs, Mailgun listens for the following codes from your server and reacts accordingly:</p>
<ul class="simple">
<li>If Mailgun receives a <code class="docutils literal"><span class="pre">200</span> <span class="pre">(Success)</span></code> code it will determine the webhook POST is successful and not retry.</li>
<li>If Mailgun receives a <code class="docutils literal"><span class="pre">406</span> <span class="pre">(Not</span> <span class="pre">Acceptable)</span></code> code, Mailgun will determine the POST is rejected and not retry.</li>
<li>For any other code, Mailgun will retry POSTing according to the schedule below for Webhooks other than the delivery notification.</li>
</ul>
<p>If your application is unable to process the webhook request but you do not return a 406 error code, Mailgun will
retry (other than for delivery notification) during 8 hours at the following intervals before stop trying:
10 minutes, 10 minutes, 15 minutes, 30 minutes, 1 hour, 2 hour and 4 hours.</p>
<p>Below are two tables of HTTP parameters that you can expect to be posted into your application through a forward() action.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In addition to these parameters Mailgun will post <cite>all</cite> MIME headers.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Do not rely on the <code class="docutils literal"><span class="pre">body-plain</span></code>, <code class="docutils literal"><span class="pre">stripped-text</span></code>, and <code class="docutils literal"><span class="pre">stripped-signature</span></code> fields for HTML sanitization. These fields
merely provide content from the text/plain portion of an incoming message. This content may contain unescaped HTML.</p>
</div>
</div>
<div class="section" id="parsed-messages-parameters">
<h4>Parsed Messages Parameters<a class="headerlink" href="#parsed-messages-parameters" title="Permalink to this headline">¶</a></h4>
<div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="4%" />
<col width="89%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>recipient</td>
<td>string</td>
<td>recipient of the message as reported by <code class="docutils literal"><span class="pre">MAIL</span> <span class="pre">TO</span></code> during SMTP chat.</td>
</tr>
<tr class="row-odd"><td>sender</td>
<td>string</td>
<td>sender of the message as reported by <code class="docutils literal"><span class="pre">MAIL</span> <span class="pre">FROM</span></code> during SMTP chat. Note: this value may differ
from <code class="docutils literal"><span class="pre">From</span></code> MIME header.</td>
</tr>
<tr class="row-even"><td>from</td>
<td>string</td>
<td>sender of the message as reported by <code class="docutils literal"><span class="pre">From</span></code> message header, for example &#8220;Bob &lt;<a class="reference external" href="mailto:bob&#37;&#52;&#48;example&#46;com">bob<span>&#64;</span>example<span>&#46;</span>com</a>&gt;&#8221;.</td>
</tr>
<tr class="row-odd"><td>subject</td>
<td>string</td>
<td>subject string.</td>
</tr>
<tr class="row-even"><td>body-plain</td>
<td>string</td>
<td>text version of the email. This field is always present.
If the incoming message only has HTML body, Mailgun will create a text representation for you.</td>
</tr>
<tr class="row-odd"><td>stripped-text</td>
<td>string</td>
<td>text version of the message without quoted parts and signature block (if found).</td>
</tr>
<tr class="row-even"><td>stripped-signature</td>
<td>string</td>
<td>the signature block stripped from the plain text message (if found).</td>
</tr>
<tr class="row-odd"><td>body-html</td>
<td>string</td>
<td>HTML version of the message, if message was multipart. Note that all parts of the message will be posted,
not just text/html. For instance if a message arrives with &#8220;foo&#8221; part it will be posted as &#8220;body-foo&#8221;.</td>
</tr>
<tr class="row-even"><td>stripped-html</td>
<td>string</td>
<td>HTML version of the message, without quoted parts.</td>
</tr>
<tr class="row-odd"><td>attachment-count</td>
<td>int</td>
<td>how many attachments the message has.</td>
</tr>
<tr class="row-even"><td>attachment-x</td>
<td>string</td>
<td>attached file (&#8216;x&#8217; stands for number of the attachment). Attachments are handled as file uploads,
encoded as <code class="docutils literal"><span class="pre">multipart/form-data</span></code>.</td>
</tr>
<tr class="row-odd"><td>timestamp</td>
<td>int</td>
<td>number of seconds passed since January 1, 1970 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-even"><td>token</td>
<td>string</td>
<td>randomly generated string with length 50 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-odd"><td>signature</td>
<td>string</td>
<td>string with hexadecimal digits generate by HMAC algorithm (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-even"><td>message-headers</td>
<td>string</td>
<td>list of all MIME headers dumped to a json string (order of headers preserved).</td>
</tr>
<tr class="row-odd"><td>content-id-map</td>
<td>string</td>
<td>JSON-encoded dictionary which maps Content-ID (CID) of each attachment to the corresponding <code class="docutils literal"><span class="pre">attachment-x</span></code> parameter. This allows you to map posted attachments to tags like <code class="docutils literal"><span class="pre">&lt;img</span> <span class="pre">src='cid'&gt;</span></code> in the message body.</td>
</tr>
</tbody>
</table>
</div>
<p>Note the <code class="docutils literal"><span class="pre">message-headers</span></code> parameter. It was added because not all web frameworks support multi-valued keys parameters. For example Ruby on Rails requires a special syntax to post params like that: you need to add <cite>[]</cite> to a key to collect it&#8217;s values on the server side as an array. Below is a Ruby on Rails example of obtaining MIME headers via <code class="docutils literal"><span class="pre">message-headers</span></code> parameter:</p>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mailgun_posted_params</span>
  <span class="n">message_headers</span> <span class="o">=</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="s2">&quot;message-headers&quot;</span><span class="o">]</span><span class="p">)</span>
  <span class="n">message_headers</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">header</span><span class="o">|</span>
    <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">header</span>
    <span class="nb">puts</span> <span class="s2">&quot;header key: </span><span class="si">#{</span><span class="n">key</span><span class="si">}</span><span class="s2">, header value: </span><span class="si">#{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="mime-messages-parameters">
<h4>MIME Messages Parameters<a class="headerlink" href="#mime-messages-parameters" title="Permalink to this headline">¶</a></h4>
<div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="5%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>recipient</td>
<td>string</td>
<td>recipient of the message.</td>
</tr>
<tr class="row-odd"><td>sender</td>
<td>string</td>
<td>sender of the message as reported by SMTP MAIL FROM.</td>
</tr>
<tr class="row-even"><td>from</td>
<td>string</td>
<td>sender of the message as reported by <code class="docutils literal"><span class="pre">From</span></code> message header, for example &#8220;Bob &lt;<a class="reference external" href="mailto:bob&#37;&#52;&#48;example&#46;com">bob<span>&#64;</span>example<span>&#46;</span>com</a>&gt;&#8221;.</td>
</tr>
<tr class="row-odd"><td>subject</td>
<td>string</td>
<td>subject string.</td>
</tr>
<tr class="row-even"><td>body-mime</td>
<td>string</td>
<td>full MIME envelope. You will need a MIME parsing library to process this data.</td>
</tr>
<tr class="row-odd"><td>timestamp</td>
<td>int</td>
<td>number of seconds passed since January 1, 1970 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-even"><td>token</td>
<td>string</td>
<td>randomly generated string with length 50 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-odd"><td>signature</td>
<td>string</td>
<td>string with hexadecimal digits generate by HMAC algorithm(see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To receive raw MIME messages and perform your own parsing you must configure a route with a
URL ending with &#8220;mime&#8221;, like <a class="reference external" href="http://myhost/post_mime">http://myhost/post_mime</a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Consider using <a class="reference external" href="http://bin.mailgun.net/">http://bin.mailgun.net</a> to debug and play with your routes. This tool allows you to forward
incoming messages to a temporary URL and inspecting the posted data. No programming required.</p>
</div>
</div>
<div class="section" id="storing-and-retrieving-messages">
<h4>Storing and Retrieving Messages<a class="headerlink" href="#storing-and-retrieving-messages" title="Permalink to this headline">¶</a></h4>
<p>When storing an email through a <code class="docutils literal"><span class="pre">store()</span></code> action in a Route, you can chose to be notified when the message is stored by including a URL with the notify parameter when setting up the store action or you can retrieve the message later by searching for the message through the <a class="reference internal" href="api-events.html#api-events"><span class="std std-ref">Events API</span></a> and retrieving it through the <a class="reference internal" href="api-sending.html#api-sending-messages"><span class="std std-ref">Messages API</span></a>.</p>
<p>If you set a URL to be posted when the message is received (<code class="docutils literal"><span class="pre">store(notify=&quot;http://mydomain.com/callback&quot;)</span></code>), or retrieve the message later through a GET request to the <a class="reference internal" href="api-sending.html#api-sending-messages"><span class="std std-ref">Messages API</span></a>, the following parameters are posted/returned in JSON.</p>
<blockquote>
<div><div class="ptable container">
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="4%" />
<col width="89%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>domain</td>
<td>string</td>
<td>domain name this message was received for.</td>
</tr>
<tr class="row-odd"><td>recipient</td>
<td>string</td>
<td>recipient of the message as reported by <code class="docutils literal"><span class="pre">MAIL</span> <span class="pre">TO</span></code> during SMTP chat.</td>
</tr>
<tr class="row-even"><td>sender</td>
<td>string</td>
<td>sender of the message as reported by <code class="docutils literal"><span class="pre">MAIL</span> <span class="pre">FROM</span></code> during SMTP chat. Note: this value may differ
from <code class="docutils literal"><span class="pre">From</span></code> MIME header.</td>
</tr>
<tr class="row-odd"><td>from</td>
<td>string</td>
<td>sender of the message as reported by <code class="docutils literal"><span class="pre">From</span></code> message header, for example &#8220;Bob Lee &lt;<a class="reference external" href="mailto:blee&#37;&#52;&#48;mailgun&#46;net">blee<span>&#64;</span>mailgun<span>&#46;</span>net</a>&gt;&#8221;.</td>
</tr>
<tr class="row-even"><td>subject</td>
<td>string</td>
<td>subject string.</td>
</tr>
<tr class="row-odd"><td>body-plain</td>
<td>string</td>
<td>text version of the email. This field is always present.
If the incoming message only has HTML body, Mailgun will create a text representation for you.</td>
</tr>
<tr class="row-even"><td>stripped-text</td>
<td>string</td>
<td>text version of the message without quoted parts and signature block (if found).</td>
</tr>
<tr class="row-odd"><td>stripped-signature</td>
<td>string</td>
<td>the signature block stripped from the plain text message (if found).</td>
</tr>
<tr class="row-even"><td>body-html</td>
<td>string</td>
<td>HTML version of the message, if message was multipart. Note that all parts of the message will be posted,
not just text/html. For instance if a message arrives with &#8220;foo&#8221; part it will be posted as &#8220;body-foo&#8221;.</td>
</tr>
<tr class="row-odd"><td>stripped-html</td>
<td>string</td>
<td>HTML version of the message, without quoted parts.</td>
</tr>
<tr class="row-even"><td>attachments</td>
<td>string</td>
<td>contains a json list of metadata objects, one for each attachment, see below.</td>
</tr>
<tr class="row-odd"><td>message-url</td>
<td>string</td>
<td>a URL that you can use to get and/or delete the message. Only present in the payload posted to the notification URL.</td>
</tr>
<tr class="row-even"><td>timestamp</td>
<td>int</td>
<td>number of seconds passed since January 1, 1970 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-odd"><td>token</td>
<td>string</td>
<td>randomly generated string with length 50 (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-even"><td>signature</td>
<td>string</td>
<td>string with hexadecimal digits generate by HMAC algorithm (see <a class="reference internal" href="#securing-webhooks">securing webhooks</a>).</td>
</tr>
<tr class="row-odd"><td>message-headers</td>
<td>string</td>
<td>list of all MIME headers dumped to a json string (order of headers preserved).</td>
</tr>
<tr class="row-even"><td>content-id-map</td>
<td>string</td>
<td>JSON-encoded dictionary which maps Content-ID (CID) of each attachment to the corresponding <code class="docutils literal"><span class="pre">attachment-x</span></code> parameter. This allows you to map posted attachments to tags like <code class="docutils literal"><span class="pre">&lt;img</span> <span class="pre">src='cid'&gt;</span></code> in the message body.</td>
</tr>
</tbody>
</table>
</div>
</div></blockquote>
<p>The attachments JSON contains the following items.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="7%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>size</td>
<td>integer</td>
<td>indicates the size of the attachment in bytes.</td>
</tr>
<tr class="row-odd"><td>url</td>
<td>string</td>
<td>contains the url where the attachment can be found. This does not support DELETE.</td>
</tr>
<tr class="row-even"><td>name</td>
<td>string</td>
<td>the name of the attachment</td>
</tr>
<tr class="row-odd"><td>content-type</td>
<td>string</td>
<td>the content type of the attachment</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Alternatively, you can choose the following parameters when the <code class="docutils literal"><span class="pre">Accept</span></code> header is set to <code class="docutils literal"><span class="pre">message/rfc2822</span></code></p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="5%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>recipient</td>
<td>string</td>
<td>recipient of the message.</td>
</tr>
<tr class="row-odd"><td>sender</td>
<td>string</td>
<td>sender of the message as reported by SMTP MAIL FROM.</td>
</tr>
<tr class="row-even"><td>from</td>
<td>string</td>
<td>sender of the message as reported by <code class="docutils literal"><span class="pre">From</span></code> message header, for example &#8220;Bob &lt;<a class="reference external" href="mailto:bob&#37;&#52;&#48;example&#46;com">bob<span>&#64;</span>example<span>&#46;</span>com</a>&gt;&#8221;.</td>
</tr>
<tr class="row-odd"><td>subject</td>
<td>string</td>
<td>subject string.</td>
</tr>
<tr class="row-even"><td>body-mime</td>
<td>string</td>
<td>full MIME envelope. You will need a MIME parsing library to process this data.</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="api-routing-samples">
<h4>API Routing Samples<a class="headerlink" href="#api-routing-samples" title="Permalink to this headline">¶</a></h4>
<p>You can define routes programmatically using our <a class="reference internal" href="api-routes.html#api-routes"><span class="std std-ref">HTTP API</span></a>
like in these examples.</p>
<p>Create a route of the highest priority with multiple actions:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/routes <span class="se">\</span>
    -F <span class="nv">priority</span><span class="o">=</span><span class="m">0</span> <span class="se">\</span>
    -F <span class="nv">description</span><span class="o">=</span><span class="s1">&#39;Sample route&#39;</span> <span class="se">\</span>
    -F <span class="nv">expression</span><span class="o">=</span><span class="s1">&#39;match_recipient(&quot;.*@YOUR_DOMAIN_NAME&quot;)&#39;</span> <span class="se">\</span>
    -F <span class="nv">action</span><span class="o">=</span><span class="s1">&#39;forward(&quot;http://myhost.com/messages/&quot;)&#39;</span> <span class="se">\</span>
    -F <span class="nv">action</span><span class="o">=</span><span class="s1">&#39;stop()&#39;</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">CreateRoute</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">Form</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Form</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;priority&quot;</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;description&quot;</span><span class="o">,</span> <span class="s">&quot;Sample route&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;expression&quot;</span><span class="o">,</span> <span class="s">&quot;match_recipient(&#39;.*@YOUR_DOMAIN_NAME&#39;)&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;action&quot;</span><span class="o">,</span> <span class="s">&quot;forward(&#39;http://myhost.com/messages/&#39;)&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;action&quot;</span><span class="o">,</span> <span class="s">&quot;stop()&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/routes&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>

<span class="c1"># Issue the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s2">&quot;routes&quot;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;priority&#39;</span>    <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;expression&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;match_recipient(&quot;.*@YOUR_DOMAIN_NAME&quot;)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;action&#39;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;forward(&quot;http://host.com/messages&quot;)&#39;</span><span class="p">,</span> <span class="s1">&#39;stop()&#39;</span><span class="p">),</span>
    <span class="s1">&#39;description&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Sample route&#39;</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_route</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/routes&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
              <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Sample route&quot;</span><span class="p">,</span>
              <span class="s2">&quot;expression&quot;</span><span class="p">:</span> <span class="s2">&quot;match_recipient(&#39;.*@YOUR_DOMAIN_NAME&#39;)&quot;</span><span class="p">,</span>
              <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;forward(&#39;http://myhost.com/messages/&#39;)&quot;</span><span class="p">,</span> <span class="s2">&quot;stop()&quot;</span><span class="p">]})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_route</span>
  <span class="n">data</span> <span class="o">=</span> <span class="no">Multimap</span><span class="o">.</span><span class="n">new</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:priority</span><span class="o">]</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:description</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Sample route&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:expression</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;match_recipient(&#39;.*@YOUR_DOMAIN_NAME&#39;)&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:action</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;forward(&#39;http://myhost.com/messages/&#39;)&quot;</span>
  <span class="n">data</span><span class="o">[</span><span class="ss">:action</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;stop()&quot;</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/routes&quot;</span><span class="p">,</span> <span class="n">data</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">CreateRouteChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">CreateRoute</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">CreateRoute</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;routes&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;priority&quot;</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;description&quot;</span><span class="p">,</span> <span class="s">&quot;Sample route&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;expression&quot;</span><span class="p">,</span> <span class="s">&quot;match_recipient(&#39;.*@YOUR_DOMAIN_NAME&#39;)&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;action&quot;</span><span class="p">,</span>
                              <span class="s">&quot;forward(&#39;http://myhost.com/messages/&#39;)&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;action&quot;</span><span class="p">,</span> <span class="s">&quot;stop()&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">CreateRoute</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">mailgun</span><span class="p">.</span><span class="nx">Route</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">CreateRoute</span><span class="p">(</span><span class="nx">mailgun</span><span class="p">.</span><span class="nx">Route</span><span class="p">{</span>
    <span class="nx">Priority</span><span class="p">:</span>    <span class="mi">1</span><span class="p">,</span>
    <span class="nx">Description</span><span class="p">:</span> <span class="s">&quot;Sample Route&quot;</span><span class="p">,</span>
    <span class="nx">Expression</span><span class="p">:</span>  <span class="s">&quot;match_recipient(\&quot;.*@YOUR_DOMAIN_NAME\&quot;)&quot;</span><span class="p">,</span>
    <span class="nx">Actions</span><span class="p">:</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{</span>
      <span class="s">&quot;forward(\&quot;http://example.com/messages/\&quot;)&quot;</span><span class="p">,</span>
      <span class="s">&quot;stop()&quot;</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">})</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample response:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="s2">&quot;Route has been created&quot;</span><span class="p">,</span>
  <span class="s2">&quot;route&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;description&quot;</span><span class="o">:</span> <span class="s2">&quot;Sample route&quot;</span><span class="p">,</span>
      <span class="s2">&quot;created_at&quot;</span><span class="o">:</span> <span class="s2">&quot;Wed, 15 Feb 2012 13:03:31 GMT&quot;</span><span class="p">,</span>
      <span class="s2">&quot;actions&quot;</span><span class="o">:</span> <span class="p">[</span>
          <span class="s2">&quot;forward(\&quot;http://myhost.com/messages/\&quot;)&quot;</span><span class="p">,</span>
          <span class="s2">&quot;stop()&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;priority&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;expression&quot;</span><span class="o">:</span> <span class="s2">&quot;match_recipient(\&quot;.*@samples.mailgun.org\&quot;)&quot;</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;4f3bad2335335426750048c6&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Higher priority routes are handled first. Smaller numbers indicate
higher priority. Default is 0.</p>
</div>
<p>Listing routes:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> -G <span class="se">\</span>
    https://api.mailgun.net/v3/routes <span class="se">\</span>
    -d <span class="nv">skip</span><span class="o">=</span><span class="m">1</span> <span class="se">\</span>
    -d <span class="nv">limit</span><span class="o">=</span>1
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">ParseAddresses</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/routes&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">&quot;skip&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>
            <span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">&quot;limit&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">()</span>
            <span class="o">.</span><span class="na">buildGet</span><span class="o">()</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>

<span class="c1"># Issue the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s2">&quot;routes&quot;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;skip&#39;</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;limit&#39;</span> <span class="o">=&gt;</span> <span class="mi">10</span><span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_routes</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/routes&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;skip&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_routes</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">get</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/routes&quot;</span><span class="p">,</span> <span class="ss">:params</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="ss">:skip</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="ss">:limit</span> <span class="o">=&gt;</span> <span class="mi">1</span>
  <span class="p">}</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">GetRoutesChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">GetRoutes</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">GetRoutes</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;routes&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;skip&quot;</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;limit&quot;</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">GetRoutes</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="p">[]</span><span class="nx">mailgun</span><span class="p">.</span><span class="nx">Route</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">GetRoutes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample response:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;total_count&quot;</span><span class="o">:</span> <span class="mi">266</span><span class="p">,</span>
  <span class="s2">&quot;items&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
          <span class="s2">&quot;description&quot;</span><span class="o">:</span> <span class="s2">&quot;Sample route&quot;</span><span class="p">,</span>
          <span class="s2">&quot;created_at&quot;</span><span class="o">:</span> <span class="s2">&quot;Wed, 15 Feb 2012 12:58:12 GMT&quot;</span><span class="p">,</span>
          <span class="s2">&quot;actions&quot;</span><span class="o">:</span> <span class="p">[</span>
              <span class="s2">&quot;forward(\&quot;http://myhost.com/messages/\&quot;)&quot;</span><span class="p">,</span>
              <span class="s2">&quot;stop()&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;priority&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;expression&quot;</span><span class="o">:</span> <span class="s2">&quot;match_recipient(\&quot;.*@samples.mailgun.org\&quot;)&quot;</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;4f3babe4ba8a481c6400476a&quot;</span>
      <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Access the route by id:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/routes/4f3bad2335335426750048c6
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">GetRoute</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/routes/{route_id}&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;route_id&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_ROUTE_ID&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">()</span>
            <span class="o">.</span><span class="na">buildGet</span><span class="o">()</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$routeId</span> <span class="o">=</span> <span class="s1">&#39;4e97c1b2ba8a48567f007fb6&#39;</span><span class="p">;</span>

<span class="c1"># Issue the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s2">&quot;routes/</span><span class="si">$routeId</span><span class="s2">&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_route</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/routes/4e97c1b2ba8a48567f007fb6&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_route</span>
  <span class="no">RestClient</span><span class="o">.</span>
    <span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
        <span class="s2">&quot;@api.mailgun.net/v3/routes/&quot;</span><span class="p">\</span>
        <span class="s2">&quot;4e97c1b2ba8a48567f007fb6&quot;</span><span class="p">){</span><span class="o">|</span><span class="n">response</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">result</span><span class="o">|</span> <span class="n">response</span> <span class="p">}</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">GetRouteChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">GetRoute</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">GetRoute</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;routes/{id}&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddUrlSegment</span> <span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="s">&quot;4e97c1b2ba8a48567f007fb6&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">GetRouteByID</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">Route</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">GetRouteByID</span><span class="p">(</span><span class="s">&quot;4e97c1b2ba8a48567f007fb6&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample response:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;route&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;description&quot;</span><span class="o">:</span> <span class="s2">&quot;Sample route&quot;</span><span class="p">,</span>
      <span class="s2">&quot;created_at&quot;</span><span class="o">:</span> <span class="s2">&quot;Wed, 15 Feb 2012 13:03:31 GMT&quot;</span><span class="p">,</span>
      <span class="s2">&quot;actions&quot;</span><span class="o">:</span> <span class="p">[</span>
          <span class="s2">&quot;forward(\&quot;http://myhost.com/messages/\&quot;)&quot;</span><span class="p">,</span>
          <span class="s2">&quot;stop()&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;priority&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;expression&quot;</span><span class="o">:</span> <span class="s2">&quot;match_recipient(\&quot;.*@samples.mailgun.org\&quot;)&quot;</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;4f3bad2335335426750048c6&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="credentials">
<h3>Credentials<a class="headerlink" href="#credentials" title="Permalink to this headline">¶</a></h3>
<p>Mailgun gives you the ability to programmatically create SMTP credentials which can be used to send mail. SMTP credentials can be used to relay email, through Mailgun, using the SMTP protocol.</p>
<div class="section" id="smtp-credentials-api-examples">
<h4>SMTP Credentials API Examples<a class="headerlink" href="#smtp-credentials-api-examples" title="Permalink to this headline">¶</a></h4>
<p>Listing all credentials:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> -G <span class="se">\</span>
    https://api.mailgun.net/v3/domains/YOUR_DOMAIN_NAME/credentials
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">GetCredentials</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/credentials&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">()</span>
            <span class="o">.</span><span class="na">buildGet</span><span class="o">()</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s1">&#39;YOUR_DOMAIN_NAME&#39;</span><span class="p">;</span>

<span class="c1"># Issue the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s2">&quot;domains/</span><span class="si">$domain</span><span class="s2">/credentials&quot;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;limit&#39;</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s1">&#39;skip&#39;</span>  <span class="o">=&gt;</span> <span class="mi">10</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_credentials</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/domains/YOUR_DOMAIN_NAME/credentials&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_credentials</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">get</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/domains/YOUR_DOMAIN_NAME/credentials&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">GetCredentialsChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">GetCredentials</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">GetCredentials</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;domains/{domain}/credentials&quot;</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">GetCredentials</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="p">[]</span><span class="nx">mailgun</span><span class="p">.</span><span class="nx">Credential</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">GetCredentials</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample response:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;total_count&quot;</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="s2">&quot;items&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;size_bytes&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;created_at&quot;</span><span class="o">:</span> <span class="s2">&quot;Tue, 27 Sep 2011 20:24:22 GMT&quot;</span><span class="p">,</span>
      <span class="s2">&quot;mailbox&quot;</span><span class="o">:</span> <span class="s2">&quot;user@samples.mailgun.org&quot;</span>
      <span class="s2">&quot;login&quot;</span><span class="o">:</span> <span class="s2">&quot;user@samples.mailgun.org&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;size_bytes&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;created_at&quot;</span><span class="o">:</span> <span class="s2">&quot;Thu, 06 Oct 2011 10:22:36 GMT&quot;</span><span class="p">,</span>
      <span class="s2">&quot;mailbox&quot;</span><span class="o">:</span> <span class="s2">&quot;user@samples.mailgun.org&quot;</span>
      <span class="s2">&quot;login&quot;</span><span class="o">:</span> <span class="s2">&quot;user@samples.mailgun.org&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Creating a new SMTP credential:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> <span class="se">\</span>
    https://api.mailgun.net/v3/domains/YOUR_DOMAIN_NAME/credentials <span class="se">\</span>
    -F <span class="nv">login</span><span class="o">=</span><span class="s1">&#39;alice@YOUR_DOMAIN_NAME&#39;</span> <span class="se">\</span>
    -F <span class="nv">password</span><span class="o">=</span><span class="s1">&#39;supasecret&#39;</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">CreateCredentials</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">Form</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Form</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;login&quot;</span><span class="o">,</span> <span class="s">&quot;alice@YOUR_DOMAIN_NAME&quot;</span><span class="o">);</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;password&quot;</span><span class="o">,</span> <span class="s">&quot;supersecret&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/credentials&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPost</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s1">&#39;YOUR_DOMAIN_NAME&#39;</span><span class="p">;</span>

<span class="c1"># Issue the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s2">&quot;domains/</span><span class="si">$domain</span><span class="s2">/credentials&quot;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;login&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;alice@YOUR_DOMAIN_NAME&#39;</span><span class="p">,</span>
    <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;secret&#39;</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_credentials</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/domains/YOUR_DOMAIN_NAME/credentials&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;login&quot;</span><span class="p">:</span> <span class="s2">&quot;alice@YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span>
              <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;secret&quot;</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_credentials</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">post</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/domains/YOUR_DOMAIN_NAME/credentials&quot;</span><span class="p">,</span>
  <span class="ss">:login</span> <span class="o">=&gt;</span> <span class="s2">&quot;alice@YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span>
  <span class="ss">:password</span> <span class="o">=&gt;</span> <span class="s2">&quot;secret&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">CreateCredentialsChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">CreateCredentials</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">CreateCredentials</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;domains/{domain}/credentials&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;login&quot;</span><span class="p">,</span> <span class="s">&quot;alice@YOUR_DOMAIN_NAME&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">,</span> <span class="s">&quot;secret&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">CreateCredential</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">CreateCredential</span><span class="p">(</span><span class="s">&quot;alice@YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="s">&quot;secret&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="s2">&quot;Created 1 credentials pair(s)&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Updating the password for a given credential:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> -X PUT <span class="se">\</span>
    https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/credentials/alice <span class="se">\</span>
    -F <span class="nv">password</span><span class="o">=</span><span class="s1">&#39;abc123&#39;</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">ChangeCredentialPassword</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="n">Form</span> <span class="n">reqData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Form</span><span class="o">();</span>
        <span class="n">reqData</span><span class="o">.</span><span class="na">param</span><span class="o">(</span><span class="s">&quot;password&quot;</span><span class="o">,</span> <span class="s">&quot;supersecret&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/{domain}/credentials/{username}&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;username&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_MAILBOX_USER&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildPut</span><span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">reqData</span><span class="o">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">))</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s1">&#39;YOUR_DOMAIN_NAME&#39;</span><span class="p">;</span>
<span class="nv">$login</span><span class="o">=</span> <span class="s1">&#39;alice&#39;</span><span class="p">;</span>

<span class="c1"># Issue the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">put</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$domain</span><span class="s2">/credentials/</span><span class="si">$login</span><span class="s2">&quot;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;supersecret&#39;</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">change_credential_password</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">put</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/YOUR_DOMAIN_NAME/credentials/alice&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;supersecret&quot;</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">change_credential_password</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">put</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/YOUR_DOMAIN_NAME/credentials/alice&quot;</span><span class="p">,</span>
  <span class="ss">:password</span> <span class="o">=&gt;</span> <span class="s2">&quot;supersecret&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">ChangePwdCredentialsChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">ChangeCredentialPassword</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">ChangeCredentialPassword</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;{domain}/credentials/{username}&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddUrlSegment</span> <span class="p">(</span><span class="s">&quot;username&quot;</span><span class="p">,</span> <span class="s">&quot;alice&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">,</span> <span class="s">&quot;supersecret&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">PUT</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="c1">// coming soon</span>
</pre></div>
</div>
<p>Sample response:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="s2">&quot;Password changed&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Deleting a given credential:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>curl -s --user <span class="s1">&#39;api:YOUR_API_KEY&#39;</span> -X DELETE <span class="se">\</span>
    https://api.mailgun.net/v3/domains/YOUR_DOMAIN_NAME/credentials/alice
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.ws.rs.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.ClientBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.client.WebTarget</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.core.Form</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.glassfish.jersey.client.authentication.HttpAuthenticationFeature</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MGSample</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ClientResponse</span> <span class="nf">DeleteCredentials</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">();</span>
        <span class="n">client</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">HttpAuthenticationFeature</span><span class="o">.</span><span class="na">basic</span><span class="o">(</span>
            <span class="s">&quot;api&quot;</span><span class="o">,</span>
            <span class="s">&quot;YOUR_API_KEY&quot;</span>
        <span class="o">));</span>

        <span class="n">WebTarget</span> <span class="n">mgRoot</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mgRoot</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;/domains/{domain}/credentials/{username}&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;domain&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">resolveTemplate</span><span class="o">(</span><span class="s">&quot;username&quot;</span><span class="o">,</span> <span class="s">&quot;YOUR_CREDENTIAL_USERNAME&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
            <span class="o">.</span><span class="na">buildDelete</span><span class="o">()</span>
            <span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">ClientResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1"># Include the Autoloader (see &quot;Libraries&quot; for install instructions)</span>
<span class="k">require</span> <span class="s1">&#39;vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mailgun\Mailgun</span><span class="p">;</span>

<span class="c1"># Instantiate the client.</span>
<span class="nv">$mgClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mailgun</span><span class="p">(</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">);</span>
<span class="nv">$domain</span> <span class="o">=</span> <span class="s1">&#39;YOUR_DOMAIN_NAME&#39;</span><span class="p">;</span>
<span class="nv">$login</span> <span class="o">=</span> <span class="s1">&#39;alice&#39;</span><span class="p">;</span>

<span class="c1"># Issue the call to the client.</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mgClient</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span><span class="s2">&quot;domains/</span><span class="si">$domain</span><span class="s2">/credentials/</span><span class="si">$login</span><span class="s2">&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_credentials</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
        <span class="s2">&quot;https://api.mailgun.net/v3/domains/YOUR_DOMAIN_NAME/credentials/alice&quot;</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR_API_KEY&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-rb"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_credentials</span>
  <span class="no">RestClient</span><span class="o">.</span><span class="n">delete</span> <span class="s2">&quot;https://api:YOUR_API_KEY&quot;</span><span class="p">\</span>
  <span class="s2">&quot;@api.mailgun.net/v3/domains/YOUR_DOMAIN_NAME/credentials/alice&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">RestSharp.Authenticators</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">DeleteCredentialsChunk</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">DeleteCredentials</span> <span class="p">().</span><span class="n">Content</span><span class="p">.</span><span class="n">ToString</span> <span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IRestResponse</span> <span class="nf">DeleteCredentials</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RestClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestClient</span> <span class="p">();</span>
        <span class="n">client</span><span class="p">.</span><span class="n">BaseUrl</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span> <span class="p">(</span><span class="s">&quot;https://api.mailgun.net/v3&quot;</span><span class="p">);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">HttpBasicAuthenticator</span> <span class="p">(</span><span class="s">&quot;api&quot;</span><span class="p">,</span>
                                        <span class="s">&quot;YOUR_API_KEY&quot;</span><span class="p">);</span>
        <span class="n">RestRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RestRequest</span> <span class="p">();</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddParameter</span> <span class="p">(</span><span class="s">&quot;domain&quot;</span><span class="p">,</span> <span class="s">&quot;YOUR_DOMAIN_NAME&quot;</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">.</span><span class="n">UrlSegment</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Resource</span> <span class="p">=</span> <span class="s">&quot;domains/{domain}/credentials/{login}&quot;</span><span class="p">;</span>
        <span class="n">request</span><span class="p">.</span><span class="n">AddUrlSegment</span> <span class="p">(</span><span class="s">&quot;login&quot;</span><span class="p">,</span> <span class="s">&quot;alice&quot;</span><span class="p">);</span>
        <span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="n">Method</span><span class="p">.</span><span class="n">DELETE</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="n">Execute</span> <span class="p">(</span><span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">DeleteCredential</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
  <span class="nx">mg</span> <span class="o">:=</span> <span class="nx">mailgun</span><span class="p">.</span><span class="nx">NewMailgun</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">mg</span><span class="p">.</span><span class="nx">DeleteCredential</span><span class="p">(</span><span class="s">&quot;alice&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample response:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="s2">&quot;Credentials have been deleted&quot;</span><span class="p">,</span>
  <span class="s2">&quot;spec&quot;</span><span class="o">:</span> <span class="s2">&quot;alice@samples.mailgun.org&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="spam-filter">
<span id="um-spam-filter"></span><h3>Spam Filter<a class="headerlink" href="#spam-filter" title="Permalink to this headline">¶</a></h3>
<p>If you are receiving email, you need spam filtering. Mailgun spam filtering is powered
by an army of SpamAssassin machines. Mailgun gives you three ways to configure spam
filtering. You can select the appropriate option in the Control Panel when you click
on a domain name in the &#8216;Domains&#8217; tab.</p>
<ul class="simple">
<li>Disabled (default)</li>
<li>Delete spam (spam is removed and you won’t see it)</li>
<li>Mark spam with MIME headers and you decide what to do with it</li>
</ul>
<p>If you chose option 3, there are four headers we provide for you: <code class="docutils literal"><span class="pre">X-Mailgun-Sflag</span></code>,
<code class="docutils literal"><span class="pre">X-Mailgun-Sscore</span></code>, <code class="docutils literal"><span class="pre">X-Mailgun-Dkim-Check-Result</span></code> and <code class="docutils literal"><span class="pre">X-Mailgun-Spf</span></code>.</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">X-Mailgun-Sflag</span></code></dt>
<dd>Inserted with the value &#8216;Yes&#8217; if the message was classified as a spam.</dd>
<dt><code class="docutils literal"><span class="pre">X-Mailgun-Sscore</span></code></dt>
<dd><p class="first">A &#8216;spamicity&#8217; score that you can use to calibrate your own filter. Inserted for every
message checked for a spam. The score ranges from low negative digits (very unlikely to be spam)
to 20 and occasionally higher (very likely to be spam).</p>
<p class="last">At the time of writing this, we are filtering spam at a score of around 5.0 but we are
constantly calibrating this.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">X-Mailgun-Dkim-Check-Result</span></code></dt>
<dd>If DKIM is used to sign an inbound message, Mailgun will attempt DKIM validation,
the results will be stored in this header.
Possible values are: &#8216;Pass&#8217; or &#8216;Fail&#8217;</dd>
<dt><code class="docutils literal"><span class="pre">X-Mailgun-Spf</span></code></dt>
<dd>Mailgun will perform an SPF validation, and results will be stored in this header.
Possible values are: &#8216;Pass&#8217;, &#8216;Neutral&#8217;, &#8216;Fail&#8217; or &#8216;SoftFail&#8217;.</dd>
</dl>
</div>
</div>
<div class="section" id="smtp-protocol">
<span id="smtp"></span><h2>SMTP Protocol<a class="headerlink" href="#smtp-protocol" title="Permalink to this headline">¶</a></h2>
<p>In addition to our HTTP API, Mailgun servers supports the standard SMTP protocol... You can send using SMTP with or without TLS.</p>
<p>Please consult a standard library documentation for language of your choice to learn how to use the SMTP protocol. Below are some helpful links for a few popular languages:</p>
<ul class="simple">
<li><a class="reference external" href="http://ruby-doc.org/stdlib/libdoc/net/smtp/rdoc/classes/Net/SMTP.html">Ruby SMTP</a></li>
<li><a class="reference external" href="http://docs.python.org/library/smtplib.html">Python SMTP</a></li>
<li><a class="reference external" href="http://java.sun.com/products/javamail/javadocs/index.html">JavaMail API</a></li>
</ul>
<div class="section" id="smtp-relay">
<h3>SMTP Relay<a class="headerlink" href="#smtp-relay" title="Permalink to this headline">¶</a></h3>
<p>You can also configure your own mailserver to relay mail via Mailgun as shown below. All of them require these three variables which you can look up in the Control Panel:</p>
<ul class="simple">
<li>Your SMTP username</li>
<li>Your SMTP password</li>
<li>SMTP host name mailserver (these instructions will use smtp.mailgun.org as an example)</li>
</ul>
<p>You have an SMTP username and password for each domain you have at Mailgun.  To send mail from a particular domain, just use the appropriate credentials.</p>
<p><strong>Postfix Instructions</strong></p>
<p>You have to configure a relay host with SASL authentication like shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># /etc/postfix/main.cf:</span>

<span class="n">mydestination</span> <span class="o">=</span> <span class="n">localhost</span><span class="o">.</span><span class="n">localdomain</span><span class="p">,</span> <span class="n">localhost</span>
<span class="n">relayhost</span> <span class="o">=</span> <span class="p">[</span><span class="n">smtp</span><span class="o">.</span><span class="n">mailgun</span><span class="o">.</span><span class="n">org</span><span class="p">]:</span><span class="mi">587</span>
<span class="n">smtp_sasl_auth_enable</span> <span class="o">=</span> <span class="n">yes</span>
<span class="n">smtp_sasl_password_maps</span> <span class="o">=</span> <span class="n">static</span><span class="p">:</span><span class="n">postmaster</span><span class="nd">@mydomain</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">password</span>
<span class="n">smtp_sasl_security_options</span> <span class="o">=</span> <span class="n">noanonymous</span>

<span class="c1"># TLS support</span>
<span class="n">smtp_tls_security_level</span> <span class="o">=</span> <span class="n">may</span>
<span class="n">smtpd_tls_security_level</span> <span class="o">=</span> <span class="n">may</span>
<span class="n">smtp_tls_note_starttls_offer</span> <span class="o">=</span> <span class="n">yes</span>
</pre></div>
</div>
<p>When using TLS encryption, make sure Postfix knows where to locate the CA database for your Linux distribution:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">smtpd_tls_key_file</span> <span class="o">=</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">private</span><span class="o">/</span><span class="n">smtpd</span><span class="o">.</span><span class="n">key</span>
<span class="n">smtpd_tls_cert_file</span> <span class="o">=</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">certs</span><span class="o">/</span><span class="n">smtpd</span><span class="o">.</span><span class="n">crt</span>
<span class="n">smtpd_tls_CApath</span> <span class="o">=</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">certs</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can use SMTP Credentials, but not your Control Panel password.</p>
</div>
<p><strong>Exim Instructions</strong></p>
<p>For more information see Exim&#8217;s documentation for authenticated outgoing SMTP. You need to configure &#8220;smarthost&#8221; for your Exim setup.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span># In your exim.conf:
# In routes configuration:
mailgun:
        driver = manualroute
        domains = ! +local_domains
        transport = mailgun_transport
        route_list = * smtp.mailgun.org byname

# In transports configuration:
        mailgun_transport:
        driver=smtp
        hosts_try_auth = smtp.mailgun.org
</pre></div>
</div>
<p>Also make sure to configure login credentials (in your /etc/exim/passwd.client):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">*.</span><span class="n">mailgun</span><span class="o">.</span><span class="n">org</span><span class="p">:</span><span class="n">username</span><span class="p">:</span><span class="n">password</span>
</pre></div>
</div>
<p><strong>Sendmail Instructions</strong></p>
<p>Define the smarthost in your sendmail.mc before mailer definitions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>## Mailgun
define(`SMART_HOST&#39;, `smtp.mailgun.org&#39;)dnl
FEATURE(`authinfo&#39;, `hash /etc/mail/authinfo&#39;)dnl
# optional, see http://www.sendmail.org/m4/features.html before enabling:
# FEATURE(`accept_unresolvable_domains&#39;)dnl
# FEATURE(`accept_unqualified_senders&#39;)dnl
# execute: make -C /etc/mail
## Mailgun
</pre></div>
</div>
<p>Specify login credentials in your authinfo:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">AuthInfo</span><span class="p">:</span><span class="n">smtp</span><span class="o">.</span><span class="n">mailgun</span><span class="o">.</span><span class="n">org</span> <span class="s2">&quot;U:&lt;LOGIN&gt;&quot;</span> <span class="s2">&quot;P:&lt;PASSWORD&gt;&quot;</span> <span class="s2">&quot;M:PLAIN&quot;</span>
</pre></div>
</div>
<p>Don&#8217;t forget to run the following command and then restart sendmail:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">mail</span>
</pre></div>
</div>
</div>
<div class="section" id="using-standard-email-clients">
<h3>Using Standard Email Clients<a class="headerlink" href="#using-standard-email-clients" title="Permalink to this headline">¶</a></h3>
<p>Standard email clients like Thunderbird or Outlook can also be used to send mail.</p>
<p>Settings for sending mail:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SMTP</span> <span class="n">server</span><span class="p">:</span> <span class="n">smtp</span><span class="o">.</span><span class="n">mailgun</span><span class="o">.</span><span class="n">org</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Use a full address like &#8220;<a class="reference external" href="mailto:user&#37;&#52;&#48;mymailgundomain&#46;com">user<span>&#64;</span>mymailgundomain<span>&#46;</span>com</a>&#8221; as a login for SMTP. SSL or TLS are supported.</p>
</div>
</div>
</div>
<div class="section" id="tls-sending-connection-settings">
<span id="tls-sending"></span><h2>TLS Sending Connection Settings<a class="headerlink" href="#tls-sending-connection-settings" title="Permalink to this headline">¶</a></h2>
<p>For message delivery, Mailgun exposes two flags that will work at the domain level or message level
(message level will override domain level) that allow you to control how messages are delivered. See
documentation for sending messages and domains for examples on how these fields can be updated.</p>
<p><strong>require tls</strong>: If set to <cite>True</cite> this requires the message only be sent over
a TLS connection. If a TLS connection can not be established,
Mailgun will not deliver the message. If set to <cite>False</cite>, Mailgun will still
try and upgrade the connection, but if Mailgun can not, the message will be
delivered over a plaintext SMTP connection. The default is False.</p>
<p><strong>skip verification</strong>: If set to <cite>True</cite>, the certificate and hostname will not be
verified when trying to establish a TLS connection and Mailgun will accept any
certificate during delivery. If set to <cite>False</cite>, Mailgun will verify the certificate
and hostname. If either one can not be verified, a TLS connection will not be
established. The default is <cite>False</cite>.</p>
<p>To help you better understand the configuration possibilities and potential issues, take a look at the
following table. Take into account the type of threat you are concerned with when making your decision
on how to configure sending settings. By default, <cite>require-tls</cite> and <cite>skip-verification</cite> are <cite>false</cite>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="15%" />
<col width="7%" />
<col width="21%" />
<col width="25%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">require-tls</th>
<th class="head">skip-verification</th>
<th class="head">TLS</th>
<th class="head">TLS Active Attack (MITM)</th>
<th class="head">TLS Passive Attack (Capture)</th>
<th class="head">Passive Plaintext Capture</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>false</td>
<td>false</td>
<td>Attempt</td>
<td>Not Possible</td>
<td>Not Possible</td>
<td>Possible via downgrade</td>
</tr>
<tr class="row-odd"><td>false</td>
<td>true</td>
<td>Attempt</td>
<td>Possible</td>
<td>Not Possible</td>
<td>If STARTTLS not offered</td>
</tr>
<tr class="row-even"><td>true</td>
<td>false</td>
<td>Required</td>
<td>Not Possible</td>
<td>Not Possible</td>
<td>Not Possible</td>
</tr>
<tr class="row-odd"><td>true</td>
<td>true</td>
<td>Required</td>
<td>Possible</td>
<td>Not Possible</td>
<td>Not Possible</td>
</tr>
</tbody>
</table>
<p>Additionally the following fields are available in your logs under <cite>delivery-status</cite> to indicate how the message was delivered:</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>tls</td>
<td>Indicates if a TLS connection was used or not when delivering the message.</td>
</tr>
<tr class="row-odd"><td>certificate-verified</td>
<td>Indicates if we verified the certificate or not when delivering the message.</td>
</tr>
<tr class="row-even"><td>mx-host</td>
<td>Tells you the MX server we connected to to deliver the message.</td>
</tr>
</tbody>
</table>
</div>
</div>


            </div>
          </div>
    </div>
      <div class="clearer"></div>
    </div>

    </div> <!-- /content -->
  </section> <!-- /container -->
</div> <!-- /body --> 

    <script type="text/javascript" charset="utf-8" src="_static/toc.js"></script>
    <script type="text/javascript" charset="utf-8" src="_static/jquery.debounce.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="_static/jquery.cookie.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="_static/jquery.viewport.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="_static/samples.js"></script>
    <script type="text/javascript" charset="utf-8" src="_static/scroll_hash.js"></script>
    <script type="text/javascript" charset="utf-8" src="_static/underscore-min.js"></script>
    <script type="text/javascript">
        window.underscore = _.noConflict();
    </script>


<script type="text/javascript">
  var Swiftype = window.Swiftype || {};
  (function() {
    Swiftype.key = 'dpKXg3Qg6P5paq8LDpDu';
    Swiftype.inputElement = '#st-search-input';
    Swiftype.resultContainingElement = '#st-results-container';
    Swiftype.attachElement = '#st-search-input';
    Swiftype.renderStyle = "overlay";


    var script = document.createElement('script');
    script.type = 'text/javascript';
    script.async = true;
    script.src = "http://swiftype.com/embed.js";
    var entry = document.getElementsByTagName('script')[0];
    entry.parentNode.insertBefore(script, entry);
  }());
</script>

<!-- Ace editor for editable code -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/ace/1.1.01/ace.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript">
  (function() {
    var timer;
    function waitForSwiftype() {
      if (Swiftype.Util && Swiftype.Util.pingSearchResultClick) {
        clearInterval(timer);
        Swiftype.Util.pingSearchResultClick = function(docId, query, destinationUrl, theWindow) {
          var url = Swiftype.root_url + "/api/v1/public/analytics/pc?engine_key=" + Swiftype.key + "&doc_id=" + docId + "&q=" + query;
          var queryAnchor = query.replace(/\s+/g, '-').toLowerCase();
          Swiftype.Util.pingUrl(url, destinationUrl + '?highlight=' + query + '#' + queryAnchor, theWindow);
        };
      }
    }
    timer = setInterval(waitForSwiftype, 500);
  })();

   // $('input[type=\"search\"]').wrap('<span style=\"position:relative;\"></span>').after('<i id="clear-search" class="icon-remove-sign" style=\"position:absolute; right:5px;line-height:26px;\"></i><i class="icon-search" style=\"position:absolute; left:5px;line-height:26px;\"></i>');
   // $('#clear-search').click(function(){
   //  $(this).parent().find('input').val('');
   //  $(this).parent().find('input').focus();
   // });
   // $("input").focusout(function() {this.value = "";});

    // Responsive navigation show/hide main nav
	$("#js-show-nav").click(function(){
		$("#js-header-nav").slideToggle();
	});




  // highlight nav on load
  $(document).ready(function(){
      $('.docs-sidebar li').removeClass('active');
      $('.docs-sidebar ul.current li.current a.current').parent().addClass('active');
  });




  // Make sample code snippets editable in the browser
  $('.highlight pre').click(function(){
    ace_activate(this);
  });

  // Ace editor activation
  function ace_activate(container) {
    var editor = ace.edit(container);
    editor.setTheme("ace/theme/monokai");
    editor.getSession().setMode("ace/mode/sh");
    editor.setShowPrintMargin(false);
    editor.renderer.setShowGutter(false);
    editor.setHighlightActiveLine(false);
    editor.getSession().setUseWrapMode(true);
    editor.setBehavioursEnabled(false);
    $(container).height(editor.getSession().getScreenLength() * 20);
  }

</script>

<!-- User information insertion code-->
<script type="text/javascript">
  var cp_hostname = "";
</script>
  
<script type="text/javascript"
  src="_static/insert-api-key.js">
</script>
  </body>

<!-- Mirrored from documentation.mailgun.com/user_manual.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 14 Jan 2017 00:06:51 GMT -->
</html>